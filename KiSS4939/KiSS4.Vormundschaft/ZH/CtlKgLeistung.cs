#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.832
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Drawing;
using KiSS.DBScheme;
using KiSS4.Common;
using Kiss.Interfaces.UI;
using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Vormundschaft.ZH
{
    public class CtlKgLeistung : KiSS4.Gui.KissUserControl
    {
        #region Fields

        private KiSS4.Gui.KissButton btnReopen;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissTextEdit editMA;
        private KiSS4.Gui.KissLookUpEdit edtAbschlussgrund;
        private KiSS4.Gui.KissMemoEdit edtBemerkung;
        private KiSS4.Gui.KissDateEdit edtDatumBis;
        private KiSS4.Gui.KissDateEdit edtDatumVon;
        private KiSS4.Gui.KissTextEdit edtFaLeistungID;
        private int faLeistungID = 0;
        private KiSS4.Gui.KissLabel kissLabel1;
        private KiSS4.Gui.KissLabel kissLabel2;
        private KiSS4.Gui.KissLabel kissLabel3;
        private KiSS4.Gui.KissLabel kissLabel4;
        private KiSS4.Gui.KissLabel kissLabel5;
        private KiSS4.Gui.KissLabel kissLabel6;
        private KiSS4.Gui.KissLabel kissLabel7;
        private KiSS4.Gui.KissLabel kissLabel8;
        private KiSS4.Gui.KissLabel kissLabel9;
        private KiSS4.Gui.KissLookUpEdit kissLookUpEdit1;
        private KiSS4.Gui.KissTextEdit kissTextEdit1;
        private KiSS4.Gui.KissLabel lblTitel;
        private System.Windows.Forms.Panel panel1;
        private System.Windows.Forms.PictureBox picTitel;
        private KiSS4.DB.SqlQuery qryFaLeistung;

        #endregion

        #region Constructors

        public CtlKgLeistung()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlKgLeistung));
            this.kissLabel5 = new KiSS4.Gui.KissLabel();
            this.kissLookUpEdit1 = new KiSS4.Gui.KissLookUpEdit();
            this.edtDatumBis = new KiSS4.Gui.KissDateEdit();
            this.kissLabel6 = new KiSS4.Gui.KissLabel();
            this.edtAbschlussgrund = new KiSS4.Gui.KissLookUpEdit();
            this.kissLabel1 = new KiSS4.Gui.KissLabel();
            this.edtBemerkung = new KiSS4.Gui.KissMemoEdit();
            this.btnReopen = new KiSS4.Gui.KissButton();
            this.kissLabel7 = new KiSS4.Gui.KissLabel();
            this.kissLabel3 = new KiSS4.Gui.KissLabel();
            this.kissLabel4 = new KiSS4.Gui.KissLabel();
            this.edtFaLeistungID = new KiSS4.Gui.KissTextEdit();
            this.edtDatumVon = new KiSS4.Gui.KissDateEdit();
            this.editMA = new KiSS4.Gui.KissTextEdit();
            this.panel1 = new System.Windows.Forms.Panel();
            this.lblTitel = new KiSS4.Gui.KissLabel();
            this.picTitel = new System.Windows.Forms.PictureBox();
            this.kissLabel2 = new KiSS4.Gui.KissLabel();
            this.kissLabel8 = new KiSS4.Gui.KissLabel();
            this.kissLabel9 = new KiSS4.Gui.KissLabel();
            this.qryFaLeistung = new KiSS4.DB.SqlQuery(this.components);
            this.kissTextEdit1 = new KiSS4.Gui.KissTextEdit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel5)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLookUpEdit1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLookUpEdit1.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel6)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussgrund)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussgrund.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBemerkung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel7)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel3)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel4)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtFaLeistungID.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.editMA.Properties)).BeginInit();
            this.panel1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel8)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel9)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryFaLeistung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissTextEdit1.Properties)).BeginInit();
            this.SuspendLayout();
            //
            // kissLabel5
            //
            this.kissLabel5.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.kissLabel5.Location = new System.Drawing.Point(105, 225);
            this.kissLabel5.Name = "kissLabel5";
            this.kissLabel5.Size = new System.Drawing.Size(124, 16);
            this.kissLabel5.TabIndex = 0;
            this.kissLabel5.Text = "Abschluss";
            this.kissLabel5.UseCompatibleTextRendering = true;
            //
            // kissLookUpEdit1
            //
            this.kissLookUpEdit1.DataMember = "EroeffnungsGrundCode";
            this.kissLookUpEdit1.DataSource = this.qryFaLeistung;
            this.kissLookUpEdit1.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.kissLookUpEdit1.Location = new System.Drawing.Point(105, 170);
            this.kissLookUpEdit1.LOVFilter = "K";
            this.kissLookUpEdit1.LOVName = "EroeffnungsGrund";
            this.kissLookUpEdit1.Name = "kissLookUpEdit1";
            this.kissLookUpEdit1.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.kissLookUpEdit1.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.kissLookUpEdit1.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.kissLookUpEdit1.Properties.Appearance.Options.UseBackColor = true;
            this.kissLookUpEdit1.Properties.Appearance.Options.UseBorderColor = true;
            this.kissLookUpEdit1.Properties.Appearance.Options.UseFont = true;
            this.kissLookUpEdit1.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.kissLookUpEdit1.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.kissLookUpEdit1.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.kissLookUpEdit1.Properties.AppearanceDropDown.Options.UseFont = true;
            this.kissLookUpEdit1.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.kissLookUpEdit1.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.kissLookUpEdit1.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.kissLookUpEdit1.Properties.NullText = "";
            this.kissLookUpEdit1.Properties.ReadOnly = true;
            this.kissLookUpEdit1.Properties.ShowFooter = false;
            this.kissLookUpEdit1.Properties.ShowHeader = false;
            this.kissLookUpEdit1.Size = new System.Drawing.Size(388, 24);
            this.kissLookUpEdit1.TabIndex = 0;
            //
            // edtDatumBis
            //
            this.edtDatumBis.DataMember = "DatumBis";
            this.edtDatumBis.DataSource = this.qryFaLeistung;
            this.edtDatumBis.EditValue = null;
            this.edtDatumBis.Location = new System.Drawing.Point(105, 255);
            this.edtDatumBis.Name = "edtDatumBis";
            this.edtDatumBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.False;
            this.edtDatumBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseFont = true;
            this.edtDatumBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtDatumBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph)});
            this.edtDatumBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumBis.Properties.Name = "editDatumBis.Properties";
            this.edtDatumBis.Properties.ShowToday = false;
            this.edtDatumBis.Size = new System.Drawing.Size(89, 24);
            this.edtDatumBis.TabIndex = 1;
            //
            // kissLabel6
            //
            this.kissLabel6.Location = new System.Drawing.Point(5, 255);
            this.kissLabel6.Name = "kissLabel6";
            this.kissLabel6.Size = new System.Drawing.Size(70, 24);
            this.kissLabel6.TabIndex = 1;
            this.kissLabel6.Text = "Datum";
            this.kissLabel6.UseCompatibleTextRendering = true;
            //
            // edtAbschlussgrund
            //
            this.edtAbschlussgrund.DataMember = "AbschlussGrundCode";
            this.edtAbschlussgrund.DataSource = this.qryFaLeistung;
            this.edtAbschlussgrund.Location = new System.Drawing.Point(105, 285);
            this.edtAbschlussgrund.LOVFilter = "K";
            this.edtAbschlussgrund.LOVName = "AbschlussGrund";
            this.edtAbschlussgrund.Name = "edtAbschlussgrund";
            this.edtAbschlussgrund.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtAbschlussgrund.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAbschlussgrund.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAbschlussgrund.Properties.Appearance.Options.UseBackColor = true;
            this.edtAbschlussgrund.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAbschlussgrund.Properties.Appearance.Options.UseFont = true;
            this.edtAbschlussgrund.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtAbschlussgrund.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtAbschlussgrund.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtAbschlussgrund.Properties.NullText = "";
            this.edtAbschlussgrund.Properties.ShowFooter = false;
            this.edtAbschlussgrund.Properties.ShowHeader = false;
            this.edtAbschlussgrund.Size = new System.Drawing.Size(388, 24);
            this.edtAbschlussgrund.TabIndex = 2;
            //
            // kissLabel1
            //
            this.kissLabel1.Location = new System.Drawing.Point(5, 110);
            this.kissLabel1.Name = "kissLabel1";
            this.kissLabel1.Size = new System.Drawing.Size(70, 24);
            this.kissLabel1.TabIndex = 2;
            this.kissLabel1.Text = "Datum";
            this.kissLabel1.UseCompatibleTextRendering = true;
            //
            // edtBemerkung
            //
            this.edtBemerkung.DataMember = "Bemerkung";
            this.edtBemerkung.DataSource = this.qryFaLeistung;
            this.edtBemerkung.Location = new System.Drawing.Point(105, 315);
            this.edtBemerkung.Name = "edtBemerkung";
            this.edtBemerkung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBemerkung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBemerkung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBemerkung.Properties.Appearance.Options.UseBackColor = true;
            this.edtBemerkung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBemerkung.Properties.Appearance.Options.UseFont = true;
            this.edtBemerkung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBemerkung.Size = new System.Drawing.Size(388, 36);
            this.edtBemerkung.TabIndex = 3;
            //
            // btnReopen
            //
            this.btnReopen.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnReopen.Location = new System.Drawing.Point(105, 362);
            this.btnReopen.Name = "btnReopen";
            this.btnReopen.Size = new System.Drawing.Size(118, 24);
            this.btnReopen.TabIndex = 4;
            this.btnReopen.Text = "Fall wieder öffnen";
            this.btnReopen.UseCompatibleTextRendering = true;
            this.btnReopen.UseVisualStyleBackColor = false;
            this.btnReopen.Visible = false;
            this.btnReopen.Click += new System.EventHandler(this.btnReopen_Click);
            //
            // kissLabel7
            //
            this.kissLabel7.Location = new System.Drawing.Point(5, 140);
            this.kissLabel7.Name = "kissLabel7";
            this.kissLabel7.Size = new System.Drawing.Size(94, 24);
            this.kissLabel7.TabIndex = 4;
            this.kissLabel7.Text = "zuständige/r MA";
            this.kissLabel7.UseCompatibleTextRendering = true;
            //
            // kissLabel3
            //
            this.kissLabel3.Location = new System.Drawing.Point(5, 315);
            this.kissLabel3.Name = "kissLabel3";
            this.kissLabel3.Size = new System.Drawing.Size(66, 24);
            this.kissLabel3.TabIndex = 5;
            this.kissLabel3.Text = "Bemerkung";
            this.kissLabel3.UseCompatibleTextRendering = true;
            //
            // kissLabel4
            //
            this.kissLabel4.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.kissLabel4.Location = new System.Drawing.Point(105, 50);
            this.kissLabel4.Name = "kissLabel4";
            this.kissLabel4.Size = new System.Drawing.Size(126, 16);
            this.kissLabel4.TabIndex = 5;
            this.kissLabel4.Text = "Eröffnung";
            this.kissLabel4.UseCompatibleTextRendering = true;
            //
            // edtFaLeistungID
            //
            this.edtFaLeistungID.DataMember = "FaLeistungID";
            this.edtFaLeistungID.DataSource = this.qryFaLeistung;
            this.edtFaLeistungID.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtFaLeistungID.Location = new System.Drawing.Point(105, 80);
            this.edtFaLeistungID.Name = "edtFaLeistungID";
            this.edtFaLeistungID.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtFaLeistungID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtFaLeistungID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtFaLeistungID.Properties.Appearance.Options.UseBackColor = true;
            this.edtFaLeistungID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtFaLeistungID.Properties.Appearance.Options.UseFont = true;
            this.edtFaLeistungID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtFaLeistungID.Properties.ReadOnly = true;
            this.edtFaLeistungID.Size = new System.Drawing.Size(89, 24);
            this.edtFaLeistungID.TabIndex = 6;
            //
            // edtDatumVon
            //
            this.edtDatumVon.DataMember = "DatumVon";
            this.edtDatumVon.DataSource = this.qryFaLeistung;
            this.edtDatumVon.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtDatumVon.EditValue = null;
            this.edtDatumVon.Location = new System.Drawing.Point(105, 110);
            this.edtDatumVon.Name = "edtDatumVon";
            this.edtDatumVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.False;
            this.edtDatumVon.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtDatumVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumVon.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseFont = true;
            this.edtDatumVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtDatumVon.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph)});
            this.edtDatumVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumVon.Properties.Name = "editDatumVon.Properties";
            this.edtDatumVon.Properties.ReadOnly = true;
            this.edtDatumVon.Properties.ShowToday = false;
            this.edtDatumVon.Size = new System.Drawing.Size(89, 24);
            this.edtDatumVon.TabIndex = 7;
            //
            // editMA
            //
            this.editMA.DataMember = "MA";
            this.editMA.DataSource = this.qryFaLeistung;
            this.editMA.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.editMA.Location = new System.Drawing.Point(105, 140);
            this.editMA.Name = "editMA";
            this.editMA.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.editMA.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.editMA.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.editMA.Properties.Appearance.Options.UseBackColor = true;
            this.editMA.Properties.Appearance.Options.UseBorderColor = true;
            this.editMA.Properties.Appearance.Options.UseFont = true;
            this.editMA.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.editMA.Properties.Name = "editSAR.Properties";
            this.editMA.Properties.ReadOnly = true;
            this.editMA.Size = new System.Drawing.Size(388, 24);
            this.editMA.TabIndex = 8;
            //
            // panel1
            //
            this.panel1.Controls.Add(this.picTitel);
            this.panel1.Controls.Add(this.lblTitel);
            this.panel1.Dock = System.Windows.Forms.DockStyle.Top;
            this.panel1.Location = new System.Drawing.Point(0, 0);
            this.panel1.Name = "panel1";
            this.panel1.Size = new System.Drawing.Size(607, 24);
            this.panel1.TabIndex = 14;
            //
            // lblTitel
            //
            this.lblTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitel.Location = new System.Drawing.Point(25, 5);
            this.lblTitel.Name = "lblTitel";
            this.lblTitel.Size = new System.Drawing.Size(542, 15);
            this.lblTitel.TabIndex = 0;
            this.lblTitel.Text = "Fallführung";
            this.lblTitel.UseCompatibleTextRendering = true;
            //
            // picTitel
            //
            this.picTitel.Location = new System.Drawing.Point(5, 5);
            this.picTitel.Name = "picTitel";
            this.picTitel.Size = new System.Drawing.Size(16, 16);
            this.picTitel.TabIndex = 293;
            this.picTitel.TabStop = false;
            //
            // kissLabel2
            //
            this.kissLabel2.Location = new System.Drawing.Point(5, 285);
            this.kissLabel2.Name = "kissLabel2";
            this.kissLabel2.Size = new System.Drawing.Size(94, 24);
            this.kissLabel2.TabIndex = 15;
            this.kissLabel2.Text = "Grund";
            this.kissLabel2.UseCompatibleTextRendering = true;
            //
            // kissLabel8
            //
            this.kissLabel8.Location = new System.Drawing.Point(5, 80);
            this.kissLabel8.Name = "kissLabel8";
            this.kissLabel8.Size = new System.Drawing.Size(70, 24);
            this.kissLabel8.TabIndex = 17;
            this.kissLabel8.Text = "Leistung / Fall";
            this.kissLabel8.UseCompatibleTextRendering = true;
            //
            // kissLabel9
            //
            this.kissLabel9.Location = new System.Drawing.Point(5, 170);
            this.kissLabel9.Name = "kissLabel9";
            this.kissLabel9.Size = new System.Drawing.Size(94, 24);
            this.kissLabel9.TabIndex = 20;
            this.kissLabel9.Text = "Grund";
            this.kissLabel9.UseCompatibleTextRendering = true;
            //
            // qryFaLeistung
            //
            this.qryFaLeistung.CanUpdate = true;
            this.qryFaLeistung.HostControl = this;
            this.qryFaLeistung.SelectStatement = resources.GetString("qryFaLeistung.SelectStatement");
            this.qryFaLeistung.TableName = "FaLeistung";
            this.qryFaLeistung.BeforePost += new System.EventHandler(this.qryFaLeistung_BeforePost);
            this.qryFaLeistung.AfterPost += new System.EventHandler(this.qryFaLeistung_AfterPost);
            //
            // kissTextEdit1
            //
            this.kissTextEdit1.DataMember = "FaFallID";
            this.kissTextEdit1.DataSource = this.qryFaLeistung;
            this.kissTextEdit1.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.kissTextEdit1.Location = new System.Drawing.Point(200, 80);
            this.kissTextEdit1.Name = "kissTextEdit1";
            this.kissTextEdit1.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.kissTextEdit1.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.kissTextEdit1.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.kissTextEdit1.Properties.Appearance.Options.UseBackColor = true;
            this.kissTextEdit1.Properties.Appearance.Options.UseBorderColor = true;
            this.kissTextEdit1.Properties.Appearance.Options.UseFont = true;
            this.kissTextEdit1.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.kissTextEdit1.Properties.ReadOnly = true;
            this.kissTextEdit1.Size = new System.Drawing.Size(100, 24);
            this.kissTextEdit1.TabIndex = 21;
            //
            // CtlKgLeistung
            //
            this.ActiveSQLQuery = this.qryFaLeistung;
            this.Controls.Add(this.kissTextEdit1);
            this.Controls.Add(this.kissLabel9);
            this.Controls.Add(this.kissLabel8);
            this.Controls.Add(this.kissLabel2);
            this.Controls.Add(this.panel1);
            this.Controls.Add(this.editMA);
            this.Controls.Add(this.edtDatumVon);
            this.Controls.Add(this.edtFaLeistungID);
            this.Controls.Add(this.kissLabel4);
            this.Controls.Add(this.kissLabel3);
            this.Controls.Add(this.kissLabel7);
            this.Controls.Add(this.btnReopen);
            this.Controls.Add(this.edtBemerkung);
            this.Controls.Add(this.kissLabel1);
            this.Controls.Add(this.edtAbschlussgrund);
            this.Controls.Add(this.kissLabel6);
            this.Controls.Add(this.edtDatumBis);
            this.Controls.Add(this.kissLookUpEdit1);
            this.Controls.Add(this.kissLabel5);
            this.Location = new System.Drawing.Point(90, 0);
            this.Name = "CtlKgLeistung";
            this.Size = new System.Drawing.Size(607, 464);
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel5)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLookUpEdit1.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLookUpEdit1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel6)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussgrund.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussgrund)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBemerkung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel7)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel3)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel4)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtFaLeistungID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.editMA.Properties)).EndInit();
            this.panel1.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel8)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel9)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryFaLeistung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissTextEdit1.Properties)).EndInit();
            this.ResumeLayout(false);
        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Public Methods

        public void Init(string TitleName, Image TitleImage, int FaLeistungID)
        {
            this.lblTitel.Text = TitleName;
            this.picTitel.Image = TitleImage;
            this.faLeistungID = FaLeistungID;

            qryFaLeistung.Fill(faLeistungID);
            SetEditMode();
        }

        #endregion

        #region Private Methods

        private void SetEditMode()
        {
            if (qryFaLeistung.Count == 0) return;

            //TODO: temporärer Hack, solange Benutzerrechte/Spezialrechte nicht implementiert sind
            bool open = DBUtil.IsEmpty(qryFaLeistung["DatumBis"]);

            btnReopen.Visible = !open && qryFaLeistung.CanUpdate;
            edtDatumBis.EditMode = (open ? EditModeType.Normal : EditModeType.ReadOnly);
            edtAbschlussgrund.EditMode = (open ? EditModeType.Normal : EditModeType.ReadOnly);
            edtBemerkung.EditMode = (open ? EditModeType.Normal : EditModeType.ReadOnly);

            qryFaLeistung.EnableBoundFields();

            /*
            bool MayRead = false;
            bool MayIns = false;
            bool MayUpd = false;
            bool MayDel = false;
            bool MayClose = false;
            bool MayReopen = false;

            DBUtil.GetFallRights((int)qryFaLeistung["FaFallID"], out MayRead, out MayIns, out MayUpd, out MayDel, out MayClose, out MayReopen);
            if (MayClose)
            {
                bool open = DBUtil.IsEmpty(qryFaLeistung["DatumBis"]);
                bool archived = !DBUtil.IsEmpty(qryFaLeistung["FaLeistungArchivID"]);

                qryFaLeistung.CanUpdate = open;
                btnReopen.Visible = !open && !archived && MayReopen && DBUtil.UserHasRight("CtlFaPeriodeReopen");

                if (open)
                    editDatumVon.EditMode = EditModeType.Normal;
                else
                    editDatumVon.EditMode = EditModeType.ReadOnly;
            }
            else
            {
                qryFaLeistung.CanUpdate = false;;
                btnReopen.Visible = false;
                editDatumVon.EditMode = EditModeType.ReadOnly;
            }
            qryFaLeistung.EnableBoundFields(qryFaLeistung.CanUpdate);
            */
        }

        private void btnReopen_Click(object sender, System.EventArgs e)
        {
            // EndDatum ist leer, d.h. die Leistung ist aktiv. Wir müssen prüfen, ob es auch ein offener Fall gibt, sonst darf das Bis-Datum nicht leer sein
            object obj = DBUtil.ExecuteScalarSQL("SELECT FaFallID FROM FaLeistung WHERE FaFallID = {0} AND FaProzessCode = 200 AND DatumBis IS NULL", qryFaLeistung["FaFallID"]);

            if (obj == null)
            {
                KissMsg.ShowInfo("Ohne aktive Fallführung kann diese Leistung nicht wieder eröffnet werden.");
                return;
            }

            if (KissMsg.ShowQuestion("CtlKgLeistung", "FallverlaufWiederOeffnen", "Soll die geschlossene Fallführung wieder geöffnet werden ?"))
            {
                qryFaLeistung.CanUpdate = true;
                qryFaLeistung["DatumBis"] = DBNull.Value;
                qryFaLeistung.Post();

                DBUtil.ExecSQL(@"
                    INSERT FaJournal (FaFallID,FaLeistungID,UserID,Text)
                               VALUES ({0},{1},{2},{3})",
                                   qryFaLeistung["FaFallID"],
                                   qryFaLeistung["FaLeistungID"],
                                   Session.User.UserID,
                                   "Wiedereröffnung Klientengelder");
            }
        }

        private void qryFaLeistung_AfterPost(object sender, System.EventArgs e)
        {
            FormController.SendMessage("FrmFall", "Action", "RefreshTree");
            SetEditMode();
        }

        private void qryFaLeistung_BeforePost(object sender, System.EventArgs e)
        {
            if (!DBUtil.IsEmpty(qryFaLeistung["DatumBis"]))
            {
                // Liegt DatumBis nach DatumVon?
                DateTime datumVon = (DateTime)qryFaLeistung["DatumVon"];
                DateTime datumBis = (DateTime)qryFaLeistung["DatumBis"];
                if (datumVon > datumBis)
                {
                    throw new KissInfoException("Abschlussdatum muss nach Eröffnungsdatum liegen!");
                }

                //Kontrolle offene Pendenzen
                int countPendenzen = Utils.GetAnzahlOffenePendenzen((int)qryFaLeistung[DBO.FaLeistung.FaLeistungID]);
                if (countPendenzen > 0)
                {
                    string Msg =
                        string.Format(KissMsg.GetMLMessage("CtlKgLeistung", "OffenePendenzenVorhanden",
                                                           string.Format(
                                                               "Es existieren noch {0} offene Pendenzen zu der abzuschliessenden Leistung.",
                                                               countPendenzen)));
                    KissMsg.ShowInfo(Msg);
                }

                //Eintrag ins Fallverlaufsprotokoll

                DBUtil.ExecSQL(@"
                    INSERT FaJournal (FaFallID,FaLeistungID,UserID,Text)
                               VALUES ({0},{1},{2},{3})",
                                   qryFaLeistung["FaFallID"],
                                   qryFaLeistung["FaLeistungID"],
                                   Session.User.UserID,
                                   "Abschluss Klientengelder");

            }

            if (DBUtil.IsEmpty(qryFaLeistung["DatumBis"]))
            {
                // EndDatum ist leer, d.h. die Leistung ist aktiv. Wir müssen prüfen, ob es auch ein offener Fall gibt, sonst darf das Bis-Datum nicht leer sein
                object obj = DBUtil.ExecuteScalarSQL("SELECT FaFallID FROM FaLeistung WHERE FaFallID = {0} AND FaProzessCode = 200 AND DatumBis IS NULL", qryFaLeistung["FaFallID"]);

                if (obj == null)
                {
                    throw new KissInfoException("Ohne aktive Fallführung kann diese Leistung nicht wieder eröffnet werden. Das Bis-Datum darf nicht leer sein.");
                }
            }
        }

        #endregion
    }
}