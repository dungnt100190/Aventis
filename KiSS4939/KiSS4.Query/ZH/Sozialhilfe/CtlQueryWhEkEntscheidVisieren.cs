#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Collections.Generic;
using System.Data;
using System.Globalization;
using Kiss.Interfaces.UI;
using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Query.ZH
{
    public class CtlQueryWhEkEntscheidVisieren : KiSS4.Common.KissQueryControl
    {
        private static readonly log4net.ILog LOG = log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);

        #region Fields

        private KiSS4.Gui.KissButton btnAblehnen;
        private KiSS4.Gui.KissButton btnVisieren;
        private KiSS4.Gui.KissButton btnZurueckziehen;
        private DevExpress.XtraGrid.Columns.GridColumn colBemerkung;
        private DevExpress.XtraGrid.Columns.GridColumn colDatum;
        private DevExpress.XtraGrid.Columns.GridColumn colGrund;
        private DevExpress.XtraGrid.Columns.GridColumn colJahr;
        private DevExpress.XtraGrid.Columns.GridColumn colKW;
        private DevExpress.XtraGrid.Columns.GridColumn colKlient;
        private DevExpress.XtraGrid.Columns.GridColumn colLaufNr;
        private DevExpress.XtraGrid.Columns.GridColumn colSA;
        private DevExpress.XtraGrid.Columns.GridColumn colStatus;
        private DevExpress.XtraGrid.Columns.GridColumn colTeam;
        private DevExpress.XtraGrid.Columns.GridColumn colVisiertDurch;
        private DevExpress.XtraGrid.Columns.GridColumn colVisumDatum;
        private DevExpress.XtraGrid.Columns.GridColumn colZentrum;
        private KiSS4.Dokument.XDokument edtDoc;
        private KiSS4.Gui.KissCalcEdit edtSucheEntscheidJahr;
        private KiSS4.Gui.KissCalcEdit edtSucheEntscheidKW;
        private KiSS4.Gui.KissCheckedLookupEdit edtSucheStati;
        private KiSS4.Gui.KissDateEdit edtVisum;
        private DevExpress.XtraGrid.Views.Grid.GridView gridView1;

        private KiSS4.Gui.KissLabel lblJahr;
        private KiSS4.Gui.KissLabel lblKW;
        private KiSS4.Gui.KissLabel lblStati;
        private KiSS4.Gui.KissLabel lblVisum;

        #endregion

        #region Constructors

        public CtlQueryWhEkEntscheidVisieren()
        {
            this.InitializeComponent();
            // AllowMultiselecting sollte nicht durch den Designer gesetzt werden, da sonst Nebenwirkungen entstehen können
            // (RunSearch wird aufgerufen bevor IntializeComponent fertig ist). Siehe #6074.
            this.AllowMultiselecting = true;
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlQueryWhEkEntscheidVisieren));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject6 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject5 = new DevExpress.Utils.SerializableAppearanceObject();
            this.edtVisum = new KiSS4.Gui.KissDateEdit();
            this.lblVisum = new KiSS4.Gui.KissLabel();
            this.btnAblehnen = new KiSS4.Gui.KissButton();
            this.btnVisieren = new KiSS4.Gui.KissButton();
            this.btnZurueckziehen = new KiSS4.Gui.KissButton();
            this.edtDoc = new KiSS4.Dokument.XDokument();
            this.edtSucheEntscheidJahr = new KiSS4.Gui.KissCalcEdit();
            this.edtSucheEntscheidKW = new KiSS4.Gui.KissCalcEdit();
            this.lblJahr = new KiSS4.Gui.KissLabel();
            this.lblStati = new KiSS4.Gui.KissLabel();
            this.lblKW = new KiSS4.Gui.KissLabel();
            this.edtSucheStati = new KiSS4.Gui.KissCheckedLookupEdit();
            this.colBemerkung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colGrund = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colJahr = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colKlient = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colKW = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLaufNr = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colSA = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colStatus = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colTeam = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVisiertDurch = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVisumDatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colZentrum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.gridView1 = new DevExpress.XtraGrid.Views.Grid.GridView();
            ((System.ComponentModel.ISupportInitialize)(this.qryQuery)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvQuery1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdQuery1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.xDocument.Properties)).BeginInit();
            this.tabControlSearch.SuspendLayout();
            this.tpgListe.SuspendLayout();
            this.tpgSuchen.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.edtVisum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVisum)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDoc.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheEntscheidJahr.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheEntscheidKW.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblJahr)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblStati)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKW)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheStati)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gridView1)).BeginInit();
            this.SuspendLayout();
            // 
            // qryQuery
            // 
            this.qryQuery.CanUpdate = true;
            this.qryQuery.SelectStatement = resources.GetString("qryQuery.SelectStatement");
            this.qryQuery.TableName = "WhEkEntscheid";
            this.qryQuery.PositionChanged += new System.EventHandler(this.qryQuery_PositionChanged);
            // 
            // grvQuery1
            // 
            this.grvQuery1.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvQuery1.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.Empty.Options.UseBackColor = true;
            this.grvQuery1.Appearance.Empty.Options.UseFont = true;
            this.grvQuery1.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.grvQuery1.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.EvenRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.EvenRow.Options.UseFont = true;
            this.grvQuery1.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvQuery1.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvQuery1.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvQuery1.Appearance.FocusedCell.Options.UseFont = true;
            this.grvQuery1.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvQuery1.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvQuery1.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvQuery1.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.FocusedRow.Options.UseFont = true;
            this.grvQuery1.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvQuery1.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvQuery1.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvQuery1.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvQuery1.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvQuery1.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.GroupRow.Options.UseFont = true;
            this.grvQuery1.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvQuery1.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvQuery1.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvQuery1.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvQuery1.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvQuery1.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvQuery1.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvQuery1.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvQuery1.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvQuery1.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvQuery1.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvQuery1.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvQuery1.Appearance.OddRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(222)))));
            this.grvQuery1.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.OddRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.OddRow.Options.UseFont = true;
            this.grvQuery1.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvQuery1.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.Row.Options.UseBackColor = true;
            this.grvQuery1.Appearance.Row.Options.UseFont = true;
            this.grvQuery1.Appearance.SelectedRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(208)))), ((int)(((byte)(170)))), ((int)(((byte)(74)))));
            this.grvQuery1.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.grvQuery1.Appearance.SelectedRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.SelectedRow.Options.UseFont = true;
            this.grvQuery1.Appearance.SelectedRow.Options.UseForeColor = true;
            this.grvQuery1.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvQuery1.Appearance.VertLine.Options.UseBackColor = true;
            this.grvQuery1.OptionsBehavior.Editable = false;
            this.grvQuery1.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvQuery1.OptionsNavigation.AutoFocusNewRow = true;
            this.grvQuery1.OptionsNavigation.UseTabKey = false;
            this.grvQuery1.OptionsPrint.AutoWidth = false;
            this.grvQuery1.OptionsPrint.ExpandAllDetails = true;
            this.grvQuery1.OptionsPrint.UsePrintStyles = true;
            this.grvQuery1.OptionsView.ColumnAutoWidth = false;
            this.grvQuery1.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvQuery1.OptionsView.ShowGroupPanel = false;
            this.grvQuery1.OptionsView.ShowIndicator = false;
            // 
            // grdQuery1
            // 
            // 
            // 
            // 
            this.grdQuery1.EmbeddedNavigator.Name = "";
            this.grdQuery1.MainView = this.gridView1;
            this.grdQuery1.Size = new System.Drawing.Size(766, 391);
            this.grdQuery1.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.gridView1});
            // 
            // xDocument
            // 
            this.xDocument.DataMember = null;
            this.xDocument.EditValue = null;
            this.xDocument.Location = new System.Drawing.Point(0, 410);
            this.xDocument.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.xDocument.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.xDocument.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.xDocument.Properties.Appearance.Options.UseBackColor = true;
            this.xDocument.Properties.Appearance.Options.UseBorderColor = true;
            this.xDocument.Properties.Appearance.Options.UseFont = true;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.xDocument.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, false, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("xDocument.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1, "Dokument öffnen")});
            this.xDocument.Visible = false;
            // 
            // ctlGotoFall
            // 
            this.ctlGotoFall.DataMember = "KlientensystemID$";
            this.ctlGotoFall.Location = new System.Drawing.Point(0, 397);
            // 
            // tpgListe
            // 
            this.tpgListe.Controls.Add(this.edtDoc);
            this.tpgListe.Controls.Add(this.btnZurueckziehen);
            this.tpgListe.Controls.Add(this.btnVisieren);
            this.tpgListe.Controls.Add(this.btnAblehnen);
            this.tpgListe.Controls.Add(this.lblVisum);
            this.tpgListe.Controls.Add(this.edtVisum);
            this.tpgListe.Location = new System.Drawing.Point(6, 6);
            this.tpgListe.Controls.SetChildIndex(this.grdQuery1, 0);
            this.tpgListe.Controls.SetChildIndex(this.ctlGotoFall, 0);
            this.tpgListe.Controls.SetChildIndex(this.xDocument, 0);
            this.tpgListe.Controls.SetChildIndex(this.edtVisum, 0);
            this.tpgListe.Controls.SetChildIndex(this.lblVisum, 0);
            this.tpgListe.Controls.SetChildIndex(this.btnAblehnen, 0);
            this.tpgListe.Controls.SetChildIndex(this.btnVisieren, 0);
            this.tpgListe.Controls.SetChildIndex(this.btnZurueckziehen, 0);
            this.tpgListe.Controls.SetChildIndex(this.edtDoc, 0);
            // 
            // tpgSuchen
            // 
            this.tpgSuchen.Controls.Add(this.edtSucheStati);
            this.tpgSuchen.Controls.Add(this.lblKW);
            this.tpgSuchen.Controls.Add(this.lblStati);
            this.tpgSuchen.Controls.Add(this.lblJahr);
            this.tpgSuchen.Controls.Add(this.edtSucheEntscheidKW);
            this.tpgSuchen.Controls.Add(this.edtSucheEntscheidJahr);
            this.tpgSuchen.Location = new System.Drawing.Point(6, 6);
            this.tpgSuchen.Controls.SetChildIndex(this.searchTitle, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtSucheEntscheidJahr, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtSucheEntscheidKW, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.lblJahr, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.lblStati, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.lblKW, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtSucheStati, 0);
            // 
            // edtVisum
            // 
            this.edtVisum.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtVisum.EditValue = null;
            this.edtVisum.Location = new System.Drawing.Point(243, 397);
            this.edtVisum.Name = "edtVisum";
            this.edtVisum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtVisum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtVisum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtVisum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtVisum.Properties.Appearance.Options.UseBackColor = true;
            this.edtVisum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtVisum.Properties.Appearance.Options.UseFont = true;
            this.edtVisum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject6.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject6.Options.UseBackColor = true;
            this.edtVisum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtVisum.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject6)});
            this.edtVisum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtVisum.Properties.ShowToday = false;
            this.edtVisum.Size = new System.Drawing.Size(100, 24);
            this.edtVisum.TabIndex = 3;
            // 
            // lblVisum
            // 
            this.lblVisum.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblVisum.Location = new System.Drawing.Point(164, 397);
            this.lblVisum.Name = "lblVisum";
            this.lblVisum.Size = new System.Drawing.Size(73, 24);
            this.lblVisum.TabIndex = 4;
            this.lblVisum.Text = "Datum Visum";
            this.lblVisum.UseCompatibleTextRendering = true;
            // 
            // btnAblehnen
            // 
            this.btnAblehnen.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnAblehnen.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnAblehnen.Location = new System.Drawing.Point(584, 397);
            this.btnAblehnen.Name = "btnAblehnen";
            this.btnAblehnen.Size = new System.Drawing.Size(89, 24);
            this.btnAblehnen.TabIndex = 5;
            this.btnAblehnen.Text = "Ablehnen";
            this.btnAblehnen.UseCompatibleTextRendering = true;
            this.btnAblehnen.UseVisualStyleBackColor = false;
            this.btnAblehnen.Visible = false;
            this.btnAblehnen.Click += new System.EventHandler(this.btnAblehnen_Click);
            // 
            // btnVisieren
            // 
            this.btnVisieren.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.btnVisieren.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnVisieren.Location = new System.Drawing.Point(359, 397);
            this.btnVisieren.Name = "btnVisieren";
            this.btnVisieren.Size = new System.Drawing.Size(76, 24);
            this.btnVisieren.TabIndex = 5;
            this.btnVisieren.Text = "Visieren";
            this.btnVisieren.UseCompatibleTextRendering = true;
            this.btnVisieren.UseVisualStyleBackColor = false;
            this.btnVisieren.Click += new System.EventHandler(this.btnVisieren_Click);
            // 
            // btnZurueckziehen
            // 
            this.btnZurueckziehen.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnZurueckziehen.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnZurueckziehen.Location = new System.Drawing.Point(680, 397);
            this.btnZurueckziehen.Name = "btnZurueckziehen";
            this.btnZurueckziehen.Size = new System.Drawing.Size(89, 24);
            this.btnZurueckziehen.TabIndex = 5;
            this.btnZurueckziehen.Text = "Zurückziehen";
            this.btnZurueckziehen.UseCompatibleTextRendering = true;
            this.btnZurueckziehen.UseVisualStyleBackColor = false;
            this.btnZurueckziehen.Click += new System.EventHandler(this.btnZurueckziehen_Click);
            // 
            // edtDoc
            // 
            this.edtDoc.AllowDrop = true;
            this.edtDoc.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtDoc.CanCreateDocument = false;
            this.edtDoc.Context = null;
            this.edtDoc.DataMember = "DocumentID";
            this.edtDoc.DataSource = this.qryQuery;
            this.edtDoc.Location = new System.Drawing.Point(441, 397);
            this.edtDoc.Name = "edtDoc";
            this.edtDoc.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDoc.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDoc.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDoc.Properties.Appearance.Options.UseBackColor = true;
            this.edtDoc.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDoc.Properties.Appearance.Options.UseFont = true;
            this.edtDoc.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            serializableAppearanceObject5.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject5.Options.UseBackColor = true;
            this.edtDoc.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, false, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDoc.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2, "Dokument öffnen"),
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, false, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDoc.Properties.Buttons1"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3, "Dokument löschen"),
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, false, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDoc.Properties.Buttons2"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4, "Neues Dokument erstellen"),
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDoc.Properties.Buttons3"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject5, "Dokument importieren")});
            this.edtDoc.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDoc.Properties.ReadOnly = true;
            this.edtDoc.Size = new System.Drawing.Size(115, 24);
            this.edtDoc.TabIndex = 6;
            // 
            // edtSucheEntscheidJahr
            // 
            this.edtSucheEntscheidJahr.Location = new System.Drawing.Point(53, 86);
            this.edtSucheEntscheidJahr.Name = "edtSucheEntscheidJahr";
            this.edtSucheEntscheidJahr.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtSucheEntscheidJahr.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheEntscheidJahr.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheEntscheidJahr.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheEntscheidJahr.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheEntscheidJahr.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheEntscheidJahr.Properties.Appearance.Options.UseFont = true;
            this.edtSucheEntscheidJahr.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtSucheEntscheidJahr.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSucheEntscheidJahr.Size = new System.Drawing.Size(60, 24);
            this.edtSucheEntscheidJahr.TabIndex = 7;
            // 
            // edtSucheEntscheidKW
            // 
            this.edtSucheEntscheidKW.Location = new System.Drawing.Point(53, 56);
            this.edtSucheEntscheidKW.Name = "edtSucheEntscheidKW";
            this.edtSucheEntscheidKW.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtSucheEntscheidKW.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheEntscheidKW.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheEntscheidKW.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheEntscheidKW.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheEntscheidKW.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheEntscheidKW.Properties.Appearance.Options.UseFont = true;
            this.edtSucheEntscheidKW.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtSucheEntscheidKW.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSucheEntscheidKW.Size = new System.Drawing.Size(60, 24);
            this.edtSucheEntscheidKW.TabIndex = 7;
            // 
            // lblJahr
            // 
            this.lblJahr.Location = new System.Drawing.Point(15, 86);
            this.lblJahr.Name = "lblJahr";
            this.lblJahr.Size = new System.Drawing.Size(32, 24);
            this.lblJahr.TabIndex = 8;
            this.lblJahr.Text = "Jahr";
            this.lblJahr.UseCompatibleTextRendering = true;
            // 
            // lblStati
            // 
            this.lblStati.Location = new System.Drawing.Point(15, 120);
            this.lblStati.Name = "lblStati";
            this.lblStati.Size = new System.Drawing.Size(32, 24);
            this.lblStati.TabIndex = 8;
            this.lblStati.Text = "Stati";
            this.lblStati.UseCompatibleTextRendering = true;
            // 
            // lblKW
            // 
            this.lblKW.Location = new System.Drawing.Point(15, 55);
            this.lblKW.Name = "lblKW";
            this.lblKW.Size = new System.Drawing.Size(32, 24);
            this.lblKW.TabIndex = 9;
            this.lblKW.Text = "KW";
            this.lblKW.UseCompatibleTextRendering = true;
            // 
            // edtSucheStati
            // 
            this.edtSucheStati.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtSucheStati.Appearance.Options.UseBackColor = true;
            this.edtSucheStati.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.NoBorder;
            this.edtSucheStati.CheckOnClick = true;
            this.edtSucheStati.Location = new System.Drawing.Point(54, 124);
            this.edtSucheStati.LOVFilter = "V";
            this.edtSucheStati.LOVName = "WhEkStatus";
            this.edtSucheStati.Name = "edtSucheStati";
            this.edtSucheStati.Size = new System.Drawing.Size(140, 131);
            this.edtSucheStati.TabIndex = 10;
            // 
            // colBemerkung
            // 
            this.colBemerkung.Caption = "Bemerkung";
            this.colBemerkung.FieldName = "Bemerkung";
            this.colBemerkung.Name = "colBemerkung";
            this.colBemerkung.Visible = true;
            this.colBemerkung.VisibleIndex = 12;
            this.colBemerkung.Width = 166;
            // 
            // colDatum
            // 
            this.colDatum.Caption = "Datum";
            this.colDatum.FieldName = "Datum";
            this.colDatum.Name = "colDatum";
            this.colDatum.Visible = true;
            this.colDatum.VisibleIndex = 0;
            // 
            // colGrund
            // 
            this.colGrund.Caption = "Grund";
            this.colGrund.FieldName = "Grund";
            this.colGrund.Name = "colGrund";
            this.colGrund.Visible = true;
            this.colGrund.VisibleIndex = 5;
            this.colGrund.Width = 132;
            // 
            // colJahr
            // 
            this.colJahr.Caption = "Jahr";
            this.colJahr.FieldName = "EntscheidJahr";
            this.colJahr.Name = "colJahr";
            this.colJahr.Visible = true;
            this.colJahr.VisibleIndex = 9;
            this.colJahr.Width = 51;
            // 
            // colKlient
            // 
            this.colKlient.Caption = "Klient";
            this.colKlient.FieldName = "Klient";
            this.colKlient.Name = "colKlient";
            this.colKlient.Visible = true;
            this.colKlient.VisibleIndex = 1;
            this.colKlient.Width = 105;
            // 
            // colKW
            // 
            this.colKW.Caption = "KW";
            this.colKW.FieldName = "EntscheidKW";
            this.colKW.Name = "colKW";
            this.colKW.Visible = true;
            this.colKW.VisibleIndex = 10;
            this.colKW.Width = 44;
            // 
            // colLaufNr
            // 
            this.colLaufNr.Caption = "LaufNr";
            this.colLaufNr.FieldName = "EntscheidLaufNr";
            this.colLaufNr.Name = "colLaufNr";
            this.colLaufNr.Visible = true;
            this.colLaufNr.VisibleIndex = 11;
            this.colLaufNr.Width = 51;
            // 
            // colSA
            // 
            this.colSA.Caption = "SA";
            this.colSA.FieldName = "UserName";
            this.colSA.Name = "colSA";
            this.colSA.Visible = true;
            this.colSA.VisibleIndex = 2;
            this.colSA.Width = 64;
            // 
            // colStatus
            // 
            this.colStatus.Caption = "Status";
            this.colStatus.FieldName = "Status";
            this.colStatus.Name = "colStatus";
            this.colStatus.Visible = true;
            this.colStatus.VisibleIndex = 6;
            this.colStatus.Width = 105;
            // 
            // colTeam
            // 
            this.colTeam.Caption = "Team";
            this.colTeam.FieldName = "OrgUnit";
            this.colTeam.Name = "colTeam";
            this.colTeam.Visible = true;
            this.colTeam.VisibleIndex = 4;
            // 
            // colVisiertDurch
            // 
            this.colVisiertDurch.Caption = "visiert durch";
            this.colVisiertDurch.FieldName = "VisumUser";
            this.colVisiertDurch.Name = "colVisiertDurch";
            this.colVisiertDurch.Visible = true;
            this.colVisiertDurch.VisibleIndex = 7;
            this.colVisiertDurch.Width = 91;
            // 
            // colVisumDatum
            // 
            this.colVisumDatum.Caption = "visiert am";
            this.colVisumDatum.FieldName = "VisumDatum";
            this.colVisumDatum.Name = "colVisumDatum";
            this.colVisumDatum.Visible = true;
            this.colVisumDatum.VisibleIndex = 8;
            // 
            // colZentrum
            // 
            this.colZentrum.Caption = "Zentrum";
            this.colZentrum.FieldName = "SozialzentrumKurz";
            this.colZentrum.Name = "colZentrum";
            this.colZentrum.Visible = true;
            this.colZentrum.VisibleIndex = 3;
            // 
            // gridView1
            // 
            this.gridView1.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gridView1.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.Empty.Options.UseBackColor = true;
            this.gridView1.Appearance.Empty.Options.UseFont = true;
            this.gridView1.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.EvenRow.Options.UseFont = true;
            this.gridView1.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gridView1.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gridView1.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gridView1.Appearance.FocusedCell.Options.UseFont = true;
            this.gridView1.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gridView1.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gridView1.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gridView1.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gridView1.Appearance.FocusedRow.Options.UseFont = true;
            this.gridView1.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gridView1.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gridView1.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gridView1.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gridView1.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gridView1.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gridView1.Appearance.GroupRow.Options.UseBackColor = true;
            this.gridView1.Appearance.GroupRow.Options.UseFont = true;
            this.gridView1.Appearance.GroupRow.Options.UseForeColor = true;
            this.gridView1.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gridView1.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gridView1.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gridView1.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gridView1.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gridView1.Appearance.HeaderPanel.Options.UseFont = true;
            this.gridView1.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gridView1.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gridView1.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gridView1.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gridView1.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gridView1.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gridView1.Appearance.HorzLine.Options.UseBackColor = true;
            this.gridView1.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.OddRow.Options.UseFont = true;
            this.gridView1.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gridView1.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.Row.Options.UseBackColor = true;
            this.gridView1.Appearance.Row.Options.UseFont = true;
            this.gridView1.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.SelectedRow.Options.UseFont = true;
            this.gridView1.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gridView1.Appearance.VertLine.Options.UseBackColor = true;
            this.gridView1.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gridView1.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colDatum,
            this.colKlient,
            this.colSA,
            this.colZentrum,
            this.colTeam,
            this.colGrund,
            this.colStatus,
            this.colVisiertDurch,
            this.colVisumDatum,
            this.colKW,
            this.colJahr,
            this.colLaufNr,
            this.colBemerkung});
            this.gridView1.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gridView1.GridControl = this.grdQuery1;
            this.gridView1.Name = "gridView1";
            this.gridView1.OptionsBehavior.Editable = false;
            this.gridView1.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gridView1.OptionsNavigation.AutoFocusNewRow = true;
            this.gridView1.OptionsNavigation.UseTabKey = false;
            this.gridView1.OptionsView.ColumnAutoWidth = false;
            this.gridView1.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gridView1.OptionsView.ShowGroupPanel = false;
            this.gridView1.OptionsView.ShowIndicator = false;
            // 
            // CtlQueryWhEkEntscheidVisieren
            // 
            this.Name = "CtlQueryWhEkEntscheidVisieren";
            this.Load += new System.EventHandler(this.CtlQueryWhEkEntscheidVisieren_Load);
            ((System.ComponentModel.ISupportInitialize)(this.qryQuery)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvQuery1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdQuery1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.xDocument.Properties)).EndInit();
            this.tabControlSearch.ResumeLayout(false);
            this.tpgListe.ResumeLayout(false);
            this.tpgSuchen.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.edtVisum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVisum)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDoc.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheEntscheidJahr.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheEntscheidKW.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblJahr)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblStati)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKW)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheStati)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gridView1)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        #region Public Methods

        public void SetDefaultValues()
        {
            DateTime date = DateTime.Now;
            // Aktuelle Kultur ermitteln
            CultureInfo currentCulture = CultureInfo.CurrentCulture;
            // Aktuellen Kalender ermitteln
            Calendar calendar = currentCulture.Calendar;
            // Kalenderwoche über das Calendar-Objekt ermitteln
            int calendarWeek = calendar.GetWeekOfYear(date,
                currentCulture.DateTimeFormat.CalendarWeekRule,
                currentCulture.DateTimeFormat.FirstDayOfWeek);
            // Überprüfen, ob eine Kalenderwoche größer als 52 ermittelt wurde und ob
            // die Kalenderwoche des Datums in einer Woche 2 ergibt: In diesem Fall hat
            // GetWeekOfYear die Kalenderwoche nicht nach ISO 8601 berechnet (Montag,
            // der 30.12.2003 wird z. B. fälschlicherweise als KW 53 berechnet).
            // Die Kalenderwoche wird dann auf 1 gesetzt
            if (calendarWeek > 52)
            {
                date = date.AddDays(7);
                int testCalendarWeek = calendar.GetWeekOfYear(date,
                    currentCulture.DateTimeFormat.CalendarWeekRule,
                    currentCulture.DateTimeFormat.FirstDayOfWeek);
                if (testCalendarWeek == 2)
                    calendarWeek = 1;
            }
            // Das Jahr der Kalenderwoche ermitteln
            int year = date.Year;
            if (calendarWeek == 1 && date.Month == 12)
                year++;
            if (calendarWeek >= 52 && date.Month == 1)
                year--;
            // Die ermittelte Kalenderwoche zurückgeben
            edtSucheEntscheidJahr.EditValue = DateTime.Now.Year;
            edtSucheEntscheidKW.EditValue = calendarWeek;
        }

        #endregion

        #region Protected Methods

        protected override void NewSearch()
        {
            SetDefaultValues();
            edtSucheStati.EditValue = "2,3";
        }

        #endregion

        #region Private Methods

        private void CtlQueryWhEkEntscheidVisieren_Load(object sender, System.EventArgs e)
        {
            SetDefaultValues();
        }

        private void btnAblehnen_Click(object sender, System.EventArgs e)
        {
            //List<KeyValuePair<int,int>> list = new List<KeyValuePair<int,int>>();
            List<string> ids = new List<string>();
            foreach (int rowHandle in grdQuery1.View.GetSelectedRows())
            {
                DataRow row = grdQuery1.View.GetDataRow(rowHandle);
                ids.Add(row["WhEkEntscheidID"].ToString());
            }

            try
            {
                DBUtil.ExecSQLThrowingException(string.Format("UPDATE WhEkEntscheid SET WhEkStatusCode = 4 /*abgelehnt*/ WHERE WhEkEntscheidID IN ({0})", string.Join(",", ids.ToArray())));
            }
            catch( KissCancelException ex )
            {
                //ToDo

                // Eintrag ins Log.
                LOG.ErrorFormat("Fehler in: [{0}]. Exception: [{1}]", GetType().FullName, ex.Message);

                // Eintrag ins Log (Ansicht unter Anwendung/Newod Schnittstelle/Protokolle)
                XLog.Create(GetType().FullName, LogLevel.ERROR, ex.Message);
            }
            qryQuery.Refresh();
        }

        private void btnVisieren_Click(object sender, System.EventArgs e)
        {
            if( DBUtil.IsEmpty(edtVisum.EditValue))
            {
                KissMsg.ShowError("CtlQueryWhEkEntscheidVisieren", "WerteLeer", "Das Feld 'Datum Visum ' muss ausgefüllt sein.");
                return;
            }
            if (DBUtil.IsEmpty(edtDoc.DocumentID))
            {
                KissMsg.ShowError("CtlQueryWhEkEntscheidVisieren", "DokumentWerteLeer", "Das Feld 'Dokument' muss ausgefüllt sein.");
                return;
            }

            //List<KeyValuePair<int,int>> list = new List<KeyValuePair<int,int>>();
            List<string> ids = new List<string>();
            foreach (int rowHandle in grdQuery1.View.GetSelectedRows())
            {
                DataRow row = grdQuery1.View.GetDataRow(rowHandle);
                ids.Add(row["WhEkEntscheidID"].ToString());
            /*
                int baPersonID = (int)(row["BaPersonID"]);
                int grundCode = (int)(row["WhVerfuegungGrundCode"]);
                KeyValuePair<int,int> pair = new KeyValuePair<int,int>(baPersonID, grundCode);
                if( list.Contains( pair ) )
                {
                    KissMsg.ShowError("CtlQueryWhEkEntscheidVisieren", "PersonGleicherGrund", "Pro Person darf ein Grund nur einmal an einer Sitzung diskutiert werden");
                    return;
                }
                else
                    list.Add(pair);
            */
            }

            try
            {
                DBUtil.ExecSQLThrowingException(string.Format("UPDATE WhEkEntscheid SET VisumDatum = {1}, VisumUserID = {2}, WhEkStatusCode = 3 /*visiert*/ WHERE WhEkEntscheidID IN ({0})", string.Join(",", ids.ToArray()), "{0}", "{1}"), edtVisum.EditValue,  Session.User.UserID);
            }
            catch( KissCancelException ex )
            {
                //ToDo

                // Eintrag ins Log.
                LOG.ErrorFormat("Fehler in: [{0}]. Exception: [{1}]", GetType().FullName, ex.Message);

                // Eintrag ins Log (Ansicht unter Anwendung/Newod Schnittstelle/Protokolle)
                XLog.Create(GetType().FullName, LogLevel.ERROR, ex.Message);
            }
            qryQuery.Refresh();
        }

        private void btnZurueckziehen_Click(object sender, System.EventArgs e)
        {
            //List<KeyValuePair<int,int>> list = new List<KeyValuePair<int,int>>();
            List<string> ids = new List<string>();
            foreach (int rowHandle in grdQuery1.View.GetSelectedRows())
            {
                DataRow row = grdQuery1.View.GetDataRow(rowHandle);
                ids.Add(row["WhEkEntscheidID"].ToString());
            }

            try
            {
                DBUtil.ExecSQLThrowingException(string.Format("UPDATE WhEkEntscheid SET WhEkStatusCode = 5 /*zurückgezogen*/ WHERE WhEkEntscheidID IN ({0})", string.Join(",", ids.ToArray())));
            }
            catch( KissCancelException ex )
            {
                //ToDo

                // Eintrag ins Log.
                LOG.ErrorFormat("Fehler in: [{0}]. Exception: [{1}]", GetType().FullName, ex.Message);

                // Eintrag ins Log (Ansicht unter Anwendung/Newod Schnittstelle/Protokolle)
                XLog.Create(GetType().FullName, LogLevel.ERROR, ex.Message);
            }

            qryQuery.Refresh();
        }

        private void qryQuery_PositionChanged(object sender, System.EventArgs e)
        {
            int? status = qryQuery["WhEkStatusCode"] as int?;

            bool editable = status.HasValue && status.Value == 2;
            btnAblehnen.Enabled = editable;
            btnVisieren.Enabled = editable;
            btnZurueckziehen.Enabled = editable;
            edtVisum.EditMode = editable ? EditModeType.Normal : EditModeType.ReadOnly;

            edtDoc.EditMode = editable ? EditModeType.Normal : EditModeType.ReadOnly;
            //edtDoc.EditMode = EditModeType.Normal;
        }

        #endregion
    }
}