#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Drawing;
using Kiss.Interfaces.UI;
using KiSS4.Common;
using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Fallfuehrung.ZH
{
    public class CtlFaCheckinAlim : KiSS4.Gui.KissUserControl
    {
        #region Fields

        private int ErsterDatensatzID = 0;
        private bool ErsterDatensatzWohnsitzGeprueftIstLeer = true;
        private object ErsterDatensatz_Datum;
        private string ErsterDatensatz_UserName = "";
        private object ErsterDatensatz_WohnsitzDatum;
        private int UserQTID = 0;
        private string UserQTName = "";
        private string UserWholeName = "";
        private DevExpress.XtraGrid.Columns.GridColumn colAnfrage;
        private DevExpress.XtraGrid.Columns.GridColumn colAnfrageBezeichnung;
        private DevExpress.XtraGrid.Columns.GridColumn colErstkontakt;
        private DevExpress.XtraGrid.Columns.GridColumn colErstkontaktUser;
        private DevExpress.XtraGrid.Columns.GridColumn colUnterlagen;
        private DevExpress.XtraGrid.Columns.GridColumn colUnterlagenUser;
        private DevExpress.XtraGrid.Columns.GridColumn colUser;
        private DevExpress.XtraGrid.Columns.GridColumn colWohnsitz;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissDateEdit edtAnfrageDatum;
        private KiSS4.Gui.KissButtonEdit edtAnfrageUserID;
        private KiSS4.Gui.KissMemoEdit edtBemerkung;
        private KiSS4.Gui.KissDateEdit edtDatumErstkontakt;
        private KiSS4.Gui.KissDateEdit edtDatumErstkontakt2;
        private KiSS4.Gui.KissLookUpEdit edtFaCheckInAlimentAnlass;
        private KiSS4.Gui.KissButtonEdit edtMaErstkontakt;
        private KiSS4.Gui.KissButtonEdit edtMaErstkontakt2;
        private KiSS4.Gui.KissDateEdit edtUnterlagenEingangDatum;
        private KiSS4.Gui.KissButtonEdit edtUnterlagenEingangUserID;
        private KiSS4.Gui.KissDateEdit edtWohnsitzGeprueft;
        private KiSS4.Gui.KissDateEdit edtWohnsitzGeprueft2;

        // Letzte Bearbeitung
        // 19.12.2007 : sozheo : neu
        // ---------------------------------------------------------------
        private int faLeistungID = -1;
        private KiSS4.Gui.KissGrid grdCheckInAlim;
        private DevExpress.XtraGrid.Views.Grid.GridView grvCheckInAlim;
        private KiSS4.Gui.KissLabel kissLabel1;
        private KiSS4.Gui.KissLabel kissLabel2;
        private KiSS4.Gui.KissLabel kissLabel3;
        private KiSS4.Gui.KissLabel lblAnfrageDatum;
        private KiSS4.Gui.KissLabel lblBemerkung;
        private KiSS4.Gui.KissLabel lblDatumErstkontakt;
        private KiSS4.Gui.KissLabel lblFaCheckInAlimentAnlass;
        private KiSS4.Gui.KissLabel lblTitelCheckinAlim;
        private KiSS4.Gui.KissLabel lblUnterlagenEingangDatum;
        private KiSS4.Gui.KissLabel lblWohnsitzGeprueft;
        private System.Windows.Forms.Panel panel1;
        private System.Windows.Forms.PictureBox picTitel;
        private KiSS4.DB.SqlQuery qryFaCheckInAlim;

        #endregion

        #region Constructors

        public CtlFaCheckinAlim()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject11 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject10 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject9 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject8 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject7 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject6 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject5 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlFaCheckinAlim));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            this.edtDatumErstkontakt = new KiSS4.Gui.KissDateEdit();
            this.qryFaCheckInAlim = new KiSS4.DB.SqlQuery(this.components);
            this.edtMaErstkontakt = new KiSS4.Gui.KissButtonEdit();
            this.edtWohnsitzGeprueft = new KiSS4.Gui.KissDateEdit();
            this.edtAnfrageDatum = new KiSS4.Gui.KissDateEdit();
            this.edtAnfrageUserID = new KiSS4.Gui.KissButtonEdit();
            this.edtFaCheckInAlimentAnlass = new KiSS4.Gui.KissLookUpEdit();
            this.lblDatumErstkontakt = new KiSS4.Gui.KissLabel();
            this.edtUnterlagenEingangDatum = new KiSS4.Gui.KissDateEdit();
            this.edtUnterlagenEingangUserID = new KiSS4.Gui.KissButtonEdit();
            this.edtBemerkung = new KiSS4.Gui.KissMemoEdit();
            this.lblWohnsitzGeprueft = new KiSS4.Gui.KissLabel();
            this.lblAnfrageDatum = new KiSS4.Gui.KissLabel();
            this.lblUnterlagenEingangDatum = new KiSS4.Gui.KissLabel();
            this.panel1 = new System.Windows.Forms.Panel();
            this.picTitel = new System.Windows.Forms.PictureBox();
            this.lblTitelCheckinAlim = new KiSS4.Gui.KissLabel();
            this.grdCheckInAlim = new KiSS4.Gui.KissGrid();
            this.grvCheckInAlim = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colAnfrage = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colUser = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colAnfrageBezeichnung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colUnterlagen = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colUnterlagenUser = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colErstkontakt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colErstkontaktUser = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colWohnsitz = new DevExpress.XtraGrid.Columns.GridColumn();
            this.lblFaCheckInAlimentAnlass = new KiSS4.Gui.KissLabel();
            this.lblBemerkung = new KiSS4.Gui.KissLabel();
            this.kissLabel1 = new KiSS4.Gui.KissLabel();
            this.kissLabel2 = new KiSS4.Gui.KissLabel();
            this.kissLabel3 = new KiSS4.Gui.KissLabel();
            this.edtDatumErstkontakt2 = new KiSS4.Gui.KissDateEdit();
            this.edtWohnsitzGeprueft2 = new KiSS4.Gui.KissDateEdit();
            this.edtMaErstkontakt2 = new KiSS4.Gui.KissButtonEdit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumErstkontakt.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryFaCheckInAlim)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtMaErstkontakt.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtWohnsitzGeprueft.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAnfrageDatum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAnfrageUserID.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtFaCheckInAlimentAnlass)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtFaCheckInAlimentAnlass.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumErstkontakt)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtUnterlagenEingangDatum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtUnterlagenEingangUserID.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBemerkung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblWohnsitzGeprueft)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAnfrageDatum)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblUnterlagenEingangDatum)).BeginInit();
            this.panel1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitelCheckinAlim)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdCheckInAlim)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvCheckInAlim)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblFaCheckInAlimentAnlass)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel3)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumErstkontakt2.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtWohnsitzGeprueft2.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtMaErstkontakt2.Properties)).BeginInit();
            this.SuspendLayout();
            // 
            // edtDatumErstkontakt
            // 
            this.edtDatumErstkontakt.DataMember = "ErstkontaktDatum";
            this.edtDatumErstkontakt.DataSource = this.qryFaCheckInAlim;
            this.edtDatumErstkontakt.EditValue = null;
            this.edtDatumErstkontakt.Location = new System.Drawing.Point(121, 347);
            this.edtDatumErstkontakt.Name = "edtDatumErstkontakt";
            this.edtDatumErstkontakt.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtDatumErstkontakt.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumErstkontakt.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumErstkontakt.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumErstkontakt.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumErstkontakt.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumErstkontakt.Properties.Appearance.Options.UseFont = true;
            this.edtDatumErstkontakt.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject11.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject11.Options.UseBackColor = true;
            this.edtDatumErstkontakt.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDatumErstkontakt.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject11)});
            this.edtDatumErstkontakt.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumErstkontakt.Properties.Name = "kissDateEdit13.Properties";
            this.edtDatumErstkontakt.Properties.ShowToday = false;
            this.edtDatumErstkontakt.Size = new System.Drawing.Size(102, 24);
            this.edtDatumErstkontakt.TabIndex = 0;
            this.edtDatumErstkontakt.EditValueChanged += new System.EventHandler(this.edtDatumErstkontakt_EditValueChanged);
            // 
            // qryFaCheckInAlim
            // 
            this.qryFaCheckInAlim.CanDelete = true;
            this.qryFaCheckInAlim.CanInsert = true;
            this.qryFaCheckInAlim.CanUpdate = true;
            this.qryFaCheckInAlim.HostControl = this;
            this.qryFaCheckInAlim.SelectStatement = resources.GetString("qryFaCheckInAlim.SelectStatement");
            this.qryFaCheckInAlim.TableName = "FaCheckinAlim";
            this.qryFaCheckInAlim.BeforePost += new System.EventHandler(this.qryFaCheckInAlim_BeforePost);
            this.qryFaCheckInAlim.PositionChanged += new System.EventHandler(this.qryFaCheckInAlim_PositionChanged);
            this.qryFaCheckInAlim.AfterFill += new System.EventHandler(this.qryFaCheckInAlim_AfterFill);
            this.qryFaCheckInAlim.AfterInsert += new System.EventHandler(this.qryFaCheckInAlim_AfterInsert);
            this.qryFaCheckInAlim.BeforeInsert += new System.EventHandler(this.qryFaCheckInAlim_BeforeInsert);
            this.qryFaCheckInAlim.AfterPost += new System.EventHandler(this.qryFaCheckInAlim_AfterPost);
            // 
            // edtMaErstkontakt
            // 
            this.edtMaErstkontakt.DataMember = "ErstkontaktName";
            this.edtMaErstkontakt.DataSource = this.qryFaCheckInAlim;
            this.edtMaErstkontakt.Location = new System.Drawing.Point(284, 346);
            this.edtMaErstkontakt.Name = "edtMaErstkontakt";
            this.edtMaErstkontakt.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtMaErstkontakt.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtMaErstkontakt.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtMaErstkontakt.Properties.Appearance.Options.UseBackColor = true;
            this.edtMaErstkontakt.Properties.Appearance.Options.UseBorderColor = true;
            this.edtMaErstkontakt.Properties.Appearance.Options.UseFont = true;
            this.edtMaErstkontakt.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject10.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject10.Options.UseBackColor = true;
            this.edtMaErstkontakt.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject10)});
            this.edtMaErstkontakt.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtMaErstkontakt.Properties.Name = "kissButtonEdit6.Properties";
            this.edtMaErstkontakt.Size = new System.Drawing.Size(100, 24);
            this.edtMaErstkontakt.TabIndex = 1;
            this.edtMaErstkontakt.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtMaErstkontakt_UserModifiedFld);
            // 
            // edtWohnsitzGeprueft
            // 
            this.edtWohnsitzGeprueft.DataMember = "WohnsitzGeprueftDatum";
            this.edtWohnsitzGeprueft.DataSource = this.qryFaCheckInAlim;
            this.edtWohnsitzGeprueft.EditValue = null;
            this.edtWohnsitzGeprueft.Location = new System.Drawing.Point(121, 377);
            this.edtWohnsitzGeprueft.Name = "edtWohnsitzGeprueft";
            this.edtWohnsitzGeprueft.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtWohnsitzGeprueft.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtWohnsitzGeprueft.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtWohnsitzGeprueft.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtWohnsitzGeprueft.Properties.Appearance.Options.UseBackColor = true;
            this.edtWohnsitzGeprueft.Properties.Appearance.Options.UseBorderColor = true;
            this.edtWohnsitzGeprueft.Properties.Appearance.Options.UseFont = true;
            this.edtWohnsitzGeprueft.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject9.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject9.Options.UseBackColor = true;
            this.edtWohnsitzGeprueft.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtWohnsitzGeprueft.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject9)});
            this.edtWohnsitzGeprueft.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtWohnsitzGeprueft.Properties.Name = "kissDateEdit2.Properties";
            this.edtWohnsitzGeprueft.Properties.ShowToday = false;
            this.edtWohnsitzGeprueft.Size = new System.Drawing.Size(102, 24);
            this.edtWohnsitzGeprueft.TabIndex = 2;
            this.edtWohnsitzGeprueft.EditValueChanged += new System.EventHandler(this.edtWohnsitzGeprueft_EditValueChanged);
            // 
            // edtAnfrageDatum
            // 
            this.edtAnfrageDatum.DataMember = "AnfrageDatum";
            this.edtAnfrageDatum.DataSource = this.qryFaCheckInAlim;
            this.edtAnfrageDatum.EditValue = null;
            this.edtAnfrageDatum.Location = new System.Drawing.Point(121, 425);
            this.edtAnfrageDatum.Name = "edtAnfrageDatum";
            this.edtAnfrageDatum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtAnfrageDatum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtAnfrageDatum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAnfrageDatum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAnfrageDatum.Properties.Appearance.Options.UseBackColor = true;
            this.edtAnfrageDatum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAnfrageDatum.Properties.Appearance.Options.UseFont = true;
            this.edtAnfrageDatum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject8.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject8.Options.UseBackColor = true;
            this.edtAnfrageDatum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtAnfrageDatum.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject8)});
            this.edtAnfrageDatum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtAnfrageDatum.Properties.ShowToday = false;
            this.edtAnfrageDatum.Size = new System.Drawing.Size(102, 24);
            this.edtAnfrageDatum.TabIndex = 3;
            this.edtAnfrageDatum.EditValueChanged += new System.EventHandler(this.edtAnfrageDatum_EditValueChanged);
            // 
            // edtAnfrageUserID
            // 
            this.edtAnfrageUserID.DataMember = "AnfrageName";
            this.edtAnfrageUserID.DataSource = this.qryFaCheckInAlim;
            this.edtAnfrageUserID.Location = new System.Drawing.Point(284, 425);
            this.edtAnfrageUserID.Name = "edtAnfrageUserID";
            this.edtAnfrageUserID.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtAnfrageUserID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAnfrageUserID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAnfrageUserID.Properties.Appearance.Options.UseBackColor = true;
            this.edtAnfrageUserID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAnfrageUserID.Properties.Appearance.Options.UseFont = true;
            this.edtAnfrageUserID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject7.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject7.Options.UseBackColor = true;
            this.edtAnfrageUserID.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject7)});
            this.edtAnfrageUserID.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtAnfrageUserID.Properties.Name = "kissButtonEdit1.Properties";
            this.edtAnfrageUserID.Size = new System.Drawing.Size(100, 24);
            this.edtAnfrageUserID.TabIndex = 4;
            this.edtAnfrageUserID.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtAnfrageUserID_UserModifiedFld);
            // 
            // edtFaCheckInAlimentAnlass
            // 
            this.edtFaCheckInAlimentAnlass.DataMember = "AnlassCode";
            this.edtFaCheckInAlimentAnlass.DataSource = this.qryFaCheckInAlim;
            this.edtFaCheckInAlimentAnlass.Location = new System.Drawing.Point(121, 455);
            this.edtFaCheckInAlimentAnlass.LOVName = "FaCheckInAlimentAnlass";
            this.edtFaCheckInAlimentAnlass.Name = "edtFaCheckInAlimentAnlass";
            this.edtFaCheckInAlimentAnlass.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtFaCheckInAlimentAnlass.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtFaCheckInAlimentAnlass.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtFaCheckInAlimentAnlass.Properties.Appearance.Options.UseBackColor = true;
            this.edtFaCheckInAlimentAnlass.Properties.Appearance.Options.UseBorderColor = true;
            this.edtFaCheckInAlimentAnlass.Properties.Appearance.Options.UseFont = true;
            this.edtFaCheckInAlimentAnlass.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtFaCheckInAlimentAnlass.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtFaCheckInAlimentAnlass.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtFaCheckInAlimentAnlass.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtFaCheckInAlimentAnlass.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject6.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject6.Options.UseBackColor = true;
            this.edtFaCheckInAlimentAnlass.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject6)});
            this.edtFaCheckInAlimentAnlass.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtFaCheckInAlimentAnlass.Properties.NullText = "";
            this.edtFaCheckInAlimentAnlass.Properties.ShowFooter = false;
            this.edtFaCheckInAlimentAnlass.Properties.ShowHeader = false;
            this.edtFaCheckInAlimentAnlass.Size = new System.Drawing.Size(263, 24);
            this.edtFaCheckInAlimentAnlass.TabIndex = 5;
            // 
            // lblDatumErstkontakt
            // 
            this.lblDatumErstkontakt.Location = new System.Drawing.Point(14, 347);
            this.lblDatumErstkontakt.Name = "lblDatumErstkontakt";
            this.lblDatumErstkontakt.Size = new System.Drawing.Size(71, 24);
            this.lblDatumErstkontakt.TabIndex = 5;
            this.lblDatumErstkontakt.Text = "Erstkontakt";
            this.lblDatumErstkontakt.UseCompatibleTextRendering = true;
            // 
            // edtUnterlagenEingangDatum
            // 
            this.edtUnterlagenEingangDatum.DataMember = "UnterlagenEingangDatum";
            this.edtUnterlagenEingangDatum.DataSource = this.qryFaCheckInAlim;
            this.edtUnterlagenEingangDatum.EditValue = null;
            this.edtUnterlagenEingangDatum.Location = new System.Drawing.Point(121, 503);
            this.edtUnterlagenEingangDatum.Name = "edtUnterlagenEingangDatum";
            this.edtUnterlagenEingangDatum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtUnterlagenEingangDatum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtUnterlagenEingangDatum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtUnterlagenEingangDatum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtUnterlagenEingangDatum.Properties.Appearance.Options.UseBackColor = true;
            this.edtUnterlagenEingangDatum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtUnterlagenEingangDatum.Properties.Appearance.Options.UseFont = true;
            this.edtUnterlagenEingangDatum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject5.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject5.Options.UseBackColor = true;
            this.edtUnterlagenEingangDatum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtUnterlagenEingangDatum.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject5)});
            this.edtUnterlagenEingangDatum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtUnterlagenEingangDatum.Properties.ShowToday = false;
            this.edtUnterlagenEingangDatum.Size = new System.Drawing.Size(102, 24);
            this.edtUnterlagenEingangDatum.TabIndex = 6;
            this.edtUnterlagenEingangDatum.EditValueChanged += new System.EventHandler(this.edtUnterlagenEingangDatum_EditValueChanged);
            // 
            // edtUnterlagenEingangUserID
            // 
            this.edtUnterlagenEingangUserID.DataMember = "UEingangName";
            this.edtUnterlagenEingangUserID.DataSource = this.qryFaCheckInAlim;
            this.edtUnterlagenEingangUserID.Location = new System.Drawing.Point(284, 502);
            this.edtUnterlagenEingangUserID.Name = "edtUnterlagenEingangUserID";
            this.edtUnterlagenEingangUserID.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtUnterlagenEingangUserID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtUnterlagenEingangUserID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtUnterlagenEingangUserID.Properties.Appearance.Options.UseBackColor = true;
            this.edtUnterlagenEingangUserID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtUnterlagenEingangUserID.Properties.Appearance.Options.UseFont = true;
            this.edtUnterlagenEingangUserID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            this.edtUnterlagenEingangUserID.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4)});
            this.edtUnterlagenEingangUserID.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtUnterlagenEingangUserID.Properties.Name = "kissButtonEdit14.Properties";
            this.edtUnterlagenEingangUserID.Size = new System.Drawing.Size(100, 24);
            this.edtUnterlagenEingangUserID.TabIndex = 7;
            this.edtUnterlagenEingangUserID.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtUnterlagenEingangUserID_UserModifiedFld);
            // 
            // edtBemerkung
            // 
            this.edtBemerkung.DataMember = "Bemerkung";
            this.edtBemerkung.DataSource = this.qryFaCheckInAlim;
            this.edtBemerkung.Location = new System.Drawing.Point(408, 422);
            this.edtBemerkung.Name = "edtBemerkung";
            this.edtBemerkung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBemerkung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBemerkung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBemerkung.Properties.Appearance.Options.UseBackColor = true;
            this.edtBemerkung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBemerkung.Properties.Appearance.Options.UseFont = true;
            this.edtBemerkung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBemerkung.Properties.MaxLength = 200;
            this.edtBemerkung.Size = new System.Drawing.Size(292, 104);
            this.edtBemerkung.TabIndex = 8;
            // 
            // lblWohnsitzGeprueft
            // 
            this.lblWohnsitzGeprueft.Location = new System.Drawing.Point(14, 377);
            this.lblWohnsitzGeprueft.Name = "lblWohnsitzGeprueft";
            this.lblWohnsitzGeprueft.Size = new System.Drawing.Size(93, 24);
            this.lblWohnsitzGeprueft.TabIndex = 23;
            this.lblWohnsitzGeprueft.Text = "Wohnsitz geprüft";
            this.lblWohnsitzGeprueft.UseCompatibleTextRendering = true;
            // 
            // lblAnfrageDatum
            // 
            this.lblAnfrageDatum.Location = new System.Drawing.Point(11, 425);
            this.lblAnfrageDatum.Name = "lblAnfrageDatum";
            this.lblAnfrageDatum.Size = new System.Drawing.Size(103, 24);
            this.lblAnfrageDatum.TabIndex = 105;
            this.lblAnfrageDatum.Text = "Anlass Datum";
            this.lblAnfrageDatum.UseCompatibleTextRendering = true;
            // 
            // lblUnterlagenEingangDatum
            // 
            this.lblUnterlagenEingangDatum.Location = new System.Drawing.Point(13, 503);
            this.lblUnterlagenEingangDatum.Name = "lblUnterlagenEingangDatum";
            this.lblUnterlagenEingangDatum.Size = new System.Drawing.Size(103, 24);
            this.lblUnterlagenEingangDatum.TabIndex = 106;
            this.lblUnterlagenEingangDatum.Text = "Unterlageneingang";
            this.lblUnterlagenEingangDatum.UseCompatibleTextRendering = true;
            // 
            // panel1
            // 
            this.panel1.Controls.Add(this.picTitel);
            this.panel1.Controls.Add(this.lblTitelCheckinAlim);
            this.panel1.Dock = System.Windows.Forms.DockStyle.Top;
            this.panel1.Location = new System.Drawing.Point(0, 0);
            this.panel1.Name = "panel1";
            this.panel1.Size = new System.Drawing.Size(715, 24);
            this.panel1.TabIndex = 113;
            // 
            // picTitel
            // 
            this.picTitel.Location = new System.Drawing.Point(5, 5);
            this.picTitel.Name = "picTitel";
            this.picTitel.Size = new System.Drawing.Size(16, 16);
            this.picTitel.TabIndex = 293;
            this.picTitel.TabStop = false;
            // 
            // lblTitelCheckinAlim
            // 
            this.lblTitelCheckinAlim.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitelCheckinAlim.Location = new System.Drawing.Point(25, 5);
            this.lblTitelCheckinAlim.Name = "lblTitelCheckinAlim";
            this.lblTitelCheckinAlim.Size = new System.Drawing.Size(542, 15);
            this.lblTitelCheckinAlim.TabIndex = 0;
            this.lblTitelCheckinAlim.Text = "Check-in Alimentenstelle";
            this.lblTitelCheckinAlim.UseCompatibleTextRendering = true;
            // 
            // grdCheckInAlim
            // 
            this.grdCheckInAlim.DataSource = this.qryFaCheckInAlim;
            this.grdCheckInAlim.EmbeddedNavigator.Name = "";
            this.grdCheckInAlim.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdCheckInAlim.Location = new System.Drawing.Point(10, 40);
            this.grdCheckInAlim.MainView = this.grvCheckInAlim;
            this.grdCheckInAlim.Name = "grdCheckInAlim";
            this.grdCheckInAlim.Size = new System.Drawing.Size(690, 283);
            this.grdCheckInAlim.TabIndex = 114;
            this.grdCheckInAlim.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvCheckInAlim});
            // 
            // grvCheckInAlim
            // 
            this.grvCheckInAlim.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvCheckInAlim.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvCheckInAlim.Appearance.Empty.Options.UseBackColor = true;
            this.grvCheckInAlim.Appearance.Empty.Options.UseFont = true;
            this.grvCheckInAlim.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvCheckInAlim.Appearance.EvenRow.Options.UseFont = true;
            this.grvCheckInAlim.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvCheckInAlim.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvCheckInAlim.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvCheckInAlim.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvCheckInAlim.Appearance.FocusedCell.Options.UseFont = true;
            this.grvCheckInAlim.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvCheckInAlim.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvCheckInAlim.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvCheckInAlim.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvCheckInAlim.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvCheckInAlim.Appearance.FocusedRow.Options.UseFont = true;
            this.grvCheckInAlim.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvCheckInAlim.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvCheckInAlim.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvCheckInAlim.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvCheckInAlim.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvCheckInAlim.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvCheckInAlim.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvCheckInAlim.Appearance.GroupRow.Options.UseFont = true;
            this.grvCheckInAlim.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvCheckInAlim.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvCheckInAlim.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvCheckInAlim.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvCheckInAlim.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvCheckInAlim.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvCheckInAlim.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvCheckInAlim.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvCheckInAlim.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvCheckInAlim.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvCheckInAlim.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvCheckInAlim.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvCheckInAlim.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvCheckInAlim.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvCheckInAlim.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvCheckInAlim.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvCheckInAlim.Appearance.OddRow.Options.UseFont = true;
            this.grvCheckInAlim.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvCheckInAlim.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvCheckInAlim.Appearance.Row.Options.UseBackColor = true;
            this.grvCheckInAlim.Appearance.Row.Options.UseFont = true;
            this.grvCheckInAlim.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvCheckInAlim.Appearance.SelectedRow.Options.UseFont = true;
            this.grvCheckInAlim.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvCheckInAlim.Appearance.VertLine.Options.UseBackColor = true;
            this.grvCheckInAlim.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvCheckInAlim.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colAnfrage,
            this.colUser,
            this.colAnfrageBezeichnung,
            this.colUnterlagen,
            this.colUnterlagenUser,
            this.colErstkontakt,
            this.colErstkontaktUser,
            this.colWohnsitz});
            this.grvCheckInAlim.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvCheckInAlim.GridControl = this.grdCheckInAlim;
            this.grvCheckInAlim.Name = "grvCheckInAlim";
            this.grvCheckInAlim.OptionsBehavior.Editable = false;
            this.grvCheckInAlim.OptionsCustomization.AllowFilter = false;
            this.grvCheckInAlim.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvCheckInAlim.OptionsNavigation.AutoFocusNewRow = true;
            this.grvCheckInAlim.OptionsNavigation.UseTabKey = false;
            this.grvCheckInAlim.OptionsView.ColumnAutoWidth = false;
            this.grvCheckInAlim.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvCheckInAlim.OptionsView.ShowGroupPanel = false;
            this.grvCheckInAlim.OptionsView.ShowIndicator = false;
            // 
            // colAnfrage
            // 
            this.colAnfrage.Caption = "Anlass";
            this.colAnfrage.FieldName = "AnfrageDatum";
            this.colAnfrage.Name = "colAnfrage";
            this.colAnfrage.OptionsColumn.AllowSort = DevExpress.Utils.DefaultBoolean.False;
            this.colAnfrage.Visible = true;
            this.colAnfrage.VisibleIndex = 0;
            this.colAnfrage.Width = 70;
            // 
            // colUser
            // 
            this.colUser.Caption = "MA";
            this.colUser.FieldName = "AnfrageName";
            this.colUser.Name = "colUser";
            this.colUser.OptionsColumn.AllowSort = DevExpress.Utils.DefaultBoolean.False;
            this.colUser.Visible = true;
            this.colUser.VisibleIndex = 1;
            // 
            // colAnfrageBezeichnung
            // 
            this.colAnfrageBezeichnung.Caption = "Anlass Bezeichnung";
            this.colAnfrageBezeichnung.FieldName = "AnlassCode";
            this.colAnfrageBezeichnung.Name = "colAnfrageBezeichnung";
            this.colAnfrageBezeichnung.OptionsColumn.AllowGroup = DevExpress.Utils.DefaultBoolean.False;
            this.colAnfrageBezeichnung.Visible = true;
            this.colAnfrageBezeichnung.VisibleIndex = 2;
            this.colAnfrageBezeichnung.Width = 163;
            // 
            // colUnterlagen
            // 
            this.colUnterlagen.Caption = "Unterlagen";
            this.colUnterlagen.FieldName = "UnterlagenEingangDatum";
            this.colUnterlagen.Name = "colUnterlagen";
            this.colUnterlagen.OptionsColumn.AllowGroup = DevExpress.Utils.DefaultBoolean.False;
            this.colUnterlagen.Visible = true;
            this.colUnterlagen.VisibleIndex = 3;
            this.colUnterlagen.Width = 70;
            // 
            // colUnterlagenUser
            // 
            this.colUnterlagenUser.Caption = "MA";
            this.colUnterlagenUser.FieldName = "UEingangName";
            this.colUnterlagenUser.Name = "colUnterlagenUser";
            this.colUnterlagenUser.OptionsColumn.AllowGroup = DevExpress.Utils.DefaultBoolean.False;
            this.colUnterlagenUser.Visible = true;
            this.colUnterlagenUser.VisibleIndex = 4;
            this.colUnterlagenUser.Width = 70;
            // 
            // colErstkontakt
            // 
            this.colErstkontakt.AppearanceHeader.Font = new System.Drawing.Font("Tahoma", 8.25F, System.Drawing.FontStyle.Bold);
            this.colErstkontakt.AppearanceHeader.Options.UseFont = true;
            this.colErstkontakt.Caption = "Erstkontakt";
            this.colErstkontakt.FieldName = "ErstkontaktDatum";
            this.colErstkontakt.Name = "colErstkontakt";
            this.colErstkontakt.OptionsColumn.AllowGroup = DevExpress.Utils.DefaultBoolean.False;
            this.colErstkontakt.Visible = true;
            this.colErstkontakt.VisibleIndex = 5;
            this.colErstkontakt.Width = 79;
            // 
            // colErstkontaktUser
            // 
            this.colErstkontaktUser.Caption = "MA";
            this.colErstkontaktUser.FieldName = "ErstkontaktName";
            this.colErstkontaktUser.Name = "colErstkontaktUser";
            this.colErstkontaktUser.OptionsColumn.AllowGroup = DevExpress.Utils.DefaultBoolean.False;
            this.colErstkontaktUser.Visible = true;
            this.colErstkontaktUser.VisibleIndex = 6;
            this.colErstkontaktUser.Width = 70;
            // 
            // colWohnsitz
            // 
            this.colWohnsitz.Caption = "Wohnsitz";
            this.colWohnsitz.FieldName = "WohnsitzGeprueftDatum";
            this.colWohnsitz.Name = "colWohnsitz";
            this.colWohnsitz.OptionsColumn.AllowGroup = DevExpress.Utils.DefaultBoolean.False;
            this.colWohnsitz.Visible = true;
            this.colWohnsitz.VisibleIndex = 7;
            this.colWohnsitz.Width = 70;
            // 
            // lblFaCheckInAlimentAnlass
            // 
            this.lblFaCheckInAlimentAnlass.Location = new System.Drawing.Point(10, 455);
            this.lblFaCheckInAlimentAnlass.Name = "lblFaCheckInAlimentAnlass";
            this.lblFaCheckInAlimentAnlass.Size = new System.Drawing.Size(106, 24);
            this.lblFaCheckInAlimentAnlass.TabIndex = 116;
            this.lblFaCheckInAlimentAnlass.Text = "Anlass Bezeichnung";
            this.lblFaCheckInAlimentAnlass.UseCompatibleTextRendering = true;
            // 
            // lblBemerkung
            // 
            this.lblBemerkung.Location = new System.Drawing.Point(408, 395);
            this.lblBemerkung.Name = "lblBemerkung";
            this.lblBemerkung.Size = new System.Drawing.Size(141, 24);
            this.lblBemerkung.TabIndex = 118;
            this.lblBemerkung.Text = "Bemerkung";
            this.lblBemerkung.UseCompatibleTextRendering = true;
            // 
            // kissLabel1
            // 
            this.kissLabel1.Location = new System.Drawing.Point(251, 347);
            this.kissLabel1.Name = "kissLabel1";
            this.kissLabel1.Size = new System.Drawing.Size(27, 24);
            this.kissLabel1.TabIndex = 119;
            this.kissLabel1.Text = "MA";
            this.kissLabel1.UseCompatibleTextRendering = true;
            // 
            // kissLabel2
            // 
            this.kissLabel2.Location = new System.Drawing.Point(249, 422);
            this.kissLabel2.Name = "kissLabel2";
            this.kissLabel2.Size = new System.Drawing.Size(29, 24);
            this.kissLabel2.TabIndex = 120;
            this.kissLabel2.Text = "MA";
            this.kissLabel2.UseCompatibleTextRendering = true;
            // 
            // kissLabel3
            // 
            this.kissLabel3.Location = new System.Drawing.Point(251, 502);
            this.kissLabel3.Name = "kissLabel3";
            this.kissLabel3.Size = new System.Drawing.Size(21, 24);
            this.kissLabel3.TabIndex = 121;
            this.kissLabel3.Text = "MA";
            this.kissLabel3.UseCompatibleTextRendering = true;
            // 
            // edtDatumErstkontakt2
            // 
            this.edtDatumErstkontakt2.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtDatumErstkontakt2.EditValue = null;
            this.edtDatumErstkontakt2.Location = new System.Drawing.Point(121, 347);
            this.edtDatumErstkontakt2.Name = "edtDatumErstkontakt2";
            this.edtDatumErstkontakt2.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtDatumErstkontakt2.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtDatumErstkontakt2.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumErstkontakt2.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumErstkontakt2.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumErstkontakt2.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumErstkontakt2.Properties.Appearance.Options.UseFont = true;
            this.edtDatumErstkontakt2.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            this.edtDatumErstkontakt2.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDatumErstkontakt2.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3)});
            this.edtDatumErstkontakt2.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumErstkontakt2.Properties.ReadOnly = true;
            this.edtDatumErstkontakt2.Properties.ShowToday = false;
            this.edtDatumErstkontakt2.Size = new System.Drawing.Size(102, 24);
            this.edtDatumErstkontakt2.TabIndex = 122;
            // 
            // edtWohnsitzGeprueft2
            // 
            this.edtWohnsitzGeprueft2.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtWohnsitzGeprueft2.EditValue = null;
            this.edtWohnsitzGeprueft2.Location = new System.Drawing.Point(121, 377);
            this.edtWohnsitzGeprueft2.Name = "edtWohnsitzGeprueft2";
            this.edtWohnsitzGeprueft2.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtWohnsitzGeprueft2.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtWohnsitzGeprueft2.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtWohnsitzGeprueft2.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtWohnsitzGeprueft2.Properties.Appearance.Options.UseBackColor = true;
            this.edtWohnsitzGeprueft2.Properties.Appearance.Options.UseBorderColor = true;
            this.edtWohnsitzGeprueft2.Properties.Appearance.Options.UseFont = true;
            this.edtWohnsitzGeprueft2.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtWohnsitzGeprueft2.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtWohnsitzGeprueft2.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtWohnsitzGeprueft2.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtWohnsitzGeprueft2.Properties.ReadOnly = true;
            this.edtWohnsitzGeprueft2.Properties.ShowToday = false;
            this.edtWohnsitzGeprueft2.Size = new System.Drawing.Size(102, 24);
            this.edtWohnsitzGeprueft2.TabIndex = 123;
            // 
            // edtMaErstkontakt2
            // 
            this.edtMaErstkontakt2.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtMaErstkontakt2.Location = new System.Drawing.Point(284, 346);
            this.edtMaErstkontakt2.Name = "edtMaErstkontakt2";
            this.edtMaErstkontakt2.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtMaErstkontakt2.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtMaErstkontakt2.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtMaErstkontakt2.Properties.Appearance.Options.UseBackColor = true;
            this.edtMaErstkontakt2.Properties.Appearance.Options.UseBorderColor = true;
            this.edtMaErstkontakt2.Properties.Appearance.Options.UseFont = true;
            this.edtMaErstkontakt2.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtMaErstkontakt2.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtMaErstkontakt2.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtMaErstkontakt2.Properties.ReadOnly = true;
            this.edtMaErstkontakt2.Size = new System.Drawing.Size(100, 24);
            this.edtMaErstkontakt2.TabIndex = 124;
            // 
            // CtlFaCheckinAlim
            // 
            this.ActiveSQLQuery = this.qryFaCheckInAlim;
            this.Controls.Add(this.edtMaErstkontakt2);
            this.Controls.Add(this.edtWohnsitzGeprueft2);
            this.Controls.Add(this.edtDatumErstkontakt2);
            this.Controls.Add(this.kissLabel3);
            this.Controls.Add(this.kissLabel2);
            this.Controls.Add(this.kissLabel1);
            this.Controls.Add(this.lblBemerkung);
            this.Controls.Add(this.lblFaCheckInAlimentAnlass);
            this.Controls.Add(this.grdCheckInAlim);
            this.Controls.Add(this.panel1);
            this.Controls.Add(this.lblUnterlagenEingangDatum);
            this.Controls.Add(this.lblAnfrageDatum);
            this.Controls.Add(this.lblWohnsitzGeprueft);
            this.Controls.Add(this.edtBemerkung);
            this.Controls.Add(this.edtUnterlagenEingangUserID);
            this.Controls.Add(this.edtUnterlagenEingangDatum);
            this.Controls.Add(this.lblDatumErstkontakt);
            this.Controls.Add(this.edtFaCheckInAlimentAnlass);
            this.Controls.Add(this.edtAnfrageUserID);
            this.Controls.Add(this.edtAnfrageDatum);
            this.Controls.Add(this.edtWohnsitzGeprueft);
            this.Controls.Add(this.edtMaErstkontakt);
            this.Controls.Add(this.edtDatumErstkontakt);
            this.Font = new System.Drawing.Font("Arial", 10F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.Name = "CtlFaCheckinAlim";
            this.Size = new System.Drawing.Size(715, 541);
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumErstkontakt.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryFaCheckInAlim)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtMaErstkontakt.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtWohnsitzGeprueft.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAnfrageDatum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAnfrageUserID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtFaCheckInAlimentAnlass.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtFaCheckInAlimentAnlass)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumErstkontakt)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtUnterlagenEingangDatum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtUnterlagenEingangUserID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBemerkung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblWohnsitzGeprueft)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAnfrageDatum)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblUnterlagenEingangDatum)).EndInit();
            this.panel1.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitelCheckinAlim)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdCheckInAlim)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvCheckInAlim)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblFaCheckInAlimentAnlass)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel3)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumErstkontakt2.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtWohnsitzGeprueft2.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtMaErstkontakt2.Properties)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Public Methods

        public void Init(string Name, Image TitleImage, int LeistungID)
        {
            lblTitelCheckinAlim.Text = Name;
            picTitel.Image = TitleImage;
            faLeistungID = LeistungID;

            colAnfrageBezeichnung.ColumnEdit = grdCheckInAlim.GetLOVLookUpEdit("FaCheckInAlimentAnlass");

            // User-Anzeige holen
            SqlQuery qryUser = DBUtil.OpenSQL(@"
            select DisplayText, OrgUnit, OrgUnitID from vwUser
            where UserID = {0} ",
            Session.User.UserID);
            UserWholeName = Utils.ConvertToString(qryUser["DisplayText"]);
            UserQTID = Utils.ConvertToInt(qryUser["OrgUnitID"]);
            UserQTName = Utils.ConvertToString(qryUser["OrgUnit"]);

            // Erster Datensatz suchen:
            SqlQuery qryFirst = DBUtil.OpenSQL(@"
            select top 1 FaCheckInAlimID, ErstkontaktDatum, WohnsitzGeprueftDatum
            from FaCheckInAlim where FaLeistungID = {0} and not ErstkontaktDatum is NULL
            order by case when ErstkontaktDatum is null then 1 else 0 end asc,
              AnfrageDatum asc,
              FaCheckinAlimID asc",
            faLeistungID);
            if (qryFirst.Count==0)
            {
                // Es gibt noch keine Daten
                ErsterDatensatzID = 0;
                ErsterDatensatzWohnsitzGeprueftIstLeer = true;
            }
            else
            {
                // Es gibt bereits Daten
                ErsterDatensatzID = Utils.ConvertToInt(qryFirst["FaCheckInAlimID"]);
                ErsterDatensatzWohnsitzGeprueftIstLeer = DBUtil.IsEmpty(qryFirst["WohnsitzGeprueftDatum"]);

                if (DBUtil.IsEmpty(qryFirst["ErstkontaktDatum"]))
                {
                ErsterDatensatz_Datum = DateTime.Today;
                KissMsg.ShowInfo(
                    "Inkonsistente Daten gefunden.\r\n"+
                    "Erfassen Sie das Erstkontaktdatum beim ältesten Datensatz.");
                }
                else
                {
                ErsterDatensatz_Datum = (DateTime)qryFirst["ErstkontaktDatum"];
                }
            }

            // Daten füllen:
            qryFaCheckInAlim.Fill(faLeistungID);
        }

        #endregion

        #region Private Methods

        private void FelderEinstellen_AnlassUndUnterlagenEingang(object WohnsitzGeprueftDatum)
        {
            bool CanEdit = (
            qryFaCheckInAlim.CanUpdate &&
            qryFaCheckInAlim.Count > 0 &&
            !DBUtil.IsEmpty(WohnsitzGeprueftDatum)
              );
              EditModeType EMode = EditModeType.ReadOnly;
              if (CanEdit) EMode = EditModeType.Normal;

              edtAnfrageDatum.EditMode = EMode;
              edtAnfrageUserID.EditMode = EMode;
              edtFaCheckInAlimentAnlass.EditMode = EMode;
              edtUnterlagenEingangDatum.EditMode = EMode;
              edtUnterlagenEingangUserID.EditMode = EMode;
              edtBemerkung.EditMode = EMode;
        }

        private void edtAnfrageDatum_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            if (!edtAnfrageDatum.UserModified) return;

            if (DBUtil.IsEmpty(edtAnfrageDatum.EditValue))
            {
              qryFaCheckInAlim["AnfrageDatum"] = DBNull.Value;
              qryFaCheckInAlim["AnfrageUserID"] = DBNull.Value;
              qryFaCheckInAlim["AnfrageName"] = DBNull.Value;
              edtAnfrageUserID.ToolTip = "";
            }
            else
            {
              qryFaCheckInAlim["AnfrageDatum"] = (DateTime)edtAnfrageDatum.EditValue;
              qryFaCheckInAlim["AnfrageUserID"] = Session.User.UserID;
              qryFaCheckInAlim["AnfrageName"] = UserWholeName;
              edtAnfrageUserID.ToolTip = UserWholeName;
            }
            qryFaCheckInAlim.RefreshDisplay();
        }

        private void edtAnfrageUserID_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            string SearchString = edtAnfrageUserID.Text.Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
              if (e.ButtonClicked)
                SearchString = "%";
              else
              {
                qryFaCheckInAlim["AnfrageUserID"] = DBNull.Value;
                qryFaCheckInAlim["AnfrageName"] = DBNull.Value;
                edtAnfrageUserID.ToolTip = "";
                return;
              }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
              SELECT ID$ = UserID,
                [Kürzel] = LogonName,
                [Mitarbeiter/in] = NameVorname,
                [Org.Einheit] = OrgUnit,
                DisplayText$ = DisplayText
              FROM   vwUser
              WHERE  DisplayText LIKE '%' + {0} + '%'
              ORDER BY NameVorname",
              SearchString,
              e.ButtonClicked,null,null,null);

            if (!e.Cancel)
            {
              qryFaCheckInAlim["AnfrageUserID"] = dlg[0];
              qryFaCheckInAlim["AnfrageName"] = dlg[4];
              edtAnfrageUserID.ToolTip = Utils.ConvertToString(dlg[4]);
            }
        }

        private void edtDatumErstkontakt_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            if (!edtDatumErstkontakt.UserModified) return;

            if (DBUtil.IsEmpty(edtDatumErstkontakt.EditValue))
            {
              qryFaCheckInAlim["ErstkontaktDatum"] = DBNull.Value;
              qryFaCheckInAlim["ErstkontaktUserID"] = DBNull.Value;
              qryFaCheckInAlim["ErstkontaktName"] = DBNull.Value;
              edtMaErstkontakt.ToolTip = "";
            }
            else
            {
              qryFaCheckInAlim["ErstkontaktDatum"] = (DateTime)edtDatumErstkontakt.EditValue;
              qryFaCheckInAlim["ErstkontaktUserID"] = Session.User.UserID;
              qryFaCheckInAlim["ErstkontaktName"] = UserWholeName;
              edtMaErstkontakt.ToolTip = UserWholeName;
            }
            qryFaCheckInAlim.RefreshDisplay();
        }

        private void edtMaErstkontakt_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            string SearchString = edtMaErstkontakt.Text.Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
              if (e.ButtonClicked)
                SearchString = "%";
              else
              {
                qryFaCheckInAlim["ErstkontaktUserID"]    = DBNull.Value;
                qryFaCheckInAlim["ErstkontaktName"] = DBNull.Value;
                edtMaErstkontakt.ToolTip = "";
                return;
              }
            }
            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
              SELECT ID$ = UserID,
                [Kürzel] = LogonName,
                [Mitarbeiter/in] = NameVorname,
                [Org.Einheit] = OrgUnit,
                DisplayText$ = DisplayText
              FROM   vwUser
              WHERE  DisplayText LIKE '%' + {0} + '%'
              ORDER BY NameVorname",
              SearchString,
              e.ButtonClicked,null,null,null);

            if (!e.Cancel)
            {
              qryFaCheckInAlim["ErstkontaktUserID"]    = dlg[0];
              qryFaCheckInAlim["ErstkontaktName"] = dlg[4];
              edtMaErstkontakt.ToolTip = Utils.ConvertToString(dlg[4]);
            }
        }

        private void edtUnterlagenEingangDatum_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            if (!edtUnterlagenEingangDatum.UserModified) return;

            if (DBUtil.IsEmpty(edtUnterlagenEingangDatum.EditValue))
            {
              qryFaCheckInAlim["UnterlagenEingangDatum"] = DBNull.Value;
              qryFaCheckInAlim["UnterlagenEingangUserID"] = DBNull.Value;
              qryFaCheckInAlim["UEingangName"] = DBNull.Value;
              edtUnterlagenEingangUserID.ToolTip = "";
            }
            else
            {
              qryFaCheckInAlim["UnterlagenEingangDatum"] = (DateTime)edtUnterlagenEingangDatum.EditValue;
              qryFaCheckInAlim["UnterlagenEingangUserID"] = Session.User.UserID;
              qryFaCheckInAlim["UEingangName"] = UserWholeName;
              edtUnterlagenEingangUserID.ToolTip = UserWholeName;
            }
            qryFaCheckInAlim.RefreshDisplay();
        }

        private void edtUnterlagenEingangUserID_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            string SearchString = edtUnterlagenEingangUserID.Text.Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
              if (e.ButtonClicked)
                SearchString = "%";
              else
              {
                qryFaCheckInAlim["UnterlagenEingangUserID"]    = DBNull.Value;
                qryFaCheckInAlim["UEingangName"] = DBNull.Value;
                edtUnterlagenEingangUserID.ToolTip = "";
                return;
              }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
              SELECT ID$ = UserID,
                [Kürzel] = LogonName,
                [Mitarbeiter/in] = NameVorname,
                [Org.Einheit] = OrgUnit,
                DisplayText$ = DisplayText
              FROM   vwUser
              WHERE  DisplayText LIKE '%' + {0} + '%'
              ORDER BY NameVorname",
              SearchString,
              e.ButtonClicked,null,null,null);

            if (!e.Cancel)
            {
              qryFaCheckInAlim["UnterlagenEingangUserID"] = dlg[0];
              qryFaCheckInAlim["UEingangName"] = dlg[4];
              edtUnterlagenEingangUserID.ToolTip = Utils.ConvertToString(dlg[4]);
            }
        }

        private void edtWohnsitzGeprueft_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            // Felder editieren einstellen
            if (edtWohnsitzGeprueft.UserModified)
              FelderEinstellen_AnlassUndUnterlagenEingang(edtWohnsitzGeprueft.EditValue);
            //else
            //  FelderEinstellen_AnlassUndUnterlagenEingang(WohnsitzGeprueftDatum);
        }

        private void qryFaCheckInAlim_AfterFill(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            // Angaben des ersten Datensatzes merken
            ErsterDatensatz_Datum = qryFaCheckInAlim["ErstkontaktDatum"];
            ErsterDatensatz_UserName = Utils.ConvertToString(qryFaCheckInAlim["ErstkontaktName"]);
            ErsterDatensatz_WohnsitzDatum = qryFaCheckInAlim["WohnsitzGeprueftDatum"];

            qryFaCheckInAlim_PositionChanged(sender, e);
        }

        private void qryFaCheckInAlim_AfterInsert(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            qryFaCheckInAlim["FaLeistungID"] = this.faLeistungID;
        }

        private void qryFaCheckInAlim_AfterPost(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            if (ErsterDatensatzID == 0)
              ErsterDatensatzID = Utils.ConvertToInt(qryFaCheckInAlim["FaCheckInAlimID"]);

            if (ErsterDatensatzID == Utils.ConvertToInt(qryFaCheckInAlim["FaCheckInAlimID"]))
              ErsterDatensatzWohnsitzGeprueftIstLeer = DBUtil.IsEmpty(qryFaCheckInAlim["WohnsitzGeprueftDatum"]);
        }

        private void qryFaCheckInAlim_BeforeInsert(object sender, System.EventArgs e)
        {
            if (ErsterDatensatzID > 0 && ErsterDatensatzWohnsitzGeprueftIstLeer)
            {
              KissMsg.ShowInfo(
                "Der Wohnsitz wurde noch nicht geprüft.\r\n"+
                "Erfassen Sie zuerst das Datum 'Wohnsitz geprüft' beim ersten Datensatz,\r\n"+
                "bevor Sie weitere Datensätze einfügen."
              );
              throw new KissCancelException();
            }
        }

        private void qryFaCheckInAlim_BeforePost(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            if (ErsterDatensatzID == Utils.ConvertToInt(qryFaCheckInAlim["FaCheckInAlimID"]))
            {
              // es wird der erste Datensatz erfasst:
              DBUtil.CheckNotNullField(edtDatumErstkontakt, lblDatumErstkontakt.Text);
              DBUtil.CheckNotNullField(edtMaErstkontakt, "Erstkontakt-MA");

              if (!DBUtil.IsEmpty(qryFaCheckInAlim["AnfrageDatum"]))
              {
                if ((DateTime)qryFaCheckInAlim["AnfrageDatum"] < (DateTime)qryFaCheckInAlim["ErstkontaktDatum"])
                {
                  KissMsg.ShowInfo(string.Format(
                    "Das Anlassdatum ({0}) darf nicht vor dem Erstkontakt ({1}) liegen.",
                    ((DateTime)qryFaCheckInAlim["AnfrageDatum"]).ToString("dd.MM.yyyy"),
                    ((DateTime)qryFaCheckInAlim["ErstkontaktDatum"]).ToString("dd.MM.yyyy")
                  ));
                  throw new KissCancelException();
                }
              }
              if (!DBUtil.IsEmpty(qryFaCheckInAlim["UnterlagenEingangDatum"]))
              {
                if ((DateTime)qryFaCheckInAlim["UnterlagenEingangDatum"] < (DateTime)qryFaCheckInAlim["ErstkontaktDatum"])
                {
                  KissMsg.ShowInfo("Das Unterlageneingangsdatum darf nicht vor dem Erstkontakt liegen.");
                  throw new KissCancelException();
                }
              }

              // Kontrollieren, dass alle erfassten Daten nach dem Erstkontaktdatum liegen
              bool HasError = false;
              foreach (System.Data.DataRow row in qryFaCheckInAlim.DataTable.Rows)
              {
                if (
                  !DBUtil.IsEmpty(row["AnfrageDatum"]) &&
                  (DateTime)qryFaCheckInAlim["ErstkontaktDatum"] > (DateTime)row["AnfrageDatum"]
                ) HasError = true;
                if (
                  !DBUtil.IsEmpty(row["UnterlagenEingangDatum"]) &&
                  (DateTime)qryFaCheckInAlim["ErstkontaktDatum"] > (DateTime)row["UnterlagenEingangDatum"]
                ) HasError = true;
              }
              if (HasError)
              {
                KissMsg.ShowInfo(
                  "Das Erstkontaktdatum darf nicht nach anderen Zeitpunkten liegen.\r\n"+
                  "Vergleichen Sie die Daten 'Anlass' und 'Unterlageneingang' aller Datensätze.");
                throw new KissCancelException();
              }

              if (
                DBUtil.IsEmpty(qryFaCheckInAlim["WohnsitzGeprueftDatum"]) &&
                (
                  qryFaCheckInAlim.Count > 1 ||
                  !DBUtil.IsEmpty(qryFaCheckInAlim["AnfrageDatum"]) ||
                  !DBUtil.IsEmpty(qryFaCheckInAlim["AnfrageName"]) ||
                  !DBUtil.IsEmpty(qryFaCheckInAlim["AnlassCode"]) ||
                  !DBUtil.IsEmpty(qryFaCheckInAlim["UEingangName"]) ||
                  !DBUtil.IsEmpty(qryFaCheckInAlim["Bemerkung"])
                )
              )
              {
                KissMsg.ShowInfo(
                  "Wenn Daten bei 'Anlass' oder bei 'Unterlageneingang' erfasst wurden,\r\n"+
                  "darf das Datum 'Wohnsitz geprüft' nicht leer bleiben.");
                throw new KissCancelException();
              }
            }
            else
            {
              // es wird NICHT der erste Datensatz erfasst:
              // alle Datum müssen nach dem Erstkontakt-Datum sein:
              if (!DBUtil.IsEmpty(qryFaCheckInAlim["AnfrageDatum"]))
              {
                if ((DateTime)qryFaCheckInAlim["AnfrageDatum"] < (DateTime)ErsterDatensatz_Datum)
                {
                  KissMsg.ShowInfo(string.Format(
                    "Das Anlassdatum ({0}) darf nicht vor dem Erstkontakt ({1}) liegen.",
                    ((DateTime)qryFaCheckInAlim["AnfrageDatum"]).ToString("dd.MM.yyyy"),
                    ((DateTime)ErsterDatensatz_Datum).ToString("dd.MM.yyyy")
                  ));
                  throw new KissCancelException();
                }
              }
              if (!DBUtil.IsEmpty(qryFaCheckInAlim["UnterlagenEingangDatum"]))
              {
                if ((DateTime)qryFaCheckInAlim["UnterlagenEingangDatum"] < (DateTime)ErsterDatensatz_Datum)
                {
                  KissMsg.ShowInfo("Das Unterlageneingangsdatum darf nicht vor dem Erstkontakt liegen.");
                  throw new KissCancelException();
                }
              }
            }

            if (!DBUtil.IsEmpty(qryFaCheckInAlim["WohnsitzGeprueftDatum"]))
            {
              if ((DateTime)qryFaCheckInAlim["WohnsitzGeprueftDatum"] < (DateTime)qryFaCheckInAlim["ErstkontaktDatum"] )
              {
                KissMsg.ShowInfo("Das Datum 'Wohnsitz geprüft' darf nicht vor dem Erstkontakt liegen.");
                throw new KissCancelException();
              }
            }

            if (!DBUtil.IsEmpty(qryFaCheckInAlim["AnfrageDatum"]))
            {
              DBUtil.CheckNotNullField(edtAnfrageUserID, "Anlass MA");
            }

            if (!DBUtil.IsEmpty(qryFaCheckInAlim["UnterlagenEingangDatum"]))
            {
              DBUtil.CheckNotNullField(edtUnterlagenEingangUserID, "Unterlageneingang MA");
            }

            if (ErsterDatensatzID == Utils.ConvertToInt(qryFaCheckInAlim["FaCheckInAlimID"]))
            {
              // Alles ok, also Angaben des ersten Datensatzes merken
              ErsterDatensatz_Datum = qryFaCheckInAlim["ErstkontaktDatum"];
              ErsterDatensatz_UserName = Utils.ConvertToString(qryFaCheckInAlim["ErstkontaktName"]);
              ErsterDatensatz_WohnsitzDatum = qryFaCheckInAlim["WohnsitzGeprueftDatum"];
            }
        }

        private void qryFaCheckInAlim_PositionChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 19.12.2007 : sozheo : neu
            // ---------------------------------------------------------------

            qryFaCheckInAlim.CanDelete = (
              qryFaCheckInAlim.CanUpdate &&
              Utils.ConvertToInt(qryFaCheckInAlim["FaCheckInAlimID"]) != ErsterDatensatzID
            );

            edtMaErstkontakt.ToolTip = Utils.ConvertToString(qryFaCheckInAlim["ErstkontaktName"]);
            edtAnfrageUserID.ToolTip = Utils.ConvertToString(qryFaCheckInAlim["AnfrageName"]);
            edtUnterlagenEingangUserID.ToolTip = Utils.ConvertToString(qryFaCheckInAlim["UEingangName"]);

            // Erstkontakt-Felder sollen nur editierbar sein, wenn es der erste Datensatz ist
            bool CanEdit = (
              qryFaCheckInAlim.CanUpdate &&
              qryFaCheckInAlim.Count > 0 &&
              Utils.ConvertToInt(qryFaCheckInAlim["FaCheckInAlimID"]) == ErsterDatensatzID
            );

            EditModeType EMode = EditModeType.ReadOnly;
            if (CanEdit) EMode = EditModeType.Normal;
            edtDatumErstkontakt.EditMode = EMode;
            edtMaErstkontakt.EditMode = EMode;
            edtWohnsitzGeprueft.EditMode = EMode;

            // Es sllen immer dei Datren des ersten Datensatzes angezeigt werden
            edtDatumErstkontakt.Visible = (Utils.ConvertToInt(qryFaCheckInAlim["FaCheckInAlimID"]) == ErsterDatensatzID);
            edtMaErstkontakt.Visible = edtDatumErstkontakt.Visible;
            edtWohnsitzGeprueft.Visible = edtDatumErstkontakt.Visible;

            edtDatumErstkontakt2.Visible = (!edtDatumErstkontakt.Visible);
            edtMaErstkontakt2.Visible = edtDatumErstkontakt2.Visible;
            edtWohnsitzGeprueft2.Visible = edtDatumErstkontakt2.Visible;
            edtDatumErstkontakt2.EditValue = ErsterDatensatz_Datum;
            edtMaErstkontakt2.EditValue = ErsterDatensatz_UserName;
            edtWohnsitzGeprueft2.EditValue = ErsterDatensatz_WohnsitzDatum;

            // Felder editieren einstellen
            FelderEinstellen_AnlassUndUnterlagenEingang(ErsterDatensatz_WohnsitzDatum);
        }

        #endregion
    }
}