#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Drawing;
using Kiss.Interfaces.UI;
using KiSS4.Common;
using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Fallfuehrung.ZH
{
    public class CtlFaAssessment : KiSS4.Gui.KissUserControl
    {
        #region Fields

        private bool HasSpecialRights = false;
        private int UserQTID = 0;
        private string UserQTName = "";
        private string UserWholeName = "";
        private int baPersonID = 0;
        private KiSS4.Gui.KissButton btnStellenleitung;
        private KiSS4.Dokument.KissDocumentButton btnWordUebergabe;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissDateEdit edtAbschlussDatum;
        private KiSS4.Gui.KissLookUpEdit edtAbschlussGrund;
        private KiSS4.Gui.KissButtonEdit edtAbschlussUser;
        private KiSS4.Gui.KissDateEdit edtDatumBericht;
        private KiSS4.Gui.KissLookUpEdit edtEmpfehlungRP;
        private KiSS4.Gui.KissDateEdit edtEroeffDatum;
        private KiSS4.Gui.KissButtonEdit edtEroeffnungUser;
        private KiSS4.Gui.KissLookUpEdit edtGrundBV;
        private KiSS4.Gui.KissLookUpEdit edtKriterium;
        private KiSS4.Gui.KissDateEdit edtQTUebergabeDatum;
        private KiSS4.Gui.KissButtonEdit edtQTUebergabeOrgUnit;
        private int faAssessmentID = 0;
        private int faLeistungID = -1;
        private KiSS4.Gui.KissLabel lblAbschlussDatum;
        private KiSS4.Gui.KissLabel lblAbschlussDurch;
        private KiSS4.Gui.KissLabel lblAbschlussTitle;
        private KiSS4.Gui.KissLabel lblDatumBericht;
        private KiSS4.Gui.KissLabel lblEmpfehlung;
        private KiSS4.Gui.KissLabel lblEroeffAm;
        private KiSS4.Gui.KissLabel lblEroeffDurch;
        private KiSS4.Gui.KissLabel lblEroeffTitle;
        private KiSS4.Gui.KissLabel lblGrund;
        private KiSS4.Gui.KissLabel lblGrundBV;
        private KiSS4.Gui.KissLabel lblKriterium;
        private KiSS4.Gui.KissLabel lblQTUebergabeOrgUnit;
        private KiSS4.Gui.KissLabel lblTitel;
        private System.Windows.Forms.PictureBox picTitel;
        private System.Windows.Forms.Panel pnlTitle;
        private KiSS4.DB.SqlQuery qryFaAssessment;

        #endregion

        #region Constructors

        public CtlFaAssessment()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject11 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject10 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject9 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject8 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject7 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject6 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject5 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlFaAssessment));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            this.edtEroeffDatum = new KiSS4.Gui.KissDateEdit();
            this.qryFaAssessment = new KiSS4.DB.SqlQuery(this.components);
            this.lblEmpfehlung = new KiSS4.Gui.KissLabel();
            this.edtEroeffnungUser = new KiSS4.Gui.KissButtonEdit();
            this.lblEroeffTitle = new KiSS4.Gui.KissLabel();
            this.lblKriterium = new KiSS4.Gui.KissLabel();
            this.edtDatumBericht = new KiSS4.Gui.KissDateEdit();
            this.lblEroeffAm = new KiSS4.Gui.KissLabel();
            this.edtAbschlussDatum = new KiSS4.Gui.KissDateEdit();
            this.edtAbschlussUser = new KiSS4.Gui.KissButtonEdit();
            this.edtAbschlussGrund = new KiSS4.Gui.KissLookUpEdit();
            this.edtGrundBV = new KiSS4.Gui.KissLookUpEdit();
            this.edtEmpfehlungRP = new KiSS4.Gui.KissLookUpEdit();
            this.edtKriterium = new KiSS4.Gui.KissLookUpEdit();
            this.edtQTUebergabeOrgUnit = new KiSS4.Gui.KissButtonEdit();
            this.btnWordUebergabe = new KiSS4.Dokument.KissDocumentButton();
            this.btnStellenleitung = new KiSS4.Gui.KissButton();
            this.edtQTUebergabeDatum = new KiSS4.Gui.KissDateEdit();
            this.lblAbschlussTitle = new KiSS4.Gui.KissLabel();
            this.lblAbschlussDatum = new KiSS4.Gui.KissLabel();
            this.lblAbschlussDurch = new KiSS4.Gui.KissLabel();
            this.lblGrundBV = new KiSS4.Gui.KissLabel();
            this.lblDatumBericht = new KiSS4.Gui.KissLabel();
            this.pnlTitle = new System.Windows.Forms.Panel();
            this.picTitel = new System.Windows.Forms.PictureBox();
            this.lblTitel = new KiSS4.Gui.KissLabel();
            this.lblEroeffDurch = new KiSS4.Gui.KissLabel();
            this.lblGrund = new KiSS4.Gui.KissLabel();
            this.lblQTUebergabeOrgUnit = new KiSS4.Gui.KissLabel();
            ((System.ComponentModel.ISupportInitialize)(this.edtEroeffDatum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryFaAssessment)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEmpfehlung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEroeffnungUser.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEroeffTitle)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKriterium)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBericht.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEroeffAm)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussDatum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussUser.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussGrund)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussGrund.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtGrundBV)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtGrundBV.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEmpfehlungRP)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEmpfehlungRP.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKriterium)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKriterium.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtQTUebergabeOrgUnit.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtQTUebergabeDatum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAbschlussTitle)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAbschlussDatum)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAbschlussDurch)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGrundBV)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumBericht)).BeginInit();
            this.pnlTitle.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEroeffDurch)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGrund)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblQTUebergabeOrgUnit)).BeginInit();
            this.SuspendLayout();
            // 
            // edtEroeffDatum
            // 
            this.edtEroeffDatum.DataMember = "EroeffnungDatum";
            this.edtEroeffDatum.DataSource = this.qryFaAssessment;
            this.edtEroeffDatum.EditValue = null;
            this.edtEroeffDatum.Location = new System.Drawing.Point(101, 64);
            this.edtEroeffDatum.Name = "edtEroeffDatum";
            this.edtEroeffDatum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtEroeffDatum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtEroeffDatum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtEroeffDatum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtEroeffDatum.Properties.Appearance.Options.UseBackColor = true;
            this.edtEroeffDatum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtEroeffDatum.Properties.Appearance.Options.UseFont = true;
            this.edtEroeffDatum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject11.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject11.Options.UseBackColor = true;
            this.edtEroeffDatum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtEroeffDatum.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject11)});
            this.edtEroeffDatum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtEroeffDatum.Properties.Name = "kissDateEdit1.Properties";
            this.edtEroeffDatum.Properties.ShowToday = false;
            this.edtEroeffDatum.Size = new System.Drawing.Size(90, 24);
            this.edtEroeffDatum.TabIndex = 0;
            this.edtEroeffDatum.EditValueChanged += new System.EventHandler(this.edtEroeffDatum_EditValueChanged);
            // 
            // qryFaAssessment
            // 
            this.qryFaAssessment.CanUpdate = true;
            this.qryFaAssessment.HostControl = this;
            this.qryFaAssessment.SelectStatement = resources.GetString("qryFaAssessment.SelectStatement");
            this.qryFaAssessment.TableName = "FaAssessment";
            this.qryFaAssessment.AfterFill += new System.EventHandler(this.qryFaAssessment_AfterFill);
            this.qryFaAssessment.BeforePost += new System.EventHandler(this.qryFaAssessment_BeforePost);
            this.qryFaAssessment.AfterPost += new System.EventHandler(this.qryFaAssessment_AfterPost);
            this.qryFaAssessment.PositionChanged += new System.EventHandler(this.qryFaAssessment_PositionChanged);
            // 
            // lblEmpfehlung
            // 
            this.lblEmpfehlung.Location = new System.Drawing.Point(5, 271);
            this.lblEmpfehlung.Name = "lblEmpfehlung";
            this.lblEmpfehlung.Size = new System.Drawing.Size(90, 24);
            this.lblEmpfehlung.TabIndex = 0;
            this.lblEmpfehlung.Text = "Empfehlung RP";
            this.lblEmpfehlung.UseCompatibleTextRendering = true;
            // 
            // edtEroeffnungUser
            // 
            this.edtEroeffnungUser.DataMember = "EroeffnungUser";
            this.edtEroeffnungUser.DataSource = this.qryFaAssessment;
            this.edtEroeffnungUser.Location = new System.Drawing.Point(270, 64);
            this.edtEroeffnungUser.Name = "edtEroeffnungUser";
            this.edtEroeffnungUser.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtEroeffnungUser.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtEroeffnungUser.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtEroeffnungUser.Properties.Appearance.Options.UseBackColor = true;
            this.edtEroeffnungUser.Properties.Appearance.Options.UseBorderColor = true;
            this.edtEroeffnungUser.Properties.Appearance.Options.UseFont = true;
            this.edtEroeffnungUser.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject10.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject10.Options.UseBackColor = true;
            this.edtEroeffnungUser.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject10)});
            this.edtEroeffnungUser.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtEroeffnungUser.Properties.Name = "kissButtonEdit1.Properties";
            this.edtEroeffnungUser.SearchStringWhitelist = new string[] {
        ".",
        "*",
        "%"};
            this.edtEroeffnungUser.Size = new System.Drawing.Size(354, 24);
            this.edtEroeffnungUser.TabIndex = 1;
            this.edtEroeffnungUser.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtEroeffnungUser_UserModifiedFld);
            // 
            // lblEroeffTitle
            // 
            this.lblEroeffTitle.LabelStyle = KiSS4.Gui.LabelStyleType.DataView;
            this.lblEroeffTitle.Location = new System.Drawing.Point(5, 45);
            this.lblEroeffTitle.Name = "lblEroeffTitle";
            this.lblEroeffTitle.Size = new System.Drawing.Size(152, 16);
            this.lblEroeffTitle.TabIndex = 1;
            this.lblEroeffTitle.Text = "Eröffnung Assessment";
            this.lblEroeffTitle.UseCompatibleTextRendering = true;
            // 
            // lblKriterium
            // 
            this.lblKriterium.Location = new System.Drawing.Point(5, 301);
            this.lblKriterium.Name = "lblKriterium";
            this.lblKriterium.Size = new System.Drawing.Size(91, 24);
            this.lblKriterium.TabIndex = 1;
            this.lblKriterium.Text = "Kriterium";
            this.lblKriterium.UseCompatibleTextRendering = true;
            // 
            // edtDatumBericht
            // 
            this.edtDatumBericht.DataMember = "DatumBericht";
            this.edtDatumBericht.DataSource = this.qryFaAssessment;
            this.edtDatumBericht.EditValue = null;
            this.edtDatumBericht.Location = new System.Drawing.Point(101, 94);
            this.edtDatumBericht.Name = "edtDatumBericht";
            this.edtDatumBericht.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtDatumBericht.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumBericht.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumBericht.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumBericht.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumBericht.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumBericht.Properties.Appearance.Options.UseFont = true;
            this.edtDatumBericht.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject9.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject9.Options.UseBackColor = true;
            this.edtDatumBericht.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDatumBericht.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject9)});
            this.edtDatumBericht.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumBericht.Properties.ShowToday = false;
            this.edtDatumBericht.Size = new System.Drawing.Size(90, 24);
            this.edtDatumBericht.TabIndex = 2;
            // 
            // lblEroeffAm
            // 
            this.lblEroeffAm.Location = new System.Drawing.Point(5, 64);
            this.lblEroeffAm.Name = "lblEroeffAm";
            this.lblEroeffAm.Size = new System.Drawing.Size(90, 24);
            this.lblEroeffAm.TabIndex = 2;
            this.lblEroeffAm.Text = "am";
            this.lblEroeffAm.UseCompatibleTextRendering = true;
            // 
            // edtAbschlussDatum
            // 
            this.edtAbschlussDatum.DataMember = "AbschlussDatum";
            this.edtAbschlussDatum.DataSource = this.qryFaAssessment;
            this.edtAbschlussDatum.EditValue = null;
            this.edtAbschlussDatum.Location = new System.Drawing.Point(101, 173);
            this.edtAbschlussDatum.Name = "edtAbschlussDatum";
            this.edtAbschlussDatum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtAbschlussDatum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtAbschlussDatum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAbschlussDatum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAbschlussDatum.Properties.Appearance.Options.UseBackColor = true;
            this.edtAbschlussDatum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAbschlussDatum.Properties.Appearance.Options.UseFont = true;
            this.edtAbschlussDatum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject8.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject8.Options.UseBackColor = true;
            this.edtAbschlussDatum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtAbschlussDatum.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject8)});
            this.edtAbschlussDatum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtAbschlussDatum.Properties.Name = "kissDateEdit3.Properties";
            this.edtAbschlussDatum.Properties.ShowToday = false;
            this.edtAbschlussDatum.Size = new System.Drawing.Size(90, 24);
            this.edtAbschlussDatum.TabIndex = 3;
            this.edtAbschlussDatum.EditValueChanged += new System.EventHandler(this.edtAbschlussDatum_EditValueChanged);
            // 
            // edtAbschlussUser
            // 
            this.edtAbschlussUser.DataMember = "AbschlussUser";
            this.edtAbschlussUser.DataSource = this.qryFaAssessment;
            this.edtAbschlussUser.Location = new System.Drawing.Point(270, 173);
            this.edtAbschlussUser.Name = "edtAbschlussUser";
            this.edtAbschlussUser.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtAbschlussUser.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAbschlussUser.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAbschlussUser.Properties.Appearance.Options.UseBackColor = true;
            this.edtAbschlussUser.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAbschlussUser.Properties.Appearance.Options.UseFont = true;
            this.edtAbschlussUser.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject7.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject7.Options.UseBackColor = true;
            this.edtAbschlussUser.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject7)});
            this.edtAbschlussUser.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtAbschlussUser.Properties.Name = "kissButtonEdit1.Properties";
            this.edtAbschlussUser.SearchStringWhitelist = new string[] {
        ".",
        "*",
        "%"};
            this.edtAbschlussUser.Size = new System.Drawing.Size(354, 24);
            this.edtAbschlussUser.TabIndex = 4;
            this.edtAbschlussUser.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtAbschlussUser_UserModifiedFld);
            // 
            // edtAbschlussGrund
            // 
            this.edtAbschlussGrund.DataMember = "FaAssessmentAbschlussGrundCode";
            this.edtAbschlussGrund.DataSource = this.qryFaAssessment;
            this.edtAbschlussGrund.Location = new System.Drawing.Point(101, 203);
            this.edtAbschlussGrund.LOVName = "FaAssessmentAbschlussgrund";
            this.edtAbschlussGrund.Name = "edtAbschlussGrund";
            this.edtAbschlussGrund.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtAbschlussGrund.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtAbschlussGrund.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAbschlussGrund.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAbschlussGrund.Properties.Appearance.Options.UseBackColor = true;
            this.edtAbschlussGrund.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAbschlussGrund.Properties.Appearance.Options.UseFont = true;
            this.edtAbschlussGrund.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtAbschlussGrund.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtAbschlussGrund.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtAbschlussGrund.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtAbschlussGrund.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject6.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject6.Options.UseBackColor = true;
            this.edtAbschlussGrund.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject6)});
            this.edtAbschlussGrund.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtAbschlussGrund.Properties.Name = "kissLookUpEdit1.Properties";
            this.edtAbschlussGrund.Properties.NullText = "";
            this.edtAbschlussGrund.Properties.ShowFooter = false;
            this.edtAbschlussGrund.Properties.ShowHeader = false;
            this.edtAbschlussGrund.Size = new System.Drawing.Size(523, 24);
            this.edtAbschlussGrund.TabIndex = 5;
            this.edtAbschlussGrund.CloseUp += new DevExpress.XtraEditors.Controls.CloseUpEventHandler(this.edtAbschlussGrund_CloseUp);
            // 
            // edtGrundBV
            // 
            this.edtGrundBV.DataMember = "FaUeberbrueckungGrundCode";
            this.edtGrundBV.DataSource = this.qryFaAssessment;
            this.edtGrundBV.Location = new System.Drawing.Point(101, 233);
            this.edtGrundBV.LOVName = "FaUeberbrueckungBevorschussungGrund";
            this.edtGrundBV.Name = "edtGrundBV";
            this.edtGrundBV.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtGrundBV.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtGrundBV.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtGrundBV.Properties.Appearance.Options.UseBackColor = true;
            this.edtGrundBV.Properties.Appearance.Options.UseBorderColor = true;
            this.edtGrundBV.Properties.Appearance.Options.UseFont = true;
            this.edtGrundBV.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtGrundBV.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtGrundBV.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtGrundBV.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtGrundBV.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject5.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject5.Options.UseBackColor = true;
            this.edtGrundBV.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject5)});
            this.edtGrundBV.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtGrundBV.Properties.NullText = "";
            this.edtGrundBV.Properties.ShowFooter = false;
            this.edtGrundBV.Properties.ShowHeader = false;
            this.edtGrundBV.Size = new System.Drawing.Size(302, 24);
            this.edtGrundBV.TabIndex = 6;
            // 
            // edtEmpfehlungRP
            // 
            this.edtEmpfehlungRP.DataMember = "FaRessourcenPaketCode";
            this.edtEmpfehlungRP.DataSource = this.qryFaAssessment;
            this.edtEmpfehlungRP.Location = new System.Drawing.Point(101, 271);
            this.edtEmpfehlungRP.LOVName = "FaRessourcenpaket";
            this.edtEmpfehlungRP.Name = "edtEmpfehlungRP";
            this.edtEmpfehlungRP.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtEmpfehlungRP.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtEmpfehlungRP.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtEmpfehlungRP.Properties.Appearance.Options.UseBackColor = true;
            this.edtEmpfehlungRP.Properties.Appearance.Options.UseBorderColor = true;
            this.edtEmpfehlungRP.Properties.Appearance.Options.UseFont = true;
            this.edtEmpfehlungRP.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtEmpfehlungRP.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtEmpfehlungRP.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtEmpfehlungRP.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtEmpfehlungRP.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            this.edtEmpfehlungRP.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4)});
            this.edtEmpfehlungRP.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtEmpfehlungRP.Properties.NullText = "";
            this.edtEmpfehlungRP.Properties.ShowFooter = false;
            this.edtEmpfehlungRP.Properties.ShowHeader = false;
            this.edtEmpfehlungRP.Size = new System.Drawing.Size(302, 24);
            this.edtEmpfehlungRP.TabIndex = 7;
            this.edtEmpfehlungRP.CloseUp += new DevExpress.XtraEditors.Controls.CloseUpEventHandler(this.edtEmpfehlungRP_CloseUp);
            // 
            // edtKriterium
            // 
            this.edtKriterium.DataMember = "FaKriteriumCode";
            this.edtKriterium.DataSource = this.qryFaAssessment;
            this.edtKriterium.Location = new System.Drawing.Point(101, 301);
            this.edtKriterium.LOVName = "FaKriterium";
            this.edtKriterium.Name = "edtKriterium";
            this.edtKriterium.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtKriterium.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtKriterium.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtKriterium.Properties.Appearance.Options.UseBackColor = true;
            this.edtKriterium.Properties.Appearance.Options.UseBorderColor = true;
            this.edtKriterium.Properties.Appearance.Options.UseFont = true;
            this.edtKriterium.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtKriterium.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtKriterium.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtKriterium.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtKriterium.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            this.edtKriterium.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3)});
            this.edtKriterium.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtKriterium.Properties.NullText = "";
            this.edtKriterium.Properties.ShowFooter = false;
            this.edtKriterium.Properties.ShowHeader = false;
            this.edtKriterium.Size = new System.Drawing.Size(523, 24);
            this.edtKriterium.TabIndex = 8;
            // 
            // edtQTUebergabeOrgUnit
            // 
            this.edtQTUebergabeOrgUnit.DataMember = "QTUebergabeOrgUnit";
            this.edtQTUebergabeOrgUnit.DataSource = this.qryFaAssessment;
            this.edtQTUebergabeOrgUnit.Location = new System.Drawing.Point(101, 331);
            this.edtQTUebergabeOrgUnit.Name = "edtQTUebergabeOrgUnit";
            this.edtQTUebergabeOrgUnit.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtQTUebergabeOrgUnit.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtQTUebergabeOrgUnit.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtQTUebergabeOrgUnit.Properties.Appearance.Options.UseBackColor = true;
            this.edtQTUebergabeOrgUnit.Properties.Appearance.Options.UseBorderColor = true;
            this.edtQTUebergabeOrgUnit.Properties.Appearance.Options.UseFont = true;
            this.edtQTUebergabeOrgUnit.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtQTUebergabeOrgUnit.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtQTUebergabeOrgUnit.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtQTUebergabeOrgUnit.SearchStringWhitelist = new string[] {
        ".",
        "*",
        "%"};
            this.edtQTUebergabeOrgUnit.Size = new System.Drawing.Size(302, 24);
            this.edtQTUebergabeOrgUnit.TabIndex = 9;
            this.edtQTUebergabeOrgUnit.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtQTUebergabeOrgUnit_UserModifiedFld);
            // 
            // btnWordUebergabe
            // 
            this.btnWordUebergabe.Context = "FaAssesmentUebergabe";
            this.btnWordUebergabe.DocumentFormat = KiSS4.Dokument.DlgNewDocument.DocumentAccessModes.All;
            this.btnWordUebergabe.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnWordUebergabe.Image = ((System.Drawing.Image)(resources.GetObject("btnWordUebergabe.Image")));
            this.btnWordUebergabe.ImageAlign = System.Drawing.ContentAlignment.MiddleRight;
            this.btnWordUebergabe.Location = new System.Drawing.Point(475, 331);
            this.btnWordUebergabe.Name = "btnWordUebergabe";
            this.btnWordUebergabe.Size = new System.Drawing.Size(149, 24);
            this.btnWordUebergabe.TabIndex = 10;
            this.btnWordUebergabe.Text = "Übergabe-Formular";
            this.btnWordUebergabe.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.btnWordUebergabe.UseCompatibleTextRendering = true;
            this.btnWordUebergabe.UseVisualStyleBackColor = false;
            // 
            // btnStellenleitung
            // 
            this.btnStellenleitung.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnStellenleitung.Location = new System.Drawing.Point(102, 361);
            this.btnStellenleitung.Name = "btnStellenleitung";
            this.btnStellenleitung.Size = new System.Drawing.Size(194, 24);
            this.btnStellenleitung.TabIndex = 11;
            this.btnStellenleitung.Text = "Weiterleitung an Stellenleitung";
            this.btnStellenleitung.UseCompatibleTextRendering = true;
            this.btnStellenleitung.UseVisualStyleBackColor = false;
            this.btnStellenleitung.Click += new System.EventHandler(this.btnStellenleitung_Click);
            // 
            // edtQTUebergabeDatum
            // 
            this.edtQTUebergabeDatum.DataMember = "QTUebergabeDatum";
            this.edtQTUebergabeDatum.DataSource = this.qryFaAssessment;
            this.edtQTUebergabeDatum.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtQTUebergabeDatum.EditValue = null;
            this.edtQTUebergabeDatum.Location = new System.Drawing.Point(302, 361);
            this.edtQTUebergabeDatum.Name = "edtQTUebergabeDatum";
            this.edtQTUebergabeDatum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtQTUebergabeDatum.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtQTUebergabeDatum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtQTUebergabeDatum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtQTUebergabeDatum.Properties.Appearance.Options.UseBackColor = true;
            this.edtQTUebergabeDatum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtQTUebergabeDatum.Properties.Appearance.Options.UseFont = true;
            this.edtQTUebergabeDatum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtQTUebergabeDatum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtQTUebergabeDatum.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtQTUebergabeDatum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtQTUebergabeDatum.Properties.ReadOnly = true;
            this.edtQTUebergabeDatum.Properties.ShowToday = false;
            this.edtQTUebergabeDatum.Size = new System.Drawing.Size(101, 24);
            this.edtQTUebergabeDatum.TabIndex = 12;
            // 
            // lblAbschlussTitle
            // 
            this.lblAbschlussTitle.LabelStyle = KiSS4.Gui.LabelStyleType.DataView;
            this.lblAbschlussTitle.Location = new System.Drawing.Point(5, 149);
            this.lblAbschlussTitle.Name = "lblAbschlussTitle";
            this.lblAbschlussTitle.Size = new System.Drawing.Size(160, 16);
            this.lblAbschlussTitle.TabIndex = 16;
            this.lblAbschlussTitle.Text = "Abschluss Assessment";
            this.lblAbschlussTitle.UseCompatibleTextRendering = true;
            // 
            // lblAbschlussDatum
            // 
            this.lblAbschlussDatum.Location = new System.Drawing.Point(5, 173);
            this.lblAbschlussDatum.Name = "lblAbschlussDatum";
            this.lblAbschlussDatum.Size = new System.Drawing.Size(91, 24);
            this.lblAbschlussDatum.TabIndex = 17;
            this.lblAbschlussDatum.Text = "Abschlussdatum";
            this.lblAbschlussDatum.UseCompatibleTextRendering = true;
            // 
            // lblAbschlussDurch
            // 
            this.lblAbschlussDurch.Location = new System.Drawing.Point(197, 173);
            this.lblAbschlussDurch.Name = "lblAbschlussDurch";
            this.lblAbschlussDurch.Size = new System.Drawing.Size(67, 24);
            this.lblAbschlussDurch.TabIndex = 19;
            this.lblAbschlussDurch.Text = "Mitarbeiter/in";
            this.lblAbschlussDurch.UseCompatibleTextRendering = true;
            // 
            // lblGrundBV
            // 
            this.lblGrundBV.Location = new System.Drawing.Point(5, 233);
            this.lblGrundBV.Name = "lblGrundBV";
            this.lblGrundBV.Size = new System.Drawing.Size(91, 24);
            this.lblGrundBV.TabIndex = 35;
            this.lblGrundBV.Text = "Grund Üb/BV";
            this.lblGrundBV.UseCompatibleTextRendering = true;
            // 
            // lblDatumBericht
            // 
            this.lblDatumBericht.Location = new System.Drawing.Point(5, 94);
            this.lblDatumBericht.Name = "lblDatumBericht";
            this.lblDatumBericht.Size = new System.Drawing.Size(90, 24);
            this.lblDatumBericht.TabIndex = 37;
            this.lblDatumBericht.Text = "Datum Bericht";
            this.lblDatumBericht.UseCompatibleTextRendering = true;
            // 
            // pnlTitle
            // 
            this.pnlTitle.Controls.Add(this.picTitel);
            this.pnlTitle.Controls.Add(this.lblTitel);
            this.pnlTitle.Dock = System.Windows.Forms.DockStyle.Top;
            this.pnlTitle.Location = new System.Drawing.Point(0, 0);
            this.pnlTitle.Name = "pnlTitle";
            this.pnlTitle.Size = new System.Drawing.Size(659, 24);
            this.pnlTitle.TabIndex = 40;
            // 
            // picTitel
            // 
            this.picTitel.Location = new System.Drawing.Point(5, 5);
            this.picTitel.Name = "picTitel";
            this.picTitel.Size = new System.Drawing.Size(16, 16);
            this.picTitel.TabIndex = 293;
            this.picTitel.TabStop = false;
            // 
            // lblTitel
            // 
            this.lblTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitel.Location = new System.Drawing.Point(25, 5);
            this.lblTitel.Name = "lblTitel";
            this.lblTitel.Size = new System.Drawing.Size(542, 15);
            this.lblTitel.TabIndex = 0;
            this.lblTitel.Text = "Assessment";
            this.lblTitel.UseCompatibleTextRendering = true;
            // 
            // lblEroeffDurch
            // 
            this.lblEroeffDurch.Location = new System.Drawing.Point(197, 64);
            this.lblEroeffDurch.Name = "lblEroeffDurch";
            this.lblEroeffDurch.Size = new System.Drawing.Size(67, 24);
            this.lblEroeffDurch.TabIndex = 43;
            this.lblEroeffDurch.Text = "Mitarbeiter/in";
            this.lblEroeffDurch.UseCompatibleTextRendering = true;
            // 
            // lblGrund
            // 
            this.lblGrund.Location = new System.Drawing.Point(5, 203);
            this.lblGrund.Name = "lblGrund";
            this.lblGrund.Size = new System.Drawing.Size(91, 24);
            this.lblGrund.TabIndex = 44;
            this.lblGrund.Text = "Grund";
            this.lblGrund.UseCompatibleTextRendering = true;
            // 
            // lblQTUebergabeOrgUnit
            // 
            this.lblQTUebergabeOrgUnit.Location = new System.Drawing.Point(5, 331);
            this.lblQTUebergabeOrgUnit.Name = "lblQTUebergabeOrgUnit";
            this.lblQTUebergabeOrgUnit.Size = new System.Drawing.Size(91, 24);
            this.lblQTUebergabeOrgUnit.TabIndex = 52;
            this.lblQTUebergabeOrgUnit.Text = "Team";
            this.lblQTUebergabeOrgUnit.UseCompatibleTextRendering = true;
            // 
            // CtlFaAssessment
            // 
            this.ActiveSQLQuery = this.qryFaAssessment;
            this.Controls.Add(this.lblQTUebergabeOrgUnit);
            this.Controls.Add(this.lblGrund);
            this.Controls.Add(this.lblEroeffDurch);
            this.Controls.Add(this.pnlTitle);
            this.Controls.Add(this.lblDatumBericht);
            this.Controls.Add(this.lblGrundBV);
            this.Controls.Add(this.lblAbschlussDurch);
            this.Controls.Add(this.lblAbschlussDatum);
            this.Controls.Add(this.lblAbschlussTitle);
            this.Controls.Add(this.edtQTUebergabeDatum);
            this.Controls.Add(this.btnStellenleitung);
            this.Controls.Add(this.btnWordUebergabe);
            this.Controls.Add(this.edtQTUebergabeOrgUnit);
            this.Controls.Add(this.edtKriterium);
            this.Controls.Add(this.edtEmpfehlungRP);
            this.Controls.Add(this.edtGrundBV);
            this.Controls.Add(this.edtAbschlussGrund);
            this.Controls.Add(this.edtAbschlussUser);
            this.Controls.Add(this.edtAbschlussDatum);
            this.Controls.Add(this.lblEroeffAm);
            this.Controls.Add(this.edtDatumBericht);
            this.Controls.Add(this.lblKriterium);
            this.Controls.Add(this.lblEroeffTitle);
            this.Controls.Add(this.edtEroeffnungUser);
            this.Controls.Add(this.lblEmpfehlung);
            this.Controls.Add(this.edtEroeffDatum);
            this.Font = new System.Drawing.Font("Arial", 9F, System.Drawing.FontStyle.Bold);
            this.Location = new System.Drawing.Point(96, 0);
            this.Name = "CtlFaAssessment";
            this.Size = new System.Drawing.Size(659, 398);
            ((System.ComponentModel.ISupportInitialize)(this.edtEroeffDatum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryFaAssessment)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEmpfehlung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEroeffnungUser.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEroeffTitle)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKriterium)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBericht.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEroeffAm)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussDatum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussUser.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussGrund.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussGrund)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtGrundBV.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtGrundBV)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEmpfehlungRP.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEmpfehlungRP)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKriterium.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKriterium)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtQTUebergabeOrgUnit.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtQTUebergabeDatum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAbschlussTitle)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAbschlussDatum)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAbschlussDurch)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGrundBV)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumBericht)).EndInit();
            this.pnlTitle.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEroeffDurch)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGrund)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblQTUebergabeOrgUnit)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Public Methods

        public override object GetContextValue(string FieldName)
        {
            switch (FieldName.ToUpper())
            {
                case "BETRPERSONID": return DBUtil.ExecuteScalarSQL(@"
                                    select BaPersonID
                                    from   FaLeistung
                                    where  FaLeistungID = {0}",
                                       qryFaAssessment["FaLeistungID"]);
                case "FALLUSERID": return DBUtil.ExecuteScalarSQL(@"
                                    select FAL.UserID
                                    from   FaFall FAL
                                           inner join FaLeistung LEI on LEI.FaFallID = FAL.FaFallID
                                    where LEI.FaLeistungID = {0}",
                                     qryFaAssessment["FaLeistungID"]);
                case "FAFALLID": return DBUtil.ExecuteScalarSQL(@"
                                    select FaFallID
                                    from   FaLeistung
                                    where  FaLeistungID = {0}",
                                   qryFaAssessment["FaLeistungID"]);
                case "ABSENDER": return 0;
            }
            return base.GetContextValue(FieldName);
        }

        // Letzte Bearbeitung
        // ??.??.???? : ?????? : neu
        // 04.02.2008 : sozheo : Umbau für mehrere Assessments
        // -----------------------------------------------------------------------
        public void Init(string Name, Image TitleImage, int LeistungID, int ID)
        {
            lblTitel.Text = Name;
            picTitel.Image = TitleImage;
            faLeistungID = LeistungID;
            faAssessmentID = ID;

            // FallträgerID holen
            SqlQuery qryFT = DBUtil.OpenSQL(@"select BaPersonID from FaLeistung where FaLeistungID = {0}", faLeistungID);
            baPersonID = Utils.ConvertToInt(qryFT["BaPersonID"]);

            // User-Anzeige holen
            SqlQuery qry = DBUtil.OpenSQL(@"
            select LogonNameVornameOrgUnit, OrgUnit, OrgUnitID from vwUser
            where UserID = {0} ",
          Session.User.UserID);
            UserWholeName = Utils.ConvertToString(qry["LogonNameVornameOrgUnit"]);
            UserQTID = Utils.ConvertToInt(qry["OrgUnitID"]);
            UserQTName = Utils.ConvertToString(qry["OrgUnit"]);

            // Spezialrechte für Weiterleitung an Stellenleitung
            HasSpecialRights = DBUtil.UserHasRight("CtlFaAssessment_WeitergabeAnStellenleiter");

            // Daten anzeigen:
            qryFaAssessment.Fill(faAssessmentID);

            edtEroeffnungUser.ToolTip = Utils.ConvertToString(qryFaAssessment["EroeffnungUser"]);
            edtAbschlussUser.ToolTip = Utils.ConvertToString(qryFaAssessment["AbschlussUser"]);
        }

        #endregion

        #region Private Methods

        // Letzte Bearbeitung
        // 14.12.2007 : sozheo : Neu
        // 21.01.2008 : sozheo : Provisorisch soll Assessment immer editierbar sein
        // 01.02.2008 : sozheo : Alles wieder gesperrt, ausser Dokument öffnen
        // ------------------------------------------------------------------
        private bool CanEditData()
        {
            // 21.01.2008 : sozheo :
            // Provisorisch soll Assessment immer editierbar sein:
            // Alter Code, wenn nach Weiterleitung an Stellenleitung alles gesperrt wein soll:
            return (
          qryFaAssessment.CanUpdate &&
          qryFaAssessment.Count > 0 &&
          Utils.ConvertToInt(qryFaAssessment["TaskID"]) == 0
            );
        }

        private void ClearFields(int NewValue)
        {
            // Felder löschen welche nicht verwendet werden
            if (NewValue == 1) // 1 = Weiterleitung an QT
            {
                qryFaAssessment["FaUeberbrueckungGrundCode"] = DBNull.Value;
            }
            else if ((NewValue == 2) || (NewValue == 3))
            {
                qryFaAssessment["FaRessourcenPaketCode"] = DBNull.Value;
                qryFaAssessment["FaKriteriumCode"] = DBNull.Value;
                qryFaAssessment["QTUebergabeDatum"] = DBNull.Value;
                qryFaAssessment["QTUebergabeOrgUnit"] = DBNull.Value;
                qryFaAssessment["QTUebergabeOrgUnitID"] = DBNull.Value;
                qryFaAssessment["TaskID"] = DBNull.Value;
            }
            else
            {
                qryFaAssessment["FaUeberbrueckungGrundCode"] = DBNull.Value;
                qryFaAssessment["FaRessourcenPaketCode"] = DBNull.Value;
                qryFaAssessment["FaKriteriumCode"] = DBNull.Value;
                qryFaAssessment["QTUebergabeDatum"] = DBNull.Value;
                qryFaAssessment["QTUebergabeOrgUnit"] = DBNull.Value;
                qryFaAssessment["QTUebergabeOrgUnitID"] = DBNull.Value;
                qryFaAssessment["TaskID"] = DBNull.Value;
            }
            qryFaAssessment.RefreshDisplay();
        }

        private void SetDefaultFields(int NewValue)
        {
            if (NewValue == 1 && DBUtil.IsEmpty(qryFaAssessment["QTUebergabeOrgUnitID"]))  // Weiterleiten an ...
            {
                SqlQuery qry = DBUtil.OpenSQL(@"
              select HAU.OrgUnitID, Org.ItemName
              from vwPerson PRS
                LEFT JOIN BaHaus  HAU on HAU.BaStrasseID = PRS.WohnsitzStrasseCode
                  AND (CAST( HAU.Hausnummer as varchar ) + IsNull(HAU.Suffix,'')) = PRS.WohnsitzHausNr
                LEFT JOIN XOrgUnit ORG on ORG.OrgUnitID = HAU.OrgUnitID
              where BaPersonID = {0}",
                  baPersonID);
                qryFaAssessment["QTUebergabeOrgUnit"] = qry["ItemName"];
                qryFaAssessment["QTUebergabeOrgUnitID"] = qry["OrgUnitID"];
            }
        }

        private void SetEditFields_Abschluss(int agCode)
        {
            EditModeType EMode;
            bool CanEdit = (CanEditData() && agCode > 0);

            /*
            1	Weiterleitung an QT
            2	Überbrückung im Intake
            3	Bevorschussung im Intake
            4	Wirtschaftliche Sozialhilfe abgelehnt / kein Anspruch
            5	Triage an Dritte
            6	Triage an städt. Spezialdienste
            7	Unterstützungsantrag zurückgezogen
            8	Kontaktabbruch
            9	Todesfall
            10	Wechsel des Wohnortes
            11	Abschluss Beratung
            */

            // 1 = Weiterleitung an QT
            EMode = EditModeType.ReadOnly;
            if (CanEdit && agCode == 1) EMode = EditModeType.Normal;
            edtEmpfehlungRP.EditMode = EMode;
            edtKriterium.EditMode = EMode;
            //edtQTUebergabeDatum.EditMode = EMode;
            edtQTUebergabeOrgUnit.EditMode = EMode;
            btnWordUebergabe.Enabled = agCode == 1;
            btnStellenleitung.Enabled = (CanEdit && agCode == 1 && HasSpecialRights);

            // 2 = Überbrückung im Intake
            EMode = EditModeType.ReadOnly;
            if (CanEdit && (agCode == 2 || agCode == 3)) EMode = EditModeType.Normal;
            edtGrundBV.EditMode = EMode;
        }

        private void SetList_Kriterium(int aCode)
        {
            string oldCode = "";
            if (aCode > 0) oldCode = aCode.ToString();
            if (oldCode == edtKriterium.LOVFilter) return;

            edtKriterium.LOVFilter = oldCode;
            edtKriterium.LOVName = "FaKriterium";
        }

        private void btnStellenleitung_Click(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 12.12.2007 : sozheo : Neu: Pendenz erstellen
            // -------------------------------------------------------------

            if (!qryFaAssessment.Post()) return;

            if (Utils.ConvertToInt(qryFaAssessment["TaskID"]) > 0)
            {
                KissMsg.ShowInfo("Diese Pendenz wurde bereits erstellt.");
                return;
            }

            // Penden erstellen an Stellenleiter
            SqlQuery qrySL = DBUtil.OpenSQL(@"
              select top 1 O.ChiefID
              from FaLeistung L
                left outer join FaFall F on F.FaFallID = L.FaFallID
                left outer join XUser U on U.UserID = F.UserID
                left outer join XOrgUnit_User OU on OU.UserID = F.UserID and OU.OrgUnitMemberCode = 2
                left outer join XOrgUnit O on O.OrgUnitID = OU.OrgUnitID
              where L.FaLeistungID = {0}",
              faLeistungID);
            int usr = Utils.ConvertToInt(qrySL["ChiefID"]);
            if (usr == 0)
            {
                KissMsg.ShowInfo("Der Stellenleiter ist nicht definiert.");
                return;
            }

            object taskID = DBUtil.ExecuteScalarSQL(@"
              Insert into XTask (
                TaskTypeCode, Subject, TaskStatusCode, CreateDate, StartDate, SenderID,
                TaskSenderCode, ReceiverID, TaskReceiverCode, JumpToPath,
                FaLeistungID
              ) values (
                5, 'Assessment an Stellenleiter', 1, {0}, {1}, {2}, 1, {3}, 1, {4}, {5} )

              select SCOPE_IDENTITY()",
                DateTime.Now, DateTime.Now, Session.User.UserID, qrySL["ChiefID"],
                FormController.ConvertToString(FormController.GetMessage("FrmFall", false, "Action", "GetJumpToPath") as System.Collections.Specialized.HybridDictionary),
                qryFaAssessment["FaLeistungID"]);

            if (!DBUtil.IsEmpty(taskID))
            {
                qryFaAssessment["QTUebergabeDatum"] = DateTime.Today;
                qryFaAssessment["TaskID"] = taskID;
                qryFaAssessment.Post();
                qryFaAssessment_PositionChanged(sender, e);
                KissMsg.ShowInfo("Eine neue Pendenz wurde erstellt.");
            }
            else
            {
                KissMsg.ShowInfo("Fehler beim Erstellen der Pendenz.");
                return;
            }
        }

        private void edtAbschlussDatum_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 27.11.2007 : sozheo : Neu
            // 16.12.2007 : sozheo : Automatisches Editieren korrigiert
            // 22.01.2008 : sozheo : UserModified funzt nicht, Workaround implementiert
            // -------------------------------------------------------------

            if (!edtAbschlussDatum.UserModified) return;
            string tmp = DBUtil.IsEmpty(edtAbschlussDatum.EditValue) ? "" : edtAbschlussDatum.EditValue.ToString();
            if (qryFaAssessment["AbschlussDatum"].ToString() == tmp) return;

            if (!DBUtil.IsEmpty(edtAbschlussDatum.EditValue))
            {
                qryFaAssessment["AbschlussDatum"] = (DateTime)edtAbschlussDatum.EditValue;
                qryFaAssessment["AbschlussUserID"] = Session.User.UserID;
                qryFaAssessment["AbschlussUser"] = UserWholeName;
                edtAbschlussUser.ToolTip = UserWholeName;
            }
            else
            {
                qryFaAssessment["AbschlussDatum"] = DBNull.Value;
                qryFaAssessment["AbschlussUserID"] = DBNull.Value;
                qryFaAssessment["AbschlussUser"] = DBNull.Value;
                edtAbschlussUser.ToolTip = "";
            }
            qryFaAssessment.RefreshDisplay();
        }

        // Letzte Bearbeitung
        // 14.12.2007 : sozheo : neu
        // 24.12.2007 : sozheo : QT jetzt von Sozialraum
        // 23.01.2008 : sozheo : TaskID wird gelöscht, wenn Grund neu gewählt wird
        // ------------------------------------------------------------------------
        private void edtAbschlussGrund_CloseUp(object sender, DevExpress.XtraEditors.Controls.CloseUpEventArgs e)
        {
            e.AcceptValue = true;
            if (!e.CloseMode.Equals(DevExpress.XtraEditors.PopupCloseMode.Normal)) return;

            int NewValue = Utils.ConvertToInt(e.Value);
            SetEditFields_Abschluss(NewValue);

            // Defaultwerte setzen
            SetDefaultFields(NewValue);

            ClearFields(NewValue);
        }

        private void edtAbschlussUser_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            // Letzte Bearbeitung
            // 15.12.2007 : sozheo : Neues SQL für Auswahl Mitarbeiter
            // ------------------------------------------------------------------

            string SearchString = Utils.ConvertToString(edtAbschlussUser.EditValue).ToString().Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (e.ButtonClicked)
                    SearchString = "%";
                else
                {
                    qryFaAssessment["AbschlussUserID"] = DBNull.Value;
                    qryFaAssessment["AbschlussUser"] = DBNull.Value;
                    edtAbschlussUser.ToolTip = "";
                    return;
                }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
              SELECT ID$ = UserID,
                     [Kürzel] = LogonName,
                     [Mitarbeiter/in] = NameVorname,
                     [Org.Einheit] = OrgUnit,
                 LogonNameVornameOrgUnit$ = LogonNameVornameOrgUnit
              FROM     vwUser
              WHERE    LogonNameVornameOrgUnit like '%' + {0} + '%'
              ORDER BY NameVorname",
              SearchString,
              e.ButtonClicked, null, null, null);

            if (!e.Cancel)
            {
                qryFaAssessment["AbschlussUserID"] = dlg[0];
                qryFaAssessment["AbschlussUser"] = dlg[4];
                edtAbschlussUser.ToolTip = dlg[4].ToString();
            }
        }

        // Letzte Bearbeitung
        // 14.12.2007 : sozheo : neu
        // ------------------------------------------------------------------------
        private void edtEmpfehlungRP_CloseUp(object sender, DevExpress.XtraEditors.Controls.CloseUpEventArgs e)
        {
            e.AcceptValue = true;
            if (!e.CloseMode.Equals(DevExpress.XtraEditors.PopupCloseMode.Normal)) return;
            int NewValue = Utils.ConvertToInt(e.Value);
            SetList_Kriterium(NewValue);
        }

        private void edtEroeffDatum_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 17.12.2007 : sozheo : neu
            // 22.01.2008 : sozheo : UserModified funzt nicht, Workaround implementiert
            // -------------------------------------------------------------

            if (!edtEroeffDatum.UserModified) return;
            string tmp = DBUtil.IsEmpty(edtEroeffDatum.EditValue) ? "" : edtEroeffDatum.EditValue.ToString();
            if (qryFaAssessment["EroeffnungDatum"].ToString() == tmp) return;

            // Wenn das Datum gesetzt wird, soll auch der User gesetzt werden:
            if (!DBUtil.IsEmpty(edtEroeffDatum.EditValue))
            {
                qryFaAssessment["EroeffnungDatum"] = (DateTime)edtEroeffDatum.EditValue;
                qryFaAssessment["EroeffnungUserID"] = Session.User.UserID;
                qryFaAssessment["EroeffnungUser"] = UserWholeName;
                //  qryFaAssessment["EroeffnungOrgUnit"] = UserQTName;
                //  qryFaAssessment["EroeffnungOrgUnitID"] = UserQTID;
                edtEroeffnungUser.ToolTip = UserWholeName;
            }
            else
            {
                qryFaAssessment["EroeffnungDatum"] = DBNull.Value;
                qryFaAssessment["EroeffnungUserID"] = DBNull.Value;
                qryFaAssessment["EroeffnungUser"] = DBNull.Value;
                //  qryFaAssessment["EroeffnungOrgUnit"] = DBNull.Value;
                //  qryFaAssessment["EroeffnungOrgUnitID"] = DBNull.Value;
                edtEroeffnungUser.ToolTip = "";
            }
            qryFaAssessment.RefreshDisplay();
        }

        private void edtEroeffnungUser_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            // Letzte Bearbeitung
            // 14.12.2007 : sozheo : Neu
            // ------------------------------------------------------------------

            string SearchString = Utils.ConvertToString(edtEroeffnungUser.EditValue).ToString();
            SearchString = SearchString.Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (e.ButtonClicked)
                    SearchString = "%";
                else
                {
                    qryFaAssessment["EroeffnungUserID"] = DBNull.Value;
                    qryFaAssessment["EroeffnungUser"] = DBNull.Value;
                    //    qryFaAssessment["EroeffnungOrgUnitID"]  = DBNull.Value;
                    //    qryFaAssessment["EroeffnungOrgUnit"] = DBNull.Value;
                    edtEroeffnungUser.ToolTip = "";
                    return;
                }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
              SELECT
                ID$ = UserID,
                [Kürzel] = LogonName,
                [Mitarbeiter/in] = NameVorname,
                [Org.Einheit] = OrgUnit,
                LogonNameVornameOrgUnit$ = LogonNameVornameOrgUnit,
                OrgUnitID$ = OrgUnitID
              FROM vwUser
              WHERE LogonNameVornameOrgUnit like '%' + {0} + '%'
              ORDER BY NameVorname",
              SearchString,
              e.ButtonClicked, null, null, null);

            if (!e.Cancel)
            {
                qryFaAssessment["EroeffnungUserID"] = dlg[0];
                qryFaAssessment["EroeffnungUser"] = dlg[4];
                //  qryFaAssessment["EroeffnungOrgUnitID"] = dlg[5];
                //  qryFaAssessment["EroeffnungOrgUnit"] = dlg[3];
                edtEroeffnungUser.ToolTip = dlg[4].ToString();
            }
        }

        private void edtQTUebergabeOrgUnit_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            // Letzte Bearbeitung
            // 11.12.2007 : sozheo : Neu
            // ------------------------------------------------------------------

            string SearchString = edtQTUebergabeOrgUnit.Text.Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (e.ButtonClicked)
                {
                    SearchString = "%";
                }
                else
                {
                    qryFaAssessment["QTUebergabeOrgUnitID"] = DBNull.Value;
                    qryFaAssessment["QTUebergabeOrgUnit"] = DBNull.Value;
                    return;
                }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(string.Format(@"
              select ID$ = Org.OrgUnitID, [Name] = Org.ItemName from XOrgUnit Org
              where Org.ItemName like '%' + '{0}' + '%'
              --and Org.OrgUnitID in (select OU.OrgUnitID from XOrgUnit_User OU where OU.UserID = {1} )
              order by [Name]",
                SearchString,
                qryFaAssessment["AbschlussUserID"]
              ),
              SearchString,
              e.ButtonClicked, null, null, null);

            if (!e.Cancel)
            {
                qryFaAssessment["QTUebergabeOrgUnitID"] = dlg[0];
                qryFaAssessment["QTUebergabeOrgUnit"] = dlg[1];
            }
        }

        private void qryFaAssessment_AfterFill(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 14.12.2007 : sozheo : Neu
            // ------------------------------------------------------------------

            if (qryFaAssessment.Count == 0) qryFaAssessment_PositionChanged(sender, e);
        }

        private void qryFaAssessment_AfterPost(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 05.02.2008 : sozheo : Refresh des Tree eingefügt
            // ------------------------------------------------------------------

            if (!DBUtil.IsEmpty(this.qryFaAssessment["AbschlussDatum"]))
            {
                //Eintrag ins Fallverlaufsprotokoll
                DBUtil.ExecSQL(@"
                    INSERT FaJournal (FaFallID, FaLeistungID, BaPersonID, UserID, Text)
                    SELECT TOP 1 FaFallID, {0}, BaPersonID, {1}, {2}
                    FROM FaLeistung
                    WHERE FaLeistungID = {0}
                    ORDER BY DatumBis, DatumVon DESC", faLeistungID, Session.User.UserID, "Assessment abgeschlossen");
            }

            // Navigator Trees aktualisieren:
            FormController.SendMessage("FrmFall", "Action", "RefreshTree");
        }

        private void qryFaAssessment_BeforePost(object sender, System.EventArgs e)
        {
            DBUtil.CheckNotNullField(edtEroeffDatum, lblEroeffAm.Text);
            DBUtil.CheckNotNullField(edtEroeffnungUser, lblEroeffDurch.Text);

            if ((!DBUtil.IsEmpty(qryFaAssessment["AbschlussDatum"]) && DBUtil.IsEmpty(qryFaAssessment["FaAssessmentAbschlussGrundCode"])) ||
                (DBUtil.IsEmpty(qryFaAssessment["AbschlussDatum"]) && !DBUtil.IsEmpty(qryFaAssessment["FaAssessmentAbschlussGrundCode"])))
            {
                KissMsg.ShowInfo("CtlFaAssessment", "AbschlussGrundDatumLeer",
                  "Wenn das Assessment abgeschlossen werden soll,\r\n" +
                  "dann muss ein Abschlussgrund und ein Datum gewählt sein."
                );
                throw new KissCancelException();
            }
        }

        private void qryFaAssessment_PositionChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 14.12.2007 : sozheo : Neu
            // ------------------------------------------------------------------

            // ToolTip auf den Editierfeldern neu anzeigen:
            edtEroeffnungUser.ToolTip = Utils.ConvertToString(qryFaAssessment["EroeffnungUser"]);
            edtAbschlussUser.ToolTip = Utils.ConvertToString(qryFaAssessment["AbschlussUser"]);

            EditModeType EMode = EditModeType.ReadOnly;
            if (CanEditData()) EMode = EditModeType.Normal;

            edtEroeffDatum.EditMode = EMode;
            edtEroeffnungUser.EditMode = EMode;
            edtDatumBericht.EditMode = EMode;
            edtAbschlussDatum.EditMode = EMode;
            edtAbschlussUser.EditMode = EMode;
            edtAbschlussGrund.EditMode = EMode;

            // Felder bei Abschluss anhand Auswahl Abschlussgrund anzeigen:
            int aCode = Utils.ConvertToInt(qryFaAssessment["FaAssessmentAbschlussGrundCode"]);
            SetEditFields_Abschluss(aCode);

            // Felder bei Abschluss anhand Auswahl Abschlussgrund anzeigen:
            aCode = Utils.ConvertToInt(qryFaAssessment["FaRessourcenPaketCode"]);
            SetList_Kriterium(aCode);
        }

        #endregion
    }
}