#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Drawing;
using KiSS4.Common;
using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Basis.ZH
{
    public class CtlBaKlientensystem : KiSS4.Gui.KissUserControl
    {
        #region Fields

        // Letzte Bearbeitung:
        // 07.08.2007 : sozheo : Alles neu
        // 31.03.2009 : sozheo : im SQL dbo eingefügt
        // TODO: Bei Klienten Im Gitter DatumVon und DatumBis ausschalten
        // -------------------------------------------------------------------
        private int baPersonID = 0;
        private DevExpress.XtraGrid.Columns.GridColumn colBaPersonID;
        private DevExpress.XtraGrid.Columns.GridColumn colBaPersonID_1;
        private DevExpress.XtraGrid.Columns.GridColumn colBaPersonID_2;
        private DevExpress.XtraGrid.Columns.GridColumn colBaRelationID;
        private DevExpress.XtraGrid.Columns.GridColumn colBeziehung;
        private DevExpress.XtraGrid.Columns.GridColumn colDatuBis2;
        private DevExpress.XtraGrid.Columns.GridColumn colDatumBis;
        private DevExpress.XtraGrid.Columns.GridColumn colDatumVon;
        private DevExpress.XtraGrid.Columns.GridColumn colDatumVon2;
        private DevExpress.XtraGrid.Columns.GridColumn colFall;
        private DevExpress.XtraGrid.Columns.GridColumn colGeburtsdatum;
        private DevExpress.XtraGrid.Columns.GridColumn colGeschlecht;
        private DevExpress.XtraGrid.Columns.GridColumn colName;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissLookUpEdit edtBaPersonID_1;
        private KiSS4.Gui.KissLookUpEdit edtBaPersonID_2;
        private KiSS4.Gui.KissLookUpEdit edtBaRelationID;
        private KiSS4.Gui.KissMemoEdit edtBemerkung;
        private KiSS4.Gui.KissDateEdit edtDatumBis;
        private KiSS4.Gui.KissDateEdit edtDatumVon;
        private KiSS4.Gui.KissLookUpEdit edtQualitaet;
        private KiSS4.Gui.KissGrid grdBeziehungen;
        private KiSS4.Gui.KissGrid grdKlientensystem;
        private DevExpress.XtraGrid.Views.Grid.GridView grvBeziehungen;
        private DevExpress.XtraGrid.Views.Grid.GridView grvKlientensystem;
        private KiSS4.Gui.KissLabel kissLabel4;
        private KiSS4.Gui.KissLabel kissLabel5;
        private KiSS4.Gui.KissLabel kissLabel7;
        private KiSS4.Gui.KissLabel lblBaPersonID_1;
        private KiSS4.Gui.KissLabel lblBaPersonID_2;
        private KiSS4.Gui.KissLabel lblBaRelationID;
        private KiSS4.Gui.KissLabel lblBemerkung;
        private KiSS4.Gui.KissLabel lblTitel;
        private System.Windows.Forms.Panel panel1;
        private System.Windows.Forms.PictureBox picTitel;
        private KiSS4.DB.SqlQuery qryBaPerson;
        private KiSS4.DB.SqlQuery qryBaPerson_Relation;
        private KiSS4.DB.SqlQuery qryKlientensystem;
        private KiSS4.Gui.KissTabControlEx tabKlientensystem;
        private SharpLibrary.WinControls.TabPageEx tbpBeziehungen;
        private SharpLibrary.WinControls.TabPageEx tbpKlientensystem;

        #endregion

        #region Constructors

        public CtlBaKlientensystem()
        {
            this.InitializeComponent();

            // Letzte Bearbeitung:
            // 07.08.2007 : sozheo : Alles neu
            // -------------------------------------------------------------------

            tabKlientensystem.SelectedTabIndex = 0;
            grvKlientensystem.Columns["Fall"].GroupIndex = 0;

            this.ActiveSQLQuery = qryKlientensystem;
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlBaKlientensystem));
            this.panel1 = new System.Windows.Forms.Panel();
            this.lblTitel = new KiSS4.Gui.KissLabel();
            this.picTitel = new System.Windows.Forms.PictureBox();
            this.tabKlientensystem = new KiSS4.Gui.KissTabControlEx();
            this.tbpKlientensystem = new SharpLibrary.WinControls.TabPageEx();
            this.grdKlientensystem = new KiSS4.Gui.KissGrid();
            this.tbpBeziehungen = new SharpLibrary.WinControls.TabPageEx();
            this.grdBeziehungen = new KiSS4.Gui.KissGrid();
            this.edtBaPersonID_1 = new KiSS4.Gui.KissLookUpEdit();
            this.lblBaPersonID_1 = new KiSS4.Gui.KissLabel();
            this.edtBaPersonID_2 = new KiSS4.Gui.KissLookUpEdit();
            this.lblBaPersonID_2 = new KiSS4.Gui.KissLabel();
            this.edtBaRelationID = new KiSS4.Gui.KissLookUpEdit();
            this.lblBaRelationID = new KiSS4.Gui.KissLabel();
            this.edtQualitaet = new KiSS4.Gui.KissLookUpEdit();
            this.kissLabel4 = new KiSS4.Gui.KissLabel();
            this.edtDatumVon = new KiSS4.Gui.KissDateEdit();
            this.edtDatumBis = new KiSS4.Gui.KissDateEdit();
            this.edtBemerkung = new KiSS4.Gui.KissMemoEdit();
            this.kissLabel5 = new KiSS4.Gui.KissLabel();
            this.lblBemerkung = new KiSS4.Gui.KissLabel();
            this.kissLabel7 = new KiSS4.Gui.KissLabel();
            this.colBaPersonID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBaPersonID_1 = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBaPersonID_2 = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBaRelationID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBeziehung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDatuBis2 = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDatumBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDatumVon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDatumVon2 = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFall = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colGeburtsdatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colGeschlecht = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colName = new DevExpress.XtraGrid.Columns.GridColumn();
            this.grvBeziehungen = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.grvKlientensystem = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.qryBaPerson = new KiSS4.DB.SqlQuery(this.components);
            this.qryBaPerson_Relation = new KiSS4.DB.SqlQuery(this.components);
            this.qryKlientensystem = new KiSS4.DB.SqlQuery(this.components);
            this.panel1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).BeginInit();
            this.tabKlientensystem.SuspendLayout();
            this.tbpKlientensystem.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.grdKlientensystem)).BeginInit();
            this.tbpBeziehungen.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.grdBeziehungen)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID_1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID_1.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID_1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID_2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID_2.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID_2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaRelationID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaRelationID.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaRelationID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtQualitaet)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtQualitaet.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel4)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBemerkung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel5)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel7)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvBeziehungen)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvKlientensystem)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBaPerson)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBaPerson_Relation)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryKlientensystem)).BeginInit();
            this.SuspendLayout();
            //
            // panel1
            //
            this.panel1.Controls.Add(this.picTitel);
            this.panel1.Controls.Add(this.lblTitel);
            this.panel1.Dock = System.Windows.Forms.DockStyle.Top;
            this.panel1.Location = new System.Drawing.Point(0, 0);
            this.panel1.Name = "panel1";
            this.panel1.Size = new System.Drawing.Size(711, 24);
            this.panel1.TabIndex = 1;
            //
            // lblTitel
            //
            this.lblTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitel.Location = new System.Drawing.Point(25, 5);
            this.lblTitel.Name = "lblTitel";
            this.lblTitel.Size = new System.Drawing.Size(542, 15);
            this.lblTitel.TabIndex = 0;
            this.lblTitel.Text = "Klientensystem";
            this.lblTitel.UseCompatibleTextRendering = true;
            //
            // picTitel
            //
            this.picTitel.Location = new System.Drawing.Point(5, 5);
            this.picTitel.Name = "picTitel";
            this.picTitel.Size = new System.Drawing.Size(16, 16);
            this.picTitel.TabIndex = 293;
            this.picTitel.TabStop = false;
            //
            // tabKlientensystem
            //
            this.tabKlientensystem.Controls.Add(this.tbpBeziehungen);
            this.tabKlientensystem.Controls.Add(this.tbpKlientensystem);
            this.tabKlientensystem.Dock = System.Windows.Forms.DockStyle.Fill;
            this.tabKlientensystem.Location = new System.Drawing.Point(0, 24);
            this.tabKlientensystem.Name = "tabKlientensystem";
            this.tabKlientensystem.ShowFixedWidthTooltip = true;
            this.tabKlientensystem.Size = new System.Drawing.Size(711, 513);
            this.tabKlientensystem.TabIndex = 2;
            this.tabKlientensystem.TabPages.AddRange(new SharpLibrary.WinControls.TabPageEx[] {
                        this.tbpKlientensystem,
                        this.tbpBeziehungen});
            this.tabKlientensystem.TabsLineColor = System.Drawing.Color.Black;
            this.tabKlientensystem.TabsStyle = SharpLibrary.WinControls.TabsStyle.Flat;
            this.tabKlientensystem.Text = "kissTabControlEx1";
            this.tabKlientensystem.SelectedTabChanged += new SharpLibrary.WinControls.TabControlExTabChangeEventHandler(this.tabKlientensystem_SelectedTabChanged);
            this.tabKlientensystem.SelectedTabChanging += new System.ComponentModel.CancelEventHandler(this.tabKlientensystem_SelectedTabChanging);
            //
            // tbpKlientensystem
            //
            this.tbpKlientensystem.Controls.Add(this.grdKlientensystem);
            this.tbpKlientensystem.Location = new System.Drawing.Point(6, 6);
            this.tbpKlientensystem.Name = "tbpKlientensystem";
            this.tbpKlientensystem.Size = new System.Drawing.Size(699, 475);
            this.tbpKlientensystem.TabIndex = 0;
            this.tbpKlientensystem.Title = "Klientensystem";
            //
            // grdKlientensystem
            //
            this.grdKlientensystem.DataSource = this.qryKlientensystem;
            this.grdKlientensystem.Dock = System.Windows.Forms.DockStyle.Fill;
            this.grdKlientensystem.EmbeddedNavigator.Name = "";
            this.grdKlientensystem.GridStyle = KiSS4.Gui.GridStyleType.Editable;
            this.grdKlientensystem.Location = new System.Drawing.Point(0, 0);
            this.grdKlientensystem.MainView = this.grvKlientensystem;
            this.grdKlientensystem.Name = "grdKlientensystem";
            this.grdKlientensystem.Size = new System.Drawing.Size(699, 475);
            this.grdKlientensystem.TabIndex = 0;
            this.grdKlientensystem.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
                        this.grvKlientensystem});
            //
            // tbpBeziehungen
            //
            this.tbpBeziehungen.Controls.Add(this.kissLabel7);
            this.tbpBeziehungen.Controls.Add(this.lblBemerkung);
            this.tbpBeziehungen.Controls.Add(this.kissLabel5);
            this.tbpBeziehungen.Controls.Add(this.edtBemerkung);
            this.tbpBeziehungen.Controls.Add(this.edtDatumBis);
            this.tbpBeziehungen.Controls.Add(this.edtDatumVon);
            this.tbpBeziehungen.Controls.Add(this.kissLabel4);
            this.tbpBeziehungen.Controls.Add(this.edtQualitaet);
            this.tbpBeziehungen.Controls.Add(this.lblBaRelationID);
            this.tbpBeziehungen.Controls.Add(this.edtBaRelationID);
            this.tbpBeziehungen.Controls.Add(this.lblBaPersonID_2);
            this.tbpBeziehungen.Controls.Add(this.edtBaPersonID_2);
            this.tbpBeziehungen.Controls.Add(this.lblBaPersonID_1);
            this.tbpBeziehungen.Controls.Add(this.edtBaPersonID_1);
            this.tbpBeziehungen.Controls.Add(this.grdBeziehungen);
            this.tbpBeziehungen.Location = new System.Drawing.Point(6, 6);
            this.tbpBeziehungen.Name = "tbpBeziehungen";
            this.tbpBeziehungen.Size = new System.Drawing.Size(699, 475);
            this.tbpBeziehungen.TabIndex = 1;
            this.tbpBeziehungen.Title = "Beziehungen";
            //
            // grdBeziehungen
            //
            this.grdBeziehungen.DataSource = this.qryBaPerson_Relation;
            this.grdBeziehungen.EmbeddedNavigator.Name = "";
            this.grdBeziehungen.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdBeziehungen.Location = new System.Drawing.Point(0, 0);
            this.grdBeziehungen.MainView = this.grvBeziehungen;
            this.grdBeziehungen.Name = "grdBeziehungen";
            this.grdBeziehungen.Size = new System.Drawing.Size(696, 341);
            this.grdBeziehungen.TabIndex = 0;
            this.grdBeziehungen.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
                        this.grvBeziehungen});
            //
            // edtBaPersonID_1
            //
            this.edtBaPersonID_1.DataMember = "BaPersonID_1";
            this.edtBaPersonID_1.DataSource = this.qryBaPerson_Relation;
            this.edtBaPersonID_1.Location = new System.Drawing.Point(76, 356);
            this.edtBaPersonID_1.Name = "edtBaPersonID_1";
            this.edtBaPersonID_1.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBaPersonID_1.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBaPersonID_1.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaPersonID_1.Properties.Appearance.Options.UseBackColor = true;
            this.edtBaPersonID_1.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBaPersonID_1.Properties.Appearance.Options.UseFont = true;
            this.edtBaPersonID_1.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBaPersonID_1.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtBaPersonID_1.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBaPersonID_1.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
                        new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text", "Name", 20, DevExpress.Utils.FormatType.None, "", true, DevExpress.Utils.HorzAlignment.Default, DevExpress.Data.ColumnSortOrder.None)});
            this.edtBaPersonID_1.Properties.DisplayMember = "Text";
            this.edtBaPersonID_1.Properties.NullText = "";
            this.edtBaPersonID_1.Properties.ShowFooter = false;
            this.edtBaPersonID_1.Properties.ShowHeader = false;
            this.edtBaPersonID_1.Properties.ValueMember = "Code";
            this.edtBaPersonID_1.Size = new System.Drawing.Size(214, 24);
            this.edtBaPersonID_1.TabIndex = 1;
            //
            // lblBaPersonID_1
            //
            this.lblBaPersonID_1.Location = new System.Drawing.Point(3, 356);
            this.lblBaPersonID_1.Name = "lblBaPersonID_1";
            this.lblBaPersonID_1.Size = new System.Drawing.Size(67, 24);
            this.lblBaPersonID_1.TabIndex = 1;
            this.lblBaPersonID_1.Text = "Person 1";
            this.lblBaPersonID_1.UseCompatibleTextRendering = true;
            //
            // edtBaPersonID_2
            //
            this.edtBaPersonID_2.DataMember = "BaPersonID_2";
            this.edtBaPersonID_2.DataSource = this.qryBaPerson_Relation;
            this.edtBaPersonID_2.Location = new System.Drawing.Point(76, 386);
            this.edtBaPersonID_2.Name = "edtBaPersonID_2";
            this.edtBaPersonID_2.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBaPersonID_2.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBaPersonID_2.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaPersonID_2.Properties.Appearance.Options.UseBackColor = true;
            this.edtBaPersonID_2.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBaPersonID_2.Properties.Appearance.Options.UseFont = true;
            this.edtBaPersonID_2.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBaPersonID_2.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtBaPersonID_2.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBaPersonID_2.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
                        new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text", "Name", 20, DevExpress.Utils.FormatType.None, "", true, DevExpress.Utils.HorzAlignment.Default, DevExpress.Data.ColumnSortOrder.None)});
            this.edtBaPersonID_2.Properties.DisplayMember = "Text";
            this.edtBaPersonID_2.Properties.NullText = "";
            this.edtBaPersonID_2.Properties.ShowFooter = false;
            this.edtBaPersonID_2.Properties.ShowHeader = false;
            this.edtBaPersonID_2.Properties.ValueMember = "Code";
            this.edtBaPersonID_2.Size = new System.Drawing.Size(214, 24);
            this.edtBaPersonID_2.TabIndex = 2;
            //
            // lblBaPersonID_2
            //
            this.lblBaPersonID_2.Location = new System.Drawing.Point(3, 386);
            this.lblBaPersonID_2.Name = "lblBaPersonID_2";
            this.lblBaPersonID_2.Size = new System.Drawing.Size(67, 24);
            this.lblBaPersonID_2.TabIndex = 2;
            this.lblBaPersonID_2.Text = "Person 2";
            this.lblBaPersonID_2.UseCompatibleTextRendering = true;
            //
            // edtBaRelationID
            //
            this.edtBaRelationID.DataMember = "BaRelationID";
            this.edtBaRelationID.DataSource = this.qryBaPerson_Relation;
            this.edtBaRelationID.Location = new System.Drawing.Point(76, 416);
            this.edtBaRelationID.Name = "edtBaRelationID";
            this.edtBaRelationID.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBaRelationID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBaRelationID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaRelationID.Properties.Appearance.Options.UseBackColor = true;
            this.edtBaRelationID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBaRelationID.Properties.Appearance.Options.UseFont = true;
            this.edtBaRelationID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBaRelationID.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtBaRelationID.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBaRelationID.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
                        new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text", "Relation", 20, DevExpress.Utils.FormatType.None, "", true, DevExpress.Utils.HorzAlignment.Default, DevExpress.Data.ColumnSortOrder.None)});
            this.edtBaRelationID.Properties.DisplayMember = "Text";
            this.edtBaRelationID.Properties.NullText = "";
            this.edtBaRelationID.Properties.ShowFooter = false;
            this.edtBaRelationID.Properties.ShowHeader = false;
            this.edtBaRelationID.Properties.ValueMember = "Code";
            this.edtBaRelationID.Size = new System.Drawing.Size(214, 24);
            this.edtBaRelationID.TabIndex = 3;
            //
            // lblBaRelationID
            //
            this.lblBaRelationID.Location = new System.Drawing.Point(3, 416);
            this.lblBaRelationID.Name = "lblBaRelationID";
            this.lblBaRelationID.Size = new System.Drawing.Size(67, 24);
            this.lblBaRelationID.TabIndex = 3;
            this.lblBaRelationID.Text = "Beziehung";
            this.lblBaRelationID.UseCompatibleTextRendering = true;
            //
            // edtQualitaet
            //
            this.edtQualitaet.DataMember = "BaRelationQualitaetCode";
            this.edtQualitaet.DataSource = this.qryBaPerson_Relation;
            this.edtQualitaet.Location = new System.Drawing.Point(76, 446);
            this.edtQualitaet.LOVName = "BaRelationQualitaet";
            this.edtQualitaet.Name = "edtQualitaet";
            this.edtQualitaet.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtQualitaet.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtQualitaet.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtQualitaet.Properties.Appearance.Options.UseBackColor = true;
            this.edtQualitaet.Properties.Appearance.Options.UseBorderColor = true;
            this.edtQualitaet.Properties.Appearance.Options.UseFont = true;
            this.edtQualitaet.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtQualitaet.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtQualitaet.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtQualitaet.Properties.NullText = "";
            this.edtQualitaet.Properties.ShowFooter = false;
            this.edtQualitaet.Properties.ShowHeader = false;
            this.edtQualitaet.Size = new System.Drawing.Size(214, 24);
            this.edtQualitaet.TabIndex = 4;
            //
            // kissLabel4
            //
            this.kissLabel4.Location = new System.Drawing.Point(3, 446);
            this.kissLabel4.Name = "kissLabel4";
            this.kissLabel4.Size = new System.Drawing.Size(59, 24);
            this.kissLabel4.TabIndex = 4;
            this.kissLabel4.Text = "Qualität";
            this.kissLabel4.UseCompatibleTextRendering = true;
            //
            // edtDatumVon
            //
            this.edtDatumVon.DataMember = "DatumVon";
            this.edtDatumVon.DataSource = this.qryBaPerson_Relation;
            this.edtDatumVon.EditValue = null;
            this.edtDatumVon.Location = new System.Drawing.Point(397, 356);
            this.edtDatumVon.Name = "edtDatumVon";
            this.edtDatumVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.False;
            this.edtDatumVon.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumVon.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseFont = true;
            this.edtDatumVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtDatumVon.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtDatumVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumVon.Properties.ShowToday = false;
            this.edtDatumVon.Size = new System.Drawing.Size(100, 24);
            this.edtDatumVon.TabIndex = 5;
            //
            // edtDatumBis
            //
            this.edtDatumBis.DataMember = "DatumBis";
            this.edtDatumBis.DataSource = this.qryBaPerson_Relation;
            this.edtDatumBis.EditValue = null;
            this.edtDatumBis.Location = new System.Drawing.Point(526, 356);
            this.edtDatumBis.Name = "edtDatumBis";
            this.edtDatumBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.False;
            this.edtDatumBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseFont = true;
            this.edtDatumBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtDatumBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtDatumBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumBis.Properties.ShowToday = false;
            this.edtDatumBis.Size = new System.Drawing.Size(100, 24);
            this.edtDatumBis.TabIndex = 6;
            //
            // edtBemerkung
            //
            this.edtBemerkung.DataMember = "Bemerkung";
            this.edtBemerkung.DataSource = this.qryBaPerson_Relation;
            this.edtBemerkung.Location = new System.Drawing.Point(397, 402);
            this.edtBemerkung.Name = "edtBemerkung";
            this.edtBemerkung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBemerkung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBemerkung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBemerkung.Properties.Appearance.Options.UseBackColor = true;
            this.edtBemerkung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBemerkung.Properties.Appearance.Options.UseFont = true;
            this.edtBemerkung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBemerkung.Properties.MaxLength = 500;
            this.edtBemerkung.Size = new System.Drawing.Size(229, 68);
            this.edtBemerkung.TabIndex = 7;
            //
            // kissLabel5
            //
            this.kissLabel5.Location = new System.Drawing.Point(322, 356);
            this.kissLabel5.Name = "kissLabel5";
            this.kissLabel5.Size = new System.Drawing.Size(69, 24);
            this.kissLabel5.TabIndex = 12;
            this.kissLabel5.Text = "Datum von";
            this.kissLabel5.UseCompatibleTextRendering = true;
            //
            // lblBemerkung
            //
            this.lblBemerkung.Location = new System.Drawing.Point(322, 402);
            this.lblBemerkung.Name = "lblBemerkung";
            this.lblBemerkung.Size = new System.Drawing.Size(69, 24);
            this.lblBemerkung.TabIndex = 13;
            this.lblBemerkung.Text = "Bemerkung";
            this.lblBemerkung.UseCompatibleTextRendering = true;
            //
            // kissLabel7
            //
            this.kissLabel7.Location = new System.Drawing.Point(503, 356);
            this.kissLabel7.Name = "kissLabel7";
            this.kissLabel7.Size = new System.Drawing.Size(17, 24);
            this.kissLabel7.TabIndex = 14;
            this.kissLabel7.Text = "bis";
            this.kissLabel7.UseCompatibleTextRendering = true;
            //
            // colBaPersonID
            //
            this.colBaPersonID.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colBaPersonID.AppearanceCell.Options.UseBackColor = true;
            this.colBaPersonID.Caption = "P-Nr.";
            this.colBaPersonID.FieldName = "BaPersonID";
            this.colBaPersonID.Name = "colBaPersonID";
            this.colBaPersonID.OptionsColumn.AllowEdit = false;
            this.colBaPersonID.Visible = true;
            this.colBaPersonID.VisibleIndex = 0;
            //
            // colBaPersonID_1
            //
            this.colBaPersonID_1.Caption = "Person 1";
            this.colBaPersonID_1.FieldName = "BaPersonID_1";
            this.colBaPersonID_1.Name = "colBaPersonID_1";
            this.colBaPersonID_1.Visible = true;
            this.colBaPersonID_1.VisibleIndex = 0;
            this.colBaPersonID_1.Width = 168;
            //
            // colBaPersonID_2
            //
            this.colBaPersonID_2.Caption = "Person 2";
            this.colBaPersonID_2.FieldName = "BaPersonID_2";
            this.colBaPersonID_2.Name = "colBaPersonID_2";
            this.colBaPersonID_2.Visible = true;
            this.colBaPersonID_2.VisibleIndex = 2;
            this.colBaPersonID_2.Width = 168;
            //
            // colBaRelationID
            //
            this.colBaRelationID.Caption = "Beziehung";
            this.colBaRelationID.FieldName = "BaRelationID";
            this.colBaRelationID.Name = "colBaRelationID";
            this.colBaRelationID.Visible = true;
            this.colBaRelationID.VisibleIndex = 1;
            this.colBaRelationID.Width = 168;
            //
            // colBeziehung
            //
            this.colBeziehung.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colBeziehung.AppearanceCell.Options.UseBackColor = true;
            this.colBeziehung.Caption = "Beziehung  zu FT";
            this.colBeziehung.FieldName = "Beziehung";
            this.colBeziehung.Name = "colBeziehung";
            this.colBeziehung.OptionsColumn.AllowEdit = false;
            this.colBeziehung.Visible = true;
            this.colBeziehung.VisibleIndex = 2;
            this.colBeziehung.Width = 121;
            //
            // colDatuBis2
            //
            this.colDatuBis2.Caption = "bis";
            this.colDatuBis2.FieldName = "DatumBis";
            this.colDatuBis2.Name = "colDatuBis2";
            this.colDatuBis2.Visible = true;
            this.colDatuBis2.VisibleIndex = 4;
            this.colDatuBis2.Width = 80;
            //
            // colDatumBis
            //
            this.colDatumBis.Caption = "Mitglied bis";
            this.colDatumBis.FieldName = "DatumBis";
            this.colDatumBis.Name = "colDatumBis";
            this.colDatumBis.Visible = true;
            this.colDatumBis.VisibleIndex = 6;
            this.colDatumBis.Width = 90;
            //
            // colDatumVon
            //
            this.colDatumVon.Caption = "Mitglied von";
            this.colDatumVon.FieldName = "DatumVon";
            this.colDatumVon.Name = "colDatumVon";
            this.colDatumVon.Visible = true;
            this.colDatumVon.VisibleIndex = 5;
            this.colDatumVon.Width = 90;
            //
            // colDatumVon2
            //
            this.colDatumVon2.Caption = "von";
            this.colDatumVon2.FieldName = "DatumVon";
            this.colDatumVon2.Name = "colDatumVon2";
            this.colDatumVon2.Visible = true;
            this.colDatumVon2.VisibleIndex = 3;
            this.colDatumVon2.Width = 80;
            //
            // colFall
            //
            this.colFall.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colFall.AppearanceCell.Options.UseBackColor = true;
            this.colFall.Caption = "Fall";
            this.colFall.FieldName = "Fall";
            this.colFall.Name = "colFall";
            this.colFall.OptionsColumn.AllowEdit = false;
            //
            // colGeburtsdatum
            //
            this.colGeburtsdatum.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colGeburtsdatum.AppearanceCell.Options.UseBackColor = true;
            this.colGeburtsdatum.Caption = "Geburt";
            this.colGeburtsdatum.FieldName = "Geburtsdatum";
            this.colGeburtsdatum.Name = "colGeburtsdatum";
            this.colGeburtsdatum.OptionsColumn.AllowEdit = false;
            this.colGeburtsdatum.Visible = true;
            this.colGeburtsdatum.VisibleIndex = 4;
            this.colGeburtsdatum.Width = 80;
            //
            // colGeschlecht
            //
            this.colGeschlecht.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colGeschlecht.AppearanceCell.Options.UseBackColor = true;
            this.colGeschlecht.Caption = "M/W";
            this.colGeschlecht.FieldName = "Geschlecht";
            this.colGeschlecht.Name = "colGeschlecht";
            this.colGeschlecht.OptionsColumn.AllowEdit = false;
            this.colGeschlecht.Visible = true;
            this.colGeschlecht.VisibleIndex = 3;
            this.colGeschlecht.Width = 40;
            //
            // colName
            //
            this.colName.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colName.AppearanceCell.Options.UseBackColor = true;
            this.colName.Caption = "Name, Vorname";
            this.colName.FieldName = "NameVorname";
            this.colName.Name = "colName";
            this.colName.OptionsColumn.AllowEdit = false;
            this.colName.Visible = true;
            this.colName.VisibleIndex = 1;
            this.colName.Width = 169;
            //
            // grvBeziehungen
            //
            this.grvBeziehungen.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvBeziehungen.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBeziehungen.Appearance.Empty.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.Empty.Options.UseFont = true;
            this.grvBeziehungen.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.grvBeziehungen.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBeziehungen.Appearance.EvenRow.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.EvenRow.Options.UseFont = true;
            this.grvBeziehungen.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvBeziehungen.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBeziehungen.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvBeziehungen.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.FocusedCell.Options.UseFont = true;
            this.grvBeziehungen.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvBeziehungen.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvBeziehungen.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBeziehungen.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvBeziehungen.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.FocusedRow.Options.UseFont = true;
            this.grvBeziehungen.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvBeziehungen.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvBeziehungen.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvBeziehungen.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.grvBeziehungen.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvBeziehungen.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.GroupRow.Options.UseFont = true;
            this.grvBeziehungen.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvBeziehungen.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvBeziehungen.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvBeziehungen.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.grvBeziehungen.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvBeziehungen.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvBeziehungen.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvBeziehungen.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBeziehungen.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvBeziehungen.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvBeziehungen.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvBeziehungen.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvBeziehungen.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBeziehungen.Appearance.OddRow.Options.UseFont = true;
            this.grvBeziehungen.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvBeziehungen.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBeziehungen.Appearance.Row.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.Row.Options.UseFont = true;
            this.grvBeziehungen.Appearance.SelectedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.grvBeziehungen.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBeziehungen.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.grvBeziehungen.Appearance.SelectedRow.Options.UseBackColor = true;
            this.grvBeziehungen.Appearance.SelectedRow.Options.UseFont = true;
            this.grvBeziehungen.Appearance.SelectedRow.Options.UseForeColor = true;
            this.grvBeziehungen.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvBeziehungen.Appearance.VertLine.Options.UseBackColor = true;
            this.grvBeziehungen.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvBeziehungen.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
                        this.colBaPersonID_1,
                        this.colBaRelationID,
                        this.colBaPersonID_2,
                        this.colDatumVon2,
                        this.colDatuBis2});
            this.grvBeziehungen.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvBeziehungen.GridControl = this.grdBeziehungen;
            this.grvBeziehungen.Name = "grvBeziehungen";
            this.grvBeziehungen.OptionsBehavior.Editable = false;
            this.grvBeziehungen.OptionsCustomization.AllowFilter = false;
            this.grvBeziehungen.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvBeziehungen.OptionsNavigation.AutoFocusNewRow = true;
            this.grvBeziehungen.OptionsNavigation.UseTabKey = false;
            this.grvBeziehungen.OptionsView.ColumnAutoWidth = false;
            this.grvBeziehungen.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvBeziehungen.OptionsView.ShowGroupPanel = false;
            this.grvBeziehungen.OptionsView.ShowIndicator = false;
            //
            // grvKlientensystem
            //
            this.grvKlientensystem.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvKlientensystem.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKlientensystem.Appearance.Empty.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.Empty.Options.UseFont = true;
            this.grvKlientensystem.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.grvKlientensystem.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKlientensystem.Appearance.EvenRow.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.EvenRow.Options.UseFont = true;
            this.grvKlientensystem.Appearance.FocusedCell.BackColor = System.Drawing.Color.AliceBlue;
            this.grvKlientensystem.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKlientensystem.Appearance.FocusedCell.ForeColor = System.Drawing.Color.Black;
            this.grvKlientensystem.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.FocusedCell.Options.UseFont = true;
            this.grvKlientensystem.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvKlientensystem.Appearance.FocusedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.grvKlientensystem.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKlientensystem.Appearance.FocusedRow.ForeColor = System.Drawing.Color.Black;
            this.grvKlientensystem.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.FocusedRow.Options.UseFont = true;
            this.grvKlientensystem.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvKlientensystem.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvKlientensystem.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvKlientensystem.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvKlientensystem.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvKlientensystem.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.GroupRow.Options.UseFont = true;
            this.grvKlientensystem.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvKlientensystem.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvKlientensystem.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvKlientensystem.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvKlientensystem.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvKlientensystem.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvKlientensystem.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.AliceBlue;
            this.grvKlientensystem.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKlientensystem.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvKlientensystem.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvKlientensystem.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvKlientensystem.Appearance.HorzLine.BackColor = System.Drawing.Color.LightGray;
            this.grvKlientensystem.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKlientensystem.Appearance.OddRow.Options.UseFont = true;
            this.grvKlientensystem.Appearance.Row.BackColor = System.Drawing.Color.AliceBlue;
            this.grvKlientensystem.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKlientensystem.Appearance.Row.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.Row.Options.UseFont = true;
            this.grvKlientensystem.Appearance.SelectedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.grvKlientensystem.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKlientensystem.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.grvKlientensystem.Appearance.SelectedRow.Options.UseBackColor = true;
            this.grvKlientensystem.Appearance.SelectedRow.Options.UseFont = true;
            this.grvKlientensystem.Appearance.SelectedRow.Options.UseForeColor = true;
            this.grvKlientensystem.Appearance.VertLine.BackColor = System.Drawing.Color.LightGray;
            this.grvKlientensystem.Appearance.VertLine.Options.UseBackColor = true;
            this.grvKlientensystem.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvKlientensystem.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
                        this.colFall,
                        this.colBaPersonID,
                        this.colName,
                        this.colBeziehung,
                        this.colGeschlecht,
                        this.colGeburtsdatum,
                        this.colDatumVon,
                        this.colDatumBis});
            this.grvKlientensystem.GridControl = this.grdKlientensystem;
            this.grvKlientensystem.GroupCount = 1;
            this.grvKlientensystem.Name = "grvKlientensystem";
            this.grvKlientensystem.OptionsCustomization.AllowFilter = false;
            this.grvKlientensystem.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvKlientensystem.OptionsNavigation.AutoFocusNewRow = true;
            this.grvKlientensystem.OptionsSelection.EnableAppearanceFocusedCell = false;
            this.grvKlientensystem.OptionsSelection.EnableAppearanceFocusedRow = false;
            this.grvKlientensystem.OptionsView.ColumnAutoWidth = false;
            this.grvKlientensystem.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvKlientensystem.OptionsView.ShowGroupPanel = false;
            this.grvKlientensystem.SortInfo.AddRange(new DevExpress.XtraGrid.Columns.GridColumnSortInfo[] {
                        new DevExpress.XtraGrid.Columns.GridColumnSortInfo(this.colFall, DevExpress.Data.ColumnSortOrder.Ascending)});
            this.grvKlientensystem.CustomDrawCell += new DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventHandler(this.grvKlientensystem_CustomDrawCell);
            //
            // qryBaPerson
            //
            this.qryBaPerson.HostControl = this;
            this.qryBaPerson.SelectStatement = resources.GetString("qryBaPerson.SelectStatement");
            //
            // qryBaPerson_Relation
            //
            this.qryBaPerson_Relation.CanDelete = true;
            this.qryBaPerson_Relation.CanInsert = true;
            this.qryBaPerson_Relation.CanUpdate = true;
            this.qryBaPerson_Relation.HostControl = this;
            this.qryBaPerson_Relation.SelectStatement = resources.GetString("qryBaPerson_Relation.SelectStatement");
            this.qryBaPerson_Relation.TableName = "BaPerson_Relation";
            this.qryBaPerson_Relation.BeforePost += new System.EventHandler(this.qryBaPerson_Relation_BeforePost);
            //
            // qryKlientensystem
            //
            this.qryKlientensystem.CanUpdate = true;
            this.qryKlientensystem.HostControl = this;
            this.qryKlientensystem.SelectStatement = resources.GetString("qryKlientensystem.SelectStatement");
            this.qryKlientensystem.TableName = "FaFallPerson";
            this.qryKlientensystem.AfterFill += new System.EventHandler(this.qryKlientensystem_AfterFill);
            this.qryKlientensystem.BeforePost += new System.EventHandler(this.qryKlientensystem_BeforePost);
            this.qryKlientensystem.AfterPost += new System.EventHandler(this.qryKlientensystem_AfterPost);
            //
            // CtlBaKlientensystem
            //
            this.Controls.Add(this.tabKlientensystem);
            this.Controls.Add(this.panel1);
            this.Name = "CtlBaKlientensystem";
            this.Size = new System.Drawing.Size(711, 537);
            this.panel1.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).EndInit();
            this.tabKlientensystem.ResumeLayout(false);
            this.tbpKlientensystem.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.grdKlientensystem)).EndInit();
            this.tbpBeziehungen.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.grdBeziehungen)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID_1.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID_1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID_1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID_2.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID_2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID_2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaRelationID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaRelationID)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaRelationID)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtQualitaet.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtQualitaet)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel4)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBemerkung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel5)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel7)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvBeziehungen)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvKlientensystem)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBaPerson)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBaPerson_Relation)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryKlientensystem)).EndInit();
            this.ResumeLayout(false);
        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Public Methods

        public void Init(string TitleName, Image TitleImage, int baPersonID)
        {
            this.baPersonID = baPersonID;
              this.picTitel.Image = TitleImage;
              this.lblTitel.Text = TitleName;
              tabKlientensystem.SelectedTabIndex = 0;
              grvKlientensystem.Columns["Fall"].GroupIndex = 0;

              // alle Personen in allen Klientensystemen von BaPersonID
              qryBaPerson.Fill(baPersonID);

              edtBaPersonID_1.LoadQuery(qryBaPerson);
              colBaPersonID_1.ColumnEdit = grdBeziehungen.GetLOVLookUpEdit(qryBaPerson);
              edtBaPersonID_2.LoadQuery(qryBaPerson);
              colBaPersonID_2.ColumnEdit = grdBeziehungen.GetLOVLookUpEdit(qryBaPerson);

              // Auswahl Relationen
              SqlQuery qryRel = DBUtil.OpenSQL( @"
            SELECT Code = BaRelationID, Text = NameRelation
            FROM dbo.BaRelation
            WHERE BaRelationID NOT IN (2, 3)
            ORDER BY SortKey, NameRelation");
              edtBaRelationID.LoadQuery(qryRel);
              colBaRelationID.ColumnEdit = grdBeziehungen.GetLOVLookUpEdit(qryRel);

              // Anzeigen Klientensystem:
              qryKlientensystem.Fill(baPersonID);

              // Anzeigen Beziehungen:
              qryBaPerson_Relation.Fill(baPersonID);
        }

        #endregion

        #region Private Methods

        // Letzte Bearbeitung:
        // 31.03.2009 : sozheo : im SQL dbo eingefügt
        // -------------------------------------------------------------------
        // Aufruf für BaPersonID, Text
        private bool InsertFVProtokoll(object fvBaPersonID, string fvText)
        {
            return InsertFVProtokoll(DBNull.Value, DBNull.Value, fvBaPersonID, Session.User.UserID, 1, fvText);
        }

        // Aufruf für FaFallID, BaPersonID, Text
        private bool InsertFVProtokoll(object fvFaFallID, object fvBaPersonID, string fvText)
        {
            return InsertFVProtokoll(fvFaFallID, DBNull.Value, fvBaPersonID, Session.User.UserID, 1, fvText);
        }

        // Aufruf für FaFallID, FaLeistungID, BaPersonID, Text
        private bool InsertFVProtokoll(object fvFaFallID, object fvFaLeistungID, object fvBaPersonID, string fvText)
        {
            return InsertFVProtokoll(fvFaFallID, fvFaLeistungID, fvBaPersonID, Session.User.UserID, 1, fvText);
        }

        // Werte in die Datenbank in FaJournal einfügen
        private bool InsertFVProtokoll(object fvFaFallID, object fvFaLeistungID, object fvBaPersonID, int fvUserID, int fvFaJournalCode, string fvText)
        {
            // Einen neuen Eintrag im Fallverlaufsprotokoll einfügen
            // -----------------------------------------------------
            // Parameter der sp:  {0}=FaFallID, {1}=FaLeistungID, {2}=BaPersonID, {3}=UserID, {4}=FaJournalCode, {5}=Text
            // Info:              Wenn FaFallID NULL ist, wird versucht (1.) via FaLeistungID oder (2.) via BaPersonID die FaFallID zu setzen.
            //                    Wenn BaPersonID NULL ist, wird versucht (1.) via FaLeistungID oder (2.) via FaFallID die BaPersonID zu setzen.
            // Rückgabewert:      Eingefügte FaJournalID des neuen Eintrags - zum Ändern von zusätzlichen Werten verwendbar
            int faJournalID = Convert.ToInt32(DBUtil.ExecuteScalarSQL(@"
                EXEC dbo.spFaInsertFVProtokoll {0}, {1}, {2}, {3}, {4}, {5}", fvFaFallID, fvFaLeistungID, fvBaPersonID, fvUserID, fvFaJournalCode, fvText));

            // return if valid new id (< 1 = invalid)
            return faJournalID > 0;
        }

        private void grvKlientensystem_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e)
        {
            // TODO
            /*
            private void advBandedGridView1_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e) {
            GridView currentView = sender as GridView;
            if(e.RowHandle == CurrentView.FocusedRowHandle) return;
            Rectangle r = e.Bounds;
            if(e.Column.FieldName == "UnitsInStock") {
                bool check = (bool)currentView.GetRowCellValue(e.RowHandle, currentView.Columns["Discontinued"]);
                if(check) {
                    //Change the text to display
                    //The e.Handled parameter is false
                    //So the cell will be painted by default using the e.Style style
                    e.DisplayText = "Discontinued";
                }
                else {
                    // If the cell value is greater then 50 the paint color is LightGreen, otherwise LightSkyBlue
                    Brush ellipseBrush = Brushes.LightSkyBlue;
                    if (Convert.ToInt16(e.CellValue) > 50) ellipseBrush = Brushes.LightGreen;
                    //Draw an ellipse within the cell
                    e.Graphics.FillEllipse(ellipseBrush, r);
                    r.Width -= 12;
                    //Draw the cell value
                    e.Style.DrawString(e.Graphics, e.DisplayText, r);
                    //Set e.Handled to true to prevent default painting
                    e.Handled = true;
                }
            }
            }

            */
        }

        private void qryBaPerson_Relation_BeforePost(object sender, System.EventArgs e)
        {
            DBUtil.CheckNotNullField(edtBaPersonID_1, lblBaPersonID_1.Text);

            DBUtil.CheckNotNullField(edtBaPersonID_2, lblBaPersonID_2.Text);

            DBUtil.CheckNotNullField(edtBaRelationID, lblBaRelationID.Text);

            // Letzte Bearbeitung:
            // 07.08.2007 : sozheo : Alles neu
            // 31.03.2009 : sozheo : im SQL dbo eingefügt
            // -------------------------------------------------------------------

            // Kontrollieren, dass Datum von kleiner als Datum bis ist:
            if (!DBUtil.IsEmpty(qryBaPerson_Relation["DatumVon"]) && !DBUtil.IsEmpty(qryBaPerson_Relation["DatumBis"]))
            {
              if ((DateTime)qryBaPerson_Relation["DatumVon"]>=(DateTime)qryBaPerson_Relation["DatumBis"])
              {
                edtDatumVon.Focus();
                KissMsg.ShowInfo("CtlBaKlientensystem", "DatumsFehler",
                  "Das Von-Datum muss kleiner sein als das Bis-Datum.");
                throw new KissCancelException();
              }
            }

            // Kontrollieren, dass PersonID1 nicht leer ist:
            if ((int)qryBaPerson_Relation["BaPersonID_1"] == (int)qryBaPerson_Relation["BaPersonID_2"])
            {
              edtBaPersonID_1.Focus();
              KissMsg.ShowInfo("CtlBaKlientensystem", "FehlerGleichePerson",
                "Die erste uns die zweite Person dürfen nicht gleich sein.\r\n"+
                "Wählen zuerst eine andere erste Person oder eine andere zweite Person aus.");
              throw new KissCancelException();
            }
        }

        private void qryKlientensystem_AfterFill(object sender, System.EventArgs e)
        {
            grvKlientensystem.ExpandAllGroups();
        }

        private void qryKlientensystem_AfterPost(object sender, System.EventArgs e)
        {
            FormController.SendMessage( "FrmFall", "Action", "RefreshTree" );
        }

        private void qryKlientensystem_BeforePost(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung:
            // 07.08.2007 : sozheo : Alles neu
            // 26.01.2009 : sozheo : Neue Plausis für DatumBis implementiert
            // 31.03.2009 : sozheo : Plausis für DatumBis korrigiert/entfernt
            // -------------------------------------------------------------------

            // Kontrollieren, dass Datum von kleiner als Datum bis ist:
            if (!DBUtil.IsEmpty(qryKlientensystem["DatumVon"]) && !DBUtil.IsEmpty(qryKlientensystem["DatumBis"]))
            {
                if ((DateTime)qryKlientensystem["DatumVon"]>=(DateTime)qryKlientensystem["DatumBis"])
                {
                    KissMsg.ShowInfo("CtlBaKlientensystem", "DatumsFehler",
                        "Das Von-Datum muss kleiner sein als das Bis-Datum.");
                    throw new KissCancelException();
                }
            }

            // 26.01.2009 : sozheo : Neue Plausis für DatumBis implementiert
            SqlQuery qryInaktiv;
            if (!DBUtil.IsEmpty(qryKlientensystem["DatumBis"]))
            {
              // Kontrolle, ob Person in aktivem Fall ist
              // 31.03.2009 : sozheo : ##4500 : Das soll nur gesperrt werden, wenn es der gleiche Fall ist
              qryInaktiv = DBUtil.OpenSQL(@"
                select DatumBis from dbo.FaFall
                where BaPersonID = {0} and DatumBis is NULL and FaFallID = {1}",
                Utils.ConvertToInt(qryKlientensystem["BaPersonID"]),
                Utils.ConvertToInt(qryKlientensystem["FaFallID"])
              );
              //if (Utils.ConvertToInt(qryInaktiv["Anzahl"])>0) throw new KissInfoException(
              if (!DBUtil.IsEmpty(qryInaktiv["DatumBis"])) throw new KissInfoException(
                "Diese Person ist Fallträger in diesem aktiven Fall.\r\n" +
                "Das Bis-Datum kann deshalb nicht gesetzt werden."
              );

              // Kontrolle, ob Person in aktiver Leistung ist
              // 31.03.2009 : sozheo : ##4500 : Das soll nur gesperrt werden, wenn es der gleiche Fall ist
              qryInaktiv = DBUtil.OpenSQL(@"
                select Anzahl = Count(*) from dbo.FaLeistung
                where BaPersonID = {0} and DatumBis is NULL and FaFallID = {1}",
                Utils.ConvertToInt(qryKlientensystem["BaPersonID"]),
                Utils.ConvertToInt(qryKlientensystem["FaFallID"])
              );
              if (Utils.ConvertToInt(qryInaktiv["Anzahl"])>0) throw new KissInfoException(
                "Diese Person ist noch Leistungsträger in einer aktiven Leistung dieses Falles.\r\n" +
                "Das Bis-Datum kann deshalb nicht gesetzt werden."
              );

              // Kontrolle, ob Person noch Inkasso Leistungen bezieht
              // 31.03.2009 : sozheo : ##4500 : Das soll nur gesperrt werden, wenn es der gleiche Fall ist
              qryInaktiv = DBUtil.OpenSQL(@"
                select Anzahl = Count(*) from dbo.IkGlaeubiger G
                left join dbo.IkRechtstitel R on R.IkRechtstitelID = G.IkRechtstitelID
                left join dbo.FaLeistung L on L.FaLeistungID = R.FaLeistungID
                where G.BaPersonID = {0} and L.DatumBis is NULL and L.FaFallID = {1}",
                Utils.ConvertToInt(qryKlientensystem["BaPersonID"]),
                Utils.ConvertToInt(qryKlientensystem["FaFallID"])
              );
              if (Utils.ConvertToInt(qryInaktiv["Anzahl"])>0) throw new KissInfoException(
                "Diese Person bezieht noch Leistungen im Alimentwesen dieses Falles.\r\n" +
                "Das Bis-Datum kann deshalb nicht gesetzt werden."
              );
            }

            //
            if (!DBUtil.IsEmpty(qryKlientensystem["DatumVon"]) || !DBUtil.IsEmpty(qryKlientensystem["DatumBis"]))
            {
                SqlQuery qry = DBUtil.OpenSQL(@"
                    SELECT cnt = COUNT(*),
                      DatumVon = MIN(IsNull(BFP.DatumVon, BFP.GeplantVon)),
                      DatumBis = MAX(IsNull(BFP.DatumBis, BFP.GeplantBis))
                    FROM dbo.FaLeistung                     LST
                      INNER JOIN dbo.BgFinanzplan           BFP ON BFP.FaLeistungID = LST.FaLeistungID
                      INNER JOIN dbo.BgFinanzplan_BaPerson  FPR ON FPR.BgFinanzplanID = BFP.BgFinanzplanID
                    WHERE LST.FaFallID = {0} AND FPR.BaPersonID = {1}
                      AND (IsNull(BFP.DatumVon, BFP.GeplantVon) < IsNull({2}, '17530101')
                            OR IsNull(BFP.DatumBis, BFP.GeplantBis) > IsNull({3}, '99991231'))"
                    , qryKlientensystem["FaFallID"], qryKlientensystem["BaPersonID"]
                    , qryKlientensystem["DatumVon"], qryKlientensystem["DatumBis"]);

                if ((int)qry["cnt"] > 0)
                {
                    throw new KissInfoException(string.Format(
                        KissMsg.GetMLMessage("CtlBaKlientensystem", "PersonUnterstuetzt", "{0} ist vom {1:d} bis {2:d} Mitglied einer Unterstützungseinheit.")
                        , qryKlientensystem["NameVorname"], qry["DatumVon"], qry["DatumBis"]));
                }
            }

            if (!DBUtil.IsEmpty(qryKlientensystem["DatumBis"]))
            {
                //Eintrag ins Fallverlaufsprotokoll
                InsertFVProtokoll(qryKlientensystem["FaFallID"], qryKlientensystem["BaPersonID"], string.Format("Personen-Abschluss per '{0:d}'", qryKlientensystem["DatumBis"]));
            }
        }

        private void tabKlientensystem_SelectedTabChanged(SharpLibrary.WinControls.TabPageEx page)
        {
            if (tabKlientensystem.SelectedTab == tbpKlientensystem)
            {
                ActiveSQLQuery = qryKlientensystem;
            }
            else
            {
                ActiveSQLQuery = qryBaPerson_Relation;
            }
        }

        private void tabKlientensystem_SelectedTabChanging(object sender, System.ComponentModel.CancelEventArgs e)
        {
            if (tabKlientensystem.SelectedTab == tbpKlientensystem)
            {
                if (qryKlientensystem.RowModified) e.Cancel = qryKlientensystem.Post();
            }
            else
            {
                if (qryBaPerson_Relation.RowModified) e.Cancel = qryBaPerson_Relation.Post();
            }
        }

        #endregion
    }
}