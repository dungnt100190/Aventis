//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using KiSS4.Common;
using KiSS4.DB;


namespace KiSS4.Inkasso
{
	
	
	public class CtlIkMonatszahlenSaldo : KiSS4.Gui.KissUserControl
	{
		
		private KiSS4.Gui.KissGrid grdPerson;
		
		private KiSS4.DB.SqlQuery qryGlaeubiger;
		
		private System.ComponentModel.IContainer components;
		
		private KiSS4.Gui.KissLabel kissLabel1;
		
		private KiSS4.Gui.KissDateEdit edtSaldoBis;
		
		private KiSS4.Gui.KissCheckEdit edtNurALBV;
		
		private KiSS4.Gui.KissGrid grdSaldo;
		
		public KiSS4.DB.SqlQuery qrySaldo;
		
		private DevExpress.XtraGrid.Views.Grid.GridView gvwSaldo;
		
		private DevExpress.XtraGrid.Columns.GridColumn colLeisMonatJahr;
		
		private DevExpress.XtraGrid.Columns.GridColumn colLEalt;
		
		private DevExpress.XtraGrid.Columns.GridColumn colLEBetrag;
		
		private DevExpress.XtraGrid.Columns.GridColumn colDiff;
		
		private DevExpress.XtraGrid.Columns.GridColumn colVerrechg;
		
		private DevExpress.XtraGrid.Columns.GridColumn colGuth;
		
		private DevExpress.XtraGrid.Columns.GridColumn colLeisALBVbezahlt;
		
		private DevExpress.XtraGrid.Columns.GridColumn colLeisSaldo;
		
		private DevExpress.XtraGrid.Columns.GridColumn colErledigt;
		
		private DevExpress.XtraGrid.Columns.GridColumn colistWH;
		
		private DevExpress.XtraGrid.Columns.GridColumn colLeisBemerkung;
		
		private DevExpress.XtraGrid.Views.Grid.GridView gridView6;
		
		private DevExpress.XtraGrid.Views.Grid.GridView gvwPerson;
		
		private DevExpress.XtraGrid.Columns.GridColumn colKind;
		
		private DevExpress.XtraGrid.Columns.GridColumn colAlter;
		
		private DevExpress.XtraGrid.Columns.GridColumn colALBVBetrag;
		
		private DevExpress.XtraGrid.Columns.GridColumn colALBVSaldo;
		

		// Letzte Bearbeitung
		// 06.02.2008 : sozheo : neu
		// 04.03.2008 : sozheo : Saldo öffnen verbessert
		// ------------------------------------------------------
		
		private int IkRechtstitelID = 0;
		private bool GlaeubigerFilling = false;
		
		public void Init(int RechtstitelID)
		{
		  IkRechtstitelID = RechtstitelID;
		
		  // Datum auf Ende nächster Monat setzen
		  edtSaldoBis.EditValue = Utils.lastDayOfMonth(DateTime.Today.AddMonths(1));
		
		  // Daten anzeigen
		  GlaeubigerOeffnen();
		}
		
		public void GlaeubigerOeffnen()
		{
		  //int PersID = qryGlaeubiger.IsOpen ? Utils.ConvertToInt(qryGlaeubiger["BaPersonID"]) : 0;
		  int PersID = Utils.ConvertToInt(qryGlaeubiger["BaPersonID"]);
		  
		  // Damit auf den zuletzt gewählten Gläubiger gesprungen werden kann
		  // und das Berechnen des Saldo nichalles nichtt unnötig führt wird... :
		  GlaeubigerFilling = true;
		  try
		  {
		    qryGlaeubiger.Fill(IkRechtstitelID, edtNurALBV.Checked, edtSaldoBis.DateTime);
		    if (PersID > 0) qryGlaeubiger.Find("BaPersonID="+PersID.ToString());
		    SaldoOeffnen();
		  }
		  finally
		  {
		    GlaeubigerFilling = false;
		  }
		}
		
		private void SaldoOeffnen()
		{
		  qrySaldo.Fill(IkRechtstitelID, Utils.ConvertToInt(qryGlaeubiger["BaPersonID"]), edtSaldoBis.DateTime);
		}

		// Letzte Bearbeitung
		// 07.02.2008 : sozheo : neu
		// ------------------------------------------------------
		
		private void edtNurALBV_CheckedChanged(object sender, EventArgs e)
		{
		  // Daten anzeigen
		  GlaeubigerOeffnen();
		}

		// Letzte Bearbeitung
		// 07.02.2008 : sozheo : neu
		// ------------------------------------------------------
		
		private void SaldoBerechnen()
		{
		  if (qrySaldo.Count == 0) return;
		
		  Decimal Guthaben = (Decimal)0.0;
		  Decimal Saldo = (Decimal)0.0;
		  foreach (System.Data.DataRow row in qrySaldo.DataTable.Rows)
		  {
		    
		    Saldo += Utils.ConvertToDecimal(row["Auszahlung"]);
		    row["Saldo"] = Saldo;
		    
		    Guthaben += Utils.ConvertToDecimal(row["BetragALBVSoll"]) - Utils.ConvertToDecimal(row["BetragALBVIst"]) + Utils.ConvertToDecimal(row["BetragVerrechg"]);
		    row["Guthaben"] = Guthaben;
		  }
		  
		  //KissMsg.ShowInfo("Test");
		
		/*
		  int Index = qrySaldo.Count - 1;
		  while (Index >= 0)
		  {
		    Saldo += Utils.ConvertToDecimal(qrySaldo.DataTable.Rows[Index]["BetragALBVSoll"]) 
		      - Utils.ConvertToDecimal(qrySaldo.DataTable.Rows[Index]["BetragALBV"]) 
		      - Utils.ConvertToDecimal(qrySaldo.DataTable.Rows[Index]["Auszahlung"]);
		    qrySaldo.DataTable.Rows[Index]["Saldo"] = Saldo;
		    Index -= 1;
		  }
		  */
		}
		
		public CtlIkMonatszahlenSaldo()
		{
			this.InitializeComponent();
		}
		
		#region Designer generated code
		/// <summary>
		/// Required method for Designer support - do not modify
		/// the contents of this method with the code editor.
		/// </summary>
		private void InitializeComponent()
		{
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlIkMonatszahlenSaldo));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            this.grdPerson = new KiSS4.Gui.KissGrid();
            this.qryGlaeubiger = new KiSS4.DB.SqlQuery(this.components);
            this.gvwPerson = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colKind = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colAlter = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colALBVBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colALBVSaldo = new DevExpress.XtraGrid.Columns.GridColumn();
            this.grdSaldo = new KiSS4.Gui.KissGrid();
            this.qrySaldo = new KiSS4.DB.SqlQuery(this.components);
            this.gvwSaldo = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colLeisMonatJahr = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLEalt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLEBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDiff = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrechg = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colGuth = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLeisALBVbezahlt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLeisSaldo = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colErledigt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colistWH = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLeisBemerkung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.gridView6 = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.edtNurALBV = new KiSS4.Gui.KissCheckEdit();
            this.edtSaldoBis = new KiSS4.Gui.KissDateEdit();
            this.kissLabel1 = new KiSS4.Gui.KissLabel();
            ((System.ComponentModel.ISupportInitialize)(this.grdPerson)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryGlaeubiger)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwPerson)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdSaldo)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qrySaldo)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwSaldo)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gridView6)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtNurALBV.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSaldoBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).BeginInit();
            this.SuspendLayout();
            // 
            // grdPerson
            // 
            this.grdPerson.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdPerson.DataSource = this.qryGlaeubiger;
            this.grdPerson.EmbeddedNavigator.Name = "";
            this.grdPerson.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdPerson.Location = new System.Drawing.Point(9, 10);
            this.grdPerson.MainView = this.gvwPerson;
            this.grdPerson.Name = "grdPerson";
            this.grdPerson.Size = new System.Drawing.Size(449, 122);
            this.grdPerson.TabIndex = 3;
            this.grdPerson.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.gvwPerson});
            // 
            // qryGlaeubiger
            // 
            this.qryGlaeubiger.HostControl = this;
            this.qryGlaeubiger.SelectStatement = resources.GetString("qryGlaeubiger.SelectStatement");
            this.qryGlaeubiger.PositionChanged += new System.EventHandler(this.qryGlaeubiger_PositionChanged);
            this.qryGlaeubiger.AfterFill += new System.EventHandler(this.qryGlaeubiger_AfterFill);
            // 
            // gvwPerson
            // 
            this.gvwPerson.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gvwPerson.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.Empty.Options.UseBackColor = true;
            this.gvwPerson.Appearance.Empty.Options.UseFont = true;
            this.gvwPerson.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.EvenRow.Options.UseFont = true;
            this.gvwPerson.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwPerson.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gvwPerson.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gvwPerson.Appearance.FocusedCell.Options.UseFont = true;
            this.gvwPerson.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gvwPerson.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwPerson.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gvwPerson.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gvwPerson.Appearance.FocusedRow.Options.UseFont = true;
            this.gvwPerson.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gvwPerson.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwPerson.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gvwPerson.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwPerson.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwPerson.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwPerson.Appearance.GroupRow.Options.UseBackColor = true;
            this.gvwPerson.Appearance.GroupRow.Options.UseFont = true;
            this.gvwPerson.Appearance.GroupRow.Options.UseForeColor = true;
            this.gvwPerson.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gvwPerson.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gvwPerson.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwPerson.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gvwPerson.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gvwPerson.Appearance.HeaderPanel.Options.UseFont = true;
            this.gvwPerson.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gvwPerson.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwPerson.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gvwPerson.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gvwPerson.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gvwPerson.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gvwPerson.Appearance.HorzLine.Options.UseBackColor = true;
            this.gvwPerson.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.OddRow.Options.UseFont = true;
            this.gvwPerson.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gvwPerson.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.Row.Options.UseBackColor = true;
            this.gvwPerson.Appearance.Row.Options.UseFont = true;
            this.gvwPerson.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.SelectedRow.Options.UseFont = true;
            this.gvwPerson.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gvwPerson.Appearance.VertLine.Options.UseBackColor = true;
            this.gvwPerson.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gvwPerson.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colKind,
            this.colAlter,
            this.colALBVBetrag,
            this.colALBVSaldo});
            this.gvwPerson.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gvwPerson.GridControl = this.grdPerson;
            this.gvwPerson.Name = "gvwPerson";
            this.gvwPerson.OptionsBehavior.Editable = false;
            this.gvwPerson.OptionsCustomization.AllowFilter = false;
            this.gvwPerson.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gvwPerson.OptionsNavigation.AutoFocusNewRow = true;
            this.gvwPerson.OptionsNavigation.UseTabKey = false;
            this.gvwPerson.OptionsView.ColumnAutoWidth = false;
            this.gvwPerson.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gvwPerson.OptionsView.ShowGroupPanel = false;
            this.gvwPerson.OptionsView.ShowIndicator = false;
            // 
            // colKind
            // 
            this.colKind.Caption = "Person / Geburtsdatum";
            this.colKind.FieldName = "Name";
            this.colKind.Name = "colKind";
            this.colKind.Visible = true;
            this.colKind.VisibleIndex = 0;
            this.colKind.Width = 205;
            // 
            // colAlter
            // 
            this.colAlter.Caption = "Alter";
            this.colAlter.FieldName = "Alter";
            this.colAlter.Name = "colAlter";
            this.colAlter.Visible = true;
            this.colAlter.VisibleIndex = 1;
            this.colAlter.Width = 42;
            // 
            // colALBVBetrag
            // 
            this.colALBVBetrag.AppearanceCell.Options.UseTextOptions = true;
            this.colALBVBetrag.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVBetrag.AppearanceHeader.Options.UseTextOptions = true;
            this.colALBVBetrag.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVBetrag.Caption = "akt. ALBV";
            this.colALBVBetrag.DisplayFormat.FormatString = "N2";
            this.colALBVBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colALBVBetrag.FieldName = "BetragALBV";
            this.colALBVBetrag.Name = "colALBVBetrag";
            this.colALBVBetrag.Visible = true;
            this.colALBVBetrag.VisibleIndex = 2;
            this.colALBVBetrag.Width = 102;
            // 
            // colALBVSaldo
            // 
            this.colALBVSaldo.AppearanceCell.Options.UseTextOptions = true;
            this.colALBVSaldo.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVSaldo.AppearanceHeader.Options.UseTextOptions = true;
            this.colALBVSaldo.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVSaldo.Caption = "akt. Saldo";
            this.colALBVSaldo.DisplayFormat.FormatString = "N2";
            this.colALBVSaldo.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colALBVSaldo.FieldName = "BetragSaldo";
            this.colALBVSaldo.Name = "colALBVSaldo";
            this.colALBVSaldo.Visible = true;
            this.colALBVSaldo.VisibleIndex = 3;
            // 
            // grdSaldo
            // 
            this.grdSaldo.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdSaldo.DataSource = this.qrySaldo;
            this.grdSaldo.EmbeddedNavigator.Name = "";
            this.grdSaldo.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdSaldo.Location = new System.Drawing.Point(9, 138);
            this.grdSaldo.MainView = this.gvwSaldo;
            this.grdSaldo.Name = "grdSaldo";
            this.grdSaldo.Size = new System.Drawing.Size(695, 351);
            this.grdSaldo.TabIndex = 4;
            this.grdSaldo.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.gvwSaldo,
            this.gridView6});
            // 
            // qrySaldo
            // 
            this.qrySaldo.BatchUpdate = true;
            this.qrySaldo.CanUpdate = true;
            this.qrySaldo.HostControl = this;
            this.qrySaldo.SelectStatement = resources.GetString("qrySaldo.SelectStatement");
            this.qrySaldo.AfterFill += new System.EventHandler(this.qrySaldo_AfterFill);
            // 
            // gvwSaldo
            // 
            this.gvwSaldo.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gvwSaldo.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.Empty.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.Empty.Options.UseFont = true;
            this.gvwSaldo.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.EvenRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwSaldo.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gvwSaldo.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.FocusedCell.Options.UseFont = true;
            this.gvwSaldo.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gvwSaldo.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwSaldo.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gvwSaldo.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.FocusedRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gvwSaldo.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwSaldo.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwSaldo.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwSaldo.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwSaldo.Appearance.GroupRow.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.GroupRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.GroupRow.Options.UseForeColor = true;
            this.gvwSaldo.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gvwSaldo.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gvwSaldo.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwSaldo.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gvwSaldo.Appearance.HeaderPanel.Options.UseFont = true;
            this.gvwSaldo.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gvwSaldo.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwSaldo.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gvwSaldo.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gvwSaldo.Appearance.HorzLine.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.OddRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gvwSaldo.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.Row.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.Row.Options.UseFont = true;
            this.gvwSaldo.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.SelectedRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gvwSaldo.Appearance.VertLine.Options.UseBackColor = true;
            this.gvwSaldo.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gvwSaldo.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colLeisMonatJahr,
            this.colLEalt,
            this.colLEBetrag,
            this.colDiff,
            this.colVerrechg,
            this.colGuth,
            this.colLeisALBVbezahlt,
            this.colLeisSaldo,
            this.colErledigt,
            this.colistWH,
            this.colLeisBemerkung});
            this.gvwSaldo.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gvwSaldo.GridControl = this.grdSaldo;
            this.gvwSaldo.Name = "gvwSaldo";
            this.gvwSaldo.OptionsBehavior.Editable = false;
            this.gvwSaldo.OptionsCustomization.AllowFilter = false;
            this.gvwSaldo.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gvwSaldo.OptionsNavigation.AutoFocusNewRow = true;
            this.gvwSaldo.OptionsNavigation.UseTabKey = false;
            this.gvwSaldo.OptionsView.ColumnAutoWidth = false;
            this.gvwSaldo.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gvwSaldo.OptionsView.ShowGroupPanel = false;
            this.gvwSaldo.OptionsView.ShowIndicator = false;
            // 
            // colLeisMonatJahr
            // 
            this.colLeisMonatJahr.Caption = "Monat";
            this.colLeisMonatJahr.DisplayFormat.FormatString = "yyyy.MM";
            this.colLeisMonatJahr.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colLeisMonatJahr.FieldName = "Datum";
            this.colLeisMonatJahr.Name = "colLeisMonatJahr";
            this.colLeisMonatJahr.Visible = true;
            this.colLeisMonatJahr.VisibleIndex = 0;
            this.colLeisMonatJahr.Width = 62;
            // 
            // colLEalt
            // 
            this.colLEalt.AppearanceCell.Options.UseTextOptions = true;
            this.colLEalt.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLEalt.AppearanceHeader.Options.UseTextOptions = true;
            this.colLEalt.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLEalt.Caption = "LE alt";
            this.colLEalt.DisplayFormat.FormatString = "N2";
            this.colLEalt.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colLEalt.FieldName = "BetragALBVIst";
            this.colLEalt.Name = "colLEalt";
            this.colLEalt.Visible = true;
            this.colLEalt.VisibleIndex = 1;
            this.colLEalt.Width = 77;
            // 
            // colLEBetrag
            // 
            this.colLEBetrag.AppearanceCell.Options.UseTextOptions = true;
            this.colLEBetrag.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLEBetrag.AppearanceHeader.Options.UseTextOptions = true;
            this.colLEBetrag.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLEBetrag.Caption = "LE neu";
            this.colLEBetrag.DisplayFormat.FormatString = "N2";
            this.colLEBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colLEBetrag.FieldName = "BetragALBVSoll";
            this.colLEBetrag.Name = "colLEBetrag";
            this.colLEBetrag.Visible = true;
            this.colLEBetrag.VisibleIndex = 2;
            // 
            // colDiff
            // 
            this.colDiff.AppearanceCell.Options.UseTextOptions = true;
            this.colDiff.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colDiff.AppearanceHeader.Options.UseTextOptions = true;
            this.colDiff.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colDiff.Caption = "Diff.";
            this.colDiff.DisplayFormat.FormatString = "N2";
            this.colDiff.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colDiff.FieldName = "ALBVDiff";
            this.colDiff.Name = "colDiff";
            this.colDiff.Visible = true;
            this.colDiff.VisibleIndex = 3;
            // 
            // colVerrechg
            // 
            this.colVerrechg.AppearanceCell.Options.UseTextOptions = true;
            this.colVerrechg.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVerrechg.AppearanceHeader.Options.UseTextOptions = true;
            this.colVerrechg.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVerrechg.Caption = "Verrechng.";
            this.colVerrechg.DisplayFormat.FormatString = "N2";
            this.colVerrechg.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colVerrechg.FieldName = "BetragVerrechg";
            this.colVerrechg.Name = "colVerrechg";
            this.colVerrechg.Visible = true;
            this.colVerrechg.VisibleIndex = 4;
            this.colVerrechg.Width = 76;
            // 
            // colGuth
            // 
            this.colGuth.AppearanceCell.BackColor = System.Drawing.Color.LightSalmon;
            this.colGuth.AppearanceCell.Options.UseBackColor = true;
            this.colGuth.AppearanceCell.Options.UseTextOptions = true;
            this.colGuth.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colGuth.AppearanceHeader.Options.UseTextOptions = true;
            this.colGuth.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colGuth.Caption = "+/- Guth.";
            this.colGuth.DisplayFormat.FormatString = "N2";
            this.colGuth.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colGuth.FieldName = "Guthaben";
            this.colGuth.Name = "colGuth";
            this.colGuth.Visible = true;
            this.colGuth.VisibleIndex = 5;
            this.colGuth.Width = 74;
            // 
            // colLeisALBVbezahlt
            // 
            this.colLeisALBVbezahlt.AppearanceCell.Options.UseTextOptions = true;
            this.colLeisALBVbezahlt.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLeisALBVbezahlt.AppearanceHeader.Options.UseTextOptions = true;
            this.colLeisALBVbezahlt.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLeisALBVbezahlt.Caption = "Auszahlung";
            this.colLeisALBVbezahlt.DisplayFormat.FormatString = "N2";
            this.colLeisALBVbezahlt.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colLeisALBVbezahlt.FieldName = "Auszahlung";
            this.colLeisALBVbezahlt.Name = "colLeisALBVbezahlt";
            this.colLeisALBVbezahlt.Visible = true;
            this.colLeisALBVbezahlt.VisibleIndex = 6;
            this.colLeisALBVbezahlt.Width = 82;
            // 
            // colLeisSaldo
            // 
            this.colLeisSaldo.AppearanceCell.Options.UseTextOptions = true;
            this.colLeisSaldo.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLeisSaldo.AppearanceHeader.Options.UseTextOptions = true;
            this.colLeisSaldo.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLeisSaldo.Caption = "Saldo";
            this.colLeisSaldo.DisplayFormat.FormatString = "N2";
            this.colLeisSaldo.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colLeisSaldo.FieldName = "Saldo";
            this.colLeisSaldo.Name = "colLeisSaldo";
            this.colLeisSaldo.Visible = true;
            this.colLeisSaldo.VisibleIndex = 7;
            this.colLeisSaldo.Width = 70;
            // 
            // colErledigt
            // 
            this.colErledigt.Caption = "erl";
            this.colErledigt.FieldName = "ErledigterMonat";
            this.colErledigt.Name = "colErledigt";
            this.colErledigt.Visible = true;
            this.colErledigt.VisibleIndex = 8;
            this.colErledigt.Width = 27;
            // 
            // colistWH
            // 
            this.colistWH.Caption = "SH";
            this.colistWH.FieldName = "Unterstuetzungsfall";
            this.colistWH.Name = "colistWH";
            this.colistWH.Visible = true;
            this.colistWH.VisibleIndex = 9;
            this.colistWH.Width = 30;
            // 
            // colLeisBemerkung
            // 
            this.colLeisBemerkung.Caption = "Bemerkung";
            this.colLeisBemerkung.FieldName = "Bemerkung";
            this.colLeisBemerkung.Name = "colLeisBemerkung";
            this.colLeisBemerkung.Visible = true;
            this.colLeisBemerkung.VisibleIndex = 10;
            this.colLeisBemerkung.Width = 102;
            // 
            // gridView6
            // 
            this.gridView6.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gridView6.GridControl = this.grdSaldo;
            this.gridView6.Name = "gridView6";
            this.gridView6.OptionsBehavior.Editable = false;
            this.gridView6.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gridView6.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            // 
            // edtNurALBV
            // 
            this.edtNurALBV.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.edtNurALBV.EditValue = true;
            this.edtNurALBV.Location = new System.Drawing.Point(476, 10);
            this.edtNurALBV.Name = "edtNurALBV";
            this.edtNurALBV.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtNurALBV.Properties.Appearance.Options.UseBackColor = true;
            this.edtNurALBV.Properties.Caption = "Nur ALBV Gläubiger (Kinder)";
            this.edtNurALBV.Size = new System.Drawing.Size(180, 19);
            this.edtNurALBV.TabIndex = 5;
            this.edtNurALBV.CheckedChanged += new System.EventHandler(this.edtNurALBV_CheckedChanged);
            // 
            // edtSaldoBis
            // 
            this.edtSaldoBis.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.edtSaldoBis.EditValue = null;
            this.edtSaldoBis.Location = new System.Drawing.Point(476, 35);
            this.edtSaldoBis.Name = "edtSaldoBis";
            this.edtSaldoBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtSaldoBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSaldoBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSaldoBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSaldoBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtSaldoBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSaldoBis.Properties.Appearance.Options.UseFont = true;
            this.edtSaldoBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtSaldoBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtSaldoBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtSaldoBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSaldoBis.Properties.ShowToday = false;
            this.edtSaldoBis.Size = new System.Drawing.Size(99, 24);
            this.edtSaldoBis.TabIndex = 6;
            this.edtSaldoBis.EditValueChanged += new System.EventHandler(this.edtSaldoBis_EditValueChanged);
            // 
            // kissLabel1
            // 
            this.kissLabel1.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.kissLabel1.Location = new System.Drawing.Point(582, 35);
            this.kissLabel1.Name = "kissLabel1";
            this.kissLabel1.Size = new System.Drawing.Size(122, 24);
            this.kissLabel1.TabIndex = 7;
            this.kissLabel1.Text = "Saldo berechnen bis ";
            this.kissLabel1.UseCompatibleTextRendering = true;
            // 
            // CtlIkMonatszahlenSaldo
            // 
            this.Controls.Add(this.kissLabel1);
            this.Controls.Add(this.edtSaldoBis);
            this.Controls.Add(this.edtNurALBV);
            this.Controls.Add(this.grdSaldo);
            this.Controls.Add(this.grdPerson);
            this.Name = "CtlIkMonatszahlenSaldo";
            this.Size = new System.Drawing.Size(719, 505);
            ((System.ComponentModel.ISupportInitialize)(this.grdPerson)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryGlaeubiger)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwPerson)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdSaldo)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qrySaldo)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwSaldo)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gridView6)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtNurALBV.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSaldoBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).EndInit();
            this.ResumeLayout(false);

		}
		#endregion
		
		/// <summary>
		/// Clean up any resources being used.
		/// </summary>
		protected override void Dispose(bool disposing)
		{
			if (disposing)
			{
				if ((components != null))
				{
					components.Dispose();
				}
			}
			base.Dispose(disposing);
		}
		
		private void qryGlaeubiger_AfterFill(object sender, System.EventArgs e)
		{

			// Letzte Bearbeitung
			// 06.02.2008 : sozheo : neu
			// ------------------------------------------------------
			
			if (qryGlaeubiger.Count==0) qryGlaeubiger_PositionChanged(sender, e);
		}
		
		private void qrySaldo_AfterFill(object sender, System.EventArgs e)
		{

			// Letzte Bearbeitung
			// 07.02.2008 : sozheo : neu
			// ------------------------------------------------------
			
			SaldoBerechnen();
		}
		
		private void qryGlaeubiger_PositionChanged(object sender, System.EventArgs e)
		{

			// Letzte Bearbeitung
			// 06.02.2008 : sozheo : neu
			// ------------------------------------------------------
			
			if (GlaeubigerFilling) return;
			SaldoOeffnen();
		}
		
		private void edtSaldoBis_EditValueChanged(object sender, System.EventArgs e)
		{

			// Letzte Bearbeitung
			// 07.02.2008 : sozheo : neu
			// ------------------------------------------------------
			
			if (!edtSaldoBis.UserModified) return;
			if (DBUtil.IsEmpty(edtSaldoBis.EditValue)) return;
			
			//int PersID = Utils.ConvertToInt(qryGlaeubiger["BaPersonID"]);
			
			GlaeubigerOeffnen();
		}
	}
}