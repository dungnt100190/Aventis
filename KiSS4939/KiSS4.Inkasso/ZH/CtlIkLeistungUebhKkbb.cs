#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Drawing;

using KiSS.DBScheme;

using KiSS4.Common;
using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Inkasso.ZH
{
    public class CtlIkLeistungUebhKkbb : KiSS4.Gui.KissUserControl
    {
        #region Fields

        private KiSS4.Gui.KissButton btnGenerateVGNr;
        private KiSS4.Gui.KissButton btnReopen;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissLookUpEdit edtAbschlussGrundCode;
        private KiSS4.Gui.KissDateEdit edtDatumBis;
        private KiSS4.Gui.KissDateEdit edtDatumVon;
        private KiSS4.Gui.KissLookUpEdit edtEroeffnungsGrundCode;
        private KiSS4.Gui.KissTextEdit edtFaLeistungID;
        private KiSS4.Gui.KissTextEdit edtPscdVertragsgegenstandID;
        private KiSS4.Gui.KissTextEdit edtSAR;
        private KiSS4.Gui.KissLabel kissLabel1;
        private KiSS4.Gui.KissTextEdit kissTextEdit2;
        private KiSS4.Gui.KissLabel lblAbschlussGrundCode;
        private KiSS4.Gui.KissLabel lblBemerkung;
        private KiSS4.Gui.KissLabel lblDatumBis;
        private KiSS4.Gui.KissLabel lblDatumVon;
        private KiSS4.Gui.KissLabel lblEroeffnungsGrundCode;
        private KiSS4.Gui.KissLabel lblLT;
        private KiSS4.Gui.KissLabel lblPscdVgId;
        private KiSS4.Gui.KissLabel lblSAR;
        private KiSS4.Gui.KissLabel lblTitel;
        private KiSS4.Gui.KissMemoEdit memBemerkung;
        private KiSS4.Gui.KissMemoEdit memLT;
        private System.Windows.Forms.PictureBox picTitle;
        private System.Windows.Forms.Panel pnTitle;
        private KiSS4.DB.SqlQuery qryAdresse;
        private KiSS4.DB.SqlQuery qryDatenKontrolle;
        private KiSS4.DB.SqlQuery qryFaLeistung;

        #endregion

        #region Constructors

        // Letzte Bearbeitung
        // 14.09.2007 : sozheo : Neu gemacht
        // 08.05.2008 : sozheo : Anpassungen für Leistung Anspruchsberechnung
        // ------------------------------------------------------------------------------------------------
        public CtlIkLeistungUebhKkbb(Image titelImage, string titelText, int faLeistungID, int ProzessCode)
            : this()
        {
            this.picTitle.Image = titelImage;
            this.lblTitel.Text = titelText;

            lblPscdVgId.Visible = (ProzessCode >= 406);
            edtPscdVertragsgegenstandID.Visible = lblPscdVgId.Visible;
            lblEroeffnungsGrundCode.Visible = lblPscdVgId.Visible;
            edtEroeffnungsGrundCode.Visible = lblPscdVgId.Visible;
            lblAbschlussGrundCode.Visible = lblPscdVgId.Visible;
            edtAbschlussGrundCode.Visible = lblPscdVgId.Visible;

            if (ProzessCode == 406)
            {
                // UeBH
                edtEroeffnungsGrundCode.LOVFilter = "UeBH";
                edtAbschlussGrundCode.LOVFilter = "UeBH";
            }
            else if (ProzessCode == 407)
            {
                // KKBB
                edtEroeffnungsGrundCode.LOVFilter = "KKBB";
                edtAbschlussGrundCode.LOVFilter = "KKBB";
            }
            else if (ProzessCode == 402 || ProzessCode == 404)
            {
                lblLT.Text = "Vetreter/in";
            }
            edtEroeffnungsGrundCode.LOVName = "EroeffnungsGrund";
            edtAbschlussGrundCode.LOVName = "AbschlussGrund";
            qryFaLeistung.Fill(faLeistungID);
        }

        public CtlIkLeistungUebhKkbb()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlIkLeistungUebhKkbb));
            this.edtDatumVon = new KiSS4.Gui.KissDateEdit();
            this.edtEroeffnungsGrundCode = new KiSS4.Gui.KissLookUpEdit();
            this.edtDatumBis = new KiSS4.Gui.KissDateEdit();
            this.edtAbschlussGrundCode = new KiSS4.Gui.KissLookUpEdit();
            this.lblDatumVon = new KiSS4.Gui.KissLabel();
            this.lblDatumBis = new KiSS4.Gui.KissLabel();
            this.memBemerkung = new KiSS4.Gui.KissMemoEdit();
            this.pnTitle = new System.Windows.Forms.Panel();
            this.lblTitel = new KiSS4.Gui.KissLabel();
            this.picTitle = new System.Windows.Forms.PictureBox();
            this.lblSAR = new KiSS4.Gui.KissLabel();
            this.edtSAR = new KiSS4.Gui.KissTextEdit();
            this.lblEroeffnungsGrundCode = new KiSS4.Gui.KissLabel();
            this.lblAbschlussGrundCode = new KiSS4.Gui.KissLabel();
            this.lblBemerkung = new KiSS4.Gui.KissLabel();
            this.btnReopen = new KiSS4.Gui.KissButton();
            this.edtPscdVertragsgegenstandID = new KiSS4.Gui.KissTextEdit();
            this.lblPscdVgId = new KiSS4.Gui.KissLabel();
            this.lblLT = new KiSS4.Gui.KissLabel();
            this.memLT = new KiSS4.Gui.KissMemoEdit();
            this.btnGenerateVGNr = new KiSS4.Gui.KissButton();
            this.kissLabel1 = new KiSS4.Gui.KissLabel();
            this.edtFaLeistungID = new KiSS4.Gui.KissTextEdit();
            this.kissTextEdit2 = new KiSS4.Gui.KissTextEdit();
            this.qryAdresse = new KiSS4.DB.SqlQuery(this.components);
            this.qryDatenKontrolle = new KiSS4.DB.SqlQuery(this.components);
            this.qryFaLeistung = new KiSS4.DB.SqlQuery(this.components);
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEroeffnungsGrundCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEroeffnungsGrundCode.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussGrundCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussGrundCode.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumVon)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumBis)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.memBemerkung.Properties)).BeginInit();
            this.pnTitle.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.picTitle)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSAR)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSAR.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEroeffnungsGrundCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAbschlussGrundCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtPscdVertragsgegenstandID.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblPscdVgId)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblLT)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.memLT.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtFaLeistungID.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissTextEdit2.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryAdresse)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryDatenKontrolle)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryFaLeistung)).BeginInit();
            this.SuspendLayout();
            //
            // edtDatumVon
            //
            this.edtDatumVon.DataMember = "DatumVon";
            this.edtDatumVon.DataSource = this.qryFaLeistung;
            this.edtDatumVon.EditValue = null;
            this.edtDatumVon.Location = new System.Drawing.Point(105, 118);
            this.edtDatumVon.Name = "edtDatumVon";
            this.edtDatumVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.False;
            this.edtDatumVon.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumVon.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseFont = true;
            this.edtDatumVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtDatumVon.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtDatumVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumVon.Properties.ShowToday = false;
            this.edtDatumVon.Size = new System.Drawing.Size(100, 24);
            this.edtDatumVon.TabIndex = 0;
            //
            // edtEroeffnungsGrundCode
            //
            this.edtEroeffnungsGrundCode.DataMember = "EroeffnungsGrundCode";
            this.edtEroeffnungsGrundCode.DataSource = this.qryFaLeistung;
            this.edtEroeffnungsGrundCode.Location = new System.Drawing.Point(335, 118);
            this.edtEroeffnungsGrundCode.LOVFilter = "UeBH";
            this.edtEroeffnungsGrundCode.LOVName = "EroeffnungsGrund";
            this.edtEroeffnungsGrundCode.Name = "edtEroeffnungsGrundCode";
            this.edtEroeffnungsGrundCode.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtEroeffnungsGrundCode.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtEroeffnungsGrundCode.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtEroeffnungsGrundCode.Properties.Appearance.Options.UseBackColor = true;
            this.edtEroeffnungsGrundCode.Properties.Appearance.Options.UseBorderColor = true;
            this.edtEroeffnungsGrundCode.Properties.Appearance.Options.UseFont = true;
            this.edtEroeffnungsGrundCode.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtEroeffnungsGrundCode.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtEroeffnungsGrundCode.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtEroeffnungsGrundCode.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
                        new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text", null, 75)});
            this.edtEroeffnungsGrundCode.Properties.DisplayMember = "Text";
            this.edtEroeffnungsGrundCode.Properties.NullText = "";
            this.edtEroeffnungsGrundCode.Properties.ShowFooter = false;
            this.edtEroeffnungsGrundCode.Properties.ShowHeader = false;
            this.edtEroeffnungsGrundCode.Properties.ValueMember = "Code";
            this.edtEroeffnungsGrundCode.Size = new System.Drawing.Size(300, 24);
            this.edtEroeffnungsGrundCode.TabIndex = 1;
            //
            // edtDatumBis
            //
            this.edtDatumBis.DataMember = "DatumBis";
            this.edtDatumBis.DataSource = this.qryFaLeistung;
            this.edtDatumBis.EditValue = null;
            this.edtDatumBis.Location = new System.Drawing.Point(105, 148);
            this.edtDatumBis.Name = "edtDatumBis";
            this.edtDatumBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.False;
            this.edtDatumBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseFont = true;
            this.edtDatumBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtDatumBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtDatumBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumBis.Properties.ShowToday = false;
            this.edtDatumBis.Size = new System.Drawing.Size(100, 24);
            this.edtDatumBis.TabIndex = 2;
            //
            // edtAbschlussGrundCode
            //
            this.edtAbschlussGrundCode.DataMember = "AbschlussGrundCode";
            this.edtAbschlussGrundCode.DataSource = this.qryFaLeistung;
            this.edtAbschlussGrundCode.Location = new System.Drawing.Point(335, 148);
            this.edtAbschlussGrundCode.LOVFilter = "UeBH";
            this.edtAbschlussGrundCode.LOVName = "AbschlussGrund";
            this.edtAbschlussGrundCode.Name = "edtAbschlussGrundCode";
            this.edtAbschlussGrundCode.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtAbschlussGrundCode.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAbschlussGrundCode.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAbschlussGrundCode.Properties.Appearance.Options.UseBackColor = true;
            this.edtAbschlussGrundCode.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAbschlussGrundCode.Properties.Appearance.Options.UseFont = true;
            this.edtAbschlussGrundCode.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtAbschlussGrundCode.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtAbschlussGrundCode.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtAbschlussGrundCode.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
                        new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text", null, 75)});
            this.edtAbschlussGrundCode.Properties.DisplayMember = "Text";
            this.edtAbschlussGrundCode.Properties.NullText = "";
            this.edtAbschlussGrundCode.Properties.ShowFooter = false;
            this.edtAbschlussGrundCode.Properties.ShowHeader = false;
            this.edtAbschlussGrundCode.Properties.ValueMember = "Code";
            this.edtAbschlussGrundCode.Size = new System.Drawing.Size(300, 24);
            this.edtAbschlussGrundCode.TabIndex = 3;
            //
            // lblDatumVon
            //
            this.lblDatumVon.Location = new System.Drawing.Point(10, 118);
            this.lblDatumVon.Name = "lblDatumVon";
            this.lblDatumVon.Size = new System.Drawing.Size(81, 24);
            this.lblDatumVon.TabIndex = 5;
            this.lblDatumVon.Text = "Datum von";
            this.lblDatumVon.UseCompatibleTextRendering = true;
            //
            // lblDatumBis
            //
            this.lblDatumBis.Location = new System.Drawing.Point(10, 149);
            this.lblDatumBis.Name = "lblDatumBis";
            this.lblDatumBis.Size = new System.Drawing.Size(89, 24);
            this.lblDatumBis.TabIndex = 6;
            this.lblDatumBis.Text = "Datum bis";
            this.lblDatumBis.UseCompatibleTextRendering = true;
            //
            // memBemerkung
            //
            this.memBemerkung.DataMember = "Bemerkung";
            this.memBemerkung.DataSource = this.qryFaLeistung;
            this.memBemerkung.Location = new System.Drawing.Point(105, 322);
            this.memBemerkung.Name = "memBemerkung";
            this.memBemerkung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.memBemerkung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.memBemerkung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.memBemerkung.Properties.Appearance.Options.UseBackColor = true;
            this.memBemerkung.Properties.Appearance.Options.UseBorderColor = true;
            this.memBemerkung.Properties.Appearance.Options.UseFont = true;
            this.memBemerkung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.memBemerkung.Size = new System.Drawing.Size(530, 102);
            this.memBemerkung.TabIndex = 8;
            //
            // pnTitle
            //
            this.pnTitle.Controls.Add(this.picTitle);
            this.pnTitle.Controls.Add(this.lblTitel);
            this.pnTitle.Dock = System.Windows.Forms.DockStyle.Top;
            this.pnTitle.Location = new System.Drawing.Point(0, 0);
            this.pnTitle.Name = "pnTitle";
            this.pnTitle.Size = new System.Drawing.Size(646, 40);
            this.pnTitle.TabIndex = 9;
            //
            // lblTitel
            //
            this.lblTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitel.Location = new System.Drawing.Point(35, 10);
            this.lblTitel.Name = "lblTitel";
            this.lblTitel.Size = new System.Drawing.Size(500, 20);
            this.lblTitel.TabIndex = 1;
            this.lblTitel.Text = "KKBB";
            this.lblTitel.UseCompatibleTextRendering = true;
            //
            // picTitle
            //
            this.picTitle.Location = new System.Drawing.Point(10, 9);
            this.picTitle.Name = "picTitle";
            this.picTitle.Size = new System.Drawing.Size(25, 20);
            this.picTitle.TabIndex = 1;
            this.picTitle.TabStop = false;
            //
            // lblSAR
            //
            this.lblSAR.Location = new System.Drawing.Point(10, 88);
            this.lblSAR.Name = "lblSAR";
            this.lblSAR.Size = new System.Drawing.Size(81, 24);
            this.lblSAR.TabIndex = 11;
            this.lblSAR.Text = "zuständige SB";
            this.lblSAR.UseCompatibleTextRendering = true;
            //
            // edtSAR
            //
            this.edtSAR.DataMember = "LogonName";
            this.edtSAR.DataSource = this.qryFaLeistung;
            this.edtSAR.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtSAR.Location = new System.Drawing.Point(105, 88);
            this.edtSAR.Name = "edtSAR";
            this.edtSAR.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtSAR.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSAR.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSAR.Properties.Appearance.Options.UseBackColor = true;
            this.edtSAR.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSAR.Properties.Appearance.Options.UseFont = true;
            this.edtSAR.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtSAR.Properties.Name = "editSAR.Properties";
            this.edtSAR.Properties.ReadOnly = true;
            this.edtSAR.Size = new System.Drawing.Size(100, 24);
            this.edtSAR.TabIndex = 12;
            this.edtSAR.TabStop = false;
            //
            // lblEroeffnungsGrundCode
            //
            this.lblEroeffnungsGrundCode.Location = new System.Drawing.Point(229, 118);
            this.lblEroeffnungsGrundCode.Name = "lblEroeffnungsGrundCode";
            this.lblEroeffnungsGrundCode.Size = new System.Drawing.Size(100, 23);
            this.lblEroeffnungsGrundCode.TabIndex = 13;
            this.lblEroeffnungsGrundCode.Text = "Eröffnungsgrund";
            this.lblEroeffnungsGrundCode.UseCompatibleTextRendering = true;
            //
            // lblAbschlussGrundCode
            //
            this.lblAbschlussGrundCode.Location = new System.Drawing.Point(229, 148);
            this.lblAbschlussGrundCode.Name = "lblAbschlussGrundCode";
            this.lblAbschlussGrundCode.Size = new System.Drawing.Size(100, 23);
            this.lblAbschlussGrundCode.TabIndex = 14;
            this.lblAbschlussGrundCode.Text = "Abschlussgrund";
            this.lblAbschlussGrundCode.UseCompatibleTextRendering = true;
            //
            // lblBemerkung
            //
            this.lblBemerkung.Location = new System.Drawing.Point(10, 312);
            this.lblBemerkung.Name = "lblBemerkung";
            this.lblBemerkung.Size = new System.Drawing.Size(75, 24);
            this.lblBemerkung.TabIndex = 32;
            this.lblBemerkung.Text = "Bemerkung";
            this.lblBemerkung.UseCompatibleTextRendering = true;
            //
            // btnReopen
            //
            this.btnReopen.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnReopen.Location = new System.Drawing.Point(105, 443);
            this.btnReopen.Name = "btnReopen";
            this.btnReopen.Size = new System.Drawing.Size(147, 24);
            this.btnReopen.TabIndex = 33;
            this.btnReopen.Text = "Fall wieder öffnen";
            this.btnReopen.UseCompatibleTextRendering = true;
            this.btnReopen.UseVisualStyleBackColor = false;
            this.btnReopen.Click += new System.EventHandler(this.btnReopen_Click);
            //
            // edtPscdVertragsgegenstandID
            //
            this.edtPscdVertragsgegenstandID.DataMember = "PscdVertragsgegenstandID";
            this.edtPscdVertragsgegenstandID.DataSource = this.qryFaLeistung;
            this.edtPscdVertragsgegenstandID.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtPscdVertragsgegenstandID.Location = new System.Drawing.Point(560, 88);
            this.edtPscdVertragsgegenstandID.Name = "edtPscdVertragsgegenstandID";
            this.edtPscdVertragsgegenstandID.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtPscdVertragsgegenstandID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtPscdVertragsgegenstandID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtPscdVertragsgegenstandID.Properties.Appearance.Options.UseBackColor = true;
            this.edtPscdVertragsgegenstandID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtPscdVertragsgegenstandID.Properties.Appearance.Options.UseFont = true;
            this.edtPscdVertragsgegenstandID.Properties.Appearance.Options.UseTextOptions = true;
            this.edtPscdVertragsgegenstandID.Properties.Appearance.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.edtPscdVertragsgegenstandID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtPscdVertragsgegenstandID.Properties.ReadOnly = true;
            this.edtPscdVertragsgegenstandID.Size = new System.Drawing.Size(75, 24);
            this.edtPscdVertragsgegenstandID.TabIndex = 36;
            //
            // lblPscdVgId
            //
            this.lblPscdVgId.Location = new System.Drawing.Point(401, 88);
            this.lblPscdVgId.Name = "lblPscdVgId";
            this.lblPscdVgId.Size = new System.Drawing.Size(153, 24);
            this.lblPscdVgId.TabIndex = 37;
            this.lblPscdVgId.Text = "PSCD Vertragsgegenstand Nr";
            this.lblPscdVgId.UseCompatibleTextRendering = true;
            //
            // lblLT
            //
            this.lblLT.Location = new System.Drawing.Point(10, 188);
            this.lblLT.Name = "lblLT";
            this.lblLT.Size = new System.Drawing.Size(89, 24);
            this.lblLT.TabIndex = 38;
            this.lblLT.Text = "Gesuchsteller/in";
            this.lblLT.UseCompatibleTextRendering = true;
            //
            // memLT
            //
            this.memLT.DataMember = "Adresse";
            this.memLT.DataSource = this.qryAdresse;
            this.memLT.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.memLT.Location = new System.Drawing.Point(105, 188);
            this.memLT.Name = "memLT";
            this.memLT.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.memLT.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.memLT.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.memLT.Properties.Appearance.Options.UseBackColor = true;
            this.memLT.Properties.Appearance.Options.UseBorderColor = true;
            this.memLT.Properties.Appearance.Options.UseFont = true;
            this.memLT.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.memLT.Properties.ReadOnly = true;
            this.memLT.Size = new System.Drawing.Size(298, 113);
            this.memLT.TabIndex = 39;
            //
            // btnGenerateVGNr
            //
            this.btnGenerateVGNr.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnGenerateVGNr.Location = new System.Drawing.Point(313, 88);
            this.btnGenerateVGNr.Name = "btnGenerateVGNr";
            this.btnGenerateVGNr.Size = new System.Drawing.Size(82, 24);
            this.btnGenerateVGNr.TabIndex = 40;
            this.btnGenerateVGNr.Text = "VG-Nr lösen";
            this.btnGenerateVGNr.UseCompatibleTextRendering = true;
            this.btnGenerateVGNr.UseVisualStyleBackColor = false;
            this.btnGenerateVGNr.Click += new System.EventHandler(this.btnGenerateVGNr_Click);
            //
            // kissLabel1
            //
            this.kissLabel1.Location = new System.Drawing.Point(9, 59);
            this.kissLabel1.Name = "kissLabel1";
            this.kissLabel1.Size = new System.Drawing.Size(90, 24);
            this.kissLabel1.TabIndex = 41;
            this.kissLabel1.Text = "Leistung / Fall";
            this.kissLabel1.UseCompatibleTextRendering = true;
            //
            // edtFaLeistungID
            //
            this.edtFaLeistungID.DataMember = "FaLeistungID";
            this.edtFaLeistungID.DataSource = this.qryFaLeistung;
            this.edtFaLeistungID.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtFaLeistungID.Location = new System.Drawing.Point(105, 58);
            this.edtFaLeistungID.Name = "edtFaLeistungID";
            this.edtFaLeistungID.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtFaLeistungID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtFaLeistungID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtFaLeistungID.Properties.Appearance.Options.UseBackColor = true;
            this.edtFaLeistungID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtFaLeistungID.Properties.Appearance.Options.UseFont = true;
            this.edtFaLeistungID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtFaLeistungID.Properties.ReadOnly = true;
            this.edtFaLeistungID.Size = new System.Drawing.Size(100, 24);
            this.edtFaLeistungID.TabIndex = 42;
            //
            // kissTextEdit2
            //
            this.kissTextEdit2.DataMember = "FaFallID";
            this.kissTextEdit2.DataSource = this.qryFaLeistung;
            this.kissTextEdit2.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.kissTextEdit2.Location = new System.Drawing.Point(211, 58);
            this.kissTextEdit2.Name = "kissTextEdit2";
            this.kissTextEdit2.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.kissTextEdit2.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.kissTextEdit2.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.kissTextEdit2.Properties.Appearance.Options.UseBackColor = true;
            this.kissTextEdit2.Properties.Appearance.Options.UseBorderColor = true;
            this.kissTextEdit2.Properties.Appearance.Options.UseFont = true;
            this.kissTextEdit2.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.kissTextEdit2.Properties.ReadOnly = true;
            this.kissTextEdit2.Size = new System.Drawing.Size(100, 24);
            this.kissTextEdit2.TabIndex = 43;
            //
            // qryAdresse
            //
            this.qryAdresse.HostControl = this;
            this.qryAdresse.SelectStatement = resources.GetString("qryAdresse.SelectStatement");
            //
            // qryDatenKontrolle
            //
            this.qryDatenKontrolle.HostControl = this;
            this.qryDatenKontrolle.SelectStatement = resources.GetString("qryDatenKontrolle.SelectStatement");
            //
            // qryFaLeistung
            //
            this.qryFaLeistung.CanDelete = true;
            this.qryFaLeistung.CanUpdate = true;
            this.qryFaLeistung.HostControl = this;
            this.qryFaLeistung.SelectStatement = resources.GetString("qryFaLeistung.SelectStatement");
            this.qryFaLeistung.TableName = "FaLeistung";
            this.qryFaLeistung.AfterFill += new System.EventHandler(this.qryFaLeistung_AfterFill);
            this.qryFaLeistung.AfterDelete += new System.EventHandler(this.qryFaLeistung_AfterDelete);
            this.qryFaLeistung.BeforeDeleteQuestion += new System.EventHandler(this.qryFaLeistung_BeforeDeleteQuestion);
            this.qryFaLeistung.BeforePost += new System.EventHandler(this.qryFaLeistung_BeforePost);
            this.qryFaLeistung.AfterPost += new System.EventHandler(this.qryFaLeistung_AfterPost);
            //
            // CtlIkLeistungUebhKkbb
            //
            this.ActiveSQLQuery = this.qryFaLeistung;
            this.Controls.Add(this.kissTextEdit2);
            this.Controls.Add(this.edtFaLeistungID);
            this.Controls.Add(this.kissLabel1);
            this.Controls.Add(this.btnGenerateVGNr);
            this.Controls.Add(this.memLT);
            this.Controls.Add(this.lblLT);
            this.Controls.Add(this.lblPscdVgId);
            this.Controls.Add(this.edtPscdVertragsgegenstandID);
            this.Controls.Add(this.btnReopen);
            this.Controls.Add(this.lblBemerkung);
            this.Controls.Add(this.lblAbschlussGrundCode);
            this.Controls.Add(this.lblEroeffnungsGrundCode);
            this.Controls.Add(this.edtSAR);
            this.Controls.Add(this.lblSAR);
            this.Controls.Add(this.pnTitle);
            this.Controls.Add(this.memBemerkung);
            this.Controls.Add(this.lblDatumBis);
            this.Controls.Add(this.lblDatumVon);
            this.Controls.Add(this.edtAbschlussGrundCode);
            this.Controls.Add(this.edtDatumBis);
            this.Controls.Add(this.edtEroeffnungsGrundCode);
            this.Controls.Add(this.edtDatumVon);
            this.Name = "CtlIkLeistungUebhKkbb";
            this.Size = new System.Drawing.Size(646, 477);
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEroeffnungsGrundCode.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEroeffnungsGrundCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussGrundCode.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAbschlussGrundCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumVon)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumBis)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.memBemerkung.Properties)).EndInit();
            this.pnTitle.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.picTitle)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSAR)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSAR.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEroeffnungsGrundCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAbschlussGrundCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtPscdVertragsgegenstandID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblPscdVgId)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblLT)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.memLT.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtFaLeistungID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissTextEdit2.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryAdresse)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryDatenKontrolle)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryFaLeistung)).EndInit();
            this.ResumeLayout(false);
        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Private Properties

        // Letzte Bearbeitung
        // 03.04.2008 : sozheo : Neu
        // ------------------------------------------------------------------------------------------------
        private bool CanEdit
        {
            get
            {
                return (
                  qryFaLeistung.Count > 0 &&
                  qryFaLeistung.CanUpdate
                );
            }
        }

        #endregion

        #region Private Methods

        // Letzte Bearbeitung
        // 03.04.2008 : sozheo : Neu
        // 28.05.2008 : sozheo : btnGenerateVGNr einstellen
        // ------------------------------------------------------------------------------------------------
        private void SetEditMode()
        {
            qryFaLeistung.EnableBoundFields(CanEdit && DBUtil.IsEmpty(qryFaLeistung["DatumBis"]));

            btnGenerateVGNr.Enabled = CanEdit && DBUtil.IsEmpty(qryFaLeistung["DatumBis"]);

            btnReopen.Visible = (
          CanEdit &&
          (!DBUtil.IsEmpty(qryFaLeistung["DatumBis"])) &&
          DBUtil.UserHasRight("CtlIkLeistungUebhKkbb_FallWiederOeffnen")
            );
        }

        private void btnGenerateVGNr_Click(object sender, System.EventArgs e)
        {
            if (DBUtil.IsEmpty(qryFaLeistung["PscdVertragsgegenstandID"]))
            {
                if (!qryFaLeistung.Post()) return;
                qryFaLeistung["PscdVertragsgegenstandID"] = (long)DBUtil.ExecuteScalarSQLThrowingException("EXEC spKbGetBelegNr 'ALBV'");
                btnGenerateVGNr.Visible = false;
                qryFaLeistung.Post();
            }
        }

        private void btnReopen_Click(object sender, System.EventArgs e)
        {
            // Wir müssen prüfen, ob es auch eine offene Fallführung Alimentenstelle gibt, sonst darf das Bis-Datum nicht leer sein
            object obj = DBUtil.ExecuteScalarSQL("SELECT FaFallID FROM FaLeistung WHERE FaFallID = {0} AND FaProzessCode = 201 AND DatumBis IS NULL", qryFaLeistung["FaFallID"]);

            if (obj == null)
            {
                KissMsg.ShowInfo("Ohne aktive Fallführung Alimentenstelle kann diese Leistung nicht wieder eröffnet werden.");
                return;
            }

            qryFaLeistung["DatumBis"] = DBNull.Value;
            qryFaLeistung["AbschlussGrundCode"] = DBNull.Value;
            qryFaLeistung.Post("FaLeistung");

            FormController.SendMessage("FrmFall", "Action", "RefreshTree");

            //qryFaLeistung.CanUpdate = true;
            SetEditMode();
        }

        private void qryFaLeistung_AfterDelete(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 03.04.2008 : sozheo : Neu
            // ------------------------------------------------------------------------------------------------

            FormController.SendMessage("FrmFall", "Action", "RefreshTree");
        }

        private void qryFaLeistung_AfterFill(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 14.09.2007 : sozheo : Neu gemacht
            // ------------------------------------------------------------------------------------------------

            qryAdresse.Fill(Utils.ConvertToInt(qryFaLeistung["BaPersonID"]));
            SetEditMode();
            btnGenerateVGNr.Visible = lblPscdVgId.Visible && DBUtil.IsEmpty(qryFaLeistung["PscdVertragsgegenstandID"]);
            //if (qryFaLeistung.Count==0) qryFaLeistung_PositionChanged(sender, e);
        }

        private void qryFaLeistung_AfterPost(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 03.04.2008 : sozheo : Neu
            // ------------------------------------------------------------------------------------------------

            SetEditMode();
            FormController.SendMessage("FrmFall", "Action", "RefreshTree");
        }

        private void qryFaLeistung_BeforeDeleteQuestion(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 19.04.2008 : sozheo : Neu gemacht
            // 01.06.2008 : sozheo : Kontrolle PscdVertragsgegenstandID
            // 08.07.2008 : sozheo : Kontrolle PscdVertragsgegenstandID verbessert
            // ------------------------------------------------------------------------------------------------

            bool IstGesendet = false;
            SqlQuery qry = DBUtil.OpenSQL(@"
              select FaLeistungID from dbo.PscdSentFaLeistung with(readuncommitted) where FaLeistungID = {0}",
              qryFaLeistung["FaLeistungID"]
            );
            IstGesendet = (Utils.ConvertToInt(qry["FaLeistungID"]) > 0);

            if (IstGesendet)
            {
                KissMsg.ShowInfo(
                  "Dieses Inkasso hat bereits eine ans PSCD gesendete Vertragsgegenstandsnummer\r\n" +
                  "und kann deshalb nicht mehr gelöscht werden."
                );
                throw new KissCancelException();
            }

            qryDatenKontrolle.Fill(Utils.ConvertToInt(qryFaLeistung["FaLeistungID"]));
            if (Utils.ConvertToInt(qryFaLeistung["FaProzessCode"]) >= 406)
            {
                if (qryDatenKontrolle.Count > 0)
                {
                    if (Utils.ConvertToInt(qryFaLeistung["FaProzessCode"]) == 406)
                        KissMsg.ShowInfo(
                          "Dieses Inkasso hat bereits erfasste Daten.\r\n" +
                          "Löschen Sie zuerst alle Forderungen, alle Gläubiger und alle Rechtstitel."
                        );
                    else
                        KissMsg.ShowInfo(
                          "Dieses Inkasso hat bereits erfasste Daten.\r\n" +
                          "Löschen Sie zuerst alle Forderungen, alle Gläubiger und alle Bedingungen."
                        );
                    throw new KissCancelException();
                }
            }
            else
            {
                if (qryDatenKontrolle.Count > 0)
                {
                    KissMsg.ShowInfo(
                      "Diese Leistung hat bereits erfasste Daten.\r\n" +
                      "Löschen Sie zuerst alle Anspruchsberechnungen."
                    );
                    throw new KissCancelException();
                }
            }
        }

        private void qryFaLeistung_BeforePost(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 14.09.2007 : sozheo : Neu gemacht
            // 08.05.2008 : sozheo : Anpassungen für Leistung Anspruchsberechnung
            // ------------------------------------------------------------------------------------------------

            DBUtil.CheckNotNullField(edtDatumVon, lblDatumVon.Text);

            // Kontrollieren, dass Datum von kleiner als Datum bis ist:
            if (!DBUtil.IsEmpty(qryFaLeistung["DatumVon"]) && !DBUtil.IsEmpty(qryFaLeistung["DatumBis"]))
            {
                if ((DateTime)qryFaLeistung["DatumVon"] >= (DateTime)qryFaLeistung["DatumBis"])
                {
                    KissMsg.ShowInfo("CtlIkLeistungUebhKkbb", "DatumsFehler",
                      "Das Von-Datum muss kleiner sein als das Bis-Datum.");
                    throw new KissCancelException();
                }
            }

            if (
              edtAbschlussGrundCode.Visible &&
              !DBUtil.IsEmpty(qryFaLeistung["DatumBis"]) &&
              DBUtil.IsEmpty(qryFaLeistung["AbschlussGrundCode"])
            )
            {
                DBUtil.CheckNotNullField(edtAbschlussGrundCode, lblAbschlussGrundCode.Text);
            }

            if (DBUtil.IsEmpty(qryFaLeistung["DatumBis"]))
            {
                // EndDatum ist leer, d.h. die Leistung ist aktiv. Wir müssen prüfen, ob es auch ein offener Fall gibt, sonst darf das Bis-Datum nicht leer sein
                object obj = DBUtil.ExecuteScalarSQL("SELECT FaFallID FROM FaLeistung WHERE FaFallID = {0} AND FaProzessCode = 201 AND DatumBis IS NULL", qryFaLeistung["FaFallID"]);

                if (obj == null)
                {
                    throw new KissInfoException("Ohne aktive Fallführung Alimentenstelle kann diese Leistung nicht wieder eröffnet werden. Das Bis-Datum darf nicht leer sein.");
                }
            }
            else
            {
                string Msg = "";

                //Kontrolle: existieren offene Pendenzen?
                int countPendenzen = Utils.GetAnzahlOffenePendenzen((int)qryFaLeistung[DBO.FaLeistung.FaLeistungID]);
                if (countPendenzen > 0)
                {
                    Msg = string.Format(
                        "Es existieren {0} offene Pendenzen zu der abzuschliessenden Leistung.", countPendenzen);
                    KissMsg.ShowInfo(Msg);
                }
            }

            /*
            // Kontrollieren, dass es keine Überschneidungen im Datum gibt.
            int AktID = 0;
            if (!DBUtil.IsEmpty(qryFaLeistung["FaLeistungID"])) AktID = (int)qryFaLeistung["FaLeistungID"];

            string TmpSQL = "";
            TmpSQL += "SELECT DatumVon, DatumBis FROM FaLeistung ";
            TmpSQL += " WHERE FaFallNOT FaLeistungID=" + AktID.ToString();

            if (DBUtil.IsEmpty(qryBaWohnsitzAdresse["DatumVon"]) && DBUtil.IsEmpty(qryBaWohnsitzAdresse["DatumBis"]))
            {
              // Wenn beide Daten des aktuellen Datensatzes leer sind,
              // dann darf kein anderer Datensatz existieren:
            }
            else if ((!DBUtil.IsEmpty(qryBaWohnsitzAdresse["DatumVon"])) && DBUtil.IsEmpty(qryBaWohnsitzAdresse["DatumBis"]))
            {
              // Wenn Datum von nicht leer ist, DatumBis aber leer ist,
              // dann darf es kein anderer Datensatz geben,
              // bei welchem ein Datum grösser als das DatumVon des aktuellen Datensatzes ist:
              TmpSQL += string.Format(
                " and (DatumBis is NULL OR DatumVon >= '{0}' OR DatumBis >= '{0}') ",
                ((DateTime)qryBaWohnsitzAdresse["DatumVon"]).ToString("yyyyMMdd") );
            }
            else if (DBUtil.IsEmpty(qryBaWohnsitzAdresse["DatumVon"]) && (!DBUtil.IsEmpty(qryBaWohnsitzAdresse["DatumBis"])))
            {
              // Wenn Datum bis nicht leer ist, DatumVon aber leer ist,
              // dann darf es kein anderer Datensatz geben,
              // bei welchem ein Datum kleiner als das DatumBis des aktuellen Datensatzes ist:
              TmpSQL += string.Format(
                " and (DatumVon is NULL OR DatumVon <= '{0}' OR DatumBis <= '{0}') ",
                ((DateTime)qryBaWohnsitzAdresse["DatumVon"]).ToString("yyyyMMdd") );
            }
            else
            {
              // Wenn DatumBis und DatumVon nicht leer ist,
              // dann darf es keine Überschneidungen geben:
              TmpSQL += string.Format(
                " and ( (DatumVon <= '{1}' AND DatumBis is NULL) "+
                   "or (DatumBis >= '{0}' AND DatumVon is NULL) "+
                   "or (DatumBis >= '{0}' AND DatumBis <= '{1}') "+
                   "or (DatumVon >= '{0}' AND DatumVon <= '{1}') ) ",
                ((DateTime)qryBaWohnsitzAdresse["DatumVon"]).ToString("yyyyMMdd"),
                ((DateTime)qryBaWohnsitzAdresse["DatumBis"]).ToString("yyyyMMdd") );
            }

            SqlQuery qryDat = DBUtil.OpenSQL(TmpSQL);
            if (qryDat.Count>0)
            {
              string TmpMsg = "";
              if (!DBUtil.IsEmpty(qryDat["Strasse"]))
                TmpMsg += (string)qryDat["Strasse"] + "\r\n";
              TmpMsg += (string)qryDat["PLZ"] + " " + (string)qryDat["Ort"] + "\r\n\r\n";
              string[] MsgList = {TmpMsg};
              edtWohnsitzVon.Focus();
              KissMsg.ShowInfo("CtlIkLeistungUebhKkbb", "DatumsFehlerWohnsitz",
                "Es gibt mind. eine zeitliche Überschneidung, z.B. mit der Zeile:\r\n\r\n"+
                "{0}"+
                "Ändern Sie das Datum von oder Datum bis des aktuellen Datensatzes\r\n"+
                "oder ändern Sie zuerst das Von-Datum oder das Bis-Datum anderer Zeilen.",
                580, 240, MsgList);
              throw new KissCancelException();
            }
            */
        }

        #endregion
    }
}