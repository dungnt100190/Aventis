#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Drawing;
using KiSS4.Common;
using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Inkasso.ZH
{
    public class CtlIkMonatszahlenVerrechnung : KiSS4.Gui.KissUserControl
    {
        #region Fields

        // TODO RH : 
        // Neues Konzept für Annulation: alles aufhebene und neu rechnen? Liste annulierter? 
        private int FaFallID = 0;
        private int FallBaPersonID = 0;
        private bool GestartetVonRTitel = true;
        private int FaLeistungID = 0;
        private bool LeistungIstGeschlossen = true;
        private KiSS4.Gui.KissButton btnAnnullieren;
        private KiSS4.Gui.KissButton btnCalculate;
        private DevExpress.XtraGrid.Columns.GridColumn colPerson;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrDatumBis;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrGrundforderung;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrGueltigvon;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrMonatlicherBetrag;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrechnungsArt;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissDateEdit edtAnnulliertAm;
        private KiSS4.Gui.KissCheckEdit edtAnulliert;
        private KiSS4.Gui.KissLookUpEdit edtBaPersonID;
        private KiSS4.Gui.KissCalcEdit edtBetragProMonat;
        private KiSS4.Gui.KissDateEdit edtDatumBis;
        private KiSS4.Gui.KissDateEdit edtDatumVon;
        private KiSS4.Gui.KissCheckEdit edtEerledigt;
        private KiSS4.Gui.KissCalcEdit edtGrundforderung;
        private KiSS4.Gui.KissCalcEdit edtLetzterMonat;
        private KiSS4.Gui.KissDateEdit edtVereinbarungVom;
        private KiSS4.Gui.KissLookUpEdit edtVerrechnungsArt;
        private KiSS4.Gui.KissGrid grdVerrechnung;
        private DevExpress.XtraGrid.Views.Grid.GridView gvwVerrechnung;
        private KiSS4.Gui.KissLabel kissLabel1;
        private KiSS4.Gui.KissLabel lblAnnulliertAm;
        private KiSS4.Gui.KissLabel lblBaPersonID;
        private KiSS4.Gui.KissLabel lblBemerkungen;
        private KiSS4.Gui.KissLabel lblBetragProMonat;
        private KiSS4.Gui.KissLabel lblDatumVon;
        private KiSS4.Gui.KissLabel lblGrundforderung;
        private KiSS4.Gui.KissLabel lblGueltigBis;
        private KiSS4.Gui.KissLabel lblLetzterMonat;
        private KiSS4.Gui.KissLabel lblVereinbarung;
        private KiSS4.Gui.KissMemoEdit memBemerkungen;
        private KiSS4.DB.SqlQuery qryPerson;
        private KissLookUpEdit edtRechtstitel;
        private KissLabel lblRechtstitel;
        private SqlQuery qryRechtstitel;
        private DevExpress.XtraGrid.Columns.GridColumn colBezeichnung;
        public KiSS4.DB.SqlQuery qryVerrechnung;

        #endregion

        #region Constructors

        public CtlIkMonatszahlenVerrechnung()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject7 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject6 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject5 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlIkMonatszahlenVerrechnung));
            this.grdVerrechnung = new KiSS4.Gui.KissGrid();
            this.qryVerrechnung = new KiSS4.DB.SqlQuery(this.components);
            this.gvwVerrechnung = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colPerson = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrGrundforderung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrGueltigvon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrDatumBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrMonatlicherBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrechnungsArt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBezeichnung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.edtBaPersonID = new KiSS4.Gui.KissLookUpEdit();
            this.edtVereinbarungVom = new KiSS4.Gui.KissDateEdit();
            this.edtGrundforderung = new KiSS4.Gui.KissCalcEdit();
            this.edtBetragProMonat = new KiSS4.Gui.KissCalcEdit();
            this.edtVerrechnungsArt = new KiSS4.Gui.KissLookUpEdit();
            this.edtDatumVon = new KiSS4.Gui.KissDateEdit();
            this.memBemerkungen = new KiSS4.Gui.KissMemoEdit();
            this.btnCalculate = new KiSS4.Gui.KissButton();
            this.edtLetzterMonat = new KiSS4.Gui.KissCalcEdit();
            this.edtDatumBis = new KiSS4.Gui.KissDateEdit();
            this.lblGrundforderung = new KiSS4.Gui.KissLabel();
            this.lblBetragProMonat = new KiSS4.Gui.KissLabel();
            this.lblDatumVon = new KiSS4.Gui.KissLabel();
            this.lblGueltigBis = new KiSS4.Gui.KissLabel();
            this.lblBemerkungen = new KiSS4.Gui.KissLabel();
            this.lblVereinbarung = new KiSS4.Gui.KissLabel();
            this.lblBaPersonID = new KiSS4.Gui.KissLabel();
            this.lblLetzterMonat = new KiSS4.Gui.KissLabel();
            this.edtEerledigt = new KiSS4.Gui.KissCheckEdit();
            this.edtAnulliert = new KiSS4.Gui.KissCheckEdit();
            this.btnAnnullieren = new KiSS4.Gui.KissButton();
            this.edtAnnulliertAm = new KiSS4.Gui.KissDateEdit();
            this.lblAnnulliertAm = new KiSS4.Gui.KissLabel();
            this.kissLabel1 = new KiSS4.Gui.KissLabel();
            this.qryPerson = new KiSS4.DB.SqlQuery(this.components);
            this.lblRechtstitel = new KiSS4.Gui.KissLabel();
            this.edtRechtstitel = new KiSS4.Gui.KissLookUpEdit();
            this.qryRechtstitel = new KiSS4.DB.SqlQuery(this.components);
            ((System.ComponentModel.ISupportInitialize)(this.grdVerrechnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryVerrechnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwVerrechnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVereinbarungVom.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtGrundforderung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBetragProMonat.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerrechnungsArt)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerrechnungsArt.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.memBemerkungen.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtLetzterMonat.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGrundforderung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetragProMonat)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumVon)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGueltigBis)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkungen)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVereinbarung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblLetzterMonat)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEerledigt.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAnulliert.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAnnulliertAm.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAnnulliertAm)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryPerson)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRechtstitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRechtstitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRechtstitel.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryRechtstitel)).BeginInit();
            this.SuspendLayout();
            // 
            // grdVerrechnung
            // 
            this.grdVerrechnung.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdVerrechnung.DataSource = this.qryVerrechnung;
            this.grdVerrechnung.EmbeddedNavigator.Name = "";
            this.grdVerrechnung.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdVerrechnung.Location = new System.Drawing.Point(10, 10);
            this.grdVerrechnung.MainView = this.gvwVerrechnung;
            this.grdVerrechnung.Name = "grdVerrechnung";
            this.grdVerrechnung.Size = new System.Drawing.Size(670, 167);
            this.grdVerrechnung.TabIndex = 0;
            this.grdVerrechnung.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.gvwVerrechnung});
            // 
            // qryVerrechnung
            // 
            this.qryVerrechnung.CanDelete = true;
            this.qryVerrechnung.CanInsert = true;
            this.qryVerrechnung.CanUpdate = true;
            this.qryVerrechnung.HostControl = this;
            this.qryVerrechnung.SelectStatement = resources.GetString("qryVerrechnung.SelectStatement");
            this.qryVerrechnung.TableName = "IkVerrechnungskonto";
            this.qryVerrechnung.BeforePost += new System.EventHandler(this.qryVerrechnung_BeforePost);
            this.qryVerrechnung.PositionChanged += new System.EventHandler(this.qryVerrechnung_PositionChanged);
            this.qryVerrechnung.AfterFill += new System.EventHandler(this.qryVerrechnung_AfterFill);
            this.qryVerrechnung.AfterInsert += new System.EventHandler(this.qryVerrechnung_AfterInsert);
            this.qryVerrechnung.AfterPost += new System.EventHandler(this.qryVerrechnung_AfterPost);
            this.qryVerrechnung.AfterDelete += new System.EventHandler(this.qryVerrechnung_AfterDelete);
            // 
            // gvwVerrechnung
            // 
            this.gvwVerrechnung.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gvwVerrechnung.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwVerrechnung.Appearance.Empty.Options.UseBackColor = true;
            this.gvwVerrechnung.Appearance.Empty.Options.UseFont = true;
            this.gvwVerrechnung.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwVerrechnung.Appearance.EvenRow.Options.UseFont = true;
            this.gvwVerrechnung.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwVerrechnung.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwVerrechnung.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gvwVerrechnung.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gvwVerrechnung.Appearance.FocusedCell.Options.UseFont = true;
            this.gvwVerrechnung.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gvwVerrechnung.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwVerrechnung.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwVerrechnung.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gvwVerrechnung.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gvwVerrechnung.Appearance.FocusedRow.Options.UseFont = true;
            this.gvwVerrechnung.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gvwVerrechnung.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwVerrechnung.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gvwVerrechnung.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwVerrechnung.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwVerrechnung.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwVerrechnung.Appearance.GroupRow.Options.UseBackColor = true;
            this.gvwVerrechnung.Appearance.GroupRow.Options.UseFont = true;
            this.gvwVerrechnung.Appearance.GroupRow.Options.UseForeColor = true;
            this.gvwVerrechnung.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gvwVerrechnung.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gvwVerrechnung.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwVerrechnung.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gvwVerrechnung.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gvwVerrechnung.Appearance.HeaderPanel.Options.UseFont = true;
            this.gvwVerrechnung.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gvwVerrechnung.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwVerrechnung.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwVerrechnung.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gvwVerrechnung.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gvwVerrechnung.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gvwVerrechnung.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gvwVerrechnung.Appearance.HorzLine.Options.UseBackColor = true;
            this.gvwVerrechnung.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwVerrechnung.Appearance.OddRow.Options.UseFont = true;
            this.gvwVerrechnung.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gvwVerrechnung.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwVerrechnung.Appearance.Row.Options.UseBackColor = true;
            this.gvwVerrechnung.Appearance.Row.Options.UseFont = true;
            this.gvwVerrechnung.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwVerrechnung.Appearance.SelectedRow.Options.UseFont = true;
            this.gvwVerrechnung.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gvwVerrechnung.Appearance.VertLine.Options.UseBackColor = true;
            this.gvwVerrechnung.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gvwVerrechnung.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colPerson,
            this.colVerrGrundforderung,
            this.colVerrGueltigvon,
            this.colVerrDatumBis,
            this.colVerrMonatlicherBetrag,
            this.colVerrechnungsArt,
            this.colBezeichnung});
            this.gvwVerrechnung.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gvwVerrechnung.GridControl = this.grdVerrechnung;
            this.gvwVerrechnung.GroupPanelText = "zu gruppierende Kolonnen in diesen Bereich ziehen";
            this.gvwVerrechnung.Name = "gvwVerrechnung";
            this.gvwVerrechnung.OptionsBehavior.Editable = false;
            this.gvwVerrechnung.OptionsCustomization.AllowFilter = false;
            this.gvwVerrechnung.OptionsFilter.AllowFilterEditor = false;
            this.gvwVerrechnung.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gvwVerrechnung.OptionsMenu.EnableColumnMenu = false;
            this.gvwVerrechnung.OptionsNavigation.AutoFocusNewRow = true;
            this.gvwVerrechnung.OptionsNavigation.UseTabKey = false;
            this.gvwVerrechnung.OptionsView.ColumnAutoWidth = false;
            this.gvwVerrechnung.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gvwVerrechnung.OptionsView.ShowGroupPanel = false;
            this.gvwVerrechnung.OptionsView.ShowIndicator = false;
            this.gvwVerrechnung.CustomDrawCell += new DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventHandler(this.gvwVerrechnung_CustomDrawCell);
            // 
            // colPerson
            // 
            this.colPerson.Caption = "Gläubiger/in";
            this.colPerson.FieldName = "Person";
            this.colPerson.Name = "colPerson";
            this.colPerson.Visible = true;
            this.colPerson.VisibleIndex = 0;
            this.colPerson.Width = 153;
            // 
            // colVerrGrundforderung
            // 
            this.colVerrGrundforderung.AppearanceHeader.Options.UseTextOptions = true;
            this.colVerrGrundforderung.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVerrGrundforderung.Caption = "Grundford.";
            this.colVerrGrundforderung.DisplayFormat.FormatString = "N2";
            this.colVerrGrundforderung.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colVerrGrundforderung.FieldName = "Grundforderung";
            this.colVerrGrundforderung.Name = "colVerrGrundforderung";
            this.colVerrGrundforderung.Visible = true;
            this.colVerrGrundforderung.VisibleIndex = 1;
            this.colVerrGrundforderung.Width = 79;
            // 
            // colVerrGueltigvon
            // 
            this.colVerrGueltigvon.Caption = "Dauer von";
            this.colVerrGueltigvon.DisplayFormat.FormatString = "MM.yyyy";
            this.colVerrGueltigvon.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colVerrGueltigvon.FieldName = "DatumVon";
            this.colVerrGueltigvon.Name = "colVerrGueltigvon";
            this.colVerrGueltigvon.Visible = true;
            this.colVerrGueltigvon.VisibleIndex = 2;
            this.colVerrGueltigvon.Width = 83;
            // 
            // colVerrDatumBis
            // 
            this.colVerrDatumBis.Caption = "Dauer bis";
            this.colVerrDatumBis.DisplayFormat.FormatString = "MM.yyyy";
            this.colVerrDatumBis.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colVerrDatumBis.FieldName = "DatumBis";
            this.colVerrDatumBis.Name = "colVerrDatumBis";
            this.colVerrDatumBis.Visible = true;
            this.colVerrDatumBis.VisibleIndex = 3;
            this.colVerrDatumBis.Width = 73;
            // 
            // colVerrMonatlicherBetrag
            // 
            this.colVerrMonatlicherBetrag.AppearanceHeader.Options.UseTextOptions = true;
            this.colVerrMonatlicherBetrag.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVerrMonatlicherBetrag.Caption = "Monatl Betrag";
            this.colVerrMonatlicherBetrag.DisplayFormat.FormatString = "N2";
            this.colVerrMonatlicherBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colVerrMonatlicherBetrag.FieldName = "BetragProMonat";
            this.colVerrMonatlicherBetrag.Name = "colVerrMonatlicherBetrag";
            this.colVerrMonatlicherBetrag.OptionsFilter.AllowAutoFilter = false;
            this.colVerrMonatlicherBetrag.OptionsFilter.AllowFilter = false;
            this.colVerrMonatlicherBetrag.Visible = true;
            this.colVerrMonatlicherBetrag.VisibleIndex = 4;
            this.colVerrMonatlicherBetrag.Width = 92;
            // 
            // colVerrechnungsArt
            // 
            this.colVerrechnungsArt.Caption = "Art";
            this.colVerrechnungsArt.FieldName = "IkVerrechnungsartCode";
            this.colVerrechnungsArt.Name = "colVerrechnungsArt";
            this.colVerrechnungsArt.Visible = true;
            this.colVerrechnungsArt.VisibleIndex = 5;
            this.colVerrechnungsArt.Width = 179;
            // 
            // colBezeichnung
            // 
            this.colBezeichnung.Caption = "Rechtstitel";
            this.colBezeichnung.FieldName = "Bezeichnung";
            this.colBezeichnung.Name = "colBezeichnung";
            this.colBezeichnung.OptionsColumn.AllowEdit = false;
            this.colBezeichnung.Visible = true;
            this.colBezeichnung.VisibleIndex = 6;
            this.colBezeichnung.Width = 120;
            // 
            // edtBaPersonID
            // 
            this.edtBaPersonID.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBaPersonID.DataMember = "BaPersonID";
            this.edtBaPersonID.DataSource = this.qryVerrechnung;
            this.edtBaPersonID.Location = new System.Drawing.Point(136, 222);
            this.edtBaPersonID.Name = "edtBaPersonID";
            this.edtBaPersonID.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBaPersonID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBaPersonID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaPersonID.Properties.Appearance.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBaPersonID.Properties.Appearance.Options.UseFont = true;
            this.edtBaPersonID.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtBaPersonID.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaPersonID.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtBaPersonID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject7.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject7.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject7)});
            this.edtBaPersonID.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBaPersonID.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text", "Text", 20, DevExpress.Utils.FormatType.None, "", true, DevExpress.Utils.HorzAlignment.Default, DevExpress.Data.ColumnSortOrder.None)});
            this.edtBaPersonID.Properties.DisplayMember = "Text";
            this.edtBaPersonID.Properties.NullText = "";
            this.edtBaPersonID.Properties.ShowFooter = false;
            this.edtBaPersonID.Properties.ShowHeader = false;
            this.edtBaPersonID.Properties.ValueMember = "BaPersonID";
            this.edtBaPersonID.Size = new System.Drawing.Size(471, 24);
            this.edtBaPersonID.TabIndex = 1;
            // 
            // edtVereinbarungVom
            // 
            this.edtVereinbarungVom.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtVereinbarungVom.DataMember = "VereinbarungVom";
            this.edtVereinbarungVom.DataSource = this.qryVerrechnung;
            this.edtVereinbarungVom.EditValue = null;
            this.edtVereinbarungVom.Location = new System.Drawing.Point(136, 252);
            this.edtVereinbarungVom.Name = "edtVereinbarungVom";
            this.edtVereinbarungVom.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtVereinbarungVom.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtVereinbarungVom.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtVereinbarungVom.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtVereinbarungVom.Properties.Appearance.Options.UseBackColor = true;
            this.edtVereinbarungVom.Properties.Appearance.Options.UseBorderColor = true;
            this.edtVereinbarungVom.Properties.Appearance.Options.UseFont = true;
            this.edtVereinbarungVom.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject6.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject6.Options.UseBackColor = true;
            this.edtVereinbarungVom.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtVereinbarungVom.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject6)});
            this.edtVereinbarungVom.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtVereinbarungVom.Properties.ShowToday = false;
            this.edtVereinbarungVom.Size = new System.Drawing.Size(100, 24);
            this.edtVereinbarungVom.TabIndex = 2;
            // 
            // edtGrundforderung
            // 
            this.edtGrundforderung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtGrundforderung.DataMember = "Grundforderung";
            this.edtGrundforderung.DataSource = this.qryVerrechnung;
            this.edtGrundforderung.Location = new System.Drawing.Point(136, 282);
            this.edtGrundforderung.Name = "edtGrundforderung";
            this.edtGrundforderung.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtGrundforderung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtGrundforderung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtGrundforderung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtGrundforderung.Properties.Appearance.Options.UseBackColor = true;
            this.edtGrundforderung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtGrundforderung.Properties.Appearance.Options.UseFont = true;
            this.edtGrundforderung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtGrundforderung.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtGrundforderung.Properties.DisplayFormat.FormatString = "n2";
            this.edtGrundforderung.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtGrundforderung.Properties.EditFormat.FormatString = "n2";
            this.edtGrundforderung.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtGrundforderung.Properties.Mask.EditMask = "n2";
            this.edtGrundforderung.Size = new System.Drawing.Size(100, 24);
            this.edtGrundforderung.TabIndex = 3;
            this.edtGrundforderung.EditValueChanged += new System.EventHandler(this.edtGrundforderung_EditValueChanged);
            // 
            // edtBetragProMonat
            // 
            this.edtBetragProMonat.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBetragProMonat.DataMember = "BetragProMonat";
            this.edtBetragProMonat.DataSource = this.qryVerrechnung;
            this.edtBetragProMonat.Location = new System.Drawing.Point(136, 312);
            this.edtBetragProMonat.Name = "edtBetragProMonat";
            this.edtBetragProMonat.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtBetragProMonat.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBetragProMonat.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBetragProMonat.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBetragProMonat.Properties.Appearance.Options.UseBackColor = true;
            this.edtBetragProMonat.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBetragProMonat.Properties.Appearance.Options.UseFont = true;
            this.edtBetragProMonat.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBetragProMonat.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBetragProMonat.Properties.DisplayFormat.FormatString = "n2";
            this.edtBetragProMonat.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtBetragProMonat.Properties.EditFormat.FormatString = "n2";
            this.edtBetragProMonat.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtBetragProMonat.Properties.Mask.EditMask = "n2";
            this.edtBetragProMonat.Size = new System.Drawing.Size(100, 24);
            this.edtBetragProMonat.TabIndex = 4;
            this.edtBetragProMonat.EditValueChanged += new System.EventHandler(this.edtBetragProMonat_EditValueChanged);
            // 
            // edtVerrechnungsArt
            // 
            this.edtVerrechnungsArt.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtVerrechnungsArt.DataMember = "IkVerrechnungsartCode";
            this.edtVerrechnungsArt.DataSource = this.qryVerrechnung;
            this.edtVerrechnungsArt.Location = new System.Drawing.Point(338, 252);
            this.edtVerrechnungsArt.LOVName = "IkVerrechnungsArt";
            this.edtVerrechnungsArt.Name = "edtVerrechnungsArt";
            this.edtVerrechnungsArt.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtVerrechnungsArt.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtVerrechnungsArt.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtVerrechnungsArt.Properties.Appearance.Options.UseBackColor = true;
            this.edtVerrechnungsArt.Properties.Appearance.Options.UseBorderColor = true;
            this.edtVerrechnungsArt.Properties.Appearance.Options.UseFont = true;
            this.edtVerrechnungsArt.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtVerrechnungsArt.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtVerrechnungsArt.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtVerrechnungsArt.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtVerrechnungsArt.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject5.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject5.Options.UseBackColor = true;
            this.edtVerrechnungsArt.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject5)});
            this.edtVerrechnungsArt.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtVerrechnungsArt.Properties.NullText = "";
            this.edtVerrechnungsArt.Properties.ShowFooter = false;
            this.edtVerrechnungsArt.Properties.ShowHeader = false;
            this.edtVerrechnungsArt.Size = new System.Drawing.Size(269, 24);
            this.edtVerrechnungsArt.TabIndex = 5;
            // 
            // edtDatumVon
            // 
            this.edtDatumVon.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtDatumVon.DataMember = "DatumVon";
            this.edtDatumVon.DataSource = this.qryVerrechnung;
            this.edtDatumVon.EditValue = null;
            this.edtDatumVon.Location = new System.Drawing.Point(338, 282);
            this.edtDatumVon.Name = "edtDatumVon";
            this.edtDatumVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtDatumVon.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumVon.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseFont = true;
            this.edtDatumVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            this.edtDatumVon.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDatumVon.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4)});
            this.edtDatumVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumVon.Properties.DisplayFormat.FormatString = "MM.yyyy";
            this.edtDatumVon.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumVon.Properties.EditFormat.FormatString = "MM.yyyy";
            this.edtDatumVon.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumVon.Properties.Mask.EditMask = "MM.yyyy";
            this.edtDatumVon.Properties.ShowToday = false;
            this.edtDatumVon.Size = new System.Drawing.Size(82, 24);
            this.edtDatumVon.TabIndex = 6;
            this.edtDatumVon.EditValueChanged += new System.EventHandler(this.edtDatumVon_EditValueChanged);
            // 
            // memBemerkungen
            // 
            this.memBemerkungen.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.memBemerkungen.DataMember = "Bemerkung";
            this.memBemerkungen.DataSource = this.qryVerrechnung;
            this.memBemerkungen.Location = new System.Drawing.Point(136, 342);
            this.memBemerkungen.Name = "memBemerkungen";
            this.memBemerkungen.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.memBemerkungen.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.memBemerkungen.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.memBemerkungen.Properties.Appearance.Options.UseBackColor = true;
            this.memBemerkungen.Properties.Appearance.Options.UseBorderColor = true;
            this.memBemerkungen.Properties.Appearance.Options.UseFont = true;
            this.memBemerkungen.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.memBemerkungen.Size = new System.Drawing.Size(471, 77);
            this.memBemerkungen.TabIndex = 7;
            // 
            // btnCalculate
            // 
            this.btnCalculate.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.btnCalculate.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnCalculate.Location = new System.Drawing.Point(525, 282);
            this.btnCalculate.Name = "btnCalculate";
            this.btnCalculate.Size = new System.Drawing.Size(82, 24);
            this.btnCalculate.TabIndex = 8;
            this.btnCalculate.Text = "berechnen";
            this.btnCalculate.UseCompatibleTextRendering = true;
            this.btnCalculate.UseVisualStyleBackColor = false;
            this.btnCalculate.Click += new System.EventHandler(this.btnCalculate_Click);
            // 
            // edtLetzterMonat
            // 
            this.edtLetzterMonat.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtLetzterMonat.DataMember = "LetzterMonat";
            this.edtLetzterMonat.DataSource = this.qryVerrechnung;
            this.edtLetzterMonat.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtLetzterMonat.Location = new System.Drawing.Point(525, 312);
            this.edtLetzterMonat.Name = "edtLetzterMonat";
            this.edtLetzterMonat.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtLetzterMonat.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtLetzterMonat.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtLetzterMonat.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtLetzterMonat.Properties.Appearance.Options.UseBackColor = true;
            this.edtLetzterMonat.Properties.Appearance.Options.UseBorderColor = true;
            this.edtLetzterMonat.Properties.Appearance.Options.UseFont = true;
            this.edtLetzterMonat.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtLetzterMonat.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtLetzterMonat.Properties.DisplayFormat.FormatString = "n2";
            this.edtLetzterMonat.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtLetzterMonat.Properties.EditFormat.FormatString = "n2";
            this.edtLetzterMonat.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtLetzterMonat.Properties.Mask.EditMask = "n2";
            this.edtLetzterMonat.Properties.ReadOnly = true;
            this.edtLetzterMonat.Size = new System.Drawing.Size(82, 24);
            this.edtLetzterMonat.TabIndex = 34;
            this.edtLetzterMonat.TabStop = false;
            // 
            // edtDatumBis
            // 
            this.edtDatumBis.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtDatumBis.DataMember = "DatumBis";
            this.edtDatumBis.DataSource = this.qryVerrechnung;
            this.edtDatumBis.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtDatumBis.EditValue = null;
            this.edtDatumBis.Location = new System.Drawing.Point(338, 312);
            this.edtDatumBis.Name = "edtDatumBis";
            this.edtDatumBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtDatumBis.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtDatumBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseFont = true;
            this.edtDatumBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            this.edtDatumBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDatumBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3)});
            this.edtDatumBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumBis.Properties.DisplayFormat.FormatString = "MM.yyyy";
            this.edtDatumBis.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumBis.Properties.EditFormat.FormatString = "MM.yyyy";
            this.edtDatumBis.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumBis.Properties.Mask.EditMask = "MM.yyyy";
            this.edtDatumBis.Properties.ReadOnly = true;
            this.edtDatumBis.Properties.ShowToday = false;
            this.edtDatumBis.Size = new System.Drawing.Size(82, 24);
            this.edtDatumBis.TabIndex = 40;
            this.edtDatumBis.TabStop = false;
            // 
            // lblGrundforderung
            // 
            this.lblGrundforderung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblGrundforderung.Location = new System.Drawing.Point(10, 282);
            this.lblGrundforderung.Name = "lblGrundforderung";
            this.lblGrundforderung.Size = new System.Drawing.Size(110, 24);
            this.lblGrundforderung.TabIndex = 43;
            this.lblGrundforderung.Text = "Grundforderung";
            this.lblGrundforderung.UseCompatibleTextRendering = true;
            // 
            // lblBetragProMonat
            // 
            this.lblBetragProMonat.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblBetragProMonat.Location = new System.Drawing.Point(10, 312);
            this.lblBetragProMonat.Name = "lblBetragProMonat";
            this.lblBetragProMonat.Size = new System.Drawing.Size(110, 24);
            this.lblBetragProMonat.TabIndex = 44;
            this.lblBetragProMonat.Text = "Monatlicher Betrag";
            this.lblBetragProMonat.UseCompatibleTextRendering = true;
            // 
            // lblDatumVon
            // 
            this.lblDatumVon.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblDatumVon.Location = new System.Drawing.Point(269, 282);
            this.lblDatumVon.Name = "lblDatumVon";
            this.lblDatumVon.Size = new System.Drawing.Size(63, 24);
            this.lblDatumVon.TabIndex = 45;
            this.lblDatumVon.Text = "Dauer von";
            this.lblDatumVon.UseCompatibleTextRendering = true;
            // 
            // lblGueltigBis
            // 
            this.lblGueltigBis.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblGueltigBis.Location = new System.Drawing.Point(269, 312);
            this.lblGueltigBis.Name = "lblGueltigBis";
            this.lblGueltigBis.Size = new System.Drawing.Size(63, 24);
            this.lblGueltigBis.TabIndex = 46;
            this.lblGueltigBis.Text = "Dauer  bis";
            this.lblGueltigBis.UseCompatibleTextRendering = true;
            // 
            // lblBemerkungen
            // 
            this.lblBemerkungen.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblBemerkungen.Location = new System.Drawing.Point(10, 342);
            this.lblBemerkungen.Name = "lblBemerkungen";
            this.lblBemerkungen.Size = new System.Drawing.Size(100, 23);
            this.lblBemerkungen.TabIndex = 47;
            this.lblBemerkungen.Text = "Bemerkung";
            this.lblBemerkungen.UseCompatibleTextRendering = true;
            // 
            // lblVereinbarung
            // 
            this.lblVereinbarung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblVereinbarung.Location = new System.Drawing.Point(10, 252);
            this.lblVereinbarung.Name = "lblVereinbarung";
            this.lblVereinbarung.Size = new System.Drawing.Size(101, 24);
            this.lblVereinbarung.TabIndex = 48;
            this.lblVereinbarung.Text = "Verfügung vom";
            this.lblVereinbarung.UseCompatibleTextRendering = true;
            // 
            // lblBaPersonID
            // 
            this.lblBaPersonID.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblBaPersonID.Location = new System.Drawing.Point(10, 222);
            this.lblBaPersonID.Name = "lblBaPersonID";
            this.lblBaPersonID.Size = new System.Drawing.Size(112, 24);
            this.lblBaPersonID.TabIndex = 49;
            this.lblBaPersonID.Text = "Gläubiger/in";
            this.lblBaPersonID.UseCompatibleTextRendering = true;
            // 
            // lblLetzterMonat
            // 
            this.lblLetzterMonat.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblLetzterMonat.Location = new System.Drawing.Point(442, 312);
            this.lblLetzterMonat.Name = "lblLetzterMonat";
            this.lblLetzterMonat.Size = new System.Drawing.Size(77, 24);
            this.lblLetzterMonat.TabIndex = 50;
            this.lblLetzterMonat.Text = "Letzter Monat";
            this.lblLetzterMonat.UseCompatibleTextRendering = true;
            // 
            // edtEerledigt
            // 
            this.edtEerledigt.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtEerledigt.DataMember = "IstErledigt";
            this.edtEerledigt.DataSource = this.qryVerrechnung;
            this.edtEerledigt.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtEerledigt.Location = new System.Drawing.Point(239, 455);
            this.edtEerledigt.Name = "edtEerledigt";
            this.edtEerledigt.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtEerledigt.Properties.Appearance.Options.UseBackColor = true;
            this.edtEerledigt.Properties.Caption = "ganz erledigt";
            this.edtEerledigt.Properties.ReadOnly = true;
            this.edtEerledigt.Size = new System.Drawing.Size(117, 19);
            this.edtEerledigt.TabIndex = 53;
            this.edtEerledigt.TabStop = false;
            // 
            // edtAnulliert
            // 
            this.edtAnulliert.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtAnulliert.DataMember = "IstAnnulliert";
            this.edtAnulliert.DataSource = this.qryVerrechnung;
            this.edtAnulliert.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtAnulliert.Location = new System.Drawing.Point(239, 430);
            this.edtAnulliert.Name = "edtAnulliert";
            this.edtAnulliert.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtAnulliert.Properties.Appearance.Options.UseBackColor = true;
            this.edtAnulliert.Properties.Caption = "Verrechnung ist annulliert";
            this.edtAnulliert.Properties.ReadOnly = true;
            this.edtAnulliert.Size = new System.Drawing.Size(155, 19);
            this.edtAnulliert.TabIndex = 54;
            this.edtAnulliert.TabStop = false;
            this.edtAnulliert.Visible = false;
            // 
            // btnAnnullieren
            // 
            this.btnAnnullieren.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.btnAnnullieren.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnAnnullieren.Location = new System.Drawing.Point(136, 425);
            this.btnAnnullieren.Name = "btnAnnullieren";
            this.btnAnnullieren.Size = new System.Drawing.Size(90, 24);
            this.btnAnnullieren.TabIndex = 55;
            this.btnAnnullieren.TabStop = false;
            this.btnAnnullieren.Text = "Annullieren";
            this.btnAnnullieren.UseCompatibleTextRendering = true;
            this.btnAnnullieren.UseVisualStyleBackColor = true;
            this.btnAnnullieren.Visible = false;
            this.btnAnnullieren.Click += new System.EventHandler(this.btnAnnullieren_Click);
            // 
            // edtAnnulliertAm
            // 
            this.edtAnnulliertAm.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtAnnulliertAm.DataMember = "AnnulliertAm";
            this.edtAnnulliertAm.DataSource = this.qryVerrechnung;
            this.edtAnnulliertAm.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtAnnulliertAm.EditValue = null;
            this.edtAnnulliertAm.Location = new System.Drawing.Point(494, 425);
            this.edtAnnulliertAm.Name = "edtAnnulliertAm";
            this.edtAnnulliertAm.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtAnnulliertAm.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtAnnulliertAm.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAnnulliertAm.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAnnulliertAm.Properties.Appearance.Options.UseBackColor = true;
            this.edtAnnulliertAm.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAnnulliertAm.Properties.Appearance.Options.UseFont = true;
            this.edtAnnulliertAm.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtAnnulliertAm.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtAnnulliertAm.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtAnnulliertAm.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtAnnulliertAm.Properties.ReadOnly = true;
            this.edtAnnulliertAm.Properties.ShowToday = false;
            this.edtAnnulliertAm.Size = new System.Drawing.Size(113, 24);
            this.edtAnnulliertAm.TabIndex = 57;
            this.edtAnnulliertAm.TabStop = false;
            this.edtAnnulliertAm.Visible = false;
            // 
            // lblAnnulliertAm
            // 
            this.lblAnnulliertAm.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblAnnulliertAm.Location = new System.Drawing.Point(423, 425);
            this.lblAnnulliertAm.Name = "lblAnnulliertAm";
            this.lblAnnulliertAm.Size = new System.Drawing.Size(65, 24);
            this.lblAnnulliertAm.TabIndex = 58;
            this.lblAnnulliertAm.Text = "annulliert am";
            this.lblAnnulliertAm.UseCompatibleTextRendering = true;
            this.lblAnnulliertAm.Visible = false;
            // 
            // kissLabel1
            // 
            this.kissLabel1.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.kissLabel1.Location = new System.Drawing.Point(267, 252);
            this.kissLabel1.Name = "kissLabel1";
            this.kissLabel1.Size = new System.Drawing.Size(65, 24);
            this.kissLabel1.TabIndex = 60;
            this.kissLabel1.Text = "Art";
            this.kissLabel1.UseCompatibleTextRendering = true;
            // 
            // qryPerson
            // 
            this.qryPerson.HostControl = this;
            this.qryPerson.SelectStatement = resources.GetString("qryPerson.SelectStatement");
            // 
            // lblRechtstitel
            // 
            this.lblRechtstitel.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblRechtstitel.Location = new System.Drawing.Point(10, 192);
            this.lblRechtstitel.Name = "lblRechtstitel";
            this.lblRechtstitel.Size = new System.Drawing.Size(112, 24);
            this.lblRechtstitel.TabIndex = 61;
            this.lblRechtstitel.Text = "Rechtstitel";
            this.lblRechtstitel.UseCompatibleTextRendering = true;
            // 
            // edtRechtstitel
            // 
            this.edtRechtstitel.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtRechtstitel.DataMember = "IkRechtstitelID";
            this.edtRechtstitel.DataSource = this.qryVerrechnung;
            this.edtRechtstitel.Location = new System.Drawing.Point(136, 192);
            this.edtRechtstitel.Name = "edtRechtstitel";
            this.edtRechtstitel.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtRechtstitel.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtRechtstitel.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtRechtstitel.Properties.Appearance.Options.UseBackColor = true;
            this.edtRechtstitel.Properties.Appearance.Options.UseBorderColor = true;
            this.edtRechtstitel.Properties.Appearance.Options.UseFont = true;
            this.edtRechtstitel.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtRechtstitel.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtRechtstitel.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtRechtstitel.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtRechtstitel.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtRechtstitel.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtRechtstitel.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtRechtstitel.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Name", "Name", 20, DevExpress.Utils.FormatType.None, "", true, DevExpress.Utils.HorzAlignment.Default, DevExpress.Data.ColumnSortOrder.None)});
            this.edtRechtstitel.Properties.DataSource = this.qryRechtstitel;
            this.edtRechtstitel.Properties.DisplayMember = "Name";
            this.edtRechtstitel.Properties.NullText = "";
            this.edtRechtstitel.Properties.ShowFooter = false;
            this.edtRechtstitel.Properties.ShowHeader = false;
            this.edtRechtstitel.Properties.ValueMember = "IkRechtstitelID";
            this.edtRechtstitel.Size = new System.Drawing.Size(471, 24);
            this.edtRechtstitel.TabIndex = 62;
            this.edtRechtstitel.EditValueChanged += new System.EventHandler(this.edtRechtstitel_EditValueChanged);
            // 
            // qryRechtstitel
            // 
            this.qryRechtstitel.HostControl = this;
            this.qryRechtstitel.SelectStatement = resources.GetString("qryRechtstitel.SelectStatement");
            // 
            // CtlIkMonatszahlenVerrechnung
            // 
            this.ActiveSQLQuery = this.qryVerrechnung;
            this.Controls.Add(this.edtRechtstitel);
            this.Controls.Add(this.lblRechtstitel);
            this.Controls.Add(this.kissLabel1);
            this.Controls.Add(this.lblAnnulliertAm);
            this.Controls.Add(this.edtAnnulliertAm);
            this.Controls.Add(this.btnAnnullieren);
            this.Controls.Add(this.edtAnulliert);
            this.Controls.Add(this.edtEerledigt);
            this.Controls.Add(this.lblLetzterMonat);
            this.Controls.Add(this.lblBaPersonID);
            this.Controls.Add(this.lblVereinbarung);
            this.Controls.Add(this.lblBemerkungen);
            this.Controls.Add(this.lblGueltigBis);
            this.Controls.Add(this.lblDatumVon);
            this.Controls.Add(this.lblBetragProMonat);
            this.Controls.Add(this.lblGrundforderung);
            this.Controls.Add(this.edtDatumBis);
            this.Controls.Add(this.edtLetzterMonat);
            this.Controls.Add(this.btnCalculate);
            this.Controls.Add(this.memBemerkungen);
            this.Controls.Add(this.edtDatumVon);
            this.Controls.Add(this.edtVerrechnungsArt);
            this.Controls.Add(this.edtBetragProMonat);
            this.Controls.Add(this.edtGrundforderung);
            this.Controls.Add(this.edtVereinbarungVom);
            this.Controls.Add(this.edtBaPersonID);
            this.Controls.Add(this.grdVerrechnung);
            this.Name = "CtlIkMonatszahlenVerrechnung";
            this.Size = new System.Drawing.Size(690, 488);
            ((System.ComponentModel.ISupportInitialize)(this.grdVerrechnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryVerrechnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwVerrechnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVereinbarungVom.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtGrundforderung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBetragProMonat.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerrechnungsArt.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerrechnungsArt)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.memBemerkungen.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtLetzterMonat.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGrundforderung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetragProMonat)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumVon)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGueltigBis)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkungen)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVereinbarung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblLetzterMonat)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEerledigt.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAnulliert.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAnnulliertAm.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAnnulliertAm)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryPerson)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRechtstitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRechtstitel.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRechtstitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryRechtstitel)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Private Properties

        private bool CanEdit
        {
            // Letzte Bearbeitung
            // 02.04.2008 : sozheo : neu
            // ------------------------------------------------------------------------
            get
            {
                bool Erledigt = (qryVerrechnung.Count == 0) ? false : (bool)qryVerrechnung["IstErledigt"];
                bool IstAnPscdGesendet = (qryVerrechnung.Count == 0) ? false : (bool)qryVerrechnung["IstAnPscdGesendet"];
                bool IstAnnulliert = (qryVerrechnung.Count == 0) ? false : (bool)qryVerrechnung["IstAnnulliert"];
                return (
                    qryVerrechnung.Count>0 &&
                    qryVerrechnung.CanUpdate &&
                    // Neu sollen Verrechnungen immer editierbar sein:
                    //!Erledigt &&
                    //!IstAnPscdGesendet &&
                    //!IstAnnulliert &&
                    !LeistungIstGeschlossen
                );
            }
        }

        #endregion

        #region Public Methods

        public void Activate()
        {
            if (GestartetVonRTitel) edtBaPersonID.Focus(); else edtVereinbarungVom.Focus();
        }

        public void InitLeistung(int LeistungID, int FallID, int FallPersonID, bool CanEdit, bool LeistgGeschlossen)
        {
            GestartetVonRTitel = true;
            FaFallID = FallID;
            FallBaPersonID = FallPersonID;
            FaLeistungID = LeistungID;

            LeistungIstGeschlossen = LeistgGeschlossen;
            if (LeistungIstGeschlossen)
            {
                qryVerrechnung.CanUpdate = false;
                qryVerrechnung.CanInsert = false;
                qryVerrechnung.CanDelete = false;
            }
            else
            {
                qryVerrechnung.CanUpdate = CanEdit;
                qryVerrechnung.CanInsert = CanEdit;
                qryVerrechnung.CanDelete = CanEdit;
            }

            colVerrechnungsArt.ColumnEdit = grdVerrechnung.GetLOVLookUpEdit("IkVerrechnungsArt");
            qryRechtstitel.Fill(FaLeistungID);
            edtBaPersonID.Properties.DataSource = qryPerson;
            VerrechnungOeffnen();
        }

        public void InitFromATree(int LeistungID, bool LeistgGeschlossen)
        {
            GestartetVonRTitel = false;
            btnAnnullieren.Visible = false;
            edtAnulliert.Visible = false;
            lblAnnulliertAm.Visible = false;
            edtAnnulliertAm.Visible = false;
            edtEerledigt.Visible = false;

            FaLeistungID = LeistungID;
            FaFallID = 0;
            FallBaPersonID = 0;

            // Auswahl Person ausblenden
            lblBaPersonID.Visible = false;
            edtBaPersonID.Visible = false;
            colPerson.Visible = false;
            grdVerrechnung.Height += 30;

            // Auswahl Rechtstitel ausblenden
            lblRechtstitel.Visible = false;
            edtRechtstitel.Visible = false;


            LeistungIstGeschlossen = LeistgGeschlossen;
            if (LeistungIstGeschlossen)
            {
                qryVerrechnung.CanUpdate = false;
                qryVerrechnung.CanInsert = false;
                qryVerrechnung.CanDelete = false;
            }
            colVerrechnungsArt.ColumnEdit = grdVerrechnung.GetLOVLookUpEdit("IkVerrechnungsArt");
            VerrechnungOeffnen();
        }

        public void VerrechnungOeffnen()
        {
            qryVerrechnung.Fill(FaLeistungID);
        }

        #endregion

        #region Private Methods

        private void MonatszahlenNeuRechnen()
        {
            // Letzte Bearbeitung
            // 17.03.2008 : sozheo : neu
            // ------------------------------------------------------------------------
            try
            {
                SqlQuery sql = DBUtil.OpenSQL("EXEC dbo.spIkMonatszahlen_DetailAll {0}, 1", FaLeistungID);
            }
            catch (Exception ex)
            {
                KissMsg.ShowInfo(ex.Message);
            }
        }

        private void SetCalculatedValues(object Grundf, object ProMonat, object DatumVon)
        {
            // Letzte Bearbeitung
            // 16.09.2007 : sozheo : neu
            // ------------------------------------------------------------------------
            qryVerrechnung.EndCurrentEdit();
            decimal LetzterBetrag = (decimal)0.0;
            decimal Grund = Utils.ConvertToDecimal(Grundf);
            decimal ProMo = Utils.ConvertToDecimal(ProMonat);
            if (!DBUtil.IsEmpty(DatumVon) && Grund>0 && ProMo>0)
            {
                DateTime StartDatum = (DateTime)DatumVon;
                DateTime LetztesDatum = StartDatum;
                decimal Rest = Grund;
                while (Rest>0)
                {
                    if (Rest > ProMo)
                    {
                        // Rest ist grösser als Betrag pro Monat, also 1 Monat erstellen
                        LetztesDatum = LetztesDatum.AddMonths(1);
                        Rest -= ProMo;
                    }
                    else
                    {
                        // Rest ist gleich oder kleiner Betrag pro Monat, also 1 Monat erstellen
                        LetzterBetrag = Rest;
                        Rest = (decimal)0.0;
                    }
                }
                qryVerrechnung["DatumBis"] = LetztesDatum;
                qryVerrechnung["LetzterMonat"] = LetzterBetrag;
            }
            else
            {
                qryVerrechnung["DatumBis"] = qryVerrechnung["DatumVon"];
                qryVerrechnung["LetzterMonat"] = (decimal)0.0;
            }
            qryVerrechnung.RefreshDisplay();
        }

        private void btnAnnullieren_Click(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 06.11.2007 : sozheo : Annullieren neu
            // ------------------------------------------------------------------------
            if (!KissMsg.ShowQuestion(
                "Annullierte Verrechnungen können nicht rückgängig gemacht werden.\r\n"+
                "Wollen Sie diese Verrechnung trotzdem annullieren?"
            )) return;

            qryVerrechnung["IstAnnulliert"] = true;
            qryVerrechnung["AnnulliertAm"] = DateTime.Today;
            qryVerrechnung.Post();
            qryVerrechnung_PositionChanged(sender, e);
        }

        private void btnCalculate_Click(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 16.09.2007 : sozheo : neu
            // ------------------------------------------------------------------------
            if (DBUtil.IsEmpty(qryVerrechnung["DatumVon"]))
            {
                KissMsg.ShowInfo("Erfassen Sie zuerst das Feld 'Dauer von', bevor Sie die Berechnung ausführen.");
                return;
            }

            qryVerrechnung["DatumVon"] = Utils.firstDayOfMonth((DateTime)qryVerrechnung["DatumVon"]);
            SetCalculatedValues(qryVerrechnung["Grundforderung"],qryVerrechnung["BetragProMonat"],qryVerrechnung["DatumVon"]);
        }

        private void edtBetragProMonat_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 16.09.2007 : sozheo : neu
            // ------------------------------------------------------------------------
            if (!edtBetragProMonat.UserModified) return;

            qryVerrechnung["BetragProMonat"] = Utils.ConvertToDecimal(edtBetragProMonat.EditValue);
            SetCalculatedValues(qryVerrechnung["Grundforderung"],qryVerrechnung["BetragProMonat"],qryVerrechnung["DatumVon"]);
        }

        private void edtDatumVon_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 16.09.2007 : sozheo : neu
            // ------------------------------------------------------------------------
            if (!edtDatumVon.UserModified) return;
            if (DBUtil.IsEmpty(edtDatumVon.EditValue)) return;

            qryVerrechnung["DatumVon"] = (DateTime)edtDatumVon.EditValue;
            SetCalculatedValues(qryVerrechnung["Grundforderung"],qryVerrechnung["BetragProMonat"],qryVerrechnung["DatumVon"]);
        }

        private void edtGrundforderung_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 16.09.2007 : sozheo : neu
            // ------------------------------------------------------------------------
            if (!edtGrundforderung.UserModified) return;

            qryVerrechnung["Grundforderung"] = Utils.ConvertToDecimal(edtGrundforderung.EditValue);
            SetCalculatedValues(
                qryVerrechnung["Grundforderung"],
                qryVerrechnung["BetragProMonat"],
                qryVerrechnung["DatumVon"]
            );
        }

        private void gvwVerrechnung_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e)
        {
            // Letzte Bearbeitung
            // 16.09.2007 : sozheo : neu
            // 06.11.2007 : sozheo : Annullieren neu
            // ------------------------------------------------------------------------
            e.Handled = false;
            if (gvwVerrechnung.FocusedRowHandle == e.RowHandle) return;

            /*
            object erl = gvwVerrechnung.GetRowCellValue(e.RowHandle, gvwVerrechnung.Columns["IstErledigt"]);
            bool erledigt = (erl is bool) ? (bool)erl : false;
            object vwt = gvwVerrechnung.GetRowCellValue(e.RowHandle, gvwVerrechnung.Columns["IstVonPscdVerwendet"]);
            bool vonPSCDverwendet = (vwt is bool) ? (bool)vwt : false;
            object anu = gvwVerrechnung.GetRowCellValue(e.RowHandle, gvwVerrechnung.Columns["IstAnnulliert"]);
            bool annulliert = (anu is bool) ? (bool)anu : false;
            */

            bool erledigt = Utils.ConvertToBool(gvwVerrechnung.GetRowCellValue(
                e.RowHandle, gvwVerrechnung.Columns["IstErledigt"]
            ));
            e.Appearance.BackColor = erledigt ? Color.LightSalmon : Color.Bisque;
        }

        private void qryVerrechnung_AfterDelete(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 28.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------
            MonatszahlenNeuRechnen();
        }

        private void qryVerrechnung_AfterFill(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 16.09.2007 : sozheo : neu
            // ------------------------------------------------------------------------
            if (qryVerrechnung.Count==0) qryVerrechnung_PositionChanged(sender, e);
        }

        private void qryVerrechnung_AfterInsert(object sender, System.EventArgs e)
        {
            qryVerrechnung["IstErledigt"] = false;
            qryVerrechnung["IstAnPscdGesendet"] = false;
            qryVerrechnung["IstAnnulliert"] = false;
            qryPerson.Fill(DBNull.Value);
            if (GestartetVonRTitel) edtRechtstitel.Focus(); else edtVereinbarungVom.Focus();
        }

        private void qryVerrechnung_AfterPost(object sender, System.EventArgs e)
        {
            MonatszahlenNeuRechnen();
        }

        private void qryVerrechnung_BeforePost(object sender, System.EventArgs e)
        {
            DBUtil.CheckNotNullField(edtDatumVon, lblDatumVon.Text);
            DBUtil.CheckNotNullField(edtRechtstitel, lblRechtstitel.Text);
            if (GestartetVonRTitel)
            {
                DBUtil.CheckNotNullField(edtBaPersonID, lblBaPersonID.Text);
            }
            DBUtil.CheckNotNullField(edtGrundforderung, lblGrundforderung.Text);
            DBUtil.CheckNotNullField(edtBetragProMonat, lblBetragProMonat.Text);

            if (Utils.ConvertToDecimal(qryVerrechnung["Grundforderung"])<0)
            {
                KissMsg.ShowInfo("Die Grundforderung darf nicht kleiner als 0 sein.");
                throw new KissCancelException();
            }

            if (Utils.ConvertToDecimal(qryVerrechnung["BetragProMonat"])<0)
            {
                KissMsg.ShowInfo("Der Betrag pro Monat darf nicht kleiner als 0 sein.");
                throw new KissCancelException();
            }

            if (Utils.ConvertToDecimal(qryVerrechnung["Grundforderung"])<Utils.ConvertToDecimal(qryVerrechnung["BetragProMonat"]))
            {
                KissMsg.ShowInfo("Die Grundforderung darf nicht kleiner sein als der Betrag pro Monat.");
                throw new KissCancelException();
            }

            qryVerrechnung["DatumVon"] = Utils.firstDayOfMonth((DateTime)qryVerrechnung["DatumVon"]);
            SetCalculatedValues(qryVerrechnung["Grundforderung"],qryVerrechnung["BetragProMonat"],qryVerrechnung["DatumVon"]);
            qryVerrechnung["DatumBis"] = Utils.firstDayOfMonth((DateTime)qryVerrechnung["DatumBis"]);

            // Person im Gitter aktualsieren
            if (GestartetVonRTitel)
                qryVerrechnung["Person"] = edtBaPersonID.GetDisplayText(edtBaPersonID.EditValue);

            // Rechtstitel im Gitter aktualsieren
            qryVerrechnung["Bezeichnung"] = edtRechtstitel.GetDisplayText(edtRechtstitel.EditValue);
        }

        private void qryVerrechnung_PositionChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 16.09.2007 : sozheo : neu
            // 06.11.2007 : sozheo : Annullieren neu
            // ------------------------------------------------------------------------
            // wenn der Rechtstitel gewechselt wird, dann muss die Auswahl der Gläubiger angepasst werden
            qryPerson.Fill(Utils.ConvertToInt(qryVerrechnung["IkRechtstitelID"]));

            // Wenn annuliert oder erledigt oder IstVonPscdVerwendet, darf nichts mehr verändert werden
            /*
            bool CanEditAnnull = (CanEdit && !(bool)qryVerrechnung["IstAnPscdGesendet"]);
            qryVerrechnung.EnableBoundFields(CanEditAnnull);
            btnCalculate.Enabled = CanEditAnnull;

            CanEditAnnull = (CanEdit && (bool)qryVerrechnung["IstAnPscdGesendet"]);
            btnAnnullieren.Enabled = CanEditAnnull;
            * */
            qryVerrechnung.EnableBoundFields(CanEdit);
        }

        #endregion

        private void edtRechtstitel_EditValueChanged(object sender, EventArgs e)
        {
            if (!edtRechtstitel.UserModified) return;

            // wenn der Rechtstitel gewechselt wird, dann muss die Auswahl der Gläubiger angepasst werden
            qryVerrechnung["IkRechtstitelID"] = Utils.ConvertToInt(edtRechtstitel.EditValue);
            qryVerrechnung["BaPersonID"] = DBNull.Value;
            qryPerson.Fill(Utils.ConvertToInt(qryVerrechnung["IkRechtstitelID"]));
        }
    }
}