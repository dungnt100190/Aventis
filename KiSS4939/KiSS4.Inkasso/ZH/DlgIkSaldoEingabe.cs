#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Windows.Forms;
using KiSS4.Common;
using KiSS4.DB;

namespace KiSS4.Inkasso.ZH
{
    public class DlgIkSaldoEingabe : KiSS4.Gui.KissDialog
    {
        #region Fields

        private bool HatZusatzBetrag = false;
        private bool IstEinmaligeZahlung = false;
        private bool IstZahlung = false;

        // Letzte Bearbeitung
        // 26.06.2008 : sozheo : neu
        // ------------------------------------------------------
        private decimal TotalBetrag = (decimal)0.0;
        private decimal ZusatzBetrag = (decimal)0.0;
        private KiSS4.Gui.KissButton btnCancel;
        private KiSS4.Gui.KissButton btnExecute;
        private KiSS4.Gui.KissLabel kissLabel2;
        private KiSS4.Gui.KissLabel lblBetrag;
        private KiSS4.Gui.KissLabel lblBetragMonat;
        private KiSS4.Gui.KissLabel lblDatum;
        private KiSS4.Gui.KissLabel lblInfo;
        private KiSS4.Gui.KissLabel lblMaxBetrag;
        private KiSS4.Gui.KissLabel lblTitel;

        public KiSS4.Gui.KissDateEdit edtDatumBis;
        public KiSS4.Gui.KissDateEdit edtDatumVon;
        public KiSS4.Gui.KissCalcEdit edtGrundforderung;
        public KiSS4.Gui.KissCalcEdit edtLetzterMonat;
        public KiSS4.Gui.KissCalcEdit edtProMonat;
        public KiSS4.Gui.KissDateEdit edtVerwPeriodeBis;
        public KiSS4.Gui.KissDateEdit edtVerwPeriodeVon;

        #endregion

        #region Constructors

        public DlgIkSaldoEingabe()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(DlgIkSaldoEingabe));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            this.btnExecute = new KiSS4.Gui.KissButton();
            this.btnCancel = new KiSS4.Gui.KissButton();
            this.lblBetrag = new KiSS4.Gui.KissLabel();
            this.edtGrundforderung = new KiSS4.Gui.KissCalcEdit();
            this.lblBetragMonat = new KiSS4.Gui.KissLabel();
            this.edtProMonat = new KiSS4.Gui.KissCalcEdit();
            this.lblDatum = new KiSS4.Gui.KissLabel();
            this.edtDatumVon = new KiSS4.Gui.KissDateEdit();
            this.lblTitel = new KiSS4.Gui.KissLabel();
            this.lblInfo = new KiSS4.Gui.KissLabel();
            this.edtDatumBis = new KiSS4.Gui.KissDateEdit();
            this.edtLetzterMonat = new KiSS4.Gui.KissCalcEdit();
            this.lblMaxBetrag = new KiSS4.Gui.KissLabel();
            this.kissLabel2 = new KiSS4.Gui.KissLabel();
            this.edtVerwPeriodeVon = new KiSS4.Gui.KissDateEdit();
            this.edtVerwPeriodeBis = new KiSS4.Gui.KissDateEdit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetrag)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtGrundforderung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetragMonat)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtProMonat.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatum)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblInfo)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtLetzterMonat.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMaxBetrag)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerwPeriodeVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerwPeriodeBis.Properties)).BeginInit();
            this.SuspendLayout();
            // 
            // btnExecute
            // 
            this.btnExecute.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnExecute.Location = new System.Drawing.Point(139, 258);
            this.btnExecute.Name = "btnExecute";
            this.btnExecute.Size = new System.Drawing.Size(120, 24);
            this.btnExecute.TabIndex = 0;
            this.btnExecute.Text = "Ausführen";
            this.btnExecute.UseCompatibleTextRendering = true;
            this.btnExecute.UseVisualStyleBackColor = false;
            this.btnExecute.Click += new System.EventHandler(this.btnExecute_Click);
            // 
            // btnCancel
            // 
            this.btnCancel.DialogResult = System.Windows.Forms.DialogResult.Cancel;
            this.btnCancel.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnCancel.Location = new System.Drawing.Point(271, 258);
            this.btnCancel.Name = "btnCancel";
            this.btnCancel.Size = new System.Drawing.Size(120, 24);
            this.btnCancel.TabIndex = 1;
            this.btnCancel.Text = "Abbrechen";
            this.btnCancel.UseCompatibleTextRendering = true;
            this.btnCancel.UseVisualStyleBackColor = false;
            // 
            // lblBetrag
            // 
            this.lblBetrag.Location = new System.Drawing.Point(12, 120);
            this.lblBetrag.Name = "lblBetrag";
            this.lblBetrag.Size = new System.Drawing.Size(121, 24);
            this.lblBetrag.TabIndex = 2;
            this.lblBetrag.Text = "Betrag Total";
            this.lblBetrag.UseCompatibleTextRendering = true;
            // 
            // edtGrundforderung
            // 
            this.edtGrundforderung.Location = new System.Drawing.Point(139, 120);
            this.edtGrundforderung.Name = "edtGrundforderung";
            this.edtGrundforderung.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtGrundforderung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtGrundforderung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtGrundforderung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtGrundforderung.Properties.Appearance.Options.UseBackColor = true;
            this.edtGrundforderung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtGrundforderung.Properties.Appearance.Options.UseFont = true;
            this.edtGrundforderung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtGrundforderung.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtGrundforderung.Properties.DisplayFormat.FormatString = "N2";
            this.edtGrundforderung.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtGrundforderung.Properties.EditFormat.FormatString = "N2";
            this.edtGrundforderung.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtGrundforderung.Size = new System.Drawing.Size(120, 24);
            this.edtGrundforderung.TabIndex = 3;
            this.edtGrundforderung.EditValueChanged += new System.EventHandler(this.edtGrundforderung_EditValueChanged);
            // 
            // lblBetragMonat
            // 
            this.lblBetragMonat.Location = new System.Drawing.Point(12, 150);
            this.lblBetragMonat.Name = "lblBetragMonat";
            this.lblBetragMonat.Size = new System.Drawing.Size(121, 24);
            this.lblBetragMonat.TabIndex = 4;
            this.lblBetragMonat.Text = "Betrag pro Monat";
            this.lblBetragMonat.UseCompatibleTextRendering = true;
            // 
            // edtProMonat
            // 
            this.edtProMonat.Location = new System.Drawing.Point(139, 150);
            this.edtProMonat.Name = "edtProMonat";
            this.edtProMonat.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtProMonat.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtProMonat.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtProMonat.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtProMonat.Properties.Appearance.Options.UseBackColor = true;
            this.edtProMonat.Properties.Appearance.Options.UseBorderColor = true;
            this.edtProMonat.Properties.Appearance.Options.UseFont = true;
            this.edtProMonat.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtProMonat.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtProMonat.Properties.DisplayFormat.FormatString = "N2";
            this.edtProMonat.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtProMonat.Properties.EditFormat.FormatString = "N2";
            this.edtProMonat.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtProMonat.Size = new System.Drawing.Size(120, 24);
            this.edtProMonat.TabIndex = 5;
            this.edtProMonat.EditValueChanged += new System.EventHandler(this.edtProMonat_EditValueChanged);
            // 
            // lblDatum
            // 
            this.lblDatum.Location = new System.Drawing.Point(12, 180);
            this.lblDatum.Name = "lblDatum";
            this.lblDatum.Size = new System.Drawing.Size(121, 24);
            this.lblDatum.TabIndex = 6;
            this.lblDatum.Text = "ab - bis Monat";
            this.lblDatum.UseCompatibleTextRendering = true;
            // 
            // edtDatumVon
            // 
            this.edtDatumVon.EditValue = null;
            this.edtDatumVon.Location = new System.Drawing.Point(139, 180);
            this.edtDatumVon.Name = "edtDatumVon";
            this.edtDatumVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtDatumVon.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumVon.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseFont = true;
            this.edtDatumVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtDatumVon.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDatumVon.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtDatumVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumVon.Properties.DisplayFormat.FormatString = "MM.yyyy";
            this.edtDatumVon.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumVon.Properties.EditFormat.FormatString = "MM.yyyy";
            this.edtDatumVon.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumVon.Properties.Mask.EditMask = "MM.yyyy";
            this.edtDatumVon.Properties.ShowToday = false;
            this.edtDatumVon.Size = new System.Drawing.Size(120, 24);
            this.edtDatumVon.TabIndex = 7;
            this.edtDatumVon.EditValueChanged += new System.EventHandler(this.edtDatumVon_EditValueChanged);
            // 
            // lblTitel
            // 
            this.lblTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitel.Location = new System.Drawing.Point(12, 14);
            this.lblTitel.Name = "lblTitel";
            this.lblTitel.Size = new System.Drawing.Size(319, 16);
            this.lblTitel.TabIndex = 8;
            this.lblTitel.Text = "Angaben für sofortige Zahlung";
            this.lblTitel.UseCompatibleTextRendering = true;
            // 
            // lblInfo
            // 
            this.lblInfo.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.lblInfo.LabelStyle = KiSS4.Gui.LabelStyleType.Custom;
            this.lblInfo.Location = new System.Drawing.Point(12, 43);
            this.lblInfo.Name = "lblInfo";
            this.lblInfo.Size = new System.Drawing.Size(379, 74);
            this.lblInfo.TabIndex = 9;
            this.lblInfo.Text = "kissLabel3";
            this.lblInfo.UseCompatibleTextRendering = true;
            // 
            // edtDatumBis
            // 
            this.edtDatumBis.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtDatumBis.EditValue = null;
            this.edtDatumBis.Location = new System.Drawing.Point(271, 180);
            this.edtDatumBis.Name = "edtDatumBis";
            this.edtDatumBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtDatumBis.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtDatumBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseFont = true;
            this.edtDatumBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtDatumBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDatumBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtDatumBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumBis.Properties.DisplayFormat.FormatString = "MM.yyyy";
            this.edtDatumBis.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumBis.Properties.EditFormat.FormatString = "MM.yyyy";
            this.edtDatumBis.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumBis.Properties.ReadOnly = true;
            this.edtDatumBis.Properties.ShowToday = false;
            this.edtDatumBis.Size = new System.Drawing.Size(120, 24);
            this.edtDatumBis.TabIndex = 10;
            // 
            // edtLetzterMonat
            // 
            this.edtLetzterMonat.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtLetzterMonat.Location = new System.Drawing.Point(271, 149);
            this.edtLetzterMonat.Name = "edtLetzterMonat";
            this.edtLetzterMonat.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtLetzterMonat.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtLetzterMonat.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtLetzterMonat.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtLetzterMonat.Properties.Appearance.Options.UseBackColor = true;
            this.edtLetzterMonat.Properties.Appearance.Options.UseBorderColor = true;
            this.edtLetzterMonat.Properties.Appearance.Options.UseFont = true;
            this.edtLetzterMonat.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtLetzterMonat.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtLetzterMonat.Properties.DisplayFormat.FormatString = "N2";
            this.edtLetzterMonat.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtLetzterMonat.Properties.EditFormat.FormatString = "N2";
            this.edtLetzterMonat.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtLetzterMonat.Properties.ReadOnly = true;
            this.edtLetzterMonat.Size = new System.Drawing.Size(120, 24);
            this.edtLetzterMonat.TabIndex = 11;
            // 
            // lblMaxBetrag
            // 
            this.lblMaxBetrag.Location = new System.Drawing.Point(271, 120);
            this.lblMaxBetrag.Name = "lblMaxBetrag";
            this.lblMaxBetrag.Size = new System.Drawing.Size(120, 24);
            this.lblMaxBetrag.TabIndex = 12;
            this.lblMaxBetrag.Text = "kissLabel4";
            this.lblMaxBetrag.UseCompatibleTextRendering = true;
            // 
            // kissLabel2
            // 
            this.kissLabel2.Location = new System.Drawing.Point(12, 210);
            this.kissLabel2.Name = "kissLabel2";
            this.kissLabel2.Size = new System.Drawing.Size(121, 24);
            this.kissLabel2.TabIndex = 15;
            this.kissLabel2.Text = "Verwendungsperiode";
            this.kissLabel2.UseCompatibleTextRendering = true;
            // 
            // edtVerwPeriodeVon
            // 
            this.edtVerwPeriodeVon.EditValue = null;
            this.edtVerwPeriodeVon.Location = new System.Drawing.Point(139, 210);
            this.edtVerwPeriodeVon.Name = "edtVerwPeriodeVon";
            this.edtVerwPeriodeVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtVerwPeriodeVon.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtVerwPeriodeVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtVerwPeriodeVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtVerwPeriodeVon.Properties.Appearance.Options.UseBackColor = true;
            this.edtVerwPeriodeVon.Properties.Appearance.Options.UseBorderColor = true;
            this.edtVerwPeriodeVon.Properties.Appearance.Options.UseFont = true;
            this.edtVerwPeriodeVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            this.edtVerwPeriodeVon.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtVerwPeriodeVon.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3)});
            this.edtVerwPeriodeVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtVerwPeriodeVon.Properties.DisplayFormat.FormatString = "MM.yyyy";
            this.edtVerwPeriodeVon.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtVerwPeriodeVon.Properties.EditFormat.FormatString = "MM.yyyy";
            this.edtVerwPeriodeVon.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtVerwPeriodeVon.Properties.Mask.EditMask = "MM.yyyy";
            this.edtVerwPeriodeVon.Properties.Mask.UseMaskAsDisplayFormat = true;
            this.edtVerwPeriodeVon.Properties.ShowToday = false;
            this.edtVerwPeriodeVon.Size = new System.Drawing.Size(120, 24);
            this.edtVerwPeriodeVon.TabIndex = 16;
            // 
            // edtVerwPeriodeBis
            // 
            this.edtVerwPeriodeBis.EditValue = null;
            this.edtVerwPeriodeBis.Location = new System.Drawing.Point(271, 210);
            this.edtVerwPeriodeBis.Name = "edtVerwPeriodeBis";
            this.edtVerwPeriodeBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtVerwPeriodeBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtVerwPeriodeBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtVerwPeriodeBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtVerwPeriodeBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtVerwPeriodeBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtVerwPeriodeBis.Properties.Appearance.Options.UseFont = true;
            this.edtVerwPeriodeBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            this.edtVerwPeriodeBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtVerwPeriodeBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4)});
            this.edtVerwPeriodeBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtVerwPeriodeBis.Properties.DisplayFormat.FormatString = "MM.yyyy";
            this.edtVerwPeriodeBis.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtVerwPeriodeBis.Properties.EditFormat.FormatString = "MM.yyyy";
            this.edtVerwPeriodeBis.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtVerwPeriodeBis.Properties.Mask.EditMask = "MM.yyyy";
            this.edtVerwPeriodeBis.Properties.Mask.UseMaskAsDisplayFormat = true;
            this.edtVerwPeriodeBis.Properties.ShowToday = false;
            this.edtVerwPeriodeBis.Size = new System.Drawing.Size(120, 24);
            this.edtVerwPeriodeBis.TabIndex = 17;
            // 
            // DlgIkSaldoEingabe
            // 
            this.ClientSize = new System.Drawing.Size(414, 306);
            this.Controls.Add(this.edtVerwPeriodeBis);
            this.Controls.Add(this.edtVerwPeriodeVon);
            this.Controls.Add(this.kissLabel2);
            this.Controls.Add(this.lblMaxBetrag);
            this.Controls.Add(this.edtLetzterMonat);
            this.Controls.Add(this.edtDatumBis);
            this.Controls.Add(this.lblInfo);
            this.Controls.Add(this.lblTitel);
            this.Controls.Add(this.edtDatumVon);
            this.Controls.Add(this.lblDatum);
            this.Controls.Add(this.edtProMonat);
            this.Controls.Add(this.lblBetragMonat);
            this.Controls.Add(this.edtGrundforderung);
            this.Controls.Add(this.lblBetrag);
            this.Controls.Add(this.btnCancel);
            this.Controls.Add(this.btnExecute);
            this.Name = "DlgIkSaldoEingabe";
            this.Text = "Saldo begleichen";
            ((System.ComponentModel.ISupportInitialize)(this.lblBetrag)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtGrundforderung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetragMonat)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtProMonat.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatum)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblInfo)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtLetzterMonat.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMaxBetrag)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerwPeriodeVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerwPeriodeBis.Properties)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        #region Public Methods

        // Letzte Bearbeitung
        // 27.06.2008 : sozheo : neu
        // ------------------------------------------------------
        public void Init(bool EinmaligeZahlung, decimal MaxBetrag, decimal ZusBetrag)
        {
            IstZahlung = (MaxBetrag > 0);
              IstEinmaligeZahlung = EinmaligeZahlung;
              HatZusatzBetrag = (ZusBetrag > 0);
              ZusatzBetrag = ZusBetrag;

              TotalBetrag = IstZahlung ? MaxBetrag : -MaxBetrag;
              edtDatumVon.EditValue = DateTime.Today;
              edtGrundforderung.EditValue = TotalBetrag;
              edtProMonat.EditValue = TotalBetrag;
              SetCalculatedValues(edtGrundforderung.EditValue, edtProMonat.EditValue, edtDatumVon.EditValue);

              if (IstEinmaligeZahlung)
              {
            lblBetragMonat.Visible = false;
            edtProMonat.Visible = false;
            edtLetzterMonat.Visible = false;
            lblDatum.Visible = false;
            edtDatumVon.Visible = false;
            edtDatumBis.Visible = false;
            edtProMonat.EditValue = (decimal)0.0;
              }

              lblMaxBetrag.Text = string.Format("Total Fr. "+TotalBetrag.ToString("N2"));
              if (IstZahlung)
              {
            // Saldo > 0 -> zusätzliche Zahlung
            if (EinmaligeZahlung)
            {

              lblTitel.Text = "Einmalige Zahlung";
              lblInfo.Text = string.Format(
                "Es kann eine einmalige Zahlung von genau Fr. {0} erstellt werden.",
                TotalBetrag.ToString("N2")
              );

              if (HatZusatzBetrag)
              {
                lblInfo.Text = lblInfo.Text + "\r\nDer Zusatz-Zahlungsweg ist definiert.";
                lblInfo.Text = lblInfo.Text + string.Format(
                  "\r\nDer periodische Zusatzbetrag beträgt Fr. {0}.",
                  ZusatzBetrag.ToString("N2")
                );

                decimal Diff = TotalBetrag - ZusatzBetrag;
                if (Diff < 0) Diff = (decimal)0.0;
                lblBetragMonat.Text = "Zusatzzahlung";
                lblBetragMonat.Visible = true;
                edtProMonat.Visible = true;
                edtProMonat.EditValue = ZusBetrag;
                edtGrundforderung.EditValue = Diff;
              }
            }
            else
            {
              lblTitel.Text = "zusätzliche Zahlung";
              lblInfo.Text = string.Format(
                "Es kann eine zusätzliche Zahlung von genau Fr. {0} erstellt werden.",
                TotalBetrag.ToString("N2")
              );
            }
              }
              else
              {
            // Saldo < 0 -> Zahlungsminderung
            lblTitel.Text = "Zahlungsminderung";
            lblInfo.Text = string.Format(
              "Es kann eine Zahlungsminderung von genau Fr. {0} erstellt werden.",
              TotalBetrag.ToString("N2")
            );
              }
        }

        #endregion

        #region Private Methods

        // Letzte Bearbeitung
        // 27.06.2008 : sozheo : neu
        // ------------------------------------------------------
        private void SetCalculatedValues(object Grundf, object ProMonat, object DatumVon)
        {
            if (IstEinmaligeZahlung) return;
              decimal LetzterBetrag = (decimal)0.0;
              decimal Grund = Utils.ConvertToDecimal(Grundf);
              decimal ProMo = Utils.ConvertToDecimal(ProMonat);
              if (!DBUtil.IsEmpty(DatumVon) && Grund>0 && ProMo>0)
              {
            DateTime StartDatum = (DateTime)DatumVon;
            DateTime LetztesDatum = StartDatum;
            decimal Rest = Grund;
            while (Rest>0)
            {
              if (Rest > ProMo)
              {
                // Rest ist grösser als Betrag pro Monat, also 1 Monat erstellen
                LetztesDatum = LetztesDatum.AddMonths(1);
                Rest -= ProMo;
              }
              else
              {
                // Rest ist gleich oder kleiner Betrag pro Monat, also 1 Monat erstellen
                LetzterBetrag = Rest;
                Rest = (decimal)0.0;
              }
            }
            edtDatumBis.EditValue = LetztesDatum;
            edtLetzterMonat.EditValue = LetzterBetrag;
              }
              else
              {
            edtDatumBis.EditValue = edtDatumVon.EditValue;
            edtLetzterMonat.EditValue = (decimal)0.0;
              }
        }

        private void btnExecute_Click(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 26.06.2008 : sozheo : neu
            // 14.07.2008 : sozheo : Verwendungperiode neu
            // ------------------------------------------------------

            if (!IstEinmaligeZahlung && DBUtil.IsEmpty(edtGrundforderung.EditValue))
            {
              KissMsg.ShowInfo("Die Grundforderung darf nicht leer bleiben.");
              return;
            }

            if (IstEinmaligeZahlung && DBUtil.IsEmpty(edtGrundforderung.EditValue) && !HatZusatzBetrag)
            {
              KissMsg.ShowInfo("Der Zahlungsbetrag darf nicht leer bleiben.");
              return;
            }

            if (DBUtil.IsEmpty(edtVerwPeriodeVon.EditValue) || DBUtil.IsEmpty(edtVerwPeriodeBis.EditValue))
            {
              KissMsg.ShowInfo("Die Angaben zur Verwendungsperiode dürfen nicht leer bleiben.");
              return;
            }
            if ((DateTime)edtVerwPeriodeVon.EditValue > (DateTime)edtVerwPeriodeBis.EditValue)
            {
              KissMsg.ShowInfo("Das Start-Datum der Verwendungsperiode muss kleiner sein als das Ende-Datum.");
              return;
            }

            if (
              IstEinmaligeZahlung &&
              DBUtil.IsEmpty(edtProMonat.EditValue) &&
              DBUtil.IsEmpty(edtGrundforderung.EditValue) &&
              HatZusatzBetrag
            )
            {
              KissMsg.ShowInfo(
                "Mindestens ein Betrag muss definiert sein.\r\n"+
                "Entweder die Zahlung an den Gläubiger oder die Zusatzzahlung."
              );
              return;
            }

            if (!IstEinmaligeZahlung)
            {
              if (DBUtil.IsEmpty(edtProMonat.EditValue))
              {
                KissMsg.ShowInfo("Der monatliche Betrag darf nicht leer bleiben.");
                return;
              }

              if (DBUtil.IsEmpty(edtDatumVon.EditValue))
              {
                KissMsg.ShowInfo("Das Datum von darf nicht leer bleiben.");
                return;
              }
            }

            if (
              (!IstEinmaligeZahlung && TotalBetrag != Utils.ConvertToDecimal(edtGrundforderung.EditValue)) ||
              (IstEinmaligeZahlung && TotalBetrag < Utils.ConvertToDecimal(edtGrundforderung.EditValue) + Utils.ConvertToDecimal(edtProMonat.EditValue))
            )
            {
              KissMsg.ShowInfo("Der totale Betrag muss dem Saldo entsprechen.");
              return;
            }

            if (!IstEinmaligeZahlung)
            if (Utils.ConvertToDecimal(edtProMonat.EditValue) > Utils.ConvertToDecimal(edtGrundforderung.EditValue))
            {
              KissMsg.ShowInfo("Der monatliche Betrag darf nicht grösser als der Totalbetrag sein.");
              return;
            }

            this.DialogResult = DialogResult.OK;
        }

        private void edtDatumVon_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 27.06.2008 : sozheo : neu
            // ------------------------------------------------------

            SetCalculatedValues(edtGrundforderung.EditValue, edtProMonat.EditValue, edtDatumVon.EditValue);
        }

        private void edtGrundforderung_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 27.06.2008 : sozheo : neu
            // ------------------------------------------------------

            SetCalculatedValues(edtGrundforderung.EditValue, edtProMonat.EditValue, edtDatumVon.EditValue);
        }

        private void edtProMonat_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 27.06.2008 : sozheo : neu
            // ------------------------------------------------------

            SetCalculatedValues(edtGrundforderung.EditValue, edtProMonat.EditValue, edtDatumVon.EditValue);
        }

        #endregion
    }
}