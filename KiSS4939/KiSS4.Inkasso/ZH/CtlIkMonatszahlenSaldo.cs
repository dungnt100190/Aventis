#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Drawing;
using System.Windows.Forms;
using KiSS4.Common;
using KiSS4.DB;

namespace KiSS4.Inkasso.ZH
{
    public class CtlIkMonatszahlenSaldo : KiSS4.Gui.KissUserControl
    {
        #region Fields

        #region Public Fields

        public KiSS4.DB.SqlQuery qrySaldo;

        #endregion

        #region Private Fields

        private int FaLeistungID = 0;
        private int FaProzessCode = 0;
        private bool GlaeubigerFilling = false;
        private bool LeistgIstGeschlossen = true;
        private decimal TotalSaldo = (decimal)0.0;
        private KiSS4.Gui.KissButton btnVerrechnung;
        private KiSS4.Gui.KissButton btnZahlung;
        private DevExpress.XtraGrid.Columns.GridColumn colALBVBetrag;
        private DevExpress.XtraGrid.Columns.GridColumn colALBVSaldo;
        private DevExpress.XtraGrid.Columns.GridColumn colAlter;
        private DevExpress.XtraGrid.Columns.GridColumn colAuszahlungIst;
        private DevExpress.XtraGrid.Columns.GridColumn colAuszahlungSoll;
        private DevExpress.XtraGrid.Columns.GridColumn colDiff;
        private DevExpress.XtraGrid.Columns.GridColumn colErledigt;
        private DevExpress.XtraGrid.Columns.GridColumn colGuth;
        private DevExpress.XtraGrid.Columns.GridColumn colIkRechtstitelID;
        private DevExpress.XtraGrid.Columns.GridColumn colInfo;
        private DevExpress.XtraGrid.Columns.GridColumn colKind;
        private DevExpress.XtraGrid.Columns.GridColumn colLEBetrag;
        private DevExpress.XtraGrid.Columns.GridColumn colLEalt;
        private DevExpress.XtraGrid.Columns.GridColumn colLeisBemerkung;
        private DevExpress.XtraGrid.Columns.GridColumn colLeisMonatJahr;
        private DevExpress.XtraGrid.Columns.GridColumn colLeisSaldo;
        private DevExpress.XtraGrid.Columns.GridColumn colRtName;
        private DevExpress.XtraGrid.Columns.GridColumn colTitel;
        private DevExpress.XtraGrid.Columns.GridColumn colVermSaldo;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrechg;
        private DevExpress.XtraGrid.Columns.GridColumn colVorSaldo;
        private DevExpress.XtraGrid.Columns.GridColumn colistWH;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissCheckEdit edtNurALBV;
        private KiSS4.Gui.KissDateEdit edtSaldoBis;
        private KiSS4.Gui.KissGrid grdPerson;
        private KiSS4.Gui.KissGrid grdSaldo;
        private DevExpress.XtraGrid.Views.Grid.GridView gvwPerson;
        private DevExpress.XtraGrid.Views.Grid.GridView gvwSaldo;
        private KiSS4.Gui.KissLabel kissLabel1;
        private DevExpress.XtraGrid.Columns.GridColumn colBetragSaldoTotal;
        private DevExpress.XtraGrid.Columns.GridColumn colEinmalig;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrechgSoll;
        private KiSS4.DB.SqlQuery qryGlaeubiger;

        #endregion

        #endregion

        #region Constructors

        #region Public Constructors

        public CtlIkMonatszahlenSaldo()
        {
            this.InitializeComponent();
        }

        #endregion

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlIkMonatszahlenSaldo));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            this.grdPerson = new KiSS4.Gui.KissGrid();
            this.qryGlaeubiger = new KiSS4.DB.SqlQuery(this.components);
            this.gvwPerson = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colKind = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colAlter = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colALBVBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colALBVSaldo = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVermSaldo = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colInfo = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVorSaldo = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBetragSaldoTotal = new DevExpress.XtraGrid.Columns.GridColumn();
            this.grdSaldo = new KiSS4.Gui.KissGrid();
            this.qrySaldo = new KiSS4.DB.SqlQuery(this.components);
            this.gvwSaldo = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colLeisMonatJahr = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLEalt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLEBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDiff = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrechg = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colAuszahlungIst = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colAuszahlungSoll = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colGuth = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLeisSaldo = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colErledigt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colistWH = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colTitel = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colRtName = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLeisBemerkung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colIkRechtstitelID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colEinmalig = new DevExpress.XtraGrid.Columns.GridColumn();
            this.edtNurALBV = new KiSS4.Gui.KissCheckEdit();
            this.edtSaldoBis = new KiSS4.Gui.KissDateEdit();
            this.kissLabel1 = new KiSS4.Gui.KissLabel();
            this.btnVerrechnung = new KiSS4.Gui.KissButton();
            this.btnZahlung = new KiSS4.Gui.KissButton();
            this.colVerrechgSoll = new DevExpress.XtraGrid.Columns.GridColumn();
            ((System.ComponentModel.ISupportInitialize)(this.grdPerson)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryGlaeubiger)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwPerson)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdSaldo)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qrySaldo)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwSaldo)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtNurALBV.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSaldoBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).BeginInit();
            this.SuspendLayout();
            // 
            // grdPerson
            // 
            this.grdPerson.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdPerson.DataSource = this.qryGlaeubiger;
            this.grdPerson.EmbeddedNavigator.Name = "";
            this.grdPerson.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdPerson.Location = new System.Drawing.Point(10, 10);
            this.grdPerson.MainView = this.gvwPerson;
            this.grdPerson.Name = "grdPerson";
            this.grdPerson.Size = new System.Drawing.Size(455, 122);
            this.grdPerson.TabIndex = 3;
            this.grdPerson.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.gvwPerson});
            // 
            // qryGlaeubiger
            // 
            this.qryGlaeubiger.BatchUpdate = true;
            this.qryGlaeubiger.HostControl = this;
            this.qryGlaeubiger.SelectStatement = "EXEC dbo.spIkMonatszahlen_SaldoGlaeubiger {0}, {1}, {2}\r\n";
            this.qryGlaeubiger.PositionChanged += new System.EventHandler(this.qryGlaeubiger_PositionChanged);
            this.qryGlaeubiger.AfterFill += new System.EventHandler(this.qryGlaeubiger_AfterFill);
            // 
            // gvwPerson
            // 
            this.gvwPerson.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gvwPerson.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.Empty.Options.UseBackColor = true;
            this.gvwPerson.Appearance.Empty.Options.UseFont = true;
            this.gvwPerson.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.EvenRow.Options.UseFont = true;
            this.gvwPerson.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwPerson.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gvwPerson.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gvwPerson.Appearance.FocusedCell.Options.UseFont = true;
            this.gvwPerson.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gvwPerson.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwPerson.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gvwPerson.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gvwPerson.Appearance.FocusedRow.Options.UseFont = true;
            this.gvwPerson.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gvwPerson.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwPerson.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gvwPerson.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwPerson.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwPerson.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwPerson.Appearance.GroupRow.Options.UseBackColor = true;
            this.gvwPerson.Appearance.GroupRow.Options.UseFont = true;
            this.gvwPerson.Appearance.GroupRow.Options.UseForeColor = true;
            this.gvwPerson.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gvwPerson.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gvwPerson.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwPerson.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gvwPerson.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gvwPerson.Appearance.HeaderPanel.Options.UseFont = true;
            this.gvwPerson.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gvwPerson.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwPerson.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gvwPerson.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gvwPerson.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gvwPerson.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gvwPerson.Appearance.HorzLine.Options.UseBackColor = true;
            this.gvwPerson.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.OddRow.Options.UseFont = true;
            this.gvwPerson.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gvwPerson.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.Row.Options.UseBackColor = true;
            this.gvwPerson.Appearance.Row.Options.UseFont = true;
            this.gvwPerson.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwPerson.Appearance.SelectedRow.Options.UseFont = true;
            this.gvwPerson.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gvwPerson.Appearance.VertLine.Options.UseBackColor = true;
            this.gvwPerson.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gvwPerson.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colKind,
            this.colAlter,
            this.colALBVBetrag,
            this.colALBVSaldo,
            this.colVermSaldo,
            this.colInfo,
            this.colVorSaldo,
            this.colBetragSaldoTotal});
            this.gvwPerson.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gvwPerson.GridControl = this.grdPerson;
            this.gvwPerson.Name = "gvwPerson";
            this.gvwPerson.OptionsBehavior.Editable = false;
            this.gvwPerson.OptionsCustomization.AllowFilter = false;
            this.gvwPerson.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gvwPerson.OptionsNavigation.AutoFocusNewRow = true;
            this.gvwPerson.OptionsNavigation.UseTabKey = false;
            this.gvwPerson.OptionsView.ColumnAutoWidth = false;
            this.gvwPerson.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gvwPerson.OptionsView.ShowGroupPanel = false;
            this.gvwPerson.OptionsView.ShowIndicator = false;
            // 
            // colKind
            // 
            this.colKind.Caption = "Person / Geburtsdatum";
            this.colKind.FieldName = "Name";
            this.colKind.Name = "colKind";
            this.colKind.Visible = true;
            this.colKind.VisibleIndex = 0;
            this.colKind.Width = 205;
            // 
            // colAlter
            // 
            this.colAlter.Caption = "Alter";
            this.colAlter.FieldName = "Alter";
            this.colAlter.Name = "colAlter";
            this.colAlter.Visible = true;
            this.colAlter.VisibleIndex = 1;
            this.colAlter.Width = 42;
            // 
            // colALBVBetrag
            // 
            this.colALBVBetrag.AppearanceCell.Options.UseTextOptions = true;
            this.colALBVBetrag.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVBetrag.AppearanceHeader.Options.UseTextOptions = true;
            this.colALBVBetrag.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVBetrag.Caption = "akt. ALBV/ÜbH";
            this.colALBVBetrag.DisplayFormat.FormatString = "N2";
            this.colALBVBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colALBVBetrag.FieldName = "BetragALBV";
            this.colALBVBetrag.Name = "colALBVBetrag";
            this.colALBVBetrag.Visible = true;
            this.colALBVBetrag.VisibleIndex = 2;
            this.colALBVBetrag.Width = 102;
            // 
            // colALBVSaldo
            // 
            this.colALBVSaldo.AppearanceCell.Options.UseTextOptions = true;
            this.colALBVSaldo.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVSaldo.AppearanceHeader.Options.UseTextOptions = true;
            this.colALBVSaldo.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVSaldo.Caption = "akt. Saldo";
            this.colALBVSaldo.DisplayFormat.FormatString = "N2";
            this.colALBVSaldo.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colALBVSaldo.FieldName = "BetragSaldo";
            this.colALBVSaldo.Name = "colALBVSaldo";
            this.colALBVSaldo.Visible = true;
            this.colALBVSaldo.VisibleIndex = 3;
            // 
            // colVermSaldo
            // 
            this.colVermSaldo.Caption = "verm. Saldo";
            this.colVermSaldo.DisplayFormat.FormatString = "N2";
            this.colVermSaldo.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colVermSaldo.FieldName = "BetragSaldoVermittelt";
            this.colVermSaldo.Name = "colVermSaldo";
            this.colVermSaldo.OptionsColumn.AllowEdit = false;
            this.colVermSaldo.Visible = true;
            this.colVermSaldo.VisibleIndex = 4;
            // 
            // colInfo
            // 
            this.colInfo.Caption = "Saldoart";
            this.colInfo.FieldName = "Info";
            this.colInfo.Name = "colInfo";
            this.colInfo.OptionsColumn.AllowEdit = false;
            this.colInfo.Visible = true;
            this.colInfo.VisibleIndex = 5;
            this.colInfo.Width = 150;
            // 
            // colVorSaldo
            // 
            this.colVorSaldo.AppearanceCell.Options.UseTextOptions = true;
            this.colVorSaldo.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVorSaldo.AppearanceHeader.Options.UseTextOptions = true;
            this.colVorSaldo.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVorSaldo.Caption = "Vorsaldo";
            this.colVorSaldo.DisplayFormat.FormatString = "N2";
            this.colVorSaldo.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colVorSaldo.FieldName = "VorSaldo";
            this.colVorSaldo.Name = "colVorSaldo";
            this.colVorSaldo.OptionsColumn.AllowEdit = false;
            this.colVorSaldo.Visible = true;
            this.colVorSaldo.VisibleIndex = 6;
            // 
            // colBetragSaldoTotal
            // 
            this.colBetragSaldoTotal.AppearanceCell.Options.UseTextOptions = true;
            this.colBetragSaldoTotal.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colBetragSaldoTotal.AppearanceHeader.Options.UseTextOptions = true;
            this.colBetragSaldoTotal.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colBetragSaldoTotal.Caption = "Saldo Total";
            this.colBetragSaldoTotal.DisplayFormat.FormatString = "N2";
            this.colBetragSaldoTotal.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colBetragSaldoTotal.FieldName = "BetragSaldoTotal";
            this.colBetragSaldoTotal.Name = "colBetragSaldoTotal";
            this.colBetragSaldoTotal.Visible = true;
            this.colBetragSaldoTotal.VisibleIndex = 7;
            // 
            // grdSaldo
            // 
            this.grdSaldo.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdSaldo.DataSource = this.qrySaldo;
            this.grdSaldo.EmbeddedNavigator.Name = "";
            this.grdSaldo.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdSaldo.Location = new System.Drawing.Point(10, 138);
            this.grdSaldo.MainView = this.gvwSaldo;
            this.grdSaldo.Name = "grdSaldo";
            this.grdSaldo.Size = new System.Drawing.Size(700, 257);
            this.grdSaldo.TabIndex = 4;
            this.grdSaldo.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.gvwSaldo});
            // 
            // qrySaldo
            // 
            this.qrySaldo.BatchUpdate = true;
            this.qrySaldo.HostControl = this;
            this.qrySaldo.SelectStatement = "EXEC dbo.spIkMonatszahlen_Saldo {0}, {1}, {2}";
            this.qrySaldo.AfterFill += new System.EventHandler(this.qrySaldo_AfterFill);
            // 
            // gvwSaldo
            // 
            this.gvwSaldo.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gvwSaldo.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.Empty.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.Empty.Options.UseFont = true;
            this.gvwSaldo.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.EvenRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwSaldo.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gvwSaldo.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.FocusedCell.Options.UseFont = true;
            this.gvwSaldo.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gvwSaldo.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwSaldo.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gvwSaldo.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.FocusedRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gvwSaldo.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwSaldo.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwSaldo.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwSaldo.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwSaldo.Appearance.GroupRow.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.GroupRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.GroupRow.Options.UseForeColor = true;
            this.gvwSaldo.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gvwSaldo.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gvwSaldo.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwSaldo.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gvwSaldo.Appearance.HeaderPanel.Options.UseFont = true;
            this.gvwSaldo.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gvwSaldo.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwSaldo.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gvwSaldo.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gvwSaldo.Appearance.HorzLine.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.OddRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gvwSaldo.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.Row.Options.UseBackColor = true;
            this.gvwSaldo.Appearance.Row.Options.UseFont = true;
            this.gvwSaldo.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwSaldo.Appearance.SelectedRow.Options.UseFont = true;
            this.gvwSaldo.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gvwSaldo.Appearance.VertLine.Options.UseBackColor = true;
            this.gvwSaldo.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gvwSaldo.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colLeisMonatJahr,
            this.colLEalt,
            this.colLEBetrag,
            this.colDiff,
            this.colVerrechg,
            this.colVerrechgSoll,
            this.colAuszahlungIst,
            this.colAuszahlungSoll,
            this.colGuth,
            this.colLeisSaldo,
            this.colErledigt,
            this.colistWH,
            this.colTitel,
            this.colRtName,
            this.colLeisBemerkung,
            this.colIkRechtstitelID,
            this.colEinmalig});
            this.gvwSaldo.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gvwSaldo.GridControl = this.grdSaldo;
            this.gvwSaldo.Name = "gvwSaldo";
            this.gvwSaldo.OptionsBehavior.Editable = false;
            this.gvwSaldo.OptionsCustomization.AllowFilter = false;
            this.gvwSaldo.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gvwSaldo.OptionsNavigation.AutoFocusNewRow = true;
            this.gvwSaldo.OptionsNavigation.UseTabKey = false;
            this.gvwSaldo.OptionsView.ColumnAutoWidth = false;
            this.gvwSaldo.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gvwSaldo.OptionsView.ShowFooter = true;
            this.gvwSaldo.OptionsView.ShowGroupPanel = false;
            this.gvwSaldo.OptionsView.ShowIndicator = false;
            this.gvwSaldo.CustomDrawCell += new DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventHandler(this.gvwSaldo_CustomDrawCell);
            // 
            // colLeisMonatJahr
            // 
            this.colLeisMonatJahr.Caption = "Monat";
            this.colLeisMonatJahr.DisplayFormat.FormatString = "yyyy.MM";
            this.colLeisMonatJahr.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colLeisMonatJahr.FieldName = "Datum";
            this.colLeisMonatJahr.Name = "colLeisMonatJahr";
            this.colLeisMonatJahr.Visible = true;
            this.colLeisMonatJahr.VisibleIndex = 0;
            this.colLeisMonatJahr.Width = 62;
            // 
            // colLEalt
            // 
            this.colLEalt.AppearanceCell.Options.UseTextOptions = true;
            this.colLEalt.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLEalt.AppearanceHeader.Options.UseTextOptions = true;
            this.colLEalt.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLEalt.Caption = "Verfüg. Ist";
            this.colLEalt.DisplayFormat.FormatString = "N2";
            this.colLEalt.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colLEalt.FieldName = "BetragALBVIst";
            this.colLEalt.Name = "colLEalt";
            this.colLEalt.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colLEalt.Visible = true;
            this.colLEalt.VisibleIndex = 1;
            this.colLEalt.Width = 77;
            // 
            // colLEBetrag
            // 
            this.colLEBetrag.AppearanceCell.Options.UseTextOptions = true;
            this.colLEBetrag.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLEBetrag.AppearanceHeader.Options.UseTextOptions = true;
            this.colLEBetrag.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLEBetrag.Caption = "Verfüg. Soll";
            this.colLEBetrag.DisplayFormat.FormatString = "N2";
            this.colLEBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colLEBetrag.FieldName = "BetragALBVSoll";
            this.colLEBetrag.Name = "colLEBetrag";
            this.colLEBetrag.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colLEBetrag.Visible = true;
            this.colLEBetrag.VisibleIndex = 2;
            // 
            // colDiff
            // 
            this.colDiff.AppearanceCell.Options.UseTextOptions = true;
            this.colDiff.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colDiff.AppearanceHeader.Options.UseTextOptions = true;
            this.colDiff.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colDiff.Caption = "Diff.";
            this.colDiff.DisplayFormat.FormatString = "N2";
            this.colDiff.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colDiff.FieldName = "ALBVDiff";
            this.colDiff.Name = "colDiff";
            this.colDiff.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colDiff.Visible = true;
            this.colDiff.VisibleIndex = 3;
            this.colDiff.Width = 64;
            // 
            // colVerrechg
            // 
            this.colVerrechg.AppearanceCell.Options.UseTextOptions = true;
            this.colVerrechg.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVerrechg.AppearanceHeader.Options.UseTextOptions = true;
            this.colVerrechg.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVerrechg.Caption = "Verr. Ist";
            this.colVerrechg.DisplayFormat.FormatString = "N2";
            this.colVerrechg.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colVerrechg.FieldName = "BetragVerrechg";
            this.colVerrechg.Name = "colVerrechg";
            this.colVerrechg.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colVerrechg.Visible = true;
            this.colVerrechg.VisibleIndex = 4;
            this.colVerrechg.Width = 76;
            // 
            // colAuszahlungIst
            // 
            this.colAuszahlungIst.AppearanceCell.Options.UseTextOptions = true;
            this.colAuszahlungIst.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colAuszahlungIst.AppearanceHeader.Options.UseTextOptions = true;
            this.colAuszahlungIst.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colAuszahlungIst.Caption = "Zahlg. Ist";
            this.colAuszahlungIst.DisplayFormat.FormatString = "N2";
            this.colAuszahlungIst.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colAuszahlungIst.FieldName = "Auszahlung";
            this.colAuszahlungIst.Name = "colAuszahlungIst";
            this.colAuszahlungIst.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colAuszahlungIst.Visible = true;
            this.colAuszahlungIst.VisibleIndex = 6;
            // 
            // colAuszahlungSoll
            // 
            this.colAuszahlungSoll.AppearanceCell.Options.UseTextOptions = true;
            this.colAuszahlungSoll.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colAuszahlungSoll.AppearanceHeader.Options.UseTextOptions = true;
            this.colAuszahlungSoll.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colAuszahlungSoll.Caption = "Zahlg. Soll";
            this.colAuszahlungSoll.DisplayFormat.FormatString = "N2";
            this.colAuszahlungSoll.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colAuszahlungSoll.FieldName = "AuszahlungSoll";
            this.colAuszahlungSoll.Name = "colAuszahlungSoll";
            this.colAuszahlungSoll.OptionsColumn.AllowEdit = false;
            this.colAuszahlungSoll.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colAuszahlungSoll.Visible = true;
            this.colAuszahlungSoll.VisibleIndex = 7;
            // 
            // colGuth
            // 
            this.colGuth.AppearanceCell.BackColor = System.Drawing.Color.LightSalmon;
            this.colGuth.AppearanceCell.Options.UseBackColor = true;
            this.colGuth.AppearanceCell.Options.UseTextOptions = true;
            this.colGuth.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colGuth.AppearanceHeader.Options.UseTextOptions = true;
            this.colGuth.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colGuth.Caption = "+/- Guth.";
            this.colGuth.DisplayFormat.FormatString = "N2";
            this.colGuth.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colGuth.FieldName = "Guthaben";
            this.colGuth.Name = "colGuth";
            this.colGuth.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colGuth.Visible = true;
            this.colGuth.VisibleIndex = 8;
            this.colGuth.Width = 74;
            // 
            // colLeisSaldo
            // 
            this.colLeisSaldo.AppearanceCell.Options.UseTextOptions = true;
            this.colLeisSaldo.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLeisSaldo.AppearanceHeader.Options.UseTextOptions = true;
            this.colLeisSaldo.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colLeisSaldo.Caption = "Saldo";
            this.colLeisSaldo.DisplayFormat.FormatString = "N2";
            this.colLeisSaldo.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colLeisSaldo.FieldName = "Saldo";
            this.colLeisSaldo.Name = "colLeisSaldo";
            this.colLeisSaldo.Width = 70;
            // 
            // colErledigt
            // 
            this.colErledigt.Caption = "erl";
            this.colErledigt.FieldName = "ErledigterMonat";
            this.colErledigt.Name = "colErledigt";
            this.colErledigt.Visible = true;
            this.colErledigt.VisibleIndex = 9;
            this.colErledigt.Width = 27;
            // 
            // colistWH
            // 
            this.colistWH.Caption = "WH";
            this.colistWH.FieldName = "Unterstuetzungsfall";
            this.colistWH.Name = "colistWH";
            this.colistWH.Visible = true;
            this.colistWH.VisibleIndex = 10;
            this.colistWH.Width = 30;
            // 
            // colTitel
            // 
            this.colTitel.Caption = "Titel";
            this.colTitel.FieldName = "Titel";
            this.colTitel.Name = "colTitel";
            this.colTitel.Visible = true;
            this.colTitel.VisibleIndex = 11;
            this.colTitel.Width = 120;
            // 
            // colRtName
            // 
            this.colRtName.Caption = "Rechtstitel";
            this.colRtName.FieldName = "RTName";
            this.colRtName.Name = "colRtName";
            this.colRtName.OptionsColumn.AllowEdit = false;
            this.colRtName.Visible = true;
            this.colRtName.VisibleIndex = 12;
            this.colRtName.Width = 150;
            // 
            // colLeisBemerkung
            // 
            this.colLeisBemerkung.Caption = "Bemerkung";
            this.colLeisBemerkung.FieldName = "Bemerkung";
            this.colLeisBemerkung.Name = "colLeisBemerkung";
            this.colLeisBemerkung.Visible = true;
            this.colLeisBemerkung.VisibleIndex = 13;
            this.colLeisBemerkung.Width = 102;
            // 
            // colIkRechtstitelID
            // 
            this.colIkRechtstitelID.Caption = "IkRechtstitelID";
            this.colIkRechtstitelID.FieldName = "IkRechtstitelID";
            this.colIkRechtstitelID.Name = "colIkRechtstitelID";
            this.colIkRechtstitelID.OptionsColumn.AllowEdit = false;
            // 
            // colEinmalig
            // 
            this.colEinmalig.Caption = "Einmalig";
            this.colEinmalig.FieldName = "Einmalig";
            this.colEinmalig.Name = "colEinmalig";
            this.colEinmalig.OptionsColumn.AllowEdit = false;
            // 
            // edtNurALBV
            // 
            this.edtNurALBV.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.edtNurALBV.EditValue = true;
            this.edtNurALBV.Location = new System.Drawing.Point(483, 10);
            this.edtNurALBV.Name = "edtNurALBV";
            this.edtNurALBV.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtNurALBV.Properties.Appearance.Options.UseBackColor = true;
            this.edtNurALBV.Properties.Caption = "Nur ALBV/ÜbH Gläubiger (Kinder)";
            this.edtNurALBV.Size = new System.Drawing.Size(222, 19);
            this.edtNurALBV.TabIndex = 5;
            this.edtNurALBV.CheckedChanged += new System.EventHandler(this.edtNurALBV_CheckedChanged);
            // 
            // edtSaldoBis
            // 
            this.edtSaldoBis.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.edtSaldoBis.EditValue = null;
            this.edtSaldoBis.Location = new System.Drawing.Point(483, 35);
            this.edtSaldoBis.Name = "edtSaldoBis";
            this.edtSaldoBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtSaldoBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSaldoBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSaldoBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSaldoBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtSaldoBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSaldoBis.Properties.Appearance.Options.UseFont = true;
            this.edtSaldoBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtSaldoBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtSaldoBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtSaldoBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSaldoBis.Properties.ShowToday = false;
            this.edtSaldoBis.Size = new System.Drawing.Size(99, 24);
            this.edtSaldoBis.TabIndex = 6;
            this.edtSaldoBis.EditValueChanged += new System.EventHandler(this.edtSaldoBis_EditValueChanged);
            // 
            // kissLabel1
            // 
            this.kissLabel1.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.kissLabel1.Location = new System.Drawing.Point(588, 35);
            this.kissLabel1.Name = "kissLabel1";
            this.kissLabel1.Size = new System.Drawing.Size(117, 24);
            this.kissLabel1.TabIndex = 7;
            this.kissLabel1.Text = "Saldo berechnen bis ";
            this.kissLabel1.UseCompatibleTextRendering = true;
            // 
            // btnVerrechnung
            // 
            this.btnVerrechnung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnVerrechnung.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnVerrechnung.Location = new System.Drawing.Point(483, 78);
            this.btnVerrechnung.Name = "btnVerrechnung";
            this.btnVerrechnung.Size = new System.Drawing.Size(227, 24);
            this.btnVerrechnung.TabIndex = 8;
            this.btnVerrechnung.Text = "Zahlungsminderung in Verrechnung";
            this.btnVerrechnung.UseCompatibleTextRendering = true;
            this.btnVerrechnung.UseVisualStyleBackColor = false;
            this.btnVerrechnung.Click += new System.EventHandler(this.btnVerrechnung_Click);
            // 
            // btnZahlung
            // 
            this.btnZahlung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnZahlung.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnZahlung.Location = new System.Drawing.Point(483, 108);
            this.btnZahlung.Name = "btnZahlung";
            this.btnZahlung.Size = new System.Drawing.Size(227, 24);
            this.btnZahlung.TabIndex = 9;
            this.btnZahlung.Text = "offener Saldo sofort bezahlen";
            this.btnZahlung.UseCompatibleTextRendering = true;
            this.btnZahlung.UseVisualStyleBackColor = false;
            this.btnZahlung.Click += new System.EventHandler(this.btnZahlung_Click);
            // 
            // colVerrechgSoll
            // 
            this.colVerrechgSoll.AppearanceCell.Options.UseTextOptions = true;
            this.colVerrechgSoll.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVerrechgSoll.AppearanceHeader.Options.UseTextOptions = true;
            this.colVerrechgSoll.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVerrechgSoll.Caption = "Verr. Soll";
            this.colVerrechgSoll.DisplayFormat.FormatString = "N2";
            this.colVerrechgSoll.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colVerrechgSoll.FieldName = "BetragVerrechgSoll";
            this.colVerrechgSoll.Name = "colVerrechgSoll";
            this.colVerrechgSoll.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colVerrechgSoll.Visible = true;
            this.colVerrechgSoll.VisibleIndex = 5;
            // 
            // CtlIkMonatszahlenSaldo
            // 
            this.ActiveSQLQuery = this.qryGlaeubiger;
            this.Controls.Add(this.btnZahlung);
            this.Controls.Add(this.btnVerrechnung);
            this.Controls.Add(this.kissLabel1);
            this.Controls.Add(this.edtSaldoBis);
            this.Controls.Add(this.edtNurALBV);
            this.Controls.Add(this.grdSaldo);
            this.Controls.Add(this.grdPerson);
            this.Name = "CtlIkMonatszahlenSaldo";
            this.Size = new System.Drawing.Size(720, 407);
            ((System.ComponentModel.ISupportInitialize)(this.grdPerson)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryGlaeubiger)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwPerson)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdSaldo)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qrySaldo)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwSaldo)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtNurALBV.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSaldoBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region EventHandlers

        #region Private EventHandlers

        private void btnVerrechnung_Click(object sender, System.EventArgs e)
        {
            // Dialog zum definieren des Saldo
            DlgIkSaldoEingabe dlg = new DlgIkSaldoEingabe();
            dlg.Init(false, TotalSaldo, (decimal)0.0);
            if (dlg.ShowDialog() != DialogResult.OK) return;

            // Werte aus Dialog lesen
            decimal GrundForderung = Utils.ConvertToDecimal(dlg.edtGrundforderung.EditValue);
            decimal ProMonat = Utils.ConvertToDecimal(dlg.edtProMonat.EditValue);
            decimal LetzterMonat = Utils.ConvertToDecimal(dlg.edtLetzterMonat.EditValue);
            DateTime DatumVon = dlg.edtDatumVon.DateTime;
            DateTime DatumBis = dlg.edtDatumBis.DateTime;

            if (TotalSaldo == 0) return;

            // RechtstitelID anhand Verwendungsperiode holen
            object ikRechtstitelID_New = HoleAktiverRechtstitel(DatumVon, DatumBis, false);
            if (DBUtil.IsEmpty(ikRechtstitelID_New))
            {
                KissMsg.ShowInfo("Es konnte kein Rechtstitel zur angegebenen Verwendungsperiode gefunden werden.");
                return;
            }

            try
            {
                DBUtil.ExecSQLThrowingException(
                    "EXEC dbo.spIkVerrechnung_Insert {0}, {1}, {2}, {3}, {4}, {5}, {6}, {7}",
                    ikRechtstitelID_New,
                     Utils.ConvertToInt(qryGlaeubiger["BaPersonID"]),
                    GrundForderung,
                    ProMonat,
                    LetzterMonat,
                    DatumVon,
                    DatumBis,
                    // 1 = Nachzahlung an Gläubiger/in (Saldo > 0)
                    // 2 = Laufende Verrechnung (Saldo < 0)
                    (TotalSaldo > 0) ? 1 : 2
                );
            }
            catch(Exception ex)
            {
                KissMsg.ShowInfo(ex.Message);
                return;
            }

            if (TotalSaldo > 0)
            {
                // Nachzahlung an Gläubiger/in (Saldo > 0)
                KissMsg.ShowInfo(string.Format(
                    "Der Betrag von {0} wird ab dem {1} zusätzlich ausbezahlt.",
                    GrundForderung.ToString("N2"),
                    DatumVon.ToString("dd.MM.yyyy")
                ));
            }
            else
            {
                // Zahlungsminderung (Saldo < 0)
                KissMsg.ShowInfo(string.Format(
                    "Der Betrag von {0} wird ab dem {1} weniger ausbezahlt.",
                    GrundForderung.ToString("N2"),
                    DatumVon.ToString("dd.MM.yyyy")
                ));
            }
            GlaeubigerOeffnen();
        }

        private void btnZahlung_Click(object sender, System.EventArgs e)
        {
            // 07.07.2008 : sozheo : bei interner Verrechnung Abfrage

            // Totalsaldo berechnen auf alle Positionen
            int personID = Utils.ConvertToInt(qryGlaeubiger["BaPersonID"]);
            SqlQuery qry;
            qry = DBUtil.OpenSQL(@"EXEC dbo.spIkMonatszahlen_TotalSaldo {0}, {1}, {2}",
                FaLeistungID,
                personID,
                edtSaldoBis.DateTime
            );
            TotalSaldo = TotalSaldo - Convert.ToInt32(qry["TotalSaldo"]);

            if (TotalSaldo < 0) return;

            decimal ZusatzBetrag =
                DBUtil.IsEmpty(qryGlaeubiger["BaZahlungswegID_ALBVZusatz"])
                ? (decimal)0.0 : Utils.ConvertToDecimal(qryGlaeubiger["BetragZusatz"]);

            DlgIkSaldoEingabe dlg = new DlgIkSaldoEingabe();
            dlg.Init(true, TotalSaldo, ZusatzBetrag);
            if (dlg.ShowDialog() != DialogResult.OK) return;

            decimal ZahlungsBetrag = Utils.ConvertToDecimal(dlg.edtGrundforderung.EditValue);
            decimal ZusatzZahlungsBetrag = Utils.ConvertToDecimal(dlg.edtProMonat.EditValue);
            decimal VermSaldo = Utils.ConvertToDecimal(qryGlaeubiger["BetragSaldoVermittelt"]);
            DateTime VerwVon = (DateTime)dlg.edtVerwPeriodeVon.EditValue;
            DateTime VerwBis = (DateTime)dlg.edtVerwPeriodeBis.EditValue;


            // Kontrollabfrage, wenn auf interne Verrechnung gestellt ist
            qry = DBUtil.OpenSQL(@"
                select top 1 IV.IntVerrechnung_ALBV 
                from dbo.IkInterneVerrechnung IV WITH(READUNCOMMITTED)
                WHERE IV.FaLeistungID = {0}
                AND IV.BaPersonID = {1}
                AND IV.DatumVon <= {2}
                ORDER BY IV.DatumVon desc",
                FaLeistungID,
                personID,
                VerwVon
            );
            bool InterneVerrechnung = Utils.ConvertToBool(qry["IntVerrechnung_ALBV"], false);
            if (InterneVerrechnung)
            {
                if (!KissMsg.ShowQuestion(
                    "Der Gläubiger ist auf interne Verrechnung eingestellt.\r\n" +
                    "Wollen Sie die sofortige Zahlung trotzdem ausführen?"
                )) return;
            }


            // RechtstitelID anhand Verwendungsperiode holen
            object ikRechtstitelID_New = HoleAktiverRechtstitel(VerwVon, VerwBis, true);

            bool HasErrors = true;
            if (ZahlungsBetrag > 0)
            {
                try
                {
                    qry = DBUtil.OpenSQL(@"
                        DECLARE @Res int
                        EXEC @Res = dbo.spIkPosition_InsertZahlung {0}, {1}, {2}, {3}, {4}, {5}, {6}, {7}
                        select Result = @Res",
                        FaLeistungID,
                        ikRechtstitelID_New,
                        personID,
                        ZahlungsBetrag,
                        FaProzessCode,
                        false,
                        VerwVon,
                        VerwBis
                    );
                    HasErrors = (Utils.ConvertToInt(qry["Result"]) <= 0);
                }
                catch(Exception ex)
                {
                    KissMsg.ShowInfo(ex.Message);
                    return;
                }
                if (HasErrors) return;
            }

            if (ZusatzZahlungsBetrag > 0)
            {
                try
                {
                    qry = DBUtil.OpenSQL(@"
                        DECLARE @Res int
                        EXEC @Res = dbo.spIkPosition_InsertZahlung {0}, {1}, {2}, {3}, {4}, {5}, {6}, {7}
                        select Result = @Res",
                        FaLeistungID,
                        ikRechtstitelID_New,
                        personID,
                        ZusatzZahlungsBetrag,
                        FaProzessCode,
                        true,
                        VerwVon,
                        VerwBis
                    );
                    HasErrors = (Utils.ConvertToInt(qry["Result"]) <= 0);
                }
                catch(Exception ex)
                {
                    KissMsg.ShowInfo(ex.Message);
                    return;
                }
                if (HasErrors) return;
            }

            if (VermSaldo != 0)
            {
                try
                {
                    qry = DBUtil.OpenSQL(@"
                        DECLARE @Res int
                        EXEC @Res = dbo.spIkPosition_InsertForderung {0}, {1}, {2}, {3}, {4}, {5}, {6}
                        select Result = @Res",
                        FaLeistungID,
                        ikRechtstitelID_New,
                        personID,
                        VermSaldo,
                        FaProzessCode,
                        VerwVon,
                        VerwBis
                    );
                    HasErrors = (Utils.ConvertToInt(qry["Result"]) <= 0);
                }
                catch(Exception ex)
                {
                    KissMsg.ShowInfo(ex.Message);
                    return;
                }
                if (HasErrors) return;
            }

            if (ZahlungsBetrag > 0 && ZusatzZahlungsBetrag > 0)
            {
                KissMsg.ShowInfo(string.Format(
                    "Eine Zahlung von {0} und eine Zusatzzahlung von {1} wurden erstellt.",
                    ZahlungsBetrag.ToString("N2"),
                    ZusatzZahlungsBetrag.ToString("N2")
                ));
            }
            else if (ZahlungsBetrag > 0 && ZusatzZahlungsBetrag == 0)
            {
                KissMsg.ShowInfo(string.Format(
                    "Eine neue einmalige Zahlung von {0} wurde erstellt.",
                    ZahlungsBetrag.ToString("N2")
                ));
            }
            else
            {
                KissMsg.ShowInfo(string.Format(
                    "Eine neue einmalige Zusatzzahlung von {0} wurde erstellt.",
                    ZusatzZahlungsBetrag.ToString("N2")
                ));
            }
            GlaeubigerOeffnen();
        }

        private void edtNurALBV_CheckedChanged(object sender, EventArgs e)
        {
            // Daten aktualisieren
            GlaeubigerOeffnen();
        }

        private void edtSaldoBis_EditValueChanged(object sender, System.EventArgs e)
        {
            if (!edtSaldoBis.UserModified) return;
            if (DBUtil.IsEmpty(edtSaldoBis.EditValue)) return;

            // Daten aktualisieren
            GlaeubigerOeffnen();
        }

        private void gvwSaldo_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e)
        {
            e.Handled = false;
            if (gvwSaldo.FocusedRowHandle == e.RowHandle) return;

            // 01.07.2009 : sozheo : Umbau neues Konzept, altes Konzept in grau
            bool istEinmalig = Utils.ConvertToBool(gvwSaldo.GetRowCellValue(e.RowHandle, gvwSaldo.Columns["Einmalig"]), true);
            int rtID = Utils.ConvertToInt(gvwSaldo.GetRowCellValue(e.RowHandle, gvwSaldo.Columns["IkRechtstitelID"]));
            e.Appearance.ForeColor = (rtID > 0 && !istEinmalig) ? Color.Gray : Color.Black;
        }

        private void qryGlaeubiger_AfterFill(object sender, System.EventArgs e)
        {
            TextInfoSetzen();
            if (qryGlaeubiger.Count == 0) qryGlaeubiger_PositionChanged(sender, e);
        }

        private void qryGlaeubiger_PositionChanged(object sender, System.EventArgs e)
        {
            if (GlaeubigerFilling) return;

            decimal ASaldo = Utils.ConvertToDecimal(qryGlaeubiger["BetragSaldo"]);
            decimal TSaldo = Utils.ConvertToDecimal(qryGlaeubiger["BetragSaldoTotal"]);
            bool IstEltern = Utils.ConvertToBool(qryGlaeubiger["IstElternteil"], true);
            int GStatus = Utils.ConvertToInt(qryGlaeubiger["IkGlaeubigerStatusCode"]);

            btnVerrechnung.Enabled = (
                !IstEltern &&
                !LeistgIstGeschlossen &&
                qryGlaeubiger.Count > 0 &&
                GStatus == 2 &&
                ASaldo < 0 &&
                TSaldo < 0
            );

            btnZahlung.Enabled = (
                !IstEltern &&
                !LeistgIstGeschlossen &&
                qryGlaeubiger.Count > 0 &&
                GStatus == 2 &&
                ASaldo > 0 &&
                TSaldo > 0
            );

            // Unteres Gitter aktualisieren:
            SaldoOeffnen();
        }

        private void qrySaldo_AfterFill(object sender, System.EventArgs e)
        {
            SaldoBerechnen();
        }

        #endregion

        #endregion

        #region Methods

        #region Public Methods

        public void GlaeubigerOeffnen()
        {
            //int PersID = qryGlaeubiger.IsOpen ? Utils.ConvertToInt(qryGlaeubiger["BaPersonID"]) : 0;
            int PersID = Utils.ConvertToInt(qryGlaeubiger["BaPersonID"]);

            // Damit auf den zuletzt gewählten Gläubiger gesprungen werden kann
            // und das Berechnen des Saldo nichalles nichtt unnötig führt wird... :
            GlaeubigerFilling = true;
            try
            {

                /*
                select distinct
                  G.BaPersonID,
                  G.IstElternteil,
                  Name = P.Name + isNull(' '+P.Vorname, '') +
                    isNULL(', '+Convert(varchar, P.Geburtsdatum, 104) + ' ', ''),
                  [Alter] = dbo.fnGetAge(P.Geburtsdatum, getDate()),
                  BetragALBV = case
                    when G.IstElternteil = 1 then NULL
                    else (
                      select top 1 P.Wert3 from dbo.AmAbPosition P WITH(READUNCOMMITTED)
                      left join dbo.AmAbKind K WITH(READUNCOMMITTED) on K.AmAbKindID = P.AmAbKindID
                      left join dbo.AmAnspruchsberechnung A WITH(READUNCOMMITTED) on A.AmAnspruchsberechnungID = P.AmAnspruchsberechnungID
                      left join dbo.FaLeistung M WITH(READUNCOMMITTED) on M.FaLeistungID = A.FaLeistungID
                      where M.FaFallID = L.FaFallID
                      and L.FaProzessCode in (402,403,404)
                      and K.BaPersonID = G.BaPersonID
                      and A.AmBerechnungsStatusCode = 3  -- bewilligt
                      and (
                        (P.AmAbPositionsArtID =  730 and L.FaProzessCode in (402,403) and K.BerechtigtCode IN (1,2)) or
                        (P.AmAbPositionsArtID = 3290 and L.FaProzessCode in (404)     and K.BerechtigtCode IN (3))
                      )
                      order by A.BerechnungDatumAb
                    )
                  end,
                  BetragSaldo = case when G.IstElternteil = 1 then NULL else (
                    IsNull(G.VorSaldo,0) + (select
                      -SUM(IsNull(S.BetragZahlung,0))
                      +SUM(IsNull(S.BetragZahlungSoll,0))
                      -SUM(IsNull(S.BetragEinmalig,0))
                    from dbo.IkPosition S WITH(READUNCOMMITTED)
                    --where S.IkRechtstitelID = R.IkRechtstitelID
                    where S.FaLeistungID = R.FaLeistungID
                    and S.BaPersonID = G.BaPersonID
                    and (S.Einmalig = 0 or S.IkBuchungsartCode in (2,3))
                    and S.Datum <= {2})
                  )
                  end,
                  BetragSaldoVermittelt = case when G.IstElternteil = 1 then NULL else (
                    select
                      sum(case
                        when IsNull(S.TotalAlimentSoll,0) > IsNull(S.BetragALBVSoll,0)
                        then IsNull(S.TotalAlimentSoll,0) - IsNull(S.BetragALBVSoll,0)
                        else 0 end)
                      -sum(case
                        when IsNull(S.TotalAliment,0) > IsNull(S.BetragALBV,0)
                        then IsNull(S.TotalAliment,0) - IsNull(S.BetragALBV,0)
                        else 0 end)
                      +sum(case
                        when S.IkBuchungsartCode = 4 then IsNull(-S.BetragEinmalig,0)
                        when S.IkBuchungsartCode = 5 then IsNull(S.BetragEinmalig,0)
                        else 0 end)
                    from dbo.IkPosition S WITH(READUNCOMMITTED)
                    --where S.IkRechtstitelID = R.IkRechtstitelID
                    where S.FaLeistungID = R.FaLeistungID
                    and S.BaPersonID = G.BaPersonID
                    and (S.Einmalig = 0 or S.IkBuchungsartCode in (4,5))
                    and S.Datum <= {2}
                  )
                  end,
                  Guthaben = Convert(money, 0.0),
                  Saldo = Convert(money, 0.0),
                  VorSaldo = SUM(G.VorSaldo),
                  G.IkGlaeubigerStatusCode,  -- TODO: ist das ok? wo verwendet?
                  GZW.BaZahlungswegID_ALBV,
                  GZW.BaZahlungswegID_ALBVZusatz,
                  GZW.BetragZusatz,
                  GZW.IntVerrechnung_ALBV,
                  Info = Convert(varchar(200), '')
                from dbo.IkGlaeubiger G WITH(READUNCOMMITTED)
                left join dbo.IkRechtstitel R WITH(READUNCOMMITTED) on R.IkRechtstitelID = G.IkRechtstitelID
                left join dbo.FaLeistung L WITH(READUNCOMMITTED) on L.FaLeistungID = R.FaLeistungID
                left join dbo.BaPerson P WITH(READUNCOMMITTED) on P.BaPersonID = G.BaPersonID
                left join dbo.IkInterneVerrechnung GZW WITH(READUNCOMMITTED) on GZW.IkInterneVerrechnungID = (
                  SELECT TOP 1 IV.IkInterneVerrechnungID FROM dbo.IkInterneVerrechnung IV
                  WHERE IV.FaLeistungID = L.FaLeistungID
                    AND IV.BaPersonID = G.BaPersonID
                    AND IV.DatumVon <= GETDATE()
                  ORDER BY IV.DatumVon desc
                )
                where R.FaLeistungID = {0} --G.IkRechtstitelID = {0}
                  and G.IkGlaeubigerStatusCode != 9
                  and (0 = {1} or L.FaProzessCode in (406,407) or G.BaPersonID in (
                    select K.BaPersonID from dbo.AmAbKind K WITH(READUNCOMMITTED)
                    left join dbo.AmAnspruchsberechnung A WITH(READUNCOMMITTED) on A.AmAnspruchsberechnungID = K.AmAnspruchsberechnungID
                    left join dbo.FaLeistung M WITH(READUNCOMMITTED) on M.FaLeistungID = A.FaLeistungID
                    where L.FaFallID = M.FaFallID and K.BerechtigtCode = 1 and M.FaProzessCode in (402,403)
                      and A.BerechnungDatumAb <= {2}
                  ))
                group by G.BaPersonID, P.Name, P.Vorname, P.Geburtsdatum, L.FaFallID, L.FaProzessCode, R.FaLeistungID,
                  G.IstElternteil, G.IkGlaeubigerStatusCode, G.VorSaldo,
                  GZW.BaZahlungswegID_ALBV, GZW.BaZahlungswegID_ALBVZusatz, GZW.BetragZusatz, GZW.IntVerrechnung_ALBV
                order by [Alter] desc, Name
                 * * */
                //qryGlaeubiger.Fill(IkRechtstitelID, edtNurALBV.Checked, edtSaldoBis.DateTime);
                qryGlaeubiger.Fill(FaLeistungID, edtNurALBV.Checked, edtSaldoBis.DateTime);
                if (PersID > 0) qryGlaeubiger.Find("BaPersonID=" + PersID.ToString());
            }
            finally
            {
                GlaeubigerFilling = false;
            }
            SaldoOeffnen();
            qryGlaeubiger_PositionChanged(null, null);
        }

        public void InitLeistung(int ProzessCode, int LeistungID, bool LeistgGeschlossen)
        {
            FaLeistungID = LeistungID;
            // Damit Fehler im Umbau schnell bemerkt werden:(kann später entfernt werden)
            if (FaLeistungID < 1) KissMsg.ShowInfo("Programmfehler: Leistungs-ID ist nicht gesetzt.");

            FaProzessCode = ProzessCode;
            LeistgIstGeschlossen = LeistgGeschlossen;

            // soll erst später sichtbar sein, ev. R4
            btnVerrechnung.Visible = false;

            if (FaProzessCode == 407)
            {
                edtNurALBV.Text = "Nur KKBB Gläubiger (Kinder)";
                colALBVBetrag.Caption = "akt. KKBB";
            }

            // Datum auf Ende nächster Monat setzen
            edtSaldoBis.EditValue = Utils.lastDayOfMonth(DateTime.Today.AddMonths(3));

            // Daten anzeigen
            GlaeubigerOeffnen();
        }

        #endregion

        #region Private Methods

        private object HoleAktiverRechtstitel(DateTime Von, DateTime Bis, bool idCanBeNull)
        {
            // Der aktive Rechtstitel beim Erstellen von Nachzahlungen im Ritter Saldo
            // wird anhand der Verwendungsperiode folgendermassen eruiert:
            // gibt es in der Verwendungsperiode nur einen Rechtstitel (Datum Rechtskräftig der Infos),
            // wird dieser gesetzt, falls es mehrere gibt, wird keiner gesetzt (Anzeige ist dann [Diverse]).
            SqlQuery qryRt = DBUtil.OpenSQL(@"
                select R.IkRechtstitelID from dbo.IkRechtstitel R
                where R.FaLeistungID = {0}
                and {1} between R.IkRechtstitelGueltigVon and ISNULL(R.IkRechtstitelGueltigBis, convert(datetime, '99990101'))
                and {2} between R.IkRechtstitelGueltigVon and ISNULL(R.IkRechtstitelGueltigBis, convert(datetime, '99990101'))
                order by R.IkRechtstitelGueltigVon desc",
                FaLeistungID, Von, Bis);

            if (qryRt.Count == 0)
            {
                qryRt = DBUtil.OpenSQL(@"
                    select R.IkRechtstitelID from dbo.IkRechtstitel R
                    where R.FaLeistungID = {0}
                    and R.IkRechtstitelGueltigVon < {1}
                    order by R.IkRechtstitelGueltigVon desc",
                    FaLeistungID, Bis
                );
            }

            if (idCanBeNull)
            {
                return qryRt.Count == 1 ? qryRt["IkRechtstitelID"] : DBNull.Value;
            }
            else
            {
                return qryRt["IkRechtstitelID"];
            }
        }

        private void SaldoBerechnen()
        {
            TotalSaldo = (Decimal)0.0;
            if (qrySaldo.Count == 0) return;

            Decimal Guthaben = (Decimal)0.0;
            Decimal Saldo = (Decimal)0.0;
            Decimal SaldoVerm = (Decimal)0.0;
            Guthaben = Utils.ConvertToDecimal(qryGlaeubiger["VorSaldo"]);
            TotalSaldo = Guthaben;
            foreach (System.Data.DataRow row in qrySaldo.DataTable.Rows)
            {
                // Saldo
                Saldo += Utils.ConvertToDecimal(row["Auszahlung"]);
                row["Saldo"] = Saldo;

                // Guthaben
                // 11.07.2009 : es solll nur Differenz angezeigt werden, nicht Kumulierung
                //Guthaben +=
                Guthaben =
                    Utils.ConvertToDecimal(row["AuszahlungSoll"])
                  - Utils.ConvertToDecimal(row["Auszahlung"]);
                row["Guthaben"] = Guthaben;
                TotalSaldo += Guthaben;

                // Saldo vermittelt
                SaldoVerm +=
                    Utils.ConvertToDecimal(row["BetragVermitteltSoll"])
                  - Utils.ConvertToDecimal(row["BetragVermittelt"]);
                row["SaldoVerm"] = SaldoVerm;
            }
        }

        private void SaldoOeffnen()
        {
            //qrySaldo.Fill(IkRechtstitelID, Utils.ConvertToInt(qryGlaeubiger["BaPersonID"]), edtSaldoBis.DateTime);
            qrySaldo.Fill(FaLeistungID, Utils.ConvertToInt(qryGlaeubiger["BaPersonID"]), edtSaldoBis.DateTime);
        }

        private void TextInfoSetzen()
        {
            if (qryGlaeubiger.Count == 0) return;

            decimal Saldo;
            foreach (System.Data.DataRow row in qryGlaeubiger.DataTable.Rows)
            {
                Saldo = Utils.ConvertToDecimal(row["BetragSaldo"]);
                if (Saldo > 0)
                    row["Info"] = "zu Gunsten Gläubiger";
                else if (Saldo < 0)
                    row["Info"] = "zu Gunsten Stadt";
                else
                    row["Info"] = DBNull.Value;
            }
        }

        #endregion
         
        #endregion
    }
}