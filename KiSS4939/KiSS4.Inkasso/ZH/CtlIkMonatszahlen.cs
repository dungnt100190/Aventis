#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Drawing;
using Kiss.Interfaces.UI;
using KiSS4.Common;
using KiSS4.DB;
using KiSS4.Gui;
using KiSS4.Common.Report;

namespace KiSS4.Inkasso.ZH
{
    public class CtlIkMonatszahlen : KiSS4.Gui.KissUserControl
    {
        #region Fields

        private int FaFallID = -1;
        private int FaLeistungID1 = -1;
        private int FaProzessCode;
        private int FallBaPersonID = -1;
        private bool LeistungIstGeschlossen = true;
        private KiSS4.Gui.KissButton btnCreate;
        private KiSS4.Gui.KissButton btnDrucken;
        private DevExpress.XtraGrid.Columns.GridColumn colALBV;
        private DevExpress.XtraGrid.Columns.GridColumn colALBVSoll;
        private DevExpress.XtraGrid.Columns.GridColumn colALBVVerrechnet;
        private DevExpress.XtraGrid.Columns.GridColumn colALVermittelt;
        private DevExpress.XtraGrid.Columns.GridColumn colALVermitteltSoll;
        private DevExpress.XtraGrid.Columns.GridColumn colDiffALBV;
        private DevExpress.XtraGrid.Columns.GridColumn colDiffALBVSoll;
        private DevExpress.XtraGrid.Columns.GridColumn colFehlerInfos;
        private DevExpress.XtraGrid.Columns.GridColumn colIndexStandbeiBerechnung;
        private DevExpress.XtraGrid.Columns.GridColumn colIndexVonDatum;
        private DevExpress.XtraGrid.Columns.GridColumn colIntVerrechnung_ALBV;
        private DevExpress.XtraGrid.Columns.GridColumn colIntVerrechnung_ALV;
        private DevExpress.XtraGrid.Columns.GridColumn colIntVerrechnung_KiZu;
        private DevExpress.XtraGrid.Columns.GridColumn colIstBarzahlung;
        private DevExpress.XtraGrid.Columns.GridColumn colKinderzulage;
        private DevExpress.XtraGrid.Columns.GridColumn colKinderzulageSoll;
        private DevExpress.XtraGrid.Columns.GridColumn colMonat;
        private DevExpress.XtraGrid.Columns.GridColumn colMonatErledigt;
        private DevExpress.XtraGrid.Columns.GridColumn colMonatJahr;
        private DevExpress.XtraGrid.Columns.GridColumn colPerson;
        private DevExpress.XtraGrid.Columns.GridColumn colRTName;
        private DevExpress.XtraGrid.Columns.GridColumn colTotalAliment;
        private DevExpress.XtraGrid.Columns.GridColumn colTotalAlimentSoll;
        private System.ComponentModel.IContainer components;
        private KiSS4.Inkasso.ZH.CtlIkMonatszahlenEinmalig ctlIkMonatszahlenEinmalig;
        private KiSS4.Inkasso.ZH.CtlIkMonatszahlenSaldo ctlIkMonatszahlenSaldo;
        private KiSS4.Inkasso.ZH.CtlIkMonatszahlenVerrechnung ctlIkMonatszahlenVerrechnung;
        private KiSS4.Inkasso.ZH.CtlIkZahlungenEinmalig ctlIkZahlungenEinmalig;
        private KiSS4.Gui.KissCheckEdit edtBarzahlung;
        private KiSS4.Gui.KissRadioGroup edtSpaltenAnzeige;
        private KiSS4.Gui.KissGrid grdMonatszahlen;
        private DevExpress.XtraGrid.Views.Grid.GridView gvwMonatszahlen;
        private KiSS4.Gui.KissLabel kissLabel1;
        private KiSS4.Gui.KissLabel lblMessage;
        private KiSS4.Gui.KissLabel lblTitel;
        private KiSS4.Gui.KissMemoEdit memBemerkung;
        private System.Windows.Forms.Panel panel1;
        private System.Windows.Forms.PictureBox picTitel;
        private KiSS4.DB.SqlQuery qryMonatszahlen;
        private KiSS4.Gui.KissTabControlEx tabMonatszahlen;
        private SharpLibrary.WinControls.TabPageEx tbpEinmalig;
        private SharpLibrary.WinControls.TabPageEx tbpMonatsbudget;
        private SharpLibrary.WinControls.TabPageEx tbpSaldoALBV;
        private SharpLibrary.WinControls.TabPageEx tbpVerrechnungskonto;
        private KissCheckEdit chkDetailansicht;
        private DevExpress.XtraGrid.Columns.GridColumn colALBVVerrechnetSoll;
        private DevExpress.XtraGrid.Columns.GridColumn colRTNameNeu;
        private DevExpress.XtraGrid.Columns.GridColumn colIkRechtstitelID;
        private SharpLibrary.WinControls.TabPageEx tbpZahlungen;

        #endregion

        #region Constructors

        public CtlIkMonatszahlen(
            int LeistungID, int FallID,
            System.Drawing.Image icon,
            int RechtstitelIDAlt,
            int FallPersonID,
            int ProzessCode,
            bool LeistgGeschlossen,
            bool MZUebergeordnet)
            : this()
        {


            picTitel.Image = icon;
            FaLeistungID1 = LeistungID;

            // Damit Fehler im Umbau schnell bemerkt werden:(kann später entfernt werden)
            if (FaLeistungID1 < 1) KissMsg.ShowInfo("Programmfehler: Leistungs-ID ist nicht gesetzt.");

            FaFallID = FallID;
            FallBaPersonID = FallPersonID;
            FaProzessCode = ProzessCode;
            LeistungIstGeschlossen = LeistgGeschlossen;

            if (FaProzessCode == 406)
            {
                colALBV.Caption = "ÜbH Ist";
                colALBVSoll.Caption = "ÜbH Soll";
                colIntVerrechnung_ALBV.Caption = "WH ÜbH";
            }
            else if (FaProzessCode == 407)
            {
                colALBV.Caption = "KKBB Ist";
                colALBVSoll.Caption = "KKBB Soll";
                colIntVerrechnung_ALBV.Caption = "WH KKBB";
            }
            else
            {
                colALBV.Caption = "ALBV Ist";
                colALBVSoll.Caption = "ALBV Soll";
                colIntVerrechnung_ALBV.Caption = "WH ALBV";
            }

            if (FaProzessCode == 407) tbpSaldoALBV.Title = "Saldo KKBB";

            colTotalAliment.Visible = (FaProzessCode == 405);
            colTotalAlimentSoll.Visible = false; //(FaProzessCode == 405);
            colALVermittelt.Visible = (FaProzessCode == 405);
            colALVermitteltSoll.Visible = false; //(FaProzessCode == 405);
            colKinderzulage.Visible = (FaProzessCode == 405);
            colKinderzulageSoll.Visible = false; //(FaProzessCode == 405);
            colIndexVonDatum.Visible = (FaProzessCode == 405);
            colIndexStandbeiBerechnung.Visible = (FaProzessCode == 405);

            colIntVerrechnung_ALV.Visible = (FaProzessCode == 405);
            colIntVerrechnung_KiZu.Visible = (FaProzessCode == 405);

            edtSpaltenAnzeige_EditValueChanged(null, null);

            // Berechnung automatisch durchführen
            CalcualteMissingPositions(2);

            // Monatszahlen anzeigen
            MonatszahlenOeffnen();

            // Andere Tabs aktualisieren
            FillOtherRegisters();
        }

        public CtlIkMonatszahlen()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            this.tabMonatszahlen = new KiSS4.Gui.KissTabControlEx();
            this.tbpZahlungen = new SharpLibrary.WinControls.TabPageEx();
            this.ctlIkZahlungenEinmalig = new KiSS4.Inkasso.ZH.CtlIkZahlungenEinmalig();
            this.tbpEinmalig = new SharpLibrary.WinControls.TabPageEx();
            this.ctlIkMonatszahlenEinmalig = new KiSS4.Inkasso.ZH.CtlIkMonatszahlenEinmalig();
            this.tbpSaldoALBV = new SharpLibrary.WinControls.TabPageEx();
            this.ctlIkMonatszahlenSaldo = new KiSS4.Inkasso.ZH.CtlIkMonatszahlenSaldo();
            this.tbpVerrechnungskonto = new SharpLibrary.WinControls.TabPageEx();
            this.ctlIkMonatszahlenVerrechnung = new KiSS4.Inkasso.ZH.CtlIkMonatszahlenVerrechnung();
            this.tbpMonatsbudget = new SharpLibrary.WinControls.TabPageEx();
            this.chkDetailansicht = new KiSS4.Gui.KissCheckEdit();
            this.edtSpaltenAnzeige = new KiSS4.Gui.KissRadioGroup(this.components);
            this.btnDrucken = new KiSS4.Gui.KissButton();
            this.edtBarzahlung = new KiSS4.Gui.KissCheckEdit();
            this.qryMonatszahlen = new KiSS4.DB.SqlQuery(this.components);
            this.lblMessage = new KiSS4.Gui.KissLabel();
            this.btnCreate = new KiSS4.Gui.KissButton();
            this.kissLabel1 = new KiSS4.Gui.KissLabel();
            this.memBemerkung = new KiSS4.Gui.KissMemoEdit();
            this.grdMonatszahlen = new KiSS4.Gui.KissGrid();
            this.gvwMonatszahlen = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colMonatJahr = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colPerson = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colTotalAliment = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colTotalAlimentSoll = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colALBV = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colALBVSoll = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colALVermittelt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colALVermitteltSoll = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colKinderzulage = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colKinderzulageSoll = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colALBVVerrechnet = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colALBVVerrechnetSoll = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDiffALBV = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDiffALBVSoll = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colIndexStandbeiBerechnung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colIndexVonDatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colMonatErledigt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colIntVerrechnung_ALBV = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colIntVerrechnung_ALV = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colIntVerrechnung_KiZu = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colIstBarzahlung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colMonat = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colRTNameNeu = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colRTName = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFehlerInfos = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colIkRechtstitelID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.panel1 = new System.Windows.Forms.Panel();
            this.picTitel = new System.Windows.Forms.PictureBox();
            this.lblTitel = new KiSS4.Gui.KissLabel();
            this.tabMonatszahlen.SuspendLayout();
            this.tbpZahlungen.SuspendLayout();
            this.tbpEinmalig.SuspendLayout();
            this.tbpSaldoALBV.SuspendLayout();
            this.tbpVerrechnungskonto.SuspendLayout();
            this.tbpMonatsbudget.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.chkDetailansicht.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSpaltenAnzeige.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBarzahlung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryMonatszahlen)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMessage)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.memBemerkung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdMonatszahlen)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwMonatszahlen)).BeginInit();
            this.panel1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).BeginInit();
            this.SuspendLayout();
            // 
            // tabMonatszahlen
            // 
            this.tabMonatszahlen.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.tabMonatszahlen.Controls.Add(this.tbpZahlungen);
            this.tabMonatszahlen.Controls.Add(this.tbpEinmalig);
            this.tabMonatszahlen.Controls.Add(this.tbpSaldoALBV);
            this.tabMonatszahlen.Controls.Add(this.tbpVerrechnungskonto);
            this.tabMonatszahlen.Controls.Add(this.tbpMonatsbudget);
            this.tabMonatszahlen.Location = new System.Drawing.Point(0, 27);
            this.tabMonatszahlen.Name = "tabMonatszahlen";
            this.tabMonatszahlen.ShowFixedWidthTooltip = true;
            this.tabMonatszahlen.Size = new System.Drawing.Size(780, 550);
            this.tabMonatszahlen.TabIndex = 0;
            this.tabMonatszahlen.TabPages.AddRange(new SharpLibrary.WinControls.TabPageEx[] {
            this.tbpMonatsbudget,
            this.tbpEinmalig,
            this.tbpZahlungen,
            this.tbpVerrechnungskonto,
            this.tbpSaldoALBV});
            this.tabMonatszahlen.TabsLineColor = System.Drawing.Color.Black;
            this.tabMonatszahlen.TabsStyle = SharpLibrary.WinControls.TabsStyle.Flat;
            this.tabMonatszahlen.Text = "kissTabControlEx1";
            this.tabMonatszahlen.SelectedTabChanged += new SharpLibrary.WinControls.TabControlExTabChangeEventHandler(this.tabMonatszahlen_SelectedTabChanged);
            // 
            // tbpZahlungen
            // 
            this.tbpZahlungen.Controls.Add(this.ctlIkZahlungenEinmalig);
            this.tbpZahlungen.Location = new System.Drawing.Point(6, 6);
            this.tbpZahlungen.Name = "tbpZahlungen";
            this.tbpZahlungen.Size = new System.Drawing.Size(768, 512);
            this.tbpZahlungen.TabIndex = 6;
            this.tbpZahlungen.Title = "Einmalige Zahlungen";
            // 
            // ctlIkZahlungenEinmalig
            // 
            this.ctlIkZahlungenEinmalig.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.ctlIkZahlungenEinmalig.Dock = System.Windows.Forms.DockStyle.Fill;
            this.ctlIkZahlungenEinmalig.Location = new System.Drawing.Point(0, 0);
            this.ctlIkZahlungenEinmalig.Name = "ctlIkZahlungenEinmalig";
            this.ctlIkZahlungenEinmalig.Size = new System.Drawing.Size(768, 512);
            this.ctlIkZahlungenEinmalig.TabIndex = 0;
            // 
            // tbpEinmalig
            // 
            this.tbpEinmalig.Controls.Add(this.ctlIkMonatszahlenEinmalig);
            this.tbpEinmalig.Location = new System.Drawing.Point(6, 6);
            this.tbpEinmalig.Name = "tbpEinmalig";
            this.tbpEinmalig.Size = new System.Drawing.Size(768, 512);
            this.tbpEinmalig.TabIndex = 5;
            this.tbpEinmalig.Title = "Einmalige Forderung";
            // 
            // ctlIkMonatszahlenEinmalig
            // 
            this.ctlIkMonatszahlenEinmalig.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.ctlIkMonatszahlenEinmalig.Dock = System.Windows.Forms.DockStyle.Fill;
            this.ctlIkMonatszahlenEinmalig.Location = new System.Drawing.Point(0, 0);
            this.ctlIkMonatszahlenEinmalig.Name = "ctlIkMonatszahlenEinmalig";
            this.ctlIkMonatszahlenEinmalig.Size = new System.Drawing.Size(768, 512);
            this.ctlIkMonatszahlenEinmalig.TabIndex = 0;
            // 
            // tbpSaldoALBV
            // 
            this.tbpSaldoALBV.Controls.Add(this.ctlIkMonatszahlenSaldo);
            this.tbpSaldoALBV.Location = new System.Drawing.Point(6, 6);
            this.tbpSaldoALBV.Name = "tbpSaldoALBV";
            this.tbpSaldoALBV.Size = new System.Drawing.Size(768, 512);
            this.tbpSaldoALBV.TabIndex = 4;
            this.tbpSaldoALBV.Title = "Saldo ALBV/UeBH";
            // 
            // ctlIkMonatszahlenSaldo
            // 
            this.ctlIkMonatszahlenSaldo.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.ctlIkMonatszahlenSaldo.Dock = System.Windows.Forms.DockStyle.Fill;
            this.ctlIkMonatszahlenSaldo.Location = new System.Drawing.Point(0, 0);
            this.ctlIkMonatszahlenSaldo.Name = "ctlIkMonatszahlenSaldo";
            this.ctlIkMonatszahlenSaldo.Size = new System.Drawing.Size(768, 512);
            this.ctlIkMonatszahlenSaldo.TabIndex = 0;
            // 
            // tbpVerrechnungskonto
            // 
            this.tbpVerrechnungskonto.Controls.Add(this.ctlIkMonatszahlenVerrechnung);
            this.tbpVerrechnungskonto.Location = new System.Drawing.Point(6, 6);
            this.tbpVerrechnungskonto.Name = "tbpVerrechnungskonto";
            this.tbpVerrechnungskonto.Size = new System.Drawing.Size(768, 512);
            this.tbpVerrechnungskonto.TabIndex = 1;
            this.tbpVerrechnungskonto.Title = "Verrechnungskonto";
            // 
            // ctlIkMonatszahlenVerrechnung
            // 
            this.ctlIkMonatszahlenVerrechnung.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.ctlIkMonatszahlenVerrechnung.Dock = System.Windows.Forms.DockStyle.Fill;
            this.ctlIkMonatszahlenVerrechnung.Location = new System.Drawing.Point(0, 0);
            this.ctlIkMonatszahlenVerrechnung.Name = "ctlIkMonatszahlenVerrechnung";
            this.ctlIkMonatszahlenVerrechnung.Size = new System.Drawing.Size(768, 512);
            this.ctlIkMonatszahlenVerrechnung.TabIndex = 0;
            // 
            // tbpMonatsbudget
            // 
            this.tbpMonatsbudget.Controls.Add(this.chkDetailansicht);
            this.tbpMonatsbudget.Controls.Add(this.edtSpaltenAnzeige);
            this.tbpMonatsbudget.Controls.Add(this.btnDrucken);
            this.tbpMonatsbudget.Controls.Add(this.edtBarzahlung);
            this.tbpMonatsbudget.Controls.Add(this.lblMessage);
            this.tbpMonatsbudget.Controls.Add(this.btnCreate);
            this.tbpMonatsbudget.Controls.Add(this.kissLabel1);
            this.tbpMonatsbudget.Controls.Add(this.memBemerkung);
            this.tbpMonatsbudget.Controls.Add(this.grdMonatszahlen);
            this.tbpMonatsbudget.Location = new System.Drawing.Point(6, 6);
            this.tbpMonatsbudget.Name = "tbpMonatsbudget";
            this.tbpMonatsbudget.Size = new System.Drawing.Size(768, 512);
            this.tbpMonatsbudget.TabIndex = 0;
            this.tbpMonatsbudget.Title = "Monatsbudget";
            // 
            // chkDetailansicht
            // 
            this.chkDetailansicht.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.chkDetailansicht.EditValue = false;
            this.chkDetailansicht.Location = new System.Drawing.Point(654, 8);
            this.chkDetailansicht.Name = "chkDetailansicht";
            this.chkDetailansicht.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.chkDetailansicht.Properties.Appearance.Options.UseBackColor = true;
            this.chkDetailansicht.Properties.Caption = "Detailansicht";
            this.chkDetailansicht.Size = new System.Drawing.Size(104, 19);
            this.chkDetailansicht.TabIndex = 34;
            this.chkDetailansicht.CheckedChanged += new System.EventHandler(this.chkDetailansicht_CheckedChanged);
            // 
            // edtSpaltenAnzeige
            // 
            this.edtSpaltenAnzeige.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtSpaltenAnzeige.EditValue = 1;
            this.edtSpaltenAnzeige.Location = new System.Drawing.Point(638, 424);
            this.edtSpaltenAnzeige.Name = "edtSpaltenAnzeige";
            this.edtSpaltenAnzeige.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtSpaltenAnzeige.Properties.Appearance.Options.UseBackColor = true;
            this.edtSpaltenAnzeige.Properties.AppearanceDisabled.BackColor = System.Drawing.Color.Transparent;
            this.edtSpaltenAnzeige.Properties.AppearanceDisabled.Options.UseBackColor = true;
            this.edtSpaltenAnzeige.Properties.Items.AddRange(new DevExpress.XtraEditors.Controls.RadioGroupItem[] {
            new DevExpress.XtraEditors.Controls.RadioGroupItem(1, "Ist anzeigen"),
            new DevExpress.XtraEditors.Controls.RadioGroupItem(2, "Soll anzeigen"),
            new DevExpress.XtraEditors.Controls.RadioGroupItem(9, "Beide")});
            this.edtSpaltenAnzeige.Size = new System.Drawing.Size(120, 61);
            this.edtSpaltenAnzeige.TabIndex = 33;
            this.edtSpaltenAnzeige.EditValueChanged += new System.EventHandler(this.edtSpaltenAnzeige_EditValueChanged);
            // 
            // btnDrucken
            // 
            this.btnDrucken.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.btnDrucken.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnDrucken.Location = new System.Drawing.Point(509, 461);
            this.btnDrucken.Name = "btnDrucken";
            this.btnDrucken.Size = new System.Drawing.Size(111, 24);
            this.btnDrucken.TabIndex = 32;
            this.btnDrucken.Text = "Drucken";
            this.btnDrucken.UseCompatibleTextRendering = true;
            this.btnDrucken.UseVisualStyleBackColor = false;
            this.btnDrucken.Click += new System.EventHandler(this.btnDrucken_Click);
            // 
            // edtBarzahlung
            // 
            this.edtBarzahlung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBarzahlung.DataMember = "IstBarzahlung";
            this.edtBarzahlung.DataSource = this.qryMonatszahlen;
            this.edtBarzahlung.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtBarzahlung.Location = new System.Drawing.Point(509, 423);
            this.edtBarzahlung.Name = "edtBarzahlung";
            this.edtBarzahlung.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtBarzahlung.Properties.Appearance.Options.UseBackColor = true;
            this.edtBarzahlung.Properties.Caption = "Barzahlung";
            this.edtBarzahlung.Properties.ReadOnly = true;
            this.edtBarzahlung.Size = new System.Drawing.Size(111, 19);
            this.edtBarzahlung.TabIndex = 31;
            // 
            // qryMonatszahlen
            // 
            this.qryMonatszahlen.BatchUpdate = true;
            this.qryMonatszahlen.CanUpdate = true;
            this.qryMonatszahlen.HostControl = this;
            this.qryMonatszahlen.TableName = "IkPosition";
            this.qryMonatszahlen.BeforePost += new System.EventHandler(this.qryMonatszahlen_BeforePost);
            this.qryMonatszahlen.PositionChanged += new System.EventHandler(this.qryMonatszahlen_PositionChanged);
            this.qryMonatszahlen.AfterFill += new System.EventHandler(this.qryMonatszahlen_AfterFill);
            this.qryMonatszahlen.PositionChanging += new System.EventHandler(this.qryMonatszahlen_PositionChanging);
            // 
            // lblMessage
            // 
            this.lblMessage.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblMessage.Location = new System.Drawing.Point(136, 488);
            this.lblMessage.Name = "lblMessage";
            this.lblMessage.Size = new System.Drawing.Size(328, 24);
            this.lblMessage.TabIndex = 30;
            this.lblMessage.Text = "kissLabel6";
            this.lblMessage.UseCompatibleTextRendering = true;
            this.lblMessage.Visible = false;
            // 
            // btnCreate
            // 
            this.btnCreate.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnCreate.Location = new System.Drawing.Point(10, 4);
            this.btnCreate.Name = "btnCreate";
            this.btnCreate.Size = new System.Drawing.Size(408, 24);
            this.btnCreate.TabIndex = 29;
            this.btnCreate.Text = "12 vorhergehende und 3 folgende Monate erstellen (optional)";
            this.btnCreate.UseCompatibleTextRendering = true;
            this.btnCreate.UseVisualStyleBackColor = false;
            this.btnCreate.Click += new System.EventHandler(this.btnCreate_Click);
            // 
            // kissLabel1
            // 
            this.kissLabel1.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.kissLabel1.Location = new System.Drawing.Point(10, 424);
            this.kissLabel1.Name = "kissLabel1";
            this.kissLabel1.Size = new System.Drawing.Size(59, 24);
            this.kissLabel1.TabIndex = 11;
            this.kissLabel1.Text = "Bemerkung";
            this.kissLabel1.UseCompatibleTextRendering = true;
            // 
            // memBemerkung
            // 
            this.memBemerkung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.memBemerkung.DataMember = "Bemerkung";
            this.memBemerkung.DataSource = this.qryMonatszahlen;
            this.memBemerkung.Location = new System.Drawing.Point(136, 424);
            this.memBemerkung.Name = "memBemerkung";
            this.memBemerkung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.memBemerkung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.memBemerkung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.memBemerkung.Properties.Appearance.Options.UseBackColor = true;
            this.memBemerkung.Properties.Appearance.Options.UseBorderColor = true;
            this.memBemerkung.Properties.Appearance.Options.UseFont = true;
            this.memBemerkung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.memBemerkung.Size = new System.Drawing.Size(347, 61);
            this.memBemerkung.TabIndex = 3;
            this.memBemerkung.EditValueChanged += new System.EventHandler(this.memBemerkung_EditValueChanged);
            // 
            // grdMonatszahlen
            // 
            this.grdMonatszahlen.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdMonatszahlen.DataSource = this.qryMonatszahlen;
            this.grdMonatszahlen.EmbeddedNavigator.Name = "";
            this.grdMonatszahlen.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdMonatszahlen.Location = new System.Drawing.Point(10, 34);
            this.grdMonatszahlen.MainView = this.gvwMonatszahlen;
            this.grdMonatszahlen.Name = "grdMonatszahlen";
            this.grdMonatszahlen.Size = new System.Drawing.Size(748, 374);
            this.grdMonatszahlen.TabIndex = 0;
            this.grdMonatszahlen.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.gvwMonatszahlen});
            // 
            // gvwMonatszahlen
            // 
            this.gvwMonatszahlen.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gvwMonatszahlen.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwMonatszahlen.Appearance.Empty.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.Empty.Options.UseFont = true;
            this.gvwMonatszahlen.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.gvwMonatszahlen.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwMonatszahlen.Appearance.EvenRow.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.EvenRow.Options.UseFont = true;
            this.gvwMonatszahlen.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwMonatszahlen.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwMonatszahlen.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gvwMonatszahlen.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.FocusedCell.Options.UseFont = true;
            this.gvwMonatszahlen.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gvwMonatszahlen.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwMonatszahlen.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwMonatszahlen.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gvwMonatszahlen.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.FocusedRow.Options.UseFont = true;
            this.gvwMonatszahlen.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gvwMonatszahlen.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwMonatszahlen.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwMonatszahlen.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwMonatszahlen.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwMonatszahlen.Appearance.GroupRow.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.GroupRow.Options.UseFont = true;
            this.gvwMonatszahlen.Appearance.GroupRow.Options.UseForeColor = true;
            this.gvwMonatszahlen.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gvwMonatszahlen.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gvwMonatszahlen.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwMonatszahlen.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gvwMonatszahlen.Appearance.HeaderPanel.Options.UseFont = true;
            this.gvwMonatszahlen.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gvwMonatszahlen.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwMonatszahlen.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwMonatszahlen.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gvwMonatszahlen.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gvwMonatszahlen.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gvwMonatszahlen.Appearance.HorzLine.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwMonatszahlen.Appearance.OddRow.Options.UseFont = true;
            this.gvwMonatszahlen.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gvwMonatszahlen.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwMonatszahlen.Appearance.Row.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.Row.Options.UseFont = true;
            this.gvwMonatszahlen.Appearance.SelectedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.gvwMonatszahlen.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwMonatszahlen.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.gvwMonatszahlen.Appearance.SelectedRow.Options.UseBackColor = true;
            this.gvwMonatszahlen.Appearance.SelectedRow.Options.UseFont = true;
            this.gvwMonatszahlen.Appearance.SelectedRow.Options.UseForeColor = true;
            this.gvwMonatszahlen.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gvwMonatszahlen.Appearance.VertLine.Options.UseBackColor = true;
            this.gvwMonatszahlen.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gvwMonatszahlen.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colMonatJahr,
            this.colPerson,
            this.colTotalAliment,
            this.colTotalAlimentSoll,
            this.colALBV,
            this.colALBVSoll,
            this.colALVermittelt,
            this.colALVermitteltSoll,
            this.colKinderzulage,
            this.colKinderzulageSoll,
            this.colALBVVerrechnet,
            this.colALBVVerrechnetSoll,
            this.colDiffALBV,
            this.colDiffALBVSoll,
            this.colIndexStandbeiBerechnung,
            this.colIndexVonDatum,
            this.colMonatErledigt,
            this.colIntVerrechnung_ALBV,
            this.colIntVerrechnung_ALV,
            this.colIntVerrechnung_KiZu,
            this.colIstBarzahlung,
            this.colMonat,
            this.colRTNameNeu,
            this.colRTName,
            this.colFehlerInfos,
            this.colIkRechtstitelID});
            this.gvwMonatszahlen.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gvwMonatszahlen.GridControl = this.grdMonatszahlen;
            this.gvwMonatszahlen.GroupSummary.AddRange(new DevExpress.XtraGrid.GridSummaryItem[] {
            new DevExpress.XtraGrid.GridGroupSummaryItem(DevExpress.Data.SummaryItemType.None, "", null, "")});
            this.gvwMonatszahlen.Name = "gvwMonatszahlen";
            this.gvwMonatszahlen.OptionsBehavior.Editable = false;
            this.gvwMonatszahlen.OptionsCustomization.AllowFilter = false;
            this.gvwMonatszahlen.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gvwMonatszahlen.OptionsNavigation.AutoFocusNewRow = true;
            this.gvwMonatszahlen.OptionsNavigation.UseTabKey = false;
            this.gvwMonatszahlen.OptionsView.ColumnAutoWidth = false;
            this.gvwMonatszahlen.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gvwMonatszahlen.OptionsView.ShowFooter = true;
            this.gvwMonatszahlen.OptionsView.ShowGroupPanel = false;
            this.gvwMonatszahlen.OptionsView.ShowIndicator = false;
            this.gvwMonatszahlen.CustomDrawCell += new DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventHandler(this.gvwMonatszahlen_CustomDrawCell);
            // 
            // colMonatJahr
            // 
            this.colMonatJahr.Caption = "Monat";
            this.colMonatJahr.DisplayFormat.FormatString = "yyyy.MM";
            this.colMonatJahr.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colMonatJahr.FieldName = "JahrMonat";
            this.colMonatJahr.Name = "colMonatJahr";
            this.colMonatJahr.OptionsColumn.AllowEdit = false;
            this.colMonatJahr.Visible = true;
            this.colMonatJahr.VisibleIndex = 0;
            this.colMonatJahr.Width = 65;
            // 
            // colPerson
            // 
            this.colPerson.Caption = " Gläubiger/in";
            this.colPerson.FieldName = "Person";
            this.colPerson.Name = "colPerson";
            this.colPerson.OptionsColumn.AllowEdit = false;
            this.colPerson.Visible = true;
            this.colPerson.VisibleIndex = 1;
            this.colPerson.Width = 130;
            // 
            // colTotalAliment
            // 
            this.colTotalAliment.AppearanceCell.Options.UseTextOptions = true;
            this.colTotalAliment.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colTotalAliment.AppearanceHeader.Options.UseTextOptions = true;
            this.colTotalAliment.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colTotalAliment.Caption = "Verpfl. Ist";
            this.colTotalAliment.DisplayFormat.FormatString = "N2";
            this.colTotalAliment.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colTotalAliment.FieldName = "TotalAliment";
            this.colTotalAliment.GroupFormat.FormatString = "N2";
            this.colTotalAliment.GroupFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colTotalAliment.Name = "colTotalAliment";
            this.colTotalAliment.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colTotalAliment.Visible = true;
            this.colTotalAliment.VisibleIndex = 2;
            // 
            // colTotalAlimentSoll
            // 
            this.colTotalAlimentSoll.AppearanceCell.Options.UseTextOptions = true;
            this.colTotalAlimentSoll.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colTotalAlimentSoll.AppearanceHeader.Options.UseTextOptions = true;
            this.colTotalAlimentSoll.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colTotalAlimentSoll.Caption = "Verpfl. Soll";
            this.colTotalAlimentSoll.DisplayFormat.FormatString = "N2";
            this.colTotalAlimentSoll.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colTotalAlimentSoll.FieldName = "TotalAlimentSoll";
            this.colTotalAlimentSoll.Name = "colTotalAlimentSoll";
            this.colTotalAlimentSoll.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colTotalAlimentSoll.Visible = true;
            this.colTotalAlimentSoll.VisibleIndex = 3;
            // 
            // colALBV
            // 
            this.colALBV.AppearanceCell.Options.UseTextOptions = true;
            this.colALBV.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBV.AppearanceHeader.Options.UseTextOptions = true;
            this.colALBV.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBV.Caption = "ALBV/ÜbH Ist";
            this.colALBV.DisplayFormat.FormatString = "N2";
            this.colALBV.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colALBV.FieldName = "BetragALBV";
            this.colALBV.Name = "colALBV";
            this.colALBV.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colALBV.Visible = true;
            this.colALBV.VisibleIndex = 4;
            // 
            // colALBVSoll
            // 
            this.colALBVSoll.AppearanceCell.Options.UseTextOptions = true;
            this.colALBVSoll.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVSoll.AppearanceHeader.Options.UseTextOptions = true;
            this.colALBVSoll.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVSoll.Caption = "ALBV/ÜbH Soll";
            this.colALBVSoll.DisplayFormat.FormatString = "N2";
            this.colALBVSoll.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colALBVSoll.FieldName = "BetragALBVSoll";
            this.colALBVSoll.Name = "colALBVSoll";
            this.colALBVSoll.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colALBVSoll.Visible = true;
            this.colALBVSoll.VisibleIndex = 5;
            // 
            // colALVermittelt
            // 
            this.colALVermittelt.AppearanceCell.Options.UseTextOptions = true;
            this.colALVermittelt.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALVermittelt.AppearanceHeader.Options.UseTextOptions = true;
            this.colALVermittelt.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALVermittelt.Caption = "verm. Ist";
            this.colALVermittelt.DisplayFormat.FormatString = "N2";
            this.colALVermittelt.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colALVermittelt.FieldName = "BetragVermittelt";
            this.colALVermittelt.Name = "colALVermittelt";
            this.colALVermittelt.OptionsColumn.AllowEdit = false;
            this.colALVermittelt.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colALVermittelt.Visible = true;
            this.colALVermittelt.VisibleIndex = 6;
            // 
            // colALVermitteltSoll
            // 
            this.colALVermitteltSoll.AppearanceCell.Options.UseTextOptions = true;
            this.colALVermitteltSoll.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALVermitteltSoll.AppearanceHeader.Options.UseTextOptions = true;
            this.colALVermitteltSoll.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALVermitteltSoll.Caption = "verm. Soll";
            this.colALVermitteltSoll.DisplayFormat.FormatString = "N2";
            this.colALVermitteltSoll.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colALVermitteltSoll.FieldName = "BetragVermitteltSoll";
            this.colALVermitteltSoll.Name = "colALVermitteltSoll";
            this.colALVermitteltSoll.OptionsColumn.AllowEdit = false;
            this.colALVermitteltSoll.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colALVermitteltSoll.Visible = true;
            this.colALVermitteltSoll.VisibleIndex = 7;
            // 
            // colKinderzulage
            // 
            this.colKinderzulage.AppearanceCell.Options.UseTextOptions = true;
            this.colKinderzulage.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colKinderzulage.AppearanceHeader.Options.UseTextOptions = true;
            this.colKinderzulage.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colKinderzulage.Caption = "Ki/A-Zu. Ist";
            this.colKinderzulage.DisplayFormat.FormatString = "N2";
            this.colKinderzulage.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colKinderzulage.FieldName = "BetragKiZulage";
            this.colKinderzulage.Name = "colKinderzulage";
            this.colKinderzulage.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colKinderzulage.Visible = true;
            this.colKinderzulage.VisibleIndex = 8;
            // 
            // colKinderzulageSoll
            // 
            this.colKinderzulageSoll.AppearanceCell.Options.UseTextOptions = true;
            this.colKinderzulageSoll.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colKinderzulageSoll.AppearanceHeader.Options.UseTextOptions = true;
            this.colKinderzulageSoll.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colKinderzulageSoll.Caption = "Ki/A-Zu. Soll";
            this.colKinderzulageSoll.DisplayFormat.FormatString = "N2";
            this.colKinderzulageSoll.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colKinderzulageSoll.FieldName = "BetragKiZulageSoll";
            this.colKinderzulageSoll.Name = "colKinderzulageSoll";
            this.colKinderzulageSoll.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colKinderzulageSoll.Visible = true;
            this.colKinderzulageSoll.VisibleIndex = 9;
            // 
            // colALBVVerrechnet
            // 
            this.colALBVVerrechnet.AppearanceCell.Options.UseTextOptions = true;
            this.colALBVVerrechnet.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVVerrechnet.AppearanceHeader.Font = new System.Drawing.Font("Tahoma", 6.75F, System.Drawing.FontStyle.Bold);
            this.colALBVVerrechnet.AppearanceHeader.Options.UseTextOptions = true;
            this.colALBVVerrechnet.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVVerrechnet.Caption = "verrechnet Ist";
            this.colALBVVerrechnet.DisplayFormat.FormatString = "N2";
            this.colALBVVerrechnet.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colALBVVerrechnet.FieldName = "BetragALBVverrechnung";
            this.colALBVVerrechnet.Name = "colALBVVerrechnet";
            this.colALBVVerrechnet.Visible = true;
            this.colALBVVerrechnet.VisibleIndex = 11;
            // 
            // colALBVVerrechnetSoll
            // 
            this.colALBVVerrechnetSoll.AppearanceCell.Options.UseTextOptions = true;
            this.colALBVVerrechnetSoll.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVVerrechnetSoll.AppearanceHeader.Options.UseTextOptions = true;
            this.colALBVVerrechnetSoll.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colALBVVerrechnetSoll.Caption = "verrechnet Soll";
            this.colALBVVerrechnetSoll.DisplayFormat.FormatString = "N2";
            this.colALBVVerrechnetSoll.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colALBVVerrechnetSoll.FieldName = "BetragALBVverrechnungSoll";
            this.colALBVVerrechnetSoll.Name = "colALBVVerrechnetSoll";
            this.colALBVVerrechnetSoll.Visible = true;
            this.colALBVVerrechnetSoll.VisibleIndex = 10;
            // 
            // colDiffALBV
            // 
            this.colDiffALBV.AppearanceCell.Options.UseTextOptions = true;
            this.colDiffALBV.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colDiffALBV.AppearanceHeader.Font = new System.Drawing.Font("Tahoma", 8.25F, System.Drawing.FontStyle.Bold);
            this.colDiffALBV.AppearanceHeader.Options.UseTextOptions = true;
            this.colDiffALBV.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colDiffALBV.Caption = "Zahlg. Ist";
            this.colDiffALBV.DisplayFormat.FormatString = "N2";
            this.colDiffALBV.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colDiffALBV.FieldName = "BetragZahlung";
            this.colDiffALBV.Name = "colDiffALBV";
            this.colDiffALBV.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colDiffALBV.Visible = true;
            this.colDiffALBV.VisibleIndex = 12;
            // 
            // colDiffALBVSoll
            // 
            this.colDiffALBVSoll.AppearanceCell.Options.UseTextOptions = true;
            this.colDiffALBVSoll.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colDiffALBVSoll.AppearanceHeader.Options.UseTextOptions = true;
            this.colDiffALBVSoll.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colDiffALBVSoll.Caption = "Zahlg. Soll";
            this.colDiffALBVSoll.DisplayFormat.FormatString = "N2";
            this.colDiffALBVSoll.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colDiffALBVSoll.FieldName = "BetragZahlungSoll";
            this.colDiffALBVSoll.Name = "colDiffALBVSoll";
            this.colDiffALBVSoll.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colDiffALBVSoll.Visible = true;
            this.colDiffALBVSoll.VisibleIndex = 13;
            // 
            // colIndexStandbeiBerechnung
            // 
            this.colIndexStandbeiBerechnung.AppearanceCell.Options.UseTextOptions = true;
            this.colIndexStandbeiBerechnung.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colIndexStandbeiBerechnung.Caption = "Punkte";
            this.colIndexStandbeiBerechnung.DisplayFormat.FormatString = "N1";
            this.colIndexStandbeiBerechnung.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colIndexStandbeiBerechnung.FieldName = "IndexStandBeiBerechnung";
            this.colIndexStandbeiBerechnung.Name = "colIndexStandbeiBerechnung";
            this.colIndexStandbeiBerechnung.Visible = true;
            this.colIndexStandbeiBerechnung.VisibleIndex = 14;
            this.colIndexStandbeiBerechnung.Width = 49;
            // 
            // colIndexVonDatum
            // 
            this.colIndexVonDatum.AppearanceCell.Options.UseTextOptions = true;
            this.colIndexVonDatum.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colIndexVonDatum.AppearanceHeader.Options.UseTextOptions = true;
            this.colIndexVonDatum.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colIndexVonDatum.Caption = "Index ";
            this.colIndexVonDatum.DisplayFormat.FormatString = "MM.yyyy";
            this.colIndexVonDatum.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colIndexVonDatum.FieldName = "IndexStandDatum";
            this.colIndexVonDatum.Name = "colIndexVonDatum";
            this.colIndexVonDatum.Visible = true;
            this.colIndexVonDatum.VisibleIndex = 15;
            this.colIndexVonDatum.Width = 55;
            // 
            // colMonatErledigt
            // 
            this.colMonatErledigt.Caption = "erl";
            this.colMonatErledigt.FieldName = "ErledigterMonat";
            this.colMonatErledigt.Name = "colMonatErledigt";
            this.colMonatErledigt.Visible = true;
            this.colMonatErledigt.VisibleIndex = 16;
            this.colMonatErledigt.Width = 27;
            // 
            // colIntVerrechnung_ALBV
            // 
            this.colIntVerrechnung_ALBV.AppearanceHeader.Options.UseTextOptions = true;
            this.colIntVerrechnung_ALBV.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.colIntVerrechnung_ALBV.Caption = "WH";
            this.colIntVerrechnung_ALBV.FieldName = "IntVerrechnung_ALBV";
            this.colIntVerrechnung_ALBV.MinWidth = 24;
            this.colIntVerrechnung_ALBV.Name = "colIntVerrechnung_ALBV";
            this.colIntVerrechnung_ALBV.Visible = true;
            this.colIntVerrechnung_ALBV.VisibleIndex = 17;
            this.colIntVerrechnung_ALBV.Width = 65;
            // 
            // colIntVerrechnung_ALV
            // 
            this.colIntVerrechnung_ALV.AppearanceHeader.Options.UseTextOptions = true;
            this.colIntVerrechnung_ALV.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.colIntVerrechnung_ALV.Caption = "WH ALV";
            this.colIntVerrechnung_ALV.FieldName = "IntVerrechnung_ALV";
            this.colIntVerrechnung_ALV.Name = "colIntVerrechnung_ALV";
            this.colIntVerrechnung_ALV.Visible = true;
            this.colIntVerrechnung_ALV.VisibleIndex = 18;
            this.colIntVerrechnung_ALV.Width = 65;
            // 
            // colIntVerrechnung_KiZu
            // 
            this.colIntVerrechnung_KiZu.AppearanceHeader.Options.UseTextOptions = true;
            this.colIntVerrechnung_KiZu.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.colIntVerrechnung_KiZu.Caption = "WH KiZu";
            this.colIntVerrechnung_KiZu.FieldName = "IntVerrechnung_KiZu";
            this.colIntVerrechnung_KiZu.Name = "colIntVerrechnung_KiZu";
            this.colIntVerrechnung_KiZu.Visible = true;
            this.colIntVerrechnung_KiZu.VisibleIndex = 19;
            this.colIntVerrechnung_KiZu.Width = 65;
            // 
            // colIstBarzahlung
            // 
            this.colIstBarzahlung.AppearanceHeader.Options.UseTextOptions = true;
            this.colIstBarzahlung.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.colIstBarzahlung.Caption = "bar";
            this.colIstBarzahlung.FieldName = "IstBarzahlung";
            this.colIstBarzahlung.Name = "colIstBarzahlung";
            this.colIstBarzahlung.Visible = true;
            this.colIstBarzahlung.VisibleIndex = 20;
            this.colIstBarzahlung.Width = 45;
            // 
            // colMonat
            // 
            this.colMonat.Caption = "Monat";
            this.colMonat.FieldName = "Monat";
            this.colMonat.Name = "colMonat";
            // 
            // colRTNameNeu
            // 
            this.colRTNameNeu.Caption = "Rechtstitel";
            this.colRTNameNeu.FieldName = "RTNameNeu";
            this.colRTNameNeu.Name = "colRTNameNeu";
            this.colRTNameNeu.OptionsColumn.AllowEdit = false;
            this.colRTNameNeu.Visible = true;
            this.colRTNameNeu.VisibleIndex = 21;
            // 
            // colRTName
            // 
            this.colRTName.Caption = "neu";
            this.colRTName.FieldName = "RTName";
            this.colRTName.Name = "colRTName";
            this.colRTName.OptionsColumn.AllowEdit = false;
            this.colRTName.Visible = true;
            this.colRTName.VisibleIndex = 22;
            this.colRTName.Width = 35;
            // 
            // colFehlerInfos
            // 
            this.colFehlerInfos.Caption = "Fehler";
            this.colFehlerInfos.FieldName = "FehlerInfos";
            this.colFehlerInfos.Name = "colFehlerInfos";
            this.colFehlerInfos.OptionsColumn.AllowEdit = false;
            this.colFehlerInfos.Visible = true;
            this.colFehlerInfos.VisibleIndex = 23;
            this.colFehlerInfos.Width = 150;
            // 
            // colIkRechtstitelID
            // 
            this.colIkRechtstitelID.Caption = "IkRechtstitelID";
            this.colIkRechtstitelID.FieldName = "IkRechtstitelID";
            this.colIkRechtstitelID.Name = "colIkRechtstitelID";
            // 
            // panel1
            // 
            this.panel1.Controls.Add(this.picTitel);
            this.panel1.Controls.Add(this.lblTitel);
            this.panel1.Dock = System.Windows.Forms.DockStyle.Top;
            this.panel1.Location = new System.Drawing.Point(0, 0);
            this.panel1.Name = "panel1";
            this.panel1.Size = new System.Drawing.Size(780, 24);
            this.panel1.TabIndex = 1;
            // 
            // picTitel
            // 
            this.picTitel.Location = new System.Drawing.Point(5, 5);
            this.picTitel.Name = "picTitel";
            this.picTitel.Size = new System.Drawing.Size(16, 16);
            this.picTitel.TabIndex = 293;
            this.picTitel.TabStop = false;
            // 
            // lblTitel
            // 
            this.lblTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitel.Location = new System.Drawing.Point(25, 5);
            this.lblTitel.Name = "lblTitel";
            this.lblTitel.Size = new System.Drawing.Size(542, 15);
            this.lblTitel.TabIndex = 0;
            this.lblTitel.Text = "Monatszahlen ";
            this.lblTitel.UseCompatibleTextRendering = true;
            // 
            // CtlIkMonatszahlen
            // 
            this.ActiveSQLQuery = this.qryMonatszahlen;
            this.Controls.Add(this.panel1);
            this.Controls.Add(this.tabMonatszahlen);
            this.Name = "CtlIkMonatszahlen";
            this.Size = new System.Drawing.Size(780, 580);
            this.tabMonatszahlen.ResumeLayout(false);
            this.tbpZahlungen.ResumeLayout(false);
            this.tbpEinmalig.ResumeLayout(false);
            this.tbpSaldoALBV.ResumeLayout(false);
            this.tbpVerrechnungskonto.ResumeLayout(false);
            this.tbpMonatsbudget.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.chkDetailansicht.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSpaltenAnzeige.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBarzahlung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryMonatszahlen)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMessage)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.memBemerkung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdMonatszahlen)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwMonatszahlen)).EndInit();
            this.panel1.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Public Properties

        public override KissUserControl DetailControl
        {
            get
            {
                if (tabMonatszahlen.SelectedTab.Controls.Count == 1 &&
                    tabMonatszahlen.SelectedTab.Controls[0] is KissUserControl)
                {
                    return (KissUserControl)tabMonatszahlen.SelectedTab.Controls[0];
                }
                else
                {
                    return base.DetailControl;
                }
            }
        }

        #endregion

        #region Private Properties

        private bool CanEdit
        {
            get
            {
                bool erledigt = Utils.ConvertToBool(qryMonatszahlen["ErledigterMonat"], false);
                return (
                  chkDetailansicht.Checked &&
                  qryMonatszahlen.Count > 0 &&
                  qryMonatszahlen.CanUpdate &&
                  !erledigt &&
                  !LeistungIstGeschlossen
                );
            }
        }

        private bool CanEditBemerkung
        {
            get
            {
                return (
                  chkDetailansicht.Checked &&
                  qryMonatszahlen.Count > 0 &&
                  qryMonatszahlen.CanUpdate &&
                  !LeistungIstGeschlossen
                );
            }
        }

        private bool CanPrint
        {
            get
            {
                bool erledigt = Utils.ConvertToBool(qryMonatszahlen["ErledigterMonat"], false);
                return (qryMonatszahlen.Count > 0 && erledigt);
            }
        }

        #endregion

        #region Private Methods

        private void CalcualteMissingPositions(int Modus)
        {
            try
            {
                SqlQuery sql = DBUtil.OpenSQL(
                    "EXEC dbo.spIkMonatszahlen_DetailAll {0}, {1}",
                    FaLeistungID1, Modus);
            }
            catch (Exception ex)
            {
                KissMsg.ShowInfo(ex.Message);
            }
        }

        private void FillOtherRegisters()
        {
            bool CanEdit = (FaLeistungID1 > 0);
            tbpEinmalig.Enabled = (FaLeistungID1 > 0);
            tbpZahlungen.Enabled = (FaLeistungID1 > 0);
            tbpVerrechnungskonto.Enabled = (FaLeistungID1 > 0);

            // Register "Einmalige Forderungen" aktualisieren:
            ctlIkMonatszahlenEinmalig.InitLeistung(
                "", null, FaFallID, FaLeistungID1, FaProzessCode, CanEdit, true, LeistungIstGeschlossen
            );

            // Register "Einmalige Zahlungen" aktualisieren:
            ctlIkZahlungenEinmalig.InitLeistung(
                "", null, FaFallID, FaLeistungID1, FaProzessCode, CanEdit, true, LeistungIstGeschlossen
            );

            // Register "Verrechnung" aktualisieren:
            ctlIkMonatszahlenVerrechnung.InitLeistung(
                FaLeistungID1, FaFallID, FallBaPersonID, CanEdit, LeistungIstGeschlossen
            );

            // Register "Saldo" aktualisieren:
            ctlIkMonatszahlenSaldo.InitLeistung(FaProzessCode, FaLeistungID1, LeistungIstGeschlossen);
        }

        private void MonatszahlenOeffnen()
        {
            string sql = "";
            if (chkDetailansicht.Checked)
            {
                // Alle Details anzeigen, doppelte Rechtstitel nicht zusammenziehen
                sql = "EXEC dbo.spIkMonatszahlen_AnsichtDetail {0}";
            }
            else
            {
                // Kein Details anzeigen, doppelte Rechtstitel zusammenziehen
                sql = "EXEC dbo.spIkMonatszahlen_Ansicht {0}";
            }
            qryMonatszahlen.SelectStatement = sql;
            qryMonatszahlen.Fill(FaLeistungID1);

            // wenn die Details angezeigt werden, stimmen die Summen nicht, deshalb ausschalten
            gvwMonatszahlen.OptionsView.ShowFooter = !chkDetailansicht.Checked;
        }

        private void btnCreate_Click(object sender, System.EventArgs e)
        {
            // 18.03.2008 : sozheo : Neu: Berechnung für alle Daten
            CalcualteMissingPositions(1);
            qryMonatszahlen.Refresh();
        }

        private void btnDrucken_Click(object sender, System.EventArgs e)
        {
            SqlQuery qryP = DBUtil.OpenSQL(@"
                select KbBuchungID, BelegNr, KbBuchungStatusCode, ValutaDatum
                from dbo.KbBuchung WITH(READUNCOMMITTED)
                where IkPositionID = {0}
                and IkForderungartCode in (10,11,12)",
                Utils.ConvertToInt(qryMonatszahlen["IkPositionID"])
            );
            int BuchgID = Utils.ConvertToInt(qryP["KbBuchungID"]);
            int KbBuchungStatusCode = Utils.ConvertToInt(qryP["KbBuchungStatusCode"]);
            if (BuchgID == 0) return;

            if (KbBuchungStatusCode == 2)
            {
                if (!KissMsg.ShowQuestion(
                    "Achtung:\r\n" +
                    //"Durch den Druck des Barbelegs wird eine Beleg-Nr. gelöst und der Belegstatus auf 'ausgedruckt' gesetzt.\r\n" +
                    "Durch den Druck des Barbelegs wird der Belegstatus auf 'ausgedruckt' gesetzt.\r\n" +
                    "Dieser Vorgang kann nicht rückgängig gemacht werden.\r\n\r\n" +
                    "Der Barbeleg kann bei Druckerproblemen nochmals ausgedruckt werden.\r\n\r\n" +
                    "Soll der Barbeleg gedruckt werden?"))
                    return;

                Session.BeginTransaction();
                try
                {
                    long BelegNr = DBUtil.IsEmpty(qryP["BelegNr"]) ?
                        (long)DBUtil.ExecuteScalarSQLThrowingException("EXEC dbo.spKbGetBelegNr 'IK'") :
                        (long)qryP["BelegNr"];
                    if (KbBuchungStatusCode == 2) KbBuchungStatusCode = 4;

                    DBUtil.ExecSQL(@"
                        Update dbo.KbBuchung set
                          KbBuchungStatusCode = {0},
                          BelegNr = {1},
                          BarbelegDatum = {2},
                          BarbelegUserID = {3},
                          BarbelegGueltigVon = {5}
                        where KbBuchungID = {4}",
                        KbBuchungStatusCode,
                        BelegNr,
                        DateTime.Today,
                        Session.User.UserID,
                        BuchgID,
                        DBUtil.IsEmpty(qryP["ValutaDatum"]) || (DateTime)qryP["ValutaDatum"] < DateTime.Today ? DateTime.Today : qryP["ValutaDatum"]
                    );
                    Session.Commit();
                }
                catch (Exception ex)
                {
                    Session.Rollback();
                    KissMsg.ShowInfo(ex.Message);
                    return;
                }
            }

            NamedPrm[] prms = new NamedPrm[2];
            prms[0] = new NamedPrm("KbBuchungID", BuchgID);
            prms[1] = new NamedPrm("KasseUserID", Session.User.UserID);
            RepUtil.ExecuteReport("AKassenbeleg", KissReportDestination.Viewer, prms);

            qryMonatszahlen.Refresh();
        }

        private void edtSpaltenAnzeige_EditValueChanged(object sender, System.EventArgs e)
        {
            int SpCode = Utils.ConvertToInt(edtSpaltenAnzeige.EditValue);

            colTotalAliment.Visible = ((SpCode == 1 || SpCode == 9) && FaProzessCode == 405);
            colALBV.Visible = (SpCode == 1 || SpCode == 9);
            colALVermittelt.Visible = ((SpCode == 1 || SpCode == 9) && FaProzessCode == 405);
            colKinderzulage.Visible = ((SpCode == 1 || SpCode == 9) && FaProzessCode == 405);
            colDiffALBV.Visible = (SpCode == 1 || SpCode == 9);
            colALBVVerrechnet.Visible = ((SpCode == 1 || SpCode == 9) && FaProzessCode == 405);

            colTotalAlimentSoll.Visible = ((SpCode == 2 || SpCode == 9) && FaProzessCode == 405);
            colALBVSoll.Visible = (SpCode == 2 || SpCode == 9);
            colALVermitteltSoll.Visible = ((SpCode == 2 || SpCode == 9) && FaProzessCode == 405);
            colKinderzulageSoll.Visible = ((SpCode == 2 || SpCode == 9) && FaProzessCode == 405);
            colDiffALBVSoll.Visible = (SpCode == 2 || SpCode == 9);
            colALBVVerrechnetSoll.Visible = ((SpCode == 2 || SpCode == 9) && FaProzessCode == 405);

            int VisibleIndex = 2;
            if (colTotalAliment.Visible)
            {
                colTotalAliment.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colTotalAlimentSoll.Visible)
            {
                colTotalAlimentSoll.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colALBV.Visible)
            {
                colALBV.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colALBVSoll.Visible)
            {
                colALBVSoll.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colALVermittelt.Visible)
            {
                colALVermittelt.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colALVermitteltSoll.Visible)
            {
                colALVermitteltSoll.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colKinderzulage.Visible)
            {
                colKinderzulage.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colKinderzulageSoll.Visible)
            {
                colKinderzulageSoll.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colALBVVerrechnet.Visible)
            {
                colALBVVerrechnet.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colALBVVerrechnetSoll.Visible)
            {
                colALBVVerrechnetSoll.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colDiffALBV.Visible)
            {
                colDiffALBV.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
            if (colDiffALBVSoll.Visible)
            {
                colDiffALBVSoll.VisibleIndex = VisibleIndex;
                VisibleIndex += 1;
            }
        }

        private void gvwMonatszahlen_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e)
        {
            // 06.02.2008 : sozheo : Farben sollen alternierend sein
            e.Handled = false;
            if (gvwMonatszahlen.FocusedRowHandle == e.RowHandle) return;

            //object erl= gvwMonatszahzlen.GetRowCellValue(e.RowHandle, gvwMonatszahzlen.Columns["ErledigterMonat"]);
            //bool erledigt = (erl is bool) ? (bool)erl : false;

            object mon = gvwMonatszahlen.GetRowCellValue(e.RowHandle, gvwMonatszahlen.Columns["Monat"]);
            int intMon = Utils.ConvertToInt(mon);
            bool MonatIstUngerade = (intMon == 1 || intMon == 3 || intMon == 5 || intMon == 7 || intMon == 9 || intMon == 11);
            e.Appearance.BackColor = MonatIstUngerade ? Color.LightSalmon : Color.Bisque;

            // 01.07.2009 : sozheo : Umbau neues Konzept, altes Konzept in grau
            int rtID = Utils.ConvertToInt(gvwMonatszahlen.GetRowCellValue(e.RowHandle, gvwMonatszahlen.Columns["IkRechtstitelID"]));
            e.Appearance.ForeColor = rtID > 0 ? Color.Gray : Color.Black;
        }

        private void qryMonatszahlen_AfterFill(object sender, System.EventArgs e)
        {
            // Fenster aktualsieren, auch wenn kein Datensatz vorhanden ist
            if (qryMonatszahlen.Count == 0) qryMonatszahlen_PositionChanged(sender, e);
        }

        private void qryMonatszahlen_PositionChanged(object sender, System.EventArgs e)
        {
            qryMonatszahlen.EnableBoundFields(CanEdit);

            // Drucken nur bei Barzahlungen möglich
            btnDrucken.Enabled = CanPrint && Utils.ConvertToBool(qryMonatszahlen["IstBarzahlung"], false);

            // Bemerkung soll immer editierbar sein.
            memBemerkung.EditMode = CanEditBemerkung ? EditModeType.Normal : EditModeType.ReadOnly;
        }

        private void tabMonatszahlen_SelectedTabChanged(SharpLibrary.WinControls.TabPageEx page)
        {
            if (tabMonatszahlen.SelectedTabIndex == 0)
                // Monatszahlen neu anzeigen
                MonatszahlenOeffnen();
            else
                if (tabMonatszahlen.SelectedTabIndex == 1)
                    // Einmalige Forderungen neu anzeigen
                    ctlIkMonatszahlenEinmalig.ForderungenNeuOeffnen();
                else
                    if (tabMonatszahlen.SelectedTabIndex == 2)
                        // Einmalige Zahlungen neu anzeigen
                        ctlIkZahlungenEinmalig.ZahlungenOeffnen();
                    else
                        if (tabMonatszahlen.SelectedTabIndex == 3)
                            // Verrechnung neu anzeigen
                            ctlIkMonatszahlenVerrechnung.VerrechnungOeffnen();
                        else
                            if (tabMonatszahlen.SelectedTabIndex == 4)
                                // Register "Saldo" aktualisieren:
                                ctlIkMonatszahlenSaldo.GlaeubigerOeffnen();
        }

        #endregion

        private void chkDetailansicht_CheckedChanged(object sender, EventArgs e)
        {
            // Filter ändern
            MonatszahlenOeffnen();
        }

        private void qryMonatszahlen_BeforePost(object sender, EventArgs e)
        {
            // save some modifications
            if (DBUtil.IsEmpty(qryMonatszahlen["IkPositionID"]))
                // without nothing to do
                return;
            int testID = Utils.ConvertToInt(qryMonatszahlen["IkPositionID"]);
            // save some modifications
            DBUtil.ExecSQL("Update dbo.IkPosition set Bemerkung = {0} where IkPositionID = {1}",
                qryMonatszahlen["Bemerkung"],
                qryMonatszahlen["IkPositionID"]
            );
            qryMonatszahlen.RowModified = false;
        }

        private void qryMonatszahlen_PositionChanging(object sender, EventArgs e)
        {
            // if not, Post is not called
            if (qryMonatszahlen.RowModified) qryMonatszahlen.Post();
        }

        private void memBemerkung_EditValueChanged(object sender, EventArgs e)
        {
            if (!memBemerkung.UserModified) return;
            qryMonatszahlen["Bemerkung"] = memBemerkung.EditValue;
            int testID = Utils.ConvertToInt(qryMonatszahlen["IkPositionID"]);
            qryMonatszahlen.RowModified = true;
        }
    }
}