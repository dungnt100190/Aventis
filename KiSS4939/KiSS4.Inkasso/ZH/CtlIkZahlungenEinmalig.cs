#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Drawing;
using Kiss.Interfaces.UI;
using KiSS4.Common;
using KiSS4.DB;
using KiSS4.Gui;
using KiSS4.Common.Report;

namespace KiSS4.Inkasso.ZH
{
    public class CtlIkZahlungenEinmalig : KiSS4.Gui.KissUserControl
    {
        private static readonly log4net.ILog LOG = log4net.LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);

        #region Fields

        private bool CanEditRTitel = false;
        private int FaFallID = 0;
        private int FaLeistungID = 0;
        private int FaProzessCode = 0;
        private bool HatVerwendungsPeriode = false;
        //private int IkRechtstitelID = 0;
        private bool LeistungIstGeschlossen = true;

        // Letzte Bearbeitung
        // 16.09.2007 : sozheo : neu
        // 06.11.2007 : sozheo : korrigiert für Auswahl nur Kindern bei Verrechnung
        // 11.03.2008 : sozheo : neu LOV-Liste
        // 03.04.2008 : sozheo : Sperren, wenn Leistung-Datum-Bis definiert ist
        // 24.06.2008 : sozheo : neu, kopiert von CtlIkMonatszahlenEinmalig
        // 21.01.2009 : sozheo : Umbau für bessere Performance: FaLeistungID wird jetzt immer gespeichert
        // ------------------------------------------------------------------------
        private bool StartedFromRechtstitel = false;
        private KiSS4.Gui.KissButton btnDrucken;
        private DevExpress.XtraGrid.Columns.GridColumn colBarbeleg;
        private DevExpress.XtraGrid.Columns.GridColumn colBetrag;
        private DevExpress.XtraGrid.Columns.GridColumn colDatum;
        private DevExpress.XtraGrid.Columns.GridColumn colErledigt;
        private DevExpress.XtraGrid.Columns.GridColumn colPerson;
        private DevExpress.XtraGrid.Columns.GridColumn colTitel;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissLookUpEdit edtBaPersonID;
        private KiSS4.Gui.KissCheckEdit edtBarbeleg;
        private KiSS4.Gui.KissCalcEdit edtBetragEinmalig;
        private KiSS4.Gui.KissLookUpEdit edtBgSplittingCode;
        private KiSS4.Gui.KissDateEdit edtDatum;
        private KiSS4.Gui.KissCheckEdit edtErledigterMonat;
        private KiSS4.Gui.KissLookUpEdit edtForderungsTitelCode;
        private KiSS4.Dokument.XDokument edtMigForderungDokument;
        private KiSS4.Gui.KissDateEdit edtVerwPeriodeBis;
        private KiSS4.Gui.KissDateEdit edtVerwPeriodeVon;
        private KiSS4.Gui.KissGrid grdIkPosition;
        private DevExpress.XtraGrid.Views.Grid.GridView gvwIkPosition;
        private KiSS4.Gui.KissLabel kissLabel12;
        private KiSS4.Gui.KissLabel lblBaPersonID;
        private KiSS4.Gui.KissLabel lblBetragEinmalig;
        private KiSS4.Gui.KissLabel lblBgSplittingCode;
        private KiSS4.Gui.KissLabel lblDatum;
        private KiSS4.Gui.KissLabel lblForderungsTitelCode;
        private KiSS4.Gui.KissLabel lblMigForderung;
        private KiSS4.Gui.KissLabel lblTitel;
        private KiSS4.Gui.KissLabel lblVerwPeriode;
        private KiSS4.Gui.KissLabel lblVerwPeriodeStrich;
        private KiSS4.Gui.KissMemoEdit memBemerkung;
        private System.Windows.Forms.Panel panTitel;
        private System.Windows.Forms.PictureBox picTitel;
        private KiSS4.DB.SqlQuery qryDeleteKontrolle;
        private KiSS4.DB.SqlQuery qryLOV;
        private KiSS4.DB.SqlQuery qryPerson;

        public KiSS4.DB.SqlQuery qryIkPosition;

        #endregion

        #region Constructors

        public CtlIkZahlungenEinmalig()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject5 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject11 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject12 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject13 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlIkZahlungenEinmalig));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject10 = new DevExpress.Utils.SerializableAppearanceObject();
            this.grdIkPosition = new KiSS4.Gui.KissGrid();
            this.qryIkPosition = new KiSS4.DB.SqlQuery(this.components);
            this.gvwIkPosition = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colDatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colPerson = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colTitel = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colErledigt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBarbeleg = new DevExpress.XtraGrid.Columns.GridColumn();
            this.edtBaPersonID = new KiSS4.Gui.KissLookUpEdit();
            this.edtForderungsTitelCode = new KiSS4.Gui.KissLookUpEdit();
            this.edtMigForderungDokument = new KiSS4.Dokument.XDokument();
            this.memBemerkung = new KiSS4.Gui.KissMemoEdit();
            this.edtDatum = new KiSS4.Gui.KissDateEdit();
            this.edtBetragEinmalig = new KiSS4.Gui.KissCalcEdit();
            this.lblBaPersonID = new KiSS4.Gui.KissLabel();
            this.lblBetragEinmalig = new KiSS4.Gui.KissLabel();
            this.lblForderungsTitelCode = new KiSS4.Gui.KissLabel();
            this.kissLabel12 = new KiSS4.Gui.KissLabel();
            this.lblMigForderung = new KiSS4.Gui.KissLabel();
            this.lblDatum = new KiSS4.Gui.KissLabel();
            this.edtErledigterMonat = new KiSS4.Gui.KissCheckEdit();
            this.lblVerwPeriode = new KiSS4.Gui.KissLabel();
            this.edtVerwPeriodeVon = new KiSS4.Gui.KissDateEdit();
            this.edtVerwPeriodeBis = new KiSS4.Gui.KissDateEdit();
            this.lblBgSplittingCode = new KiSS4.Gui.KissLabel();
            this.edtBgSplittingCode = new KiSS4.Gui.KissLookUpEdit();
            this.lblVerwPeriodeStrich = new KiSS4.Gui.KissLabel();
            this.panTitel = new System.Windows.Forms.Panel();
            this.picTitel = new System.Windows.Forms.PictureBox();
            this.lblTitel = new KiSS4.Gui.KissLabel();
            this.edtBarbeleg = new KiSS4.Gui.KissCheckEdit();
            this.btnDrucken = new KiSS4.Gui.KissButton();
            this.qryDeleteKontrolle = new KiSS4.DB.SqlQuery(this.components);
            this.qryLOV = new KiSS4.DB.SqlQuery(this.components);
            this.qryPerson = new KiSS4.DB.SqlQuery(this.components);
            ((System.ComponentModel.ISupportInitialize)(this.grdIkPosition)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryIkPosition)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwIkPosition)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtForderungsTitelCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtForderungsTitelCode.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtMigForderungDokument.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.memBemerkung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBetragEinmalig.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetragEinmalig)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblForderungsTitelCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel12)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMigForderung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatum)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtErledigterMonat.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVerwPeriode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerwPeriodeVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerwPeriodeBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBgSplittingCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgSplittingCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgSplittingCode.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVerwPeriodeStrich)).BeginInit();
            this.panTitel.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBarbeleg.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryDeleteKontrolle)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryLOV)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryPerson)).BeginInit();
            this.SuspendLayout();
            // 
            // grdIkPosition
            // 
            this.grdIkPosition.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdIkPosition.DataSource = this.qryIkPosition;
            this.grdIkPosition.EmbeddedNavigator.Name = "";
            this.grdIkPosition.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdIkPosition.Location = new System.Drawing.Point(10, 40);
            this.grdIkPosition.MainView = this.gvwIkPosition;
            this.grdIkPosition.Name = "grdIkPosition";
            this.grdIkPosition.Size = new System.Drawing.Size(749, 268);
            this.grdIkPosition.TabIndex = 0;
            this.grdIkPosition.TabStop = false;
            this.grdIkPosition.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.gvwIkPosition});
            // 
            // qryIkPosition
            // 
            this.qryIkPosition.CanDelete = true;
            this.qryIkPosition.CanUpdate = true;
            this.qryIkPosition.HostControl = this;
            this.qryIkPosition.SelectStatement = resources.GetString("qryIkPosition.SelectStatement");
            this.qryIkPosition.TableName = "IkPosition";
            this.qryIkPosition.BeforeDelete += new System.EventHandler(this.qryIkPosition_BeforeDelete);
            this.qryIkPosition.BeforePost += new System.EventHandler(this.qryIkPosition_BeforePost);
            this.qryIkPosition.PositionChanged += new System.EventHandler(this.qryIkPosition_PositionChanged);
            this.qryIkPosition.AfterFill += new System.EventHandler(this.qryIkPosition_AfterFill);
            // 
            // gvwIkPosition
            // 
            this.gvwIkPosition.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gvwIkPosition.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwIkPosition.Appearance.Empty.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.Empty.Options.UseFont = true;
            this.gvwIkPosition.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.gvwIkPosition.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwIkPosition.Appearance.EvenRow.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.EvenRow.Options.UseFont = true;
            this.gvwIkPosition.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwIkPosition.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwIkPosition.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gvwIkPosition.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.FocusedCell.Options.UseFont = true;
            this.gvwIkPosition.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gvwIkPosition.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwIkPosition.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwIkPosition.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gvwIkPosition.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.FocusedRow.Options.UseFont = true;
            this.gvwIkPosition.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gvwIkPosition.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwIkPosition.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwIkPosition.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwIkPosition.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwIkPosition.Appearance.GroupRow.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.GroupRow.Options.UseFont = true;
            this.gvwIkPosition.Appearance.GroupRow.Options.UseForeColor = true;
            this.gvwIkPosition.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gvwIkPosition.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gvwIkPosition.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gvwIkPosition.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gvwIkPosition.Appearance.HeaderPanel.Options.UseFont = true;
            this.gvwIkPosition.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gvwIkPosition.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwIkPosition.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwIkPosition.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gvwIkPosition.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gvwIkPosition.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gvwIkPosition.Appearance.HorzLine.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwIkPosition.Appearance.OddRow.Options.UseFont = true;
            this.gvwIkPosition.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gvwIkPosition.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwIkPosition.Appearance.Row.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.Row.Options.UseFont = true;
            this.gvwIkPosition.Appearance.SelectedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.gvwIkPosition.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwIkPosition.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.gvwIkPosition.Appearance.SelectedRow.Options.UseBackColor = true;
            this.gvwIkPosition.Appearance.SelectedRow.Options.UseFont = true;
            this.gvwIkPosition.Appearance.SelectedRow.Options.UseForeColor = true;
            this.gvwIkPosition.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gvwIkPosition.Appearance.VertLine.Options.UseBackColor = true;
            this.gvwIkPosition.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gvwIkPosition.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colDatum,
            this.colPerson,
            this.colTitel,
            this.colBetrag,
            this.colErledigt,
            this.colBarbeleg});
            this.gvwIkPosition.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gvwIkPosition.GridControl = this.grdIkPosition;
            this.gvwIkPosition.GroupSummary.AddRange(new DevExpress.XtraGrid.GridSummaryItem[] {
            new DevExpress.XtraGrid.GridGroupSummaryItem(DevExpress.Data.SummaryItemType.None, "", null, "")});
            this.gvwIkPosition.Name = "gvwIkPosition";
            this.gvwIkPosition.OptionsBehavior.Editable = false;
            this.gvwIkPosition.OptionsCustomization.AllowFilter = false;
            this.gvwIkPosition.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gvwIkPosition.OptionsNavigation.AutoFocusNewRow = true;
            this.gvwIkPosition.OptionsNavigation.UseTabKey = false;
            this.gvwIkPosition.OptionsView.ColumnAutoWidth = false;
            this.gvwIkPosition.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gvwIkPosition.OptionsView.ShowGroupPanel = false;
            this.gvwIkPosition.OptionsView.ShowIndicator = false;
            this.gvwIkPosition.CustomDrawCell += new DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventHandler(this.gvwIkPosition_CustomDrawCell);
            // 
            // colDatum
            // 
            this.colDatum.Caption = "Datum";
            this.colDatum.FieldName = "Datum";
            this.colDatum.Name = "colDatum";
            this.colDatum.OptionsColumn.AllowEdit = false;
            this.colDatum.Visible = true;
            this.colDatum.VisibleIndex = 2;
            this.colDatum.Width = 85;
            // 
            // colPerson
            // 
            this.colPerson.Caption = "Gläubiger/in";
            this.colPerson.FieldName = "Person";
            this.colPerson.Name = "colPerson";
            this.colPerson.OptionsColumn.AllowEdit = false;
            this.colPerson.Visible = true;
            this.colPerson.VisibleIndex = 0;
            this.colPerson.Width = 228;
            // 
            // colTitel
            // 
            this.colTitel.Caption = "Forderungsgrund";
            this.colTitel.FieldName = "IkForderungEinmaligCode";
            this.colTitel.Name = "colTitel";
            this.colTitel.Visible = true;
            this.colTitel.VisibleIndex = 1;
            this.colTitel.Width = 224;
            // 
            // colBetrag
            // 
            this.colBetrag.AppearanceHeader.Options.UseTextOptions = true;
            this.colBetrag.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colBetrag.Caption = "Zahlung";
            this.colBetrag.DisplayFormat.FormatString = "N2";
            this.colBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colBetrag.FieldName = "BetragEinmalig";
            this.colBetrag.Name = "colBetrag";
            this.colBetrag.Visible = true;
            this.colBetrag.VisibleIndex = 3;
            this.colBetrag.Width = 80;
            // 
            // colErledigt
            // 
            this.colErledigt.AppearanceCell.Options.UseTextOptions = true;
            this.colErledigt.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.colErledigt.Caption = "erl";
            this.colErledigt.FieldName = "ErledigterMonat";
            this.colErledigt.MinWidth = 10;
            this.colErledigt.Name = "colErledigt";
            this.colErledigt.Visible = true;
            this.colErledigt.VisibleIndex = 4;
            this.colErledigt.Width = 30;
            // 
            // colBarbeleg
            // 
            this.colBarbeleg.Caption = "bar";
            this.colBarbeleg.FieldName = "IstBarzahlung";
            this.colBarbeleg.Name = "colBarbeleg";
            this.colBarbeleg.Visible = true;
            this.colBarbeleg.VisibleIndex = 5;
            this.colBarbeleg.Width = 30;
            // 
            // edtBaPersonID
            // 
            this.edtBaPersonID.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBaPersonID.DataMember = "BaPersonID";
            this.edtBaPersonID.DataSource = this.qryIkPosition;
            this.edtBaPersonID.Location = new System.Drawing.Point(136, 355);
            this.edtBaPersonID.Name = "edtBaPersonID";
            this.edtBaPersonID.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBaPersonID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBaPersonID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaPersonID.Properties.Appearance.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBaPersonID.Properties.Appearance.Options.UseFont = true;
            this.edtBaPersonID.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtBaPersonID.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaPersonID.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtBaPersonID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject5.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject5.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject5)});
            this.edtBaPersonID.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBaPersonID.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text", "Text", 20, DevExpress.Utils.FormatType.None, "", true, DevExpress.Utils.HorzAlignment.Default, DevExpress.Data.ColumnSortOrder.None)});
            this.edtBaPersonID.Properties.DisplayMember = "Text";
            this.edtBaPersonID.Properties.NullText = "";
            this.edtBaPersonID.Properties.ShowFooter = false;
            this.edtBaPersonID.Properties.ShowHeader = false;
            this.edtBaPersonID.Properties.ValueMember = "BaPersonID";
            this.edtBaPersonID.Size = new System.Drawing.Size(347, 24);
            this.edtBaPersonID.TabIndex = 1;
            // 
            // edtForderungsTitelCode
            // 
            this.edtForderungsTitelCode.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtForderungsTitelCode.DataMember = "IkForderungEinmaligCode";
            this.edtForderungsTitelCode.DataSource = this.qryIkPosition;
            this.edtForderungsTitelCode.Location = new System.Drawing.Point(136, 325);
            this.edtForderungsTitelCode.LOVFilterWhereAppend = true;
            this.edtForderungsTitelCode.LOVName = "IkForderungEinmalig";
            this.edtForderungsTitelCode.Name = "edtForderungsTitelCode";
            this.edtForderungsTitelCode.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtForderungsTitelCode.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtForderungsTitelCode.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtForderungsTitelCode.Properties.Appearance.Options.UseBackColor = true;
            this.edtForderungsTitelCode.Properties.Appearance.Options.UseBorderColor = true;
            this.edtForderungsTitelCode.Properties.Appearance.Options.UseFont = true;
            this.edtForderungsTitelCode.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtForderungsTitelCode.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtForderungsTitelCode.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtForderungsTitelCode.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtForderungsTitelCode.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            this.edtForderungsTitelCode.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4)});
            this.edtForderungsTitelCode.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtForderungsTitelCode.Properties.NullText = "";
            this.edtForderungsTitelCode.Properties.ShowFooter = false;
            this.edtForderungsTitelCode.Properties.ShowHeader = false;
            this.edtForderungsTitelCode.Size = new System.Drawing.Size(347, 24);
            this.edtForderungsTitelCode.TabIndex = 2;
            this.edtForderungsTitelCode.EditValueChanged += new System.EventHandler(this.edtForderungsTitelCode_EditValueChanged);
            // 
            // edtMigForderungDokument
            // 
            this.edtMigForderungDokument.AllowDrop = true;
            this.edtMigForderungDokument.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtMigForderungDokument.Context = null;
            this.edtMigForderungDokument.DataMember = "Forderung_DocumentID";
            this.edtMigForderungDokument.DataSource = this.qryIkPosition;
            this.edtMigForderungDokument.Location = new System.Drawing.Point(136, 385);
            this.edtMigForderungDokument.Name = "edtMigForderungDokument";
            this.edtMigForderungDokument.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtMigForderungDokument.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtMigForderungDokument.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtMigForderungDokument.Properties.Appearance.Options.UseBackColor = true;
            this.edtMigForderungDokument.Properties.Appearance.Options.UseBorderColor = true;
            this.edtMigForderungDokument.Properties.Appearance.Options.UseFont = true;
            this.edtMigForderungDokument.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            serializableAppearanceObject11.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject11.Options.UseBackColor = true;
            serializableAppearanceObject12.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject12.Options.UseBackColor = true;
            serializableAppearanceObject13.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject13.Options.UseBackColor = true;
            this.edtMigForderungDokument.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, false, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtMigForderungDokument.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3, "Dokument öffnen"),
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, false, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtMigForderungDokument.Properties.Buttons1"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject11, "Dokument löschen"),
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtMigForderungDokument.Properties.Buttons2"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject12, "Neues Dokument erstellen"),
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtMigForderungDokument.Properties.Buttons3"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject13, "Dokument importieren")});
            this.edtMigForderungDokument.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtMigForderungDokument.Properties.ReadOnly = true;
            this.edtMigForderungDokument.Size = new System.Drawing.Size(194, 24);
            this.edtMigForderungDokument.TabIndex = 3;
            // 
            // memBemerkung
            // 
            this.memBemerkung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.memBemerkung.DataMember = "Bemerkung";
            this.memBemerkung.DataSource = this.qryIkPosition;
            this.memBemerkung.Location = new System.Drawing.Point(136, 445);
            this.memBemerkung.Name = "memBemerkung";
            this.memBemerkung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.memBemerkung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.memBemerkung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.memBemerkung.Properties.Appearance.Options.UseBackColor = true;
            this.memBemerkung.Properties.Appearance.Options.UseBorderColor = true;
            this.memBemerkung.Properties.Appearance.Options.UseFont = true;
            this.memBemerkung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.memBemerkung.Size = new System.Drawing.Size(347, 73);
            this.memBemerkung.TabIndex = 4;
            // 
            // edtDatum
            // 
            this.edtDatum.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtDatum.DataMember = "Datum";
            this.edtDatum.DataSource = this.qryIkPosition;
            this.edtDatum.EditValue = null;
            this.edtDatum.Location = new System.Drawing.Point(575, 325);
            this.edtDatum.Name = "edtDatum";
            this.edtDatum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtDatum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatum.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatum.Properties.Appearance.Options.UseFont = true;
            this.edtDatum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtDatum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDatum.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtDatum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatum.Properties.ShowToday = false;
            this.edtDatum.Size = new System.Drawing.Size(102, 24);
            this.edtDatum.TabIndex = 5;
            this.edtDatum.EditValueChanged += new System.EventHandler(this.edtDatum_EditValueChanged);
            // 
            // edtBetragEinmalig
            // 
            this.edtBetragEinmalig.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBetragEinmalig.DataMember = "BetragEinmalig";
            this.edtBetragEinmalig.DataSource = this.qryIkPosition;
            this.edtBetragEinmalig.Location = new System.Drawing.Point(575, 355);
            this.edtBetragEinmalig.Name = "edtBetragEinmalig";
            this.edtBetragEinmalig.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtBetragEinmalig.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBetragEinmalig.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBetragEinmalig.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBetragEinmalig.Properties.Appearance.Options.UseBackColor = true;
            this.edtBetragEinmalig.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBetragEinmalig.Properties.Appearance.Options.UseFont = true;
            this.edtBetragEinmalig.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBetragEinmalig.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBetragEinmalig.Properties.DisplayFormat.FormatString = "n2";
            this.edtBetragEinmalig.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtBetragEinmalig.Properties.EditFormat.FormatString = "n2";
            this.edtBetragEinmalig.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtBetragEinmalig.Size = new System.Drawing.Size(102, 24);
            this.edtBetragEinmalig.TabIndex = 6;
            // 
            // lblBaPersonID
            // 
            this.lblBaPersonID.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblBaPersonID.Location = new System.Drawing.Point(10, 355);
            this.lblBaPersonID.Name = "lblBaPersonID";
            this.lblBaPersonID.Size = new System.Drawing.Size(108, 24);
            this.lblBaPersonID.TabIndex = 21;
            this.lblBaPersonID.Text = "Gläubiger/in";
            this.lblBaPersonID.UseCompatibleTextRendering = true;
            // 
            // lblBetragEinmalig
            // 
            this.lblBetragEinmalig.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblBetragEinmalig.Location = new System.Drawing.Point(509, 355);
            this.lblBetragEinmalig.Name = "lblBetragEinmalig";
            this.lblBetragEinmalig.Size = new System.Drawing.Size(60, 24);
            this.lblBetragEinmalig.TabIndex = 25;
            this.lblBetragEinmalig.Text = "Betrag ";
            this.lblBetragEinmalig.UseCompatibleTextRendering = true;
            // 
            // lblForderungsTitelCode
            // 
            this.lblForderungsTitelCode.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblForderungsTitelCode.Location = new System.Drawing.Point(10, 325);
            this.lblForderungsTitelCode.Name = "lblForderungsTitelCode";
            this.lblForderungsTitelCode.Size = new System.Drawing.Size(108, 24);
            this.lblForderungsTitelCode.TabIndex = 26;
            this.lblForderungsTitelCode.Text = "Forderungsgrund";
            this.lblForderungsTitelCode.UseCompatibleTextRendering = true;
            // 
            // kissLabel12
            // 
            this.kissLabel12.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.kissLabel12.Location = new System.Drawing.Point(10, 445);
            this.kissLabel12.Name = "kissLabel12";
            this.kissLabel12.Size = new System.Drawing.Size(106, 24);
            this.kissLabel12.TabIndex = 27;
            this.kissLabel12.Text = "Bemerkung";
            this.kissLabel12.UseCompatibleTextRendering = true;
            // 
            // lblMigForderung
            // 
            this.lblMigForderung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblMigForderung.Location = new System.Drawing.Point(10, 385);
            this.lblMigForderung.Name = "lblMigForderung";
            this.lblMigForderung.Size = new System.Drawing.Size(116, 24);
            this.lblMigForderung.TabIndex = 27;
            this.lblMigForderung.Text = "Dokument";
            this.lblMigForderung.UseCompatibleTextRendering = true;
            // 
            // lblDatum
            // 
            this.lblDatum.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblDatum.Location = new System.Drawing.Point(509, 325);
            this.lblDatum.Name = "lblDatum";
            this.lblDatum.Size = new System.Drawing.Size(60, 24);
            this.lblDatum.TabIndex = 28;
            this.lblDatum.Text = "Valuta per";
            this.lblDatum.UseCompatibleTextRendering = true;
            // 
            // edtErledigterMonat
            // 
            this.edtErledigterMonat.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtErledigterMonat.DataMember = "ErledigterMonat";
            this.edtErledigterMonat.DataSource = this.qryIkPosition;
            this.edtErledigterMonat.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtErledigterMonat.Location = new System.Drawing.Point(509, 502);
            this.edtErledigterMonat.Name = "edtErledigterMonat";
            this.edtErledigterMonat.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtErledigterMonat.Properties.Appearance.Options.UseBackColor = true;
            this.edtErledigterMonat.Properties.Caption = "Sollgestellt";
            this.edtErledigterMonat.Properties.ReadOnly = true;
            this.edtErledigterMonat.Size = new System.Drawing.Size(209, 19);
            this.edtErledigterMonat.TabIndex = 31;
            this.edtErledigterMonat.TabStop = false;
            // 
            // lblVerwPeriode
            // 
            this.lblVerwPeriode.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblVerwPeriode.Location = new System.Drawing.Point(10, 415);
            this.lblVerwPeriode.Name = "lblVerwPeriode";
            this.lblVerwPeriode.Size = new System.Drawing.Size(120, 24);
            this.lblVerwPeriode.TabIndex = 60;
            this.lblVerwPeriode.Text = "Verwendungsperiode";
            this.lblVerwPeriode.UseCompatibleTextRendering = true;
            // 
            // edtVerwPeriodeVon
            // 
            this.edtVerwPeriodeVon.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtVerwPeriodeVon.DataMember = "VerwPeriodeVon";
            this.edtVerwPeriodeVon.DataSource = this.qryIkPosition;
            this.edtVerwPeriodeVon.EditValue = null;
            this.edtVerwPeriodeVon.Location = new System.Drawing.Point(136, 415);
            this.edtVerwPeriodeVon.Name = "edtVerwPeriodeVon";
            this.edtVerwPeriodeVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtVerwPeriodeVon.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtVerwPeriodeVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtVerwPeriodeVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtVerwPeriodeVon.Properties.Appearance.Options.UseBackColor = true;
            this.edtVerwPeriodeVon.Properties.Appearance.Options.UseBorderColor = true;
            this.edtVerwPeriodeVon.Properties.Appearance.Options.UseFont = true;
            this.edtVerwPeriodeVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtVerwPeriodeVon.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtVerwPeriodeVon.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtVerwPeriodeVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtVerwPeriodeVon.Properties.ShowToday = false;
            this.edtVerwPeriodeVon.Size = new System.Drawing.Size(90, 24);
            this.edtVerwPeriodeVon.TabIndex = 61;
            this.edtVerwPeriodeVon.EditValueChanged += new System.EventHandler(this.edtVerwPeriodeVon_EditValueChanged);
            // 
            // edtVerwPeriodeBis
            // 
            this.edtVerwPeriodeBis.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtVerwPeriodeBis.DataMember = "VerwPeriodeBis";
            this.edtVerwPeriodeBis.DataSource = this.qryIkPosition;
            this.edtVerwPeriodeBis.EditValue = null;
            this.edtVerwPeriodeBis.Location = new System.Drawing.Point(240, 415);
            this.edtVerwPeriodeBis.Name = "edtVerwPeriodeBis";
            this.edtVerwPeriodeBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtVerwPeriodeBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtVerwPeriodeBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtVerwPeriodeBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtVerwPeriodeBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtVerwPeriodeBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtVerwPeriodeBis.Properties.Appearance.Options.UseFont = true;
            this.edtVerwPeriodeBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject10.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject10.Options.UseBackColor = true;
            this.edtVerwPeriodeBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtVerwPeriodeBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject10)});
            this.edtVerwPeriodeBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtVerwPeriodeBis.Properties.ShowToday = false;
            this.edtVerwPeriodeBis.Size = new System.Drawing.Size(90, 24);
            this.edtVerwPeriodeBis.TabIndex = 62;
            this.edtVerwPeriodeBis.EditValueChanged += new System.EventHandler(this.edtVerwPeriodeBis_EditValueChanged);
            // 
            // lblBgSplittingCode
            // 
            this.lblBgSplittingCode.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblBgSplittingCode.Location = new System.Drawing.Point(336, 415);
            this.lblBgSplittingCode.Name = "lblBgSplittingCode";
            this.lblBgSplittingCode.Size = new System.Drawing.Size(37, 24);
            this.lblBgSplittingCode.TabIndex = 63;
            this.lblBgSplittingCode.Text = "Split.";
            this.lblBgSplittingCode.UseCompatibleTextRendering = true;
            // 
            // edtBgSplittingCode
            // 
            this.edtBgSplittingCode.AllowNull = false;
            this.edtBgSplittingCode.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBgSplittingCode.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtBgSplittingCode.Location = new System.Drawing.Point(379, 415);
            this.edtBgSplittingCode.LOVName = "BgSplittingart";
            this.edtBgSplittingCode.Name = "edtBgSplittingCode";
            this.edtBgSplittingCode.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtBgSplittingCode.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBgSplittingCode.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBgSplittingCode.Properties.Appearance.Options.UseBackColor = true;
            this.edtBgSplittingCode.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBgSplittingCode.Properties.Appearance.Options.UseFont = true;
            this.edtBgSplittingCode.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtBgSplittingCode.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtBgSplittingCode.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtBgSplittingCode.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtBgSplittingCode.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBgSplittingCode.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBgSplittingCode.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text")});
            this.edtBgSplittingCode.Properties.DisplayMember = "Text";
            this.edtBgSplittingCode.Properties.NullText = "";
            this.edtBgSplittingCode.Properties.ReadOnly = true;
            this.edtBgSplittingCode.Properties.ShowFooter = false;
            this.edtBgSplittingCode.Properties.ShowHeader = false;
            this.edtBgSplittingCode.Properties.ValueMember = "Code";
            this.edtBgSplittingCode.Size = new System.Drawing.Size(104, 24);
            this.edtBgSplittingCode.TabIndex = 64;
            this.edtBgSplittingCode.TabStop = false;
            // 
            // lblVerwPeriodeStrich
            // 
            this.lblVerwPeriodeStrich.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblVerwPeriodeStrich.Location = new System.Drawing.Point(230, 415);
            this.lblVerwPeriodeStrich.Name = "lblVerwPeriodeStrich";
            this.lblVerwPeriodeStrich.Size = new System.Drawing.Size(10, 24);
            this.lblVerwPeriodeStrich.TabIndex = 65;
            this.lblVerwPeriodeStrich.Text = "-";
            this.lblVerwPeriodeStrich.UseCompatibleTextRendering = true;
            // 
            // panTitel
            // 
            this.panTitel.Controls.Add(this.picTitel);
            this.panTitel.Controls.Add(this.lblTitel);
            this.panTitel.Dock = System.Windows.Forms.DockStyle.Top;
            this.panTitel.Location = new System.Drawing.Point(0, 0);
            this.panTitel.Name = "panTitel";
            this.panTitel.Size = new System.Drawing.Size(769, 24);
            this.panTitel.TabIndex = 66;
            // 
            // picTitel
            // 
            this.picTitel.Location = new System.Drawing.Point(5, 5);
            this.picTitel.Name = "picTitel";
            this.picTitel.Size = new System.Drawing.Size(16, 16);
            this.picTitel.TabIndex = 293;
            this.picTitel.TabStop = false;
            // 
            // lblTitel
            // 
            this.lblTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitel.Location = new System.Drawing.Point(25, 5);
            this.lblTitel.Name = "lblTitel";
            this.lblTitel.Size = new System.Drawing.Size(542, 16);
            this.lblTitel.TabIndex = 0;
            this.lblTitel.Text = "Einmalige Zahlungen";
            this.lblTitel.UseCompatibleTextRendering = true;
            // 
            // edtBarbeleg
            // 
            this.edtBarbeleg.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBarbeleg.DataMember = "IstBarzahlung";
            this.edtBarbeleg.DataSource = this.qryIkPosition;
            this.edtBarbeleg.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtBarbeleg.Location = new System.Drawing.Point(509, 445);
            this.edtBarbeleg.Name = "edtBarbeleg";
            this.edtBarbeleg.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtBarbeleg.Properties.Appearance.Options.UseBackColor = true;
            this.edtBarbeleg.Properties.Caption = "Barbeleg";
            this.edtBarbeleg.Properties.ReadOnly = true;
            this.edtBarbeleg.Size = new System.Drawing.Size(136, 19);
            this.edtBarbeleg.TabIndex = 67;
            // 
            // btnDrucken
            // 
            this.btnDrucken.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.btnDrucken.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnDrucken.Location = new System.Drawing.Point(509, 470);
            this.btnDrucken.Name = "btnDrucken";
            this.btnDrucken.Size = new System.Drawing.Size(114, 24);
            this.btnDrucken.TabIndex = 68;
            this.btnDrucken.Text = "Drucken";
            this.btnDrucken.UseCompatibleTextRendering = true;
            this.btnDrucken.UseVisualStyleBackColor = false;
            this.btnDrucken.Click += new System.EventHandler(this.btnDrucken_Click);
            // 
            // qryDeleteKontrolle
            // 
            this.qryDeleteKontrolle.HostControl = this;
            this.qryDeleteKontrolle.SelectStatement = "select Anzahl = count(*) from dbo.KbBuchung\r\nwhere IkPositionID = {0}";
            // 
            // qryLOV
            // 
            this.qryLOV.HostControl = this;
            this.qryLOV.SelectStatement = resources.GetString("qryLOV.SelectStatement");
            // 
            // qryPerson
            // 
            this.qryPerson.SelectStatement = resources.GetString("qryPerson.SelectStatement");
            // 
            // CtlIkZahlungenEinmalig
            // 
            this.ActiveSQLQuery = this.qryIkPosition;
            this.Controls.Add(this.btnDrucken);
            this.Controls.Add(this.edtBarbeleg);
            this.Controls.Add(this.panTitel);
            this.Controls.Add(this.lblVerwPeriodeStrich);
            this.Controls.Add(this.edtBgSplittingCode);
            this.Controls.Add(this.lblBgSplittingCode);
            this.Controls.Add(this.edtVerwPeriodeBis);
            this.Controls.Add(this.edtVerwPeriodeVon);
            this.Controls.Add(this.lblVerwPeriode);
            this.Controls.Add(this.edtErledigterMonat);
            this.Controls.Add(this.lblDatum);
            this.Controls.Add(this.lblMigForderung);
            this.Controls.Add(this.kissLabel12);
            this.Controls.Add(this.lblForderungsTitelCode);
            this.Controls.Add(this.lblBetragEinmalig);
            this.Controls.Add(this.lblBaPersonID);
            this.Controls.Add(this.edtBetragEinmalig);
            this.Controls.Add(this.edtDatum);
            this.Controls.Add(this.memBemerkung);
            this.Controls.Add(this.edtMigForderungDokument);
            this.Controls.Add(this.edtForderungsTitelCode);
            this.Controls.Add(this.edtBaPersonID);
            this.Controls.Add(this.grdIkPosition);
            this.Name = "CtlIkZahlungenEinmalig";
            this.Size = new System.Drawing.Size(769, 533);
            ((System.ComponentModel.ISupportInitialize)(this.grdIkPosition)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryIkPosition)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwIkPosition)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtForderungsTitelCode.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtForderungsTitelCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtMigForderungDokument.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.memBemerkung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBetragEinmalig.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetragEinmalig)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblForderungsTitelCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel12)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMigForderung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatum)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtErledigterMonat.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVerwPeriode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerwPeriodeVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVerwPeriodeBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBgSplittingCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgSplittingCode.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgSplittingCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVerwPeriodeStrich)).EndInit();
            this.panTitel.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBarbeleg.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryDeleteKontrolle)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryLOV)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryPerson)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Private Properties

        private bool CanEdit
        {
            // Letzte Bearbeitung
            // 24.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------
            get
            {
                return false;
                /*
                //bool Erledigt = (qryIkPosition.Count == 0) ? false : (bool)qryIkPosition["ErledigterMonat"];
                bool Erledigt = Utils.ConvertToBool(qryIkPosition["ErledigterMonat"], false);
                return (
                  qryIkPosition.Count>0 &&
                  qryIkPosition.CanUpdate &&
                  (IkRechtstitelID>0 || FaLeistungID>0) &&
                  CanEditRTitel &&
                  !Erledigt &&
                  !LeistungIstGeschlossen
                );
                */
            }
        }

        private bool CanEditBemerkung
        {
            get
            {
                return (
                  qryIkPosition.Count > 0 &&
                  qryIkPosition.CanUpdate &&
                  FaLeistungID > 0 &&
                  CanEditRTitel &&
                  !LeistungIstGeschlossen
                );
            }
        }

        #endregion

        #region Public Methods

        public void Activate()
        {
            edtBaPersonID.Focus();
        }

        public void InitLeistung(string Titel, System.Drawing.Image Bild,
            int FallID, int LeistungID, int ProzessCode,
            bool CanEditRT, bool FromRechtstitel, bool LeistgGeschlossen)
        {
            //IkRechtstitelID = RechtstitelID;
            FaLeistungID = LeistungID;

            // Damit Fehler im Umbau schnell bemerkt werden:(kann später entfernt werden)
            if (FaLeistungID < 1) KissMsg.ShowInfo("Programmfehler: Leistungs-ID ist nicht gesetzt.");

            FaFallID = FallID;
            StartedFromRechtstitel = FromRechtstitel;
            FaProzessCode = ProzessCode;
            CanEditRTitel = CanEditRT;
            LeistungIstGeschlossen = LeistgGeschlossen;

            lblTitel.Text = Titel;
            picTitel.Image = Bild;
            panTitel.Visible = (FaProzessCode == 408 || FaProzessCode == 409 || FaProzessCode == 410); // bei Rückforderungen
            if (panTitel.Visible)
            {
                grdIkPosition.Top = 40;
            }
            else
            {
                grdIkPosition.Top = 10;
                grdIkPosition.Height = grdIkPosition.Height + 30;
            }

            HatVerwendungsPeriode = (FaProzessCode < 400);
            if (!HatVerwendungsPeriode)
            {
                lblVerwPeriode.Visible = false;
                edtVerwPeriodeVon.Visible = false;
                lblVerwPeriodeStrich.Visible = false;
                edtVerwPeriodeBis.Visible = false;
                lblBgSplittingCode.Visible = false;
                edtBgSplittingCode.Visible = false;
            }

            qryIkPosition.CanInsert = false;
            if (LeistungIstGeschlossen)
            {
                qryIkPosition.CanUpdate = false;
                qryIkPosition.CanDelete = false;
            }

            // LOV - Liste füllen
            qryLOV.Fill();
            edtForderungsTitelCode.LOVFilter = "Value1 in ('2','3') and ','+Value3+',' like '%," + FaProzessCode.ToString() + ",%'";
            edtForderungsTitelCode.LOVName = "IkForderungEinmalig";

            if (StartedFromRechtstitel)
            {
                // Das Fenster wurde vom Ast "Rechsttitel", Unterast Monatszahlen aufgerufen:
                //qryPerson.Fill(RechtstitelID);
                edtBaPersonID.Properties.DataSource = qryPerson;
            }
            else
            {
                // Das Fenster wurde vom Ast "Rückforderung ALBV" aufgerufen:
                // Hier gibt es keine Personen Auswahl:
                lblBaPersonID.Visible = false;
                edtBaPersonID.Visible = false;
                colPerson.Visible = false;
                //grdIkPosition.Size.Height = grdIkPosition.Size.Height + 32;
            }
            colTitel.ColumnEdit = grdIkPosition.GetLOVLookUpEdit("IkForderungEinmalig");
            ZahlungenOeffnen();
        }

        public void ZahlungenOeffnen()
        {
            //qryIkPosition.Fill(IkRechtstitelID, FaLeistungID, StartedFromRechtstitel);
            qryIkPosition.Fill(FaLeistungID);
        }

        #endregion

        #region Private Methods

        private int GetBuchungsArtCode(int TCode)
        {
            if (!qryLOV.Find("Code=" + TCode.ToString())) return 0;
            string SCode = Utils.ConvertToString(qryLOV["Value1"]);
            try
            {
                return Convert.ToInt32(SCode);
            }
            catch (Exception ex)
            {
                // Eintrag ins Log.
                LOG.ErrorFormat("Fehler in: [{0}]. Exception: [{1}]", GetType().FullName, ex.Message);

                // Eintrag ins Log (Ansicht unter Anwendung/Newod Schnittstelle/Protokolle)
                XLog.Create(GetType().FullName, LogLevel.ERROR, ex.Message);

                KissMsg.ShowInfo("Der Buchungsart-Code ist nicht numerisch.");
                return 0;
            }
        }

        private int GetSplittingCode(int EinmaligCode)
        {
            if (EinmaligCode == 0) return 0;
            if (qryLOV.Find("Code=" + EinmaligCode.ToString()))
            {
                try
                {
                    return Convert.ToInt32(qryLOV["BgSplittingArtCode"]);
                }
                catch
                {
                    return 0;
                }
            }
            return 0;
        }

        private void SetVerwendungsPeriode()
        {
            // Letzte Bearbeitung
            // 24.06.2008 : sozheo : neu (von FrmWhEinzelzahlung übernommen)
            // ------------------------------------------------------------------------
            // nur für W-Modul:
            if (!HatVerwendungsPeriode) return;

            int TCode = Utils.ConvertToInt(qryIkPosition["IkForderungEinmaligCode"]);
            int BgSplittingArtCode = GetSplittingCode(TCode);
            edtBgSplittingCode.EditValue = BgSplittingArtCode;

            switch (BgSplittingArtCode)
            {
                case 1: //Taggenau
                    if (DBUtil.IsEmpty(qryIkPosition["Datum"]))
                    {
                        qryIkPosition["VerwPeriodeVon"] = DBNull.Value;
                        qryIkPosition["VerwPeriodeBis"] = DBNull.Value;
                    }
                    else
                    {
                        DateTime firstDate = (DateTime)qryIkPosition["Datum"];
                        qryIkPosition["VerwPeriodeVon"] = firstDate;
                        qryIkPosition["VerwPeriodeBis"] = firstDate;
                    }
                    qryIkPosition.RefreshDisplay();
                    break;
                case 2: //Monat
                    if (DBUtil.IsEmpty(qryIkPosition["Datum"]))
                    {
                        qryIkPosition["VerwPeriodeVon"] = DBNull.Value;
                        qryIkPosition["VerwPeriodeBis"] = DBNull.Value;
                    }
                    else
                    {
                        DateTime firstDate = (DateTime)qryIkPosition["Datum"];
                        firstDate = Utils.firstDayOfMonth(firstDate);
                        qryIkPosition["VerwPeriodeVon"] = firstDate;
                        qryIkPosition["VerwPeriodeBis"] = firstDate.AddMonths(1).AddDays(-1);
                    }
                    qryIkPosition.RefreshDisplay();
                    break;
                case 3: //Valuta
                    qryIkPosition["VerwPeriodeVon"] = DBNull.Value;
                    qryIkPosition["VerwPeriodeBis"] = DBNull.Value;
                    qryIkPosition.RefreshDisplay();
                    break;
                case 4: //Entscheid
                    qryIkPosition["VerwPeriodeVon"] = DBNull.Value;
                    qryIkPosition["VerwPeriodeBis"] = DBNull.Value;
                    qryIkPosition.RefreshDisplay();
                    break;
            }
        }

        private void SetVerwendungsPeriodeEditMode()
        {
            // nur für W-Modul:
            if (!HatVerwendungsPeriode) return;

            int TCode = Utils.ConvertToInt(qryIkPosition["IkForderungEinmaligCode"]);
            int BgSplittingArtCode = GetSplittingCode(TCode);
            bool CanEditPeriodeVon = (
                CanEdit &&
                (BgSplittingArtCode == 1 || BgSplittingArtCode == 2 || BgSplittingArtCode == 4) // Taggenau, Monat, Entscheid
            );
            bool CanEditPeriodeBis = (
                CanEdit &&
                (BgSplittingArtCode == 1 || BgSplittingArtCode == 2) // Taggenau, Monat
            );
            edtVerwPeriodeVon.EditMode = CanEditPeriodeVon ? EditModeType.Normal : EditModeType.ReadOnly;
            edtVerwPeriodeBis.EditMode = CanEditPeriodeBis ? EditModeType.Normal : EditModeType.ReadOnly;
        }

        private void btnDrucken_Click(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 14.07.2008 : sozheo : neu
            // ------------------------------------------------------------------------
            SqlQuery qryP = DBUtil.OpenSQL(@"
                select KbBuchungID, BelegNr, KbBuchungStatusCode, ValutaDatum
                from dbo.KbBuchung
                where IkPositionID = {0}
                and IkForderungartCode in (31,32)",
                Utils.ConvertToInt(qryIkPosition["IkPositionID"])
            );
            int BuchgID = Utils.ConvertToInt(qryP["KbBuchungID"]);
            if (BuchgID == 0) return;

            if (DBUtil.IsEmpty(qryP["BelegNr"]))
            {
                if (!KissMsg.ShowQuestion(
                "Achtung:\r\n" +
                "Durch den Druck des Barbelegs wird eine Beleg-Nr. gelöst und der Belegstatus auf 'ausgedruckt' gesetzt.\r\n" +
                "Dieser Vorgang kann nicht mehr rückgängig gemacht werden und " +
                "die Position kann danach nicht mehr rückgängig gemacht werden.\r\n\r\n" +
                "Der Barbeleg kann bei Druckerproblemen nochmals ausgedruckt werden.\r\n\r\n" +
                "Soll der Barbeleg gedruckt werden?"))
                    return;

                Session.BeginTransaction();
                try
                {
                    long BelegNr = (long)DBUtil.ExecuteScalarSQLThrowingException("EXEC dbo.spKbGetBelegNr 'IK'");
                    int StatCode = Utils.ConvertToInt(qryP["KbBuchungStatusCode"]);
                    if (StatCode == 2) StatCode = 4;

                    DBUtil.ExecSQL(@"
                        Update dbo.KbBuchung set
                            KbBuchungStatusCode = {0},
                            BelegNr = {1},
                            BarbelegDatum = {2},
                            BarbelegUserID = {3},
                            BarbelegGueltigVon = {5}
                        where KbBuchungID = {4}",
                        StatCode,
                        BelegNr,
                        DateTime.Today,
                        Session.User.UserID,
                        BuchgID,
                        DBUtil.IsEmpty(qryP["ValutaDatum"]) || (DateTime)qryP["ValutaDatum"] < DateTime.Today ? DateTime.Today : qryP["ValutaDatum"]
                    );
                    Session.Commit();
                }
                catch (Exception ex)
                {
                    Session.Rollback();
                    KissMsg.ShowInfo(ex.Message);
                    return;
                }
            }

            NamedPrm[] prms = new NamedPrm[2];
            prms[0] = new NamedPrm("KbBuchungID", BuchgID);
            prms[1] = new NamedPrm("KasseUserID", Session.User.UserID);
            RepUtil.ExecuteReport("AKassenbeleg", KissReportDestination.Viewer, prms);

            qryIkPosition.Refresh();
        }

        private void edtDatum_EditValueChanged(object sender, System.EventArgs e)
        {
            if (!edtDatum.UserModified) return;
            qryIkPosition["Datum"] = edtDatum.DateTime;
            //SetVerwendungsPeriode();
        }

        private void edtForderungsTitelCode_EditValueChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 24.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------
            if (!edtForderungsTitelCode.UserModified) return;
            if (DBUtil.IsEmpty(edtForderungsTitelCode.EditValue)) return;

            int TCode = Utils.ConvertToInt(edtForderungsTitelCode.EditValue);
            qryIkPosition["IkForderungEinmaligCode"] = TCode;

            int BCode = GetBuchungsArtCode(TCode);
            qryIkPosition["IkBuchungsartCode"] = BCode;

            if (TCode >= 200)
            {
                qryIkPosition["BaPersonID"] = DBNull.Value;
                qryIkPosition["Person"] = DBNull.Value;
            }
            SetVerwendungsPeriode();
            SetVerwendungsPeriodeEditMode();
        }

        private void edtVerwPeriodeBis_EditValueChanged(object sender, System.EventArgs e)
        {
            if (!edtVerwPeriodeBis.UserModified) return;
            if (DBUtil.IsEmpty(edtVerwPeriodeBis.EditValue)) return;

            if (HatVerwendungsPeriode)
            {
                int TCode = Utils.ConvertToInt(qryIkPosition["IkForderungEinmaligCode"]);
                int BgSplittingArtCode = GetSplittingCode(TCode);
                switch (BgSplittingArtCode)
                {
                    case 2: //Monat
                        edtVerwPeriodeBis.EditValue = Utils.lastDayOfMonth((DateTime)edtVerwPeriodeBis.EditValue);
                        break;
                }
            }
        }

        private void edtVerwPeriodeVon_EditValueChanged(object sender, System.EventArgs e)
        {
            if (!edtVerwPeriodeVon.UserModified) return;
            if (DBUtil.IsEmpty(edtVerwPeriodeVon.EditValue)) return;

            if (HatVerwendungsPeriode)
            {
                int TCode = Utils.ConvertToInt(qryIkPosition["IkForderungEinmaligCode"]);
                int BgSplittingArtCode = GetSplittingCode(TCode);
                switch (BgSplittingArtCode)
                {
                    case 2: //Monat
                        edtVerwPeriodeVon.EditValue = Utils.firstDayOfMonth((DateTime)edtVerwPeriodeVon.EditValue);
                        break;
                }
            }
        }

        private void gvwIkPosition_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e)
        {
            e.Handled = false;
            if (gvwIkPosition.FocusedRowHandle == e.RowHandle) return;
            object erl = gvwIkPosition.GetRowCellValue(e.RowHandle, gvwIkPosition.Columns["ErledigterMonat"]);
            bool erledigt = (erl is bool) ? (bool)erl : false;

            if (erledigt)
                e.Appearance.BackColor = Color.LightSalmon;
            else
                e.Appearance.BackColor = Color.Bisque;
        }

        private void qryIkPosition_AfterFill(object sender, System.EventArgs e)
        {
            if (qryIkPosition.Count == 0) qryIkPosition_PositionChanged(sender, e);
        }

        private void qryIkPosition_BeforeDelete(object sender, System.EventArgs e)
        {
            if (Utils.ConvertToBool(qryIkPosition["ErledigterMonat"], false))
            {
                KissMsg.ShowInfo("Diese Forderung ist bereits sollgestellt.\r\nSie kann deshalb nicht gelöscht werden.");
                throw new KissCancelException();
            }

            qryDeleteKontrolle.Fill(Utils.ConvertToInt(qryIkPosition["IkPositionID"]));
            if (Utils.ConvertToInt(qryDeleteKontrolle["Anzahl"]) > 0)
            {
                KissMsg.ShowInfo("Diese Forderung ist bereits sollgestellt.\r\nSie kann deshalb nicht gelöscht werden.");
                throw new KissCancelException();
            }
        }

        private void qryIkPosition_BeforePost(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 16.09.2007 : sozheo : neu
            // 22.11.2007 : sozheo : Datum darf nicht vor aktuellem Monat liegen
            // 27.05.2008 : sozheo : Stadt Zürich anzeigen wenn ForderungEinmaligCode > 200
            // 04.02.2009 : sozheo : SELECT * entfernt
            // ------------------------------------------------------------------------
            DBUtil.CheckNotNullField(edtDatum, lblDatum.Text);
            // Das Datum ist frei definierbar
            //DateTime dat = (DateTime)edtDatum.EditValue;
            //DateTime ErsterVomMonat = Utils.firstDayOfMonth(DateTime.Today);
            //if (dat < ErsterVomMonat)
            //{
            //  KissMsg.ShowInfo("Das Datum darf nicht vor dem aktuellen Monat liegen.");
            //  throw new KissCancelException();
            //}

            DBUtil.CheckNotNullField(edtForderungsTitelCode, lblForderungsTitelCode.Text);
            int TCode = Utils.ConvertToInt(edtForderungsTitelCode.EditValue);
            if (StartedFromRechtstitel && TCode < 200)
                DBUtil.CheckNotNullField(edtBaPersonID, lblBaPersonID.Text);

            DBUtil.CheckNotNullField(edtBetragEinmalig, lblBetragEinmalig.Text);

            if (Utils.ConvertToDecimal(qryIkPosition["BetragEinmalig"]) < 0)
            {
                KissMsg.ShowInfo("Der Betrag darf nicht kleiner als 0 sein.");
                throw new KissCancelException();
            }

            qryIkPosition["Monat"] = ((DateTime)qryIkPosition["Datum"]).Month;
            qryIkPosition["Jahr"] = ((DateTime)qryIkPosition["Datum"]).Year;

            // Verwendungsperiode
            // nur für W-Modul:
            if (HatVerwendungsPeriode)
            {
                int BgSplittingArtCode = GetSplittingCode(TCode);
                switch (BgSplittingArtCode)
                {
                    case 1: //Taggenau
                        DBUtil.CheckNotNullField(edtVerwPeriodeVon, "Verwendungsperiode von");
                        DBUtil.CheckNotNullField(edtVerwPeriodeBis, "Verwendungsperiode bis");
                        if ((DateTime)edtVerwPeriodeBis.EditValue < (DateTime)edtVerwPeriodeVon.EditValue)
                        {
                            throw new KissInfoException(
                                "'Verwendungsperiode von' muss kleiner sein als 'Verwendungsperiode bis'."
                             );
                        }
                        break;
                    case 2: //Monat
                        DBUtil.CheckNotNullField(edtVerwPeriodeVon, "Verwendungsperiode von");
                        qryIkPosition["VerwPeriodeVon"] = Utils.firstDayOfMonth((DateTime)edtVerwPeriodeVon.EditValue);
                        qryIkPosition["VerwPeriodeBis"] = DBUtil.IsEmpty(qryIkPosition["VerwPeriodeBis"]) ?
                            Utils.lastDayOfMonth((DateTime)edtVerwPeriodeVon.EditValue) :
                            Utils.lastDayOfMonth((DateTime)edtVerwPeriodeBis.EditValue);

                        if ((DateTime)edtVerwPeriodeBis.EditValue < (DateTime)edtVerwPeriodeVon.EditValue)
                        {
                            throw new KissInfoException("'Verwendungsperiode von' muss kleiner sein als 'Verwendungsperiode bis'.");
                        }
                        break;
                    case 4: //Entscheid
                        DBUtil.CheckNotNullField(edtVerwPeriodeVon, "Verwendungsperiode von");
                        break;
                }
            }

            if (StartedFromRechtstitel)
            {
                if (TCode < 200)
                    qryIkPosition["Person"] = edtBaPersonID.GetDisplayText(edtBaPersonID.EditValue);
                else
                    qryIkPosition["Person"] = "[Stadt Zürich]";
            }
        }

        private void qryIkPosition_PositionChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 16.09.2007 : sozheo : neu
            // 14.10.2007 : sozheo : Kontrolle "ErledigterMonat" eingefügt
            // 14.07.2008 : sozheo : btnDrucken neu
            // ------------------------------------------------------------------------

            qryIkPosition.EnableBoundFields(CanEdit);
            memBemerkung.EditMode = CanEditBemerkung ? EditModeType.Normal : EditModeType.ReadOnly;

            // Drucken nur bei Barzahlungen möglich
            btnDrucken.Enabled = (
                qryIkPosition.Count > 0 &&
                Utils.ConvertToBool(qryIkPosition["ErledigterMonat"], true) &&
                Utils.ConvertToBool(qryIkPosition["IstBarzahlung"], false)
            );

            // Verwendungsperiode
            SetVerwendungsPeriodeEditMode();
            int TCode = Utils.ConvertToInt(qryIkPosition["IkForderungEinmaligCode"]);
            int BgSplittingArtCode = GetSplittingCode(TCode);
            edtBgSplittingCode.EditValue = BgSplittingArtCode;

            bool migDokuVorhanden = false; // !DBUtil.IsEmpty("Forderung_DocumentID");
            edtMigForderungDokument.Visible = migDokuVorhanden;
            lblMigForderung.Visible = migDokuVorhanden;
        }

        #endregion
    }
}