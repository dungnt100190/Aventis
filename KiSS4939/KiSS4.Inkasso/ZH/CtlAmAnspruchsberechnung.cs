#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Windows.Forms;
using Kiss.Interfaces.UI;
using KiSS4.Common;
using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Inkasso.ZH
{
    public class CtlAmAnspruchsberechnung : KiSS4.Gui.KissUserControl
    {
        #region Fields

        #region Private Fields

        private int BerechnungTyp_ALBV1_KKBB3 = 0;
        private bool CanEditActiveRow = false;
        private int ClientID = 0;
        private string DefaultFormat1 = "N2";
        private string DefaultFormat2 = "N1";
        private int FaFallID = 0;
        private int FaLeistungID = 0;
        private bool FaLeistungIstGeschlossen = true;
        private int FaProzessCode = 0;
        private bool KinderSindKorrigiert = false;
        private int Old_BerechngTyp = 0;
        private int Old_BerechngTyp_Selection = 0;
        private int Old_EinkommsTyp = 0;
        private int Old_Kinder = 0;
        private int Old_KinderALBV = 0;
        private int Old_KinderKKBB = 0;
        private int Old_KinderNone = 0;
        private int Old_KinderUEBH = 0;
        private bool PositionsAreModified = false;
        private KiSS4.Gui.KissRTFEdit RTFEditKinder;
        private decimal RoundingDecimals = (decimal)0.05;
        private string SessionUserName = "";
        private string TypText = "ALBV/UeBH";
        private KiSS4.Gui.KissDateEdit adtErstkontakt;
        private KiSS4.Gui.KissButton btnCalculate;
        private KiSS4.Gui.KissButton btnChangeState;
        private KiSS4.Gui.KissButton btnCollapse;
        private KiSS4.Gui.KissButton btnCopy;
        private KiSS4.Gui.KissButton btnExpand;
        private KiSS4.Gui.KissButton btnUpdate;
        private KiSS4.Gui.KissCheckEdit chkSucheOhneMigrierte;
        private DevExpress.XtraGrid.Columns.GridColumn colAlter;
        private DevExpress.XtraGrid.Columns.GridColumn colAmBerechnung;
        private DevExpress.XtraGrid.Columns.GridColumn colAmEinkommensvariante;
        private DevExpress.XtraGrid.Columns.GridColumn colAnspruch;
        private DevExpress.XtraGrid.Columns.GridColumn colAnzahlKinder;
        private DevExpress.XtraGrid.Columns.GridColumn colBerechnung;
        private DevExpress.XtraGrid.Columns.GridColumn colBerechnungAb;
        private DevExpress.XtraGrid.Columns.GridColumn colBerechtigt;
        private DevExpress.XtraGrid.Columns.GridColumn colBezeichnung;
        private DevExpress.XtraGrid.Columns.GridColumn colDatumBis;
        private DevExpress.XtraGrid.Columns.GridColumn colEntscheidDatum;
        private DevExpress.XtraGrid.Columns.GridColumn colGeburt;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colID;
        private DevExpress.XtraGrid.Columns.GridColumn colName;
        private DevExpress.XtraGrid.Columns.GridColumn colRTName;
        private DevExpress.XtraGrid.Columns.GridColumn colRechtstitel;
        private DevExpress.XtraGrid.Columns.GridColumn colStatus;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeBemerkung;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeBezeichnung;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeDatumAb;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeEditierbar1;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeEditierbar2;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeFormat2;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeMengeneinheit1;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeMengeneinheit2;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeMengeneinheit3;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeWert1;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeWert2;
        private DevExpress.XtraTreeList.Columns.TreeListColumn colTreeWert3;
        private DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit colchkKind;
        private System.ComponentModel.IContainer components;
        private KiSS4.Inkasso.ZH.CtlAmVerfuegung ctlAmVerfuegung;
        private KiSS4.Gui.KissTextEdit edtAltersBed;
        private KiSS4.Gui.KissLookUpEdit edtAmBerechnungTyp;
        private KiSS4.Gui.KissButtonEdit edtAmtMT;
        private KiSS4.Gui.KissCalcEdit edtArbeitspensum;
        private KiSS4.Gui.KissDateEdit edtBerechnungDatum;
        private KiSS4.Gui.KissTextEdit edtBezeichnung;
        private KiSS4.Gui.KissLookUpEdit edtEinkommVar;
        private KiSS4.Gui.KissCalcEdit edtKinderbetreuung;
        private KiSS4.Gui.KissButtonEdit edtPrivMT;
        private KiSS4.Gui.KissLookUpEdit edtRechtstitel;
        private KiSS4.Gui.KissTextEdit edtStatusKinder;
        private KiSS4.Gui.KissCheckEdit edtStatusOk;
        private KiSS4.Gui.KissTextEdit edtStatusPensum;
        private KiSS4.Gui.KissLookUpEdit edtSucheBerechnungstyp;
        private KiSS4.Gui.KissDateEdit edtSucheDefinitivAb;
        private KiSS4.Gui.KissDateEdit edtSucheDefinitivBis;
        private KiSS4.Gui.KissButtonEdit edtUser;
        private KiSS4.Gui.KissGrid grdAmAnspruchsberechnung;
        private KiSS4.Gui.KissGrid grdKinder;
        private KiSS4.Gui.KissGroupBox groupBox1;
        private DevExpress.XtraGrid.Views.Grid.GridView grvAmAnspruchsberechnung;
        private DevExpress.XtraGrid.Views.Grid.GridView grvAnzahlKinder;
        private KiSS4.Gui.KissLabel lblAltersbedingung;
        private KiSS4.Gui.KissLabel kissLabel3;
        private KiSS4.Gui.KissLabel kissLabel4;
        private KiSS4.Gui.KissLabel lblArbeitspensum;
        private KiSS4.Gui.KissLabel lblArbeitspensum2;
        private KiSS4.Gui.KissLabel lblBerechnungDatum;
        private KiSS4.Gui.KissLabel lblBerechnungs;
        private KiSS4.Gui.KissLabel lblBerechnungstyp;
        private KiSS4.Gui.KissLabel lblBezeichnung;
        private KiSS4.Gui.KissLabel lblBis;
        private KiSS4.Gui.KissLabel lblEinkommen;
        private KiSS4.Gui.KissLabel lblErstkontakt;
        private KiSS4.Gui.KissLabel lblKinder;
        private KiSS4.Gui.KissLabel lblKinderbetreuung;
        private KiSS4.Gui.KissLabel lblKinderbetreuung2;
        private KiSS4.Gui.KissLabel lblMigBerechnung;
        private KiSS4.Gui.KissLabel lblMigVerfuegung;
        private System.Windows.Forms.Panel panelBottom;
        private System.Windows.Forms.Panel pnlMigDokumente;
        private KiSS4.DB.SqlQuery qryAbPosition;
        private KiSS4.DB.SqlQuery qryAmAnspruchsberechnung;
        private KiSS4.DB.SqlQuery qryBerechtigtKind;
        private KiSS4.DB.SqlQuery qryK511;
        private KiSS4.DB.SqlQuery qryKind;
        private KiSS4.DB.SqlQuery qryRechtstitel;
        private KiSS4.DB.SqlQuery qryZVV;
        private DevExpress.XtraEditors.Repository.RepositoryItemTextEdit repedtBetrag;
        private DevExpress.XtraEditors.Repository.RepositoryItemLookUpEdit repedtRechtstitel;
        private DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit repedtTreeCheckEdit;
        private KiSS4.Gui.KissRTFEdit rtfedtParams;
        private KiSS4.Gui.KissSearchTitel searchTitle;
        private KiSS4.Gui.KissTabControlEx tabControlSearch;
        private KiSS4.Gui.KissTabControlEx tabDetail;
        private SharpLibrary.WinControls.TabPageEx tbgBerechnung;
        private SharpLibrary.WinControls.TabPageEx tbgGrunddaten;
        private SharpLibrary.WinControls.TabPageEx tpgListe;
        private SharpLibrary.WinControls.TabPageEx tpgSuchen;
        private SharpLibrary.WinControls.TabPageEx tpgVerfuegung;
        private KiSS4.Gui.KissTree treBerechnung;
        private KiSS4.Dokument.XDokument xDokumentBerechnung;
        private KiSS4.Dokument.XDokument xDokumentVerfuegung;
        private KiSS4.Dokument.KissDocumentButton kissDocumentButton1;

        #endregion

        #endregion

        #region Constructors

        #region Public Constructors

        public CtlAmAnspruchsberechnung(System.Drawing.Image icon, 
            int FallID, int FallTraegerID, int LeistungID, int ProzessCode, bool LeistungGeschlossen)
            : this()
        {
            FaFallID = FallID;
            ClientID = FallTraegerID;
            FaLeistungID = LeistungID;
            FaProzessCode = ProzessCode;
            FaLeistungIstGeschlossen = LeistungGeschlossen;

            if (FaLeistungIstGeschlossen)
            {
                qryAmAnspruchsberechnung.CanUpdate = false;
                qryAmAnspruchsberechnung.CanInsert = false;
                qryAmAnspruchsberechnung.CanDelete = false;
                qryKind.CanUpdate = false;
                qryAbPosition.CanUpdate = false;
            }

            // die ID-Spalte im Tree soll nur bei Admins sichtbar sein:
            if (!Session.User.IsUserAdmin) colID.VisibleIndex = -1;

            // User Angaben holen
            SqlQuery qry = DBUtil.OpenSQL(
                "select DisplayText from dbo.vwUser where UserID={0}",
                Session.User.UserID
            );
            SessionUserName = Utils.ConvertToString(qry["DisplayText"]);

            //Typ der Berechnung:
            BerechnungTyp_ALBV1_KKBB3 = FaProzessCode - 401;

            TypText = "ALBV/UeBH";
            string sqlFilter = "A";
            if (BerechnungTyp_ALBV1_KKBB3 == 3)
            {
                // Bei Typ KKBB
                TypText = "KKBB";
                sqlFilter = "B";
                edtAmBerechnungTyp.LOVFilter = "3";
                edtAmBerechnungTyp.LOVName = "AmBerechnungTyp";
                kissDocumentButton1.Context = "AmAnspruchsberechnungKKBB";
            }
            else
            {
                // Bei Typ ALBV, UeBH
                edtArbeitspensum.Visible = false;
                lblArbeitspensum.Visible = false;
                lblArbeitspensum2.Visible = false;
                edtKinderbetreuung.Visible = false;
                lblKinderbetreuung.Visible = false;
                lblKinderbetreuung2.Visible = false;
                edtStatusPensum.Visible = false;
                edtStatusKinder.Visible = false;
                edtAltersBed.Visible = false;
                edtStatusOk.Visible = false;
                lblAltersbedingung.Visible = false;
            }
            colBerechtigt.Caption = TypText;
            object[] prms = {sqlFilter};

            qryBerechtigtKind.Fill(prms);
            colBerechtigt.ColumnEdit = grdKinder.GetLOVLookUpEdit(qryBerechtigtKind);

            // setup columnedits
            colAmBerechnung.ColumnEdit = grdAmAnspruchsberechnung.GetLOVLookUpEdit("AmBerechnungTyp" );
            colAmEinkommensvariante.ColumnEdit = grdAmAnspruchsberechnung.GetLOVLookUpEdit("AmEinkommensvariante" );

            // Query Anspruchsberechnung füllen:
            FillQryAnspruchsberechnung();

            // Register Verfügung füllen:
            ctlAmVerfuegung.Init(FaFallID, ClientID, FaLeistungID, BerechnungTyp_ALBV1_KKBB3, FaLeistungIstGeschlossen);
        }

        public CtlAmAnspruchsberechnung()
        {
            this.InitializeComponent();
        }

        #endregion

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlAmAnspruchsberechnung));
            DevExpress.XtraTreeList.StyleFormatConditions.StyleFormatCondition styleFormatCondition1 = new DevExpress.XtraTreeList.StyleFormatConditions.StyleFormatCondition();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject5 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject6 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject7 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject8 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject9 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject10 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject11 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject12 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject13 = new DevExpress.Utils.SerializableAppearanceObject();
            this.tabDetail = new KiSS4.Gui.KissTabControlEx();
            this.tpgVerfuegung = new SharpLibrary.WinControls.TabPageEx();
            this.ctlAmVerfuegung = new KiSS4.Inkasso.ZH.CtlAmVerfuegung();
            this.tbgBerechnung = new SharpLibrary.WinControls.TabPageEx();
            this.kissDocumentButton1 = new KiSS4.Dokument.KissDocumentButton();
            this.btnCollapse = new KiSS4.Gui.KissButton();
            this.btnExpand = new KiSS4.Gui.KissButton();
            this.groupBox1 = new KiSS4.Gui.KissGroupBox();
            this.rtfedtParams = new KiSS4.Gui.KissRTFEdit();
            this.RTFEditKinder = new KiSS4.Gui.KissRTFEdit();
            this.treBerechnung = new KiSS4.Gui.KissTree();
            this.colTreeBezeichnung = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colTreeDatumAb = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colTreeWert2 = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.repedtBetrag = new DevExpress.XtraEditors.Repository.RepositoryItemTextEdit();
            this.colTreeMengeneinheit2 = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colTreeWert1 = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colTreeMengeneinheit1 = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colTreeWert3 = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colTreeMengeneinheit3 = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colTreeBemerkung = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colTreeEditierbar1 = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colTreeEditierbar2 = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colTreeFormat2 = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.colID = new DevExpress.XtraTreeList.Columns.TreeListColumn();
            this.qryAbPosition = new KiSS4.DB.SqlQuery(this.components);
            this.repedtTreeCheckEdit = new DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit();
            this.btnCalculate = new KiSS4.Gui.KissButton();
            this.tbgGrunddaten = new SharpLibrary.WinControls.TabPageEx();
            this.panelBottom = new System.Windows.Forms.Panel();
            this.edtAltersBed = new KiSS4.Gui.KissTextEdit();
            this.lblAltersbedingung = new KiSS4.Gui.KissLabel();
            this.btnChangeState = new KiSS4.Gui.KissButton();
            this.edtRechtstitel = new KiSS4.Gui.KissLookUpEdit();
            this.qryKind = new KiSS4.DB.SqlQuery(this.components);
            this.qryRechtstitel = new KiSS4.DB.SqlQuery(this.components);
            this.btnUpdate = new KiSS4.Gui.KissButton();
            this.pnlMigDokumente = new System.Windows.Forms.Panel();
            this.xDokumentVerfuegung = new KiSS4.Dokument.XDokument();
            this.qryAmAnspruchsberechnung = new KiSS4.DB.SqlQuery(this.components);
            this.xDokumentBerechnung = new KiSS4.Dokument.XDokument();
            this.lblMigVerfuegung = new KiSS4.Gui.KissLabel();
            this.lblMigBerechnung = new KiSS4.Gui.KissLabel();
            this.edtStatusOk = new KiSS4.Gui.KissCheckEdit();
            this.edtStatusKinder = new KiSS4.Gui.KissTextEdit();
            this.edtStatusPensum = new KiSS4.Gui.KissTextEdit();
            this.lblKinderbetreuung2 = new KiSS4.Gui.KissLabel();
            this.lblArbeitspensum2 = new KiSS4.Gui.KissLabel();
            this.btnCopy = new KiSS4.Gui.KissButton();
            this.lblBezeichnung = new KiSS4.Gui.KissLabel();
            this.lblKinderbetreuung = new KiSS4.Gui.KissLabel();
            this.kissLabel3 = new KiSS4.Gui.KissLabel();
            this.lblArbeitspensum = new KiSS4.Gui.KissLabel();
            this.lblErstkontakt = new KiSS4.Gui.KissLabel();
            this.lblKinder = new KiSS4.Gui.KissLabel();
            this.lblEinkommen = new KiSS4.Gui.KissLabel();
            this.grdKinder = new KiSS4.Gui.KissGrid();
            this.grvAnzahlKinder = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colName = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colGeburt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colAlter = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBerechnung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colchkKind = new DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit();
            this.colBerechtigt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDatumBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colRechtstitel = new DevExpress.XtraGrid.Columns.GridColumn();
            this.repedtRechtstitel = new DevExpress.XtraEditors.Repository.RepositoryItemLookUpEdit();
            this.colAnspruch = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colRTName = new DevExpress.XtraGrid.Columns.GridColumn();
            this.edtBerechnungDatum = new KiSS4.Gui.KissDateEdit();
            this.adtErstkontakt = new KiSS4.Gui.KissDateEdit();
            this.edtKinderbetreuung = new KiSS4.Gui.KissCalcEdit();
            this.edtArbeitspensum = new KiSS4.Gui.KissCalcEdit();
            this.lblBerechnungstyp = new KiSS4.Gui.KissLabel();
            this.edtEinkommVar = new KiSS4.Gui.KissLookUpEdit();
            this.lblBerechnungDatum = new KiSS4.Gui.KissLabel();
            this.edtBezeichnung = new KiSS4.Gui.KissTextEdit();
            this.edtPrivMT = new KiSS4.Gui.KissButtonEdit();
            this.edtAmtMT = new KiSS4.Gui.KissButtonEdit();
            this.edtAmBerechnungTyp = new KiSS4.Gui.KissLookUpEdit();
            this.edtUser = new KiSS4.Gui.KissButtonEdit();
            this.tabControlSearch = new KiSS4.Gui.KissTabControlEx();
            this.tpgSuchen = new SharpLibrary.WinControls.TabPageEx();
            this.chkSucheOhneMigrierte = new KiSS4.Gui.KissCheckEdit();
            this.edtSucheDefinitivBis = new KiSS4.Gui.KissDateEdit();
            this.lblBis = new KiSS4.Gui.KissLabel();
            this.edtSucheDefinitivAb = new KiSS4.Gui.KissDateEdit();
            this.kissLabel4 = new KiSS4.Gui.KissLabel();
            this.edtSucheBerechnungstyp = new KiSS4.Gui.KissLookUpEdit();
            this.lblBerechnungs = new KiSS4.Gui.KissLabel();
            this.searchTitle = new KiSS4.Gui.KissSearchTitel();
            this.tpgListe = new SharpLibrary.WinControls.TabPageEx();
            this.grdAmAnspruchsberechnung = new KiSS4.Gui.KissGrid();
            this.grvAmAnspruchsberechnung = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colBezeichnung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colAnzahlKinder = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colStatus = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colEntscheidDatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colAmBerechnung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colAmEinkommensvariante = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBerechnungAb = new DevExpress.XtraGrid.Columns.GridColumn();
            this.qryBerechtigtKind = new KiSS4.DB.SqlQuery(this.components);
            this.qryK511 = new KiSS4.DB.SqlQuery(this.components);
            this.qryZVV = new KiSS4.DB.SqlQuery(this.components);
            this.tabDetail.SuspendLayout();
            this.tpgVerfuegung.SuspendLayout();
            this.tbgBerechnung.SuspendLayout();
            this.groupBox1.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.treBerechnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repedtBetrag)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryAbPosition)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repedtTreeCheckEdit)).BeginInit();
            this.tbgGrunddaten.SuspendLayout();
            this.panelBottom.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.edtAltersBed.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAltersbedingung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRechtstitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRechtstitel.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryKind)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryRechtstitel)).BeginInit();
            this.pnlMigDokumente.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.xDokumentVerfuegung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryAmAnspruchsberechnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.xDokumentBerechnung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMigVerfuegung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMigBerechnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtStatusOk.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtStatusKinder.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtStatusPensum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKinderbetreuung2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblArbeitspensum2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBezeichnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKinderbetreuung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel3)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblArbeitspensum)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblErstkontakt)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKinder)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEinkommen)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdKinder)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvAnzahlKinder)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.colchkKind)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repedtRechtstitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBerechnungDatum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.adtErstkontakt.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKinderbetreuung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtArbeitspensum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBerechnungstyp)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEinkommVar)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEinkommVar.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBerechnungDatum)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBezeichnung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtPrivMT.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAmtMT.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAmBerechnungTyp)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAmBerechnungTyp.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtUser.Properties)).BeginInit();
            this.tabControlSearch.SuspendLayout();
            this.tpgSuchen.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.chkSucheOhneMigrierte.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheDefinitivBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBis)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheDefinitivAb.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel4)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheBerechnungstyp)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheBerechnungstyp.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBerechnungs)).BeginInit();
            this.tpgListe.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.grdAmAnspruchsberechnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvAmAnspruchsberechnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBerechtigtKind)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryK511)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryZVV)).BeginInit();
            this.SuspendLayout();
            // 
            // tabDetail
            // 
            this.tabDetail.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.tabDetail.Controls.Add(this.tpgVerfuegung);
            this.tabDetail.Controls.Add(this.tbgBerechnung);
            this.tabDetail.Controls.Add(this.tbgGrunddaten);
            this.tabDetail.Location = new System.Drawing.Point(3, 3);
            this.tabDetail.Name = "tabDetail";
            this.tabDetail.ShowFixedWidthTooltip = true;
            this.tabDetail.Size = new System.Drawing.Size(793, 655);
            this.tabDetail.TabIndex = 33;
            this.tabDetail.TabPages.AddRange(new SharpLibrary.WinControls.TabPageEx[] {
            this.tbgGrunddaten,
            this.tbgBerechnung,
            this.tpgVerfuegung});
            this.tabDetail.TabsLineColor = System.Drawing.Color.Black;
            this.tabDetail.TabsStyle = SharpLibrary.WinControls.TabsStyle.Flat;
            this.tabDetail.Text = "kissTabControlEx1";
            this.tabDetail.SelectedTabChanging += new System.ComponentModel.CancelEventHandler(this.tabDetail_SelectedTabChanging);
            this.tabDetail.SelectedTabChanged += new SharpLibrary.WinControls.TabControlExTabChangeEventHandler(this.tabDetail_SelectedTabChanged);
            // 
            // tpgVerfuegung
            // 
            this.tpgVerfuegung.Controls.Add(this.ctlAmVerfuegung);
            this.tpgVerfuegung.Location = new System.Drawing.Point(6, 6);
            this.tpgVerfuegung.Name = "tpgVerfuegung";
            this.tpgVerfuegung.Size = new System.Drawing.Size(781, 617);
            this.tpgVerfuegung.TabIndex = 2;
            this.tpgVerfuegung.Title = "Verfügung";
            // 
            // ctlAmVerfuegung
            // 
            this.ctlAmVerfuegung.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.ctlAmVerfuegung.Dock = System.Windows.Forms.DockStyle.Fill;
            this.ctlAmVerfuegung.Location = new System.Drawing.Point(0, 0);
            this.ctlAmVerfuegung.Name = "ctlAmVerfuegung";
            this.ctlAmVerfuegung.Size = new System.Drawing.Size(781, 617);
            this.ctlAmVerfuegung.TabIndex = 34;
            // 
            // tbgBerechnung
            // 
            this.tbgBerechnung.Controls.Add(this.kissDocumentButton1);
            this.tbgBerechnung.Controls.Add(this.btnCollapse);
            this.tbgBerechnung.Controls.Add(this.btnExpand);
            this.tbgBerechnung.Controls.Add(this.groupBox1);
            this.tbgBerechnung.Controls.Add(this.treBerechnung);
            this.tbgBerechnung.Controls.Add(this.btnCalculate);
            this.tbgBerechnung.Location = new System.Drawing.Point(6, 6);
            this.tbgBerechnung.Name = "tbgBerechnung";
            this.tbgBerechnung.Size = new System.Drawing.Size(781, 617);
            this.tbgBerechnung.TabIndex = 1;
            this.tbgBerechnung.Title = "Berechnung";
            // 
            // kissDocumentButton1
            // 
            this.kissDocumentButton1.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.kissDocumentButton1.Context = "AmAnspruchsberechnungALBV";
            this.kissDocumentButton1.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.kissDocumentButton1.Image = ((System.Drawing.Image)(resources.GetObject("xWordBericht1.Image")));
            this.kissDocumentButton1.ImageAlign = System.Drawing.ContentAlignment.MiddleRight;
            this.kissDocumentButton1.Location = new System.Drawing.Point(86, 591);
            this.kissDocumentButton1.Name = "kissDocumentButton1";
            this.kissDocumentButton1.Size = new System.Drawing.Size(101, 24);
            this.kissDocumentButton1.TabIndex = 321;
            this.kissDocumentButton1.Text = "Drucken";
            this.kissDocumentButton1.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;
            this.kissDocumentButton1.UseCompatibleTextRendering = true;
            this.kissDocumentButton1.UseVisualStyleBackColor = false;
            this.kissDocumentButton1.Click += new System.EventHandler(this.kissDocumentButton1_Click);
            // 
            // btnCollapse
            // 
            this.btnCollapse.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.btnCollapse.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnCollapse.Image = ((System.Drawing.Image)(resources.GetObject("btnCollapse.Image")));
            this.btnCollapse.Location = new System.Drawing.Point(37, 590);
            this.btnCollapse.Name = "btnCollapse";
            this.btnCollapse.Size = new System.Drawing.Size(28, 24);
            this.btnCollapse.TabIndex = 320;
            this.btnCollapse.UseCompatibleTextRendering = true;
            this.btnCollapse.UseVisualStyleBackColor = false;
            this.btnCollapse.Click += new System.EventHandler(this.btnCollapse_Click);
            // 
            // btnExpand
            // 
            this.btnExpand.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.btnExpand.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnExpand.Image = ((System.Drawing.Image)(resources.GetObject("btnExpand.Image")));
            this.btnExpand.Location = new System.Drawing.Point(3, 590);
            this.btnExpand.Name = "btnExpand";
            this.btnExpand.Size = new System.Drawing.Size(28, 24);
            this.btnExpand.TabIndex = 319;
            this.btnExpand.UseCompatibleTextRendering = true;
            this.btnExpand.UseVisualStyleBackColor = false;
            this.btnExpand.Click += new System.EventHandler(this.btnExpand_Click);
            // 
            // groupBox1
            // 
            this.groupBox1.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.groupBox1.Controls.Add(this.rtfedtParams);
            this.groupBox1.Controls.Add(this.RTFEditKinder);
            this.groupBox1.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.groupBox1.Location = new System.Drawing.Point(3, 0);
            this.groupBox1.Name = "groupBox1";
            this.groupBox1.Size = new System.Drawing.Size(775, 95);
            this.groupBox1.TabIndex = 5;
            this.groupBox1.TabStop = false;
            this.groupBox1.Text = "Berechnungsangaben";
            this.groupBox1.UseCompatibleTextRendering = true;
            // 
            // rtfedtParams
            // 
            this.rtfedtParams.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)));
            this.rtfedtParams.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.rtfedtParams.BorderStyle = System.Windows.Forms.BorderStyle.None;
            this.rtfedtParams.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.rtfedtParams.EditValue = ((object)(resources.GetObject("rtfedtParams.EditValue")));
            this.rtfedtParams.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.rtfedtParams.Location = new System.Drawing.Point(10, 19);
            this.rtfedtParams.Name = "rtfedtParams";
            this.rtfedtParams.ReadOnly = true;
            this.rtfedtParams.Size = new System.Drawing.Size(301, 69);
            this.rtfedtParams.TabIndex = 7;
            // 
            // RTFEditKinder
            // 
            this.RTFEditKinder.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.RTFEditKinder.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.RTFEditKinder.BorderStyle = System.Windows.Forms.BorderStyle.None;
            this.RTFEditKinder.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.RTFEditKinder.EditValue = ((object)(resources.GetObject("RTFEditKinder.EditValue")));
            this.RTFEditKinder.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.RTFEditKinder.Location = new System.Drawing.Point(329, 19);
            this.RTFEditKinder.Name = "RTFEditKinder";
            this.RTFEditKinder.ReadOnly = true;
            this.RTFEditKinder.Size = new System.Drawing.Size(440, 70);
            this.RTFEditKinder.TabIndex = 6;
            // 
            // treBerechnung
            // 
            this.treBerechnung.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.treBerechnung.Appearance.Empty.BackColor = System.Drawing.Color.Transparent;
            this.treBerechnung.Appearance.Empty.ForeColor = System.Drawing.Color.White;
            this.treBerechnung.Appearance.Empty.Options.UseBackColor = true;
            this.treBerechnung.Appearance.Empty.Options.UseForeColor = true;
            this.treBerechnung.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(242)))), ((int)(((byte)(236)))), ((int)(((byte)(215)))));
            this.treBerechnung.Appearance.EvenRow.ForeColor = System.Drawing.Color.Black;
            this.treBerechnung.Appearance.EvenRow.Options.UseBackColor = true;
            this.treBerechnung.Appearance.EvenRow.Options.UseForeColor = true;
            this.treBerechnung.Appearance.FocusedCell.BackColor = System.Drawing.Color.Transparent;
            this.treBerechnung.Appearance.FocusedCell.ForeColor = System.Drawing.Color.Black;
            this.treBerechnung.Appearance.FocusedCell.Options.UseBackColor = true;
            this.treBerechnung.Appearance.FocusedCell.Options.UseForeColor = true;
            this.treBerechnung.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.treBerechnung.Appearance.FocusedRow.Options.UseForeColor = true;
            this.treBerechnung.Appearance.FooterPanel.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(230)))), ((int)(((byte)(216)))), ((int)(((byte)(174)))));
            this.treBerechnung.Appearance.FooterPanel.Font = new System.Drawing.Font("Microsoft Sans Serif", 11F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.treBerechnung.Appearance.FooterPanel.ForeColor = System.Drawing.Color.Black;
            this.treBerechnung.Appearance.FooterPanel.Options.UseBackColor = true;
            this.treBerechnung.Appearance.FooterPanel.Options.UseFont = true;
            this.treBerechnung.Appearance.FooterPanel.Options.UseForeColor = true;
            this.treBerechnung.Appearance.GroupButton.BackColor = System.Drawing.Color.Transparent;
            this.treBerechnung.Appearance.GroupButton.Font = new System.Drawing.Font("Microsoft Sans Serif", 9F, System.Drawing.FontStyle.Bold);
            this.treBerechnung.Appearance.GroupButton.ForeColor = System.Drawing.Color.Black;
            this.treBerechnung.Appearance.GroupButton.Options.UseBackColor = true;
            this.treBerechnung.Appearance.GroupButton.Options.UseFont = true;
            this.treBerechnung.Appearance.GroupButton.Options.UseForeColor = true;
            this.treBerechnung.Appearance.GroupFooter.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(240)))), ((int)(((byte)(226)))), ((int)(((byte)(184)))));
            this.treBerechnung.Appearance.GroupFooter.ForeColor = System.Drawing.Color.Black;
            this.treBerechnung.Appearance.GroupFooter.Options.UseBackColor = true;
            this.treBerechnung.Appearance.GroupFooter.Options.UseForeColor = true;
            this.treBerechnung.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.treBerechnung.Appearance.HeaderPanel.Font = new System.Drawing.Font("Microsoft Sans Serif", 8F, System.Drawing.FontStyle.Bold);
            this.treBerechnung.Appearance.HeaderPanel.ForeColor = System.Drawing.Color.Black;
            this.treBerechnung.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.treBerechnung.Appearance.HeaderPanel.Options.UseFont = true;
            this.treBerechnung.Appearance.HeaderPanel.Options.UseForeColor = true;
            this.treBerechnung.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.treBerechnung.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.treBerechnung.Appearance.HideSelectionRow.ForeColor = System.Drawing.Color.Black;
            this.treBerechnung.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.treBerechnung.Appearance.HideSelectionRow.Options.UseFont = true;
            this.treBerechnung.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.treBerechnung.Appearance.HorzLine.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(230)))), ((int)(((byte)(216)))), ((int)(((byte)(174)))));
            this.treBerechnung.Appearance.HorzLine.ForeColor = System.Drawing.Color.Red;
            this.treBerechnung.Appearance.HorzLine.Options.UseBackColor = true;
            this.treBerechnung.Appearance.HorzLine.Options.UseForeColor = true;
            this.treBerechnung.Appearance.OddRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.treBerechnung.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.treBerechnung.Appearance.OddRow.ForeColor = System.Drawing.Color.Black;
            this.treBerechnung.Appearance.OddRow.Options.UseBackColor = true;
            this.treBerechnung.Appearance.OddRow.Options.UseFont = true;
            this.treBerechnung.Appearance.OddRow.Options.UseForeColor = true;
            this.treBerechnung.Appearance.Preview.BackColor = System.Drawing.Color.White;
            this.treBerechnung.Appearance.Preview.Font = new System.Drawing.Font("Microsoft Sans Serif", 11F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.treBerechnung.Appearance.Preview.ForeColor = System.Drawing.Color.Maroon;
            this.treBerechnung.Appearance.Preview.Options.UseBackColor = true;
            this.treBerechnung.Appearance.Preview.Options.UseFont = true;
            this.treBerechnung.Appearance.Preview.Options.UseForeColor = true;
            this.treBerechnung.Appearance.Row.BackColor = System.Drawing.Color.Transparent;
            this.treBerechnung.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.treBerechnung.Appearance.Row.ForeColor = System.Drawing.Color.Black;
            this.treBerechnung.Appearance.Row.Options.UseBackColor = true;
            this.treBerechnung.Appearance.Row.Options.UseFont = true;
            this.treBerechnung.Appearance.Row.Options.UseForeColor = true;
            this.treBerechnung.Appearance.SelectedRow.ForeColor = System.Drawing.Color.White;
            this.treBerechnung.Appearance.SelectedRow.Options.UseForeColor = true;
            this.treBerechnung.Appearance.TreeLine.BackColor = System.Drawing.Color.Gray;
            this.treBerechnung.Appearance.TreeLine.ForeColor = System.Drawing.Color.Gray;
            this.treBerechnung.Appearance.TreeLine.Options.UseBackColor = true;
            this.treBerechnung.Appearance.TreeLine.Options.UseForeColor = true;
            this.treBerechnung.Appearance.VertLine.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(230)))), ((int)(((byte)(216)))), ((int)(((byte)(174)))));
            this.treBerechnung.Appearance.VertLine.ForeColor = System.Drawing.Color.FromArgb(((int)(((byte)(198)))), ((int)(((byte)(166)))), ((int)(((byte)(70)))));
            this.treBerechnung.Appearance.VertLine.Options.UseBackColor = true;
            this.treBerechnung.Appearance.VertLine.Options.UseForeColor = true;
            this.treBerechnung.Appearance.VertLine.Options.UseTextOptions = true;
            this.treBerechnung.Appearance.VertLine.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Near;
            this.treBerechnung.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.Flat;
            this.treBerechnung.Columns.AddRange(new DevExpress.XtraTreeList.Columns.TreeListColumn[] {
            this.colTreeBezeichnung,
            this.colTreeDatumAb,
            this.colTreeWert2,
            this.colTreeMengeneinheit2,
            this.colTreeWert1,
            this.colTreeMengeneinheit1,
            this.colTreeWert3,
            this.colTreeMengeneinheit3,
            this.colTreeBemerkung,
            this.colTreeEditierbar1,
            this.colTreeEditierbar2,
            this.colTreeFormat2,
            this.colID});
            this.treBerechnung.DataSource = this.qryAbPosition;
            this.treBerechnung.FormatConditions.AddRange(new DevExpress.XtraTreeList.StyleFormatConditions.StyleFormatCondition[] {
            styleFormatCondition1});
            this.treBerechnung.ImageIndexFieldName = "IconID";
            this.treBerechnung.KeyFieldName = "PositionsID";
            this.treBerechnung.Location = new System.Drawing.Point(3, 101);
            this.treBerechnung.Name = "treBerechnung";
            this.treBerechnung.OptionsBehavior.AutoSelectAllInEditor = false;
            this.treBerechnung.OptionsBehavior.CloseEditorOnLostFocus = false;
            this.treBerechnung.OptionsBehavior.Editable = false;
            this.treBerechnung.OptionsBehavior.KeepSelectedOnClick = false;
            this.treBerechnung.OptionsBehavior.MoveOnEdit = false;
            this.treBerechnung.OptionsBehavior.UseTabKey = true;
            this.treBerechnung.OptionsMenu.EnableColumnMenu = false;
            this.treBerechnung.OptionsMenu.EnableFooterMenu = false;
            this.treBerechnung.OptionsSelection.EnableAppearanceFocusedCell = false;
            this.treBerechnung.OptionsView.AutoWidth = false;
            this.treBerechnung.OptionsView.EnableAppearanceEvenRow = true;
            this.treBerechnung.OptionsView.EnableAppearanceOddRow = true;
            this.treBerechnung.OptionsView.ShowIndicator = false;
            this.treBerechnung.Padding = new System.Windows.Forms.Padding(10);
            this.treBerechnung.RepositoryItems.AddRange(new DevExpress.XtraEditors.Repository.RepositoryItem[] {
            this.repedtBetrag,
            this.repedtTreeCheckEdit});
            this.treBerechnung.Size = new System.Drawing.Size(775, 484);
            this.treBerechnung.TabIndex = 3;
            this.treBerechnung.CustomDrawNodeCell += new DevExpress.XtraTreeList.CustomDrawNodeCellEventHandler(this.treBerechnung_CustomDrawNodeCell);
            this.treBerechnung.AfterFocusNode += new DevExpress.XtraTreeList.NodeEventHandler(this.treBerechnung_AfterFocusNode);
            this.treBerechnung.BeforeFocusNode += new DevExpress.XtraTreeList.BeforeFocusNodeEventHandler(this.treBerechnung_BeforeFocusNode);
            this.treBerechnung.CellValueChanged += new DevExpress.XtraTreeList.CellValueChangedEventHandler(this.treBerechnung_CellValueChanged);
            this.treBerechnung.ShowingEditor += new System.ComponentModel.CancelEventHandler(this.treBerechnung_ShowingEditor);
            // 
            // colTreeBezeichnung
            // 
            this.colTreeBezeichnung.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colTreeBezeichnung.AppearanceCell.Options.UseBackColor = true;
            this.colTreeBezeichnung.Caption = "Bezeichnung";
            this.colTreeBezeichnung.FieldName = "Text";
            this.colTreeBezeichnung.Name = "colTreeBezeichnung";
            this.colTreeBezeichnung.OptionsColumn.AllowSort = false;
            this.colTreeBezeichnung.VisibleIndex = 0;
            this.colTreeBezeichnung.Width = 240;
            // 
            // colTreeDatumAb
            // 
            this.colTreeDatumAb.AppearanceCell.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(251)))), ((int)(((byte)(255)))));
            this.colTreeDatumAb.AppearanceCell.Options.UseBackColor = true;
            this.colTreeDatumAb.Caption = "Datum ab";
            this.colTreeDatumAb.FieldName = "DatumAb";
            this.colTreeDatumAb.Format.FormatString = "dd.MM.yyyy";
            this.colTreeDatumAb.Format.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colTreeDatumAb.Name = "colTreeDatumAb";
            this.colTreeDatumAb.OptionsColumn.AllowSort = false;
            // 
            // colTreeWert2
            // 
            this.colTreeWert2.AppearanceCell.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(251)))), ((int)(((byte)(255)))));
            this.colTreeWert2.AppearanceCell.Options.UseBackColor = true;
            this.colTreeWert2.AppearanceCell.Options.UseTextOptions = true;
            this.colTreeWert2.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colTreeWert2.Caption = "Anzahl";
            this.colTreeWert2.ColumnEdit = this.repedtBetrag;
            this.colTreeWert2.FieldName = "Wert2";
            this.colTreeWert2.Format.FormatString = "N2";
            this.colTreeWert2.Format.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colTreeWert2.Name = "colTreeWert2";
            this.colTreeWert2.OptionsColumn.AllowSort = false;
            this.colTreeWert2.OptionsColumn.ShowInCustomizationForm = false;
            this.colTreeWert2.VisibleIndex = 1;
            this.colTreeWert2.Width = 80;
            // 
            // repedtBetrag
            // 
            this.repedtBetrag.AutoHeight = false;
            this.repedtBetrag.DisplayFormat.FormatString = "N2";
            this.repedtBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.repedtBetrag.EditFormat.FormatString = "N2";
            this.repedtBetrag.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.repedtBetrag.HideSelection = false;
            this.repedtBetrag.Name = "repedtBetrag";
            this.repedtBetrag.ValidateOnEnterKey = true;
            // 
            // colTreeMengeneinheit2
            // 
            this.colTreeMengeneinheit2.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colTreeMengeneinheit2.AppearanceCell.Options.UseBackColor = true;
            this.colTreeMengeneinheit2.Caption = "Einheit";
            this.colTreeMengeneinheit2.FieldName = "Mengeneinheit2";
            this.colTreeMengeneinheit2.Name = "colTreeMengeneinheit2";
            this.colTreeMengeneinheit2.OptionsColumn.AllowEdit = false;
            this.colTreeMengeneinheit2.OptionsColumn.AllowFocus = false;
            this.colTreeMengeneinheit2.OptionsColumn.AllowSort = false;
            this.colTreeMengeneinheit2.VisibleIndex = 2;
            this.colTreeMengeneinheit2.Width = 80;
            // 
            // colTreeWert1
            // 
            this.colTreeWert1.AppearanceCell.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(251)))), ((int)(((byte)(255)))));
            this.colTreeWert1.AppearanceCell.Options.UseBackColor = true;
            this.colTreeWert1.AppearanceCell.Options.UseTextOptions = true;
            this.colTreeWert1.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colTreeWert1.Caption = "Betrag à";
            this.colTreeWert1.ColumnEdit = this.repedtBetrag;
            this.colTreeWert1.FieldName = "Wert1";
            this.colTreeWert1.Format.FormatString = "N2";
            this.colTreeWert1.Format.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colTreeWert1.Name = "colTreeWert1";
            this.colTreeWert1.OptionsColumn.AllowSort = false;
            this.colTreeWert1.OptionsColumn.ShowInCustomizationForm = false;
            this.colTreeWert1.VisibleIndex = 3;
            this.colTreeWert1.Width = 80;
            // 
            // colTreeMengeneinheit1
            // 
            this.colTreeMengeneinheit1.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colTreeMengeneinheit1.AppearanceCell.Options.UseBackColor = true;
            this.colTreeMengeneinheit1.Caption = "Einheit";
            this.colTreeMengeneinheit1.FieldName = "Mengeneinheit1";
            this.colTreeMengeneinheit1.Name = "colTreeMengeneinheit1";
            this.colTreeMengeneinheit1.OptionsColumn.AllowEdit = false;
            this.colTreeMengeneinheit1.OptionsColumn.AllowFocus = false;
            this.colTreeMengeneinheit1.OptionsColumn.AllowSort = false;
            this.colTreeMengeneinheit1.VisibleIndex = 4;
            this.colTreeMengeneinheit1.Width = 80;
            // 
            // colTreeWert3
            // 
            this.colTreeWert3.AppearanceCell.Options.UseTextOptions = true;
            this.colTreeWert3.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colTreeWert3.Caption = "Totalbetrag";
            this.colTreeWert3.FieldName = "Wert3";
            this.colTreeWert3.Format.FormatString = "N2";
            this.colTreeWert3.Format.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colTreeWert3.Name = "colTreeWert3";
            this.colTreeWert3.OptionsColumn.AllowEdit = false;
            this.colTreeWert3.OptionsColumn.AllowFocus = false;
            this.colTreeWert3.OptionsColumn.AllowSort = false;
            this.colTreeWert3.VisibleIndex = 5;
            this.colTreeWert3.Width = 80;
            // 
            // colTreeMengeneinheit3
            // 
            this.colTreeMengeneinheit3.Caption = "Einheit";
            this.colTreeMengeneinheit3.FieldName = "Mengeneinheit3";
            this.colTreeMengeneinheit3.Name = "colTreeMengeneinheit3";
            this.colTreeMengeneinheit3.OptionsColumn.AllowEdit = false;
            this.colTreeMengeneinheit3.OptionsColumn.AllowFocus = false;
            this.colTreeMengeneinheit3.OptionsColumn.AllowSort = false;
            this.colTreeMengeneinheit3.VisibleIndex = 6;
            this.colTreeMengeneinheit3.Width = 55;
            // 
            // colTreeBemerkung
            // 
            this.colTreeBemerkung.AppearanceCell.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(251)))), ((int)(((byte)(255)))));
            this.colTreeBemerkung.AppearanceCell.Options.UseBackColor = true;
            this.colTreeBemerkung.Caption = "Bemerkung";
            this.colTreeBemerkung.FieldName = "Bemerkung";
            this.colTreeBemerkung.Name = "colTreeBemerkung";
            this.colTreeBemerkung.OptionsColumn.AllowSort = false;
            this.colTreeBemerkung.VisibleIndex = 7;
            this.colTreeBemerkung.Width = 195;
            // 
            // colTreeEditierbar1
            // 
            this.colTreeEditierbar1.Caption = "colTreeEditierbar1";
            this.colTreeEditierbar1.FieldName = "Editierbar1";
            this.colTreeEditierbar1.Name = "colTreeEditierbar1";
            this.colTreeEditierbar1.OptionsColumn.AllowEdit = false;
            this.colTreeEditierbar1.OptionsColumn.AllowFocus = false;
            this.colTreeEditierbar1.OptionsColumn.AllowMove = false;
            this.colTreeEditierbar1.OptionsColumn.AllowSort = false;
            this.colTreeEditierbar1.OptionsColumn.ReadOnly = true;
            // 
            // colTreeEditierbar2
            // 
            this.colTreeEditierbar2.Caption = "colTreeEditierbar2";
            this.colTreeEditierbar2.FieldName = "Editierbar2";
            this.colTreeEditierbar2.Name = "colTreeEditierbar2";
            this.colTreeEditierbar2.OptionsColumn.AllowSort = false;
            // 
            // colTreeFormat2
            // 
            this.colTreeFormat2.Caption = "Format";
            this.colTreeFormat2.FieldName = "Format2";
            this.colTreeFormat2.Name = "colTreeFormat2";
            this.colTreeFormat2.OptionsColumn.AllowSort = false;
            // 
            // colID
            // 
            this.colID.Caption = "ID";
            this.colID.FieldName = "PositionsID";
            this.colID.Name = "colID";
            this.colID.OptionsColumn.AllowEdit = false;
            this.colID.OptionsColumn.AllowFocus = false;
            this.colID.OptionsColumn.AllowSort = false;
            this.colID.VisibleIndex = 8;
            this.colID.Width = 60;
            // 
            // qryAbPosition
            // 
            this.qryAbPosition.BatchUpdate = true;
            this.qryAbPosition.CanUpdate = true;
            this.qryAbPosition.HostControl = this;
            this.qryAbPosition.SelectStatement = resources.GetString("qryAbPosition.SelectStatement");
            this.qryAbPosition.TableName = "AmAbPosition";
            this.qryAbPosition.BeforePost += new System.EventHandler(this.qryAbPosition_BeforePost);
            this.qryAbPosition.AfterFill += new System.EventHandler(this.qryAbPosition_AfterFill);
            // 
            // repedtTreeCheckEdit
            // 
            this.repedtTreeCheckEdit.AutoHeight = false;
            this.repedtTreeCheckEdit.Caption = "manuell";
            this.repedtTreeCheckEdit.GlyphAlignment = DevExpress.Utils.HorzAlignment.Near;
            this.repedtTreeCheckEdit.Name = "repedtTreeCheckEdit";
            // 
            // btnCalculate
            // 
            this.btnCalculate.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnCalculate.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnCalculate.Location = new System.Drawing.Point(613, 591);
            this.btnCalculate.Name = "btnCalculate";
            this.btnCalculate.Size = new System.Drawing.Size(165, 24);
            this.btnCalculate.TabIndex = 2;
            this.btnCalculate.Text = "Berechnung durchführen";
            this.btnCalculate.UseCompatibleTextRendering = true;
            this.btnCalculate.UseVisualStyleBackColor = false;
            this.btnCalculate.Click += new System.EventHandler(this.btnCalculate_Click);
            // 
            // tbgGrunddaten
            // 
            this.tbgGrunddaten.Controls.Add(this.panelBottom);
            this.tbgGrunddaten.Controls.Add(this.tabControlSearch);
            this.tbgGrunddaten.Location = new System.Drawing.Point(6, 6);
            this.tbgGrunddaten.Name = "tbgGrunddaten";
            this.tbgGrunddaten.Size = new System.Drawing.Size(781, 617);
            this.tbgGrunddaten.TabIndex = 0;
            this.tbgGrunddaten.Title = "Grunddaten";
            // 
            // panelBottom
            // 
            this.panelBottom.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.panelBottom.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
            this.panelBottom.Controls.Add(this.edtAltersBed);
            this.panelBottom.Controls.Add(this.lblAltersbedingung);
            this.panelBottom.Controls.Add(this.btnChangeState);
            this.panelBottom.Controls.Add(this.edtRechtstitel);
            this.panelBottom.Controls.Add(this.btnUpdate);
            this.panelBottom.Controls.Add(this.pnlMigDokumente);
            this.panelBottom.Controls.Add(this.edtStatusOk);
            this.panelBottom.Controls.Add(this.edtStatusKinder);
            this.panelBottom.Controls.Add(this.edtStatusPensum);
            this.panelBottom.Controls.Add(this.lblKinderbetreuung2);
            this.panelBottom.Controls.Add(this.lblArbeitspensum2);
            this.panelBottom.Controls.Add(this.btnCopy);
            this.panelBottom.Controls.Add(this.lblBezeichnung);
            this.panelBottom.Controls.Add(this.lblKinderbetreuung);
            this.panelBottom.Controls.Add(this.kissLabel3);
            this.panelBottom.Controls.Add(this.lblArbeitspensum);
            this.panelBottom.Controls.Add(this.lblErstkontakt);
            this.panelBottom.Controls.Add(this.lblKinder);
            this.panelBottom.Controls.Add(this.lblEinkommen);
            this.panelBottom.Controls.Add(this.grdKinder);
            this.panelBottom.Controls.Add(this.edtBerechnungDatum);
            this.panelBottom.Controls.Add(this.adtErstkontakt);
            this.panelBottom.Controls.Add(this.edtKinderbetreuung);
            this.panelBottom.Controls.Add(this.edtArbeitspensum);
            this.panelBottom.Controls.Add(this.lblBerechnungstyp);
            this.panelBottom.Controls.Add(this.edtEinkommVar);
            this.panelBottom.Controls.Add(this.lblBerechnungDatum);
            this.panelBottom.Controls.Add(this.edtBezeichnung);
            this.panelBottom.Controls.Add(this.edtPrivMT);
            this.panelBottom.Controls.Add(this.edtAmtMT);
            this.panelBottom.Controls.Add(this.edtAmBerechnungTyp);
            this.panelBottom.Controls.Add(this.edtUser);
            this.panelBottom.Location = new System.Drawing.Point(9, 254);
            this.panelBottom.Name = "panelBottom";
            this.panelBottom.Padding = new System.Windows.Forms.Padding(4);
            this.panelBottom.Size = new System.Drawing.Size(762, 350);
            this.panelBottom.TabIndex = 1;
            // 
            // edtAltersBed
            // 
            this.edtAltersBed.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtAltersBed.Location = new System.Drawing.Point(621, 70);
            this.edtAltersBed.Name = "edtAltersBed";
            this.edtAltersBed.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtAltersBed.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAltersBed.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAltersBed.Properties.Appearance.Options.UseBackColor = true;
            this.edtAltersBed.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAltersBed.Properties.Appearance.Options.UseFont = true;
            this.edtAltersBed.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtAltersBed.Properties.ReadOnly = true;
            this.edtAltersBed.Size = new System.Drawing.Size(112, 24);
            this.edtAltersBed.TabIndex = 59;
            // 
            // lblAltersbedingung
            // 
            this.lblAltersbedingung.Location = new System.Drawing.Point(522, 70);
            this.lblAltersbedingung.Name = "lblAltersbedingung";
            this.lblAltersbedingung.Size = new System.Drawing.Size(84, 24);
            this.lblAltersbedingung.TabIndex = 58;
            this.lblAltersbedingung.Text = "Altersbedingung";
            this.lblAltersbedingung.UseCompatibleTextRendering = true;
            // 
            // btnChangeState
            // 
            this.btnChangeState.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnChangeState.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnChangeState.Location = new System.Drawing.Point(620, 130);
            this.btnChangeState.Name = "btnChangeState";
            this.btnChangeState.Size = new System.Drawing.Size(132, 24);
            this.btnChangeState.TabIndex = 57;
            this.btnChangeState.Text = "wieder bewilligen";
            this.btnChangeState.UseCompatibleTextRendering = true;
            this.btnChangeState.UseVisualStyleBackColor = false;
            this.btnChangeState.Click += new System.EventHandler(this.btnChangeState_Click);
            // 
            // edtRechtstitel
            // 
            this.edtRechtstitel.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtRechtstitel.DataMember = "IkRechtstitelID";
            this.edtRechtstitel.DataSource = this.qryKind;
            this.edtRechtstitel.Location = new System.Drawing.Point(289, 317);
            this.edtRechtstitel.Name = "edtRechtstitel";
            this.edtRechtstitel.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtRechtstitel.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtRechtstitel.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtRechtstitel.Properties.Appearance.Options.UseBackColor = true;
            this.edtRechtstitel.Properties.Appearance.Options.UseBorderColor = true;
            this.edtRechtstitel.Properties.Appearance.Options.UseFont = true;
            this.edtRechtstitel.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtRechtstitel.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtRechtstitel.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtRechtstitel.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtRechtstitel.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtRechtstitel.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtRechtstitel.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtRechtstitel.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text"),
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("IkRechtstitelID", "", 20, DevExpress.Utils.FormatType.None, "", false, DevExpress.Utils.HorzAlignment.Default, DevExpress.Data.ColumnSortOrder.None)});
            this.edtRechtstitel.Properties.DataSource = this.qryRechtstitel;
            this.edtRechtstitel.Properties.DisplayMember = "Text";
            this.edtRechtstitel.Properties.NullText = "";
            this.edtRechtstitel.Properties.ShowFooter = false;
            this.edtRechtstitel.Properties.ShowHeader = false;
            this.edtRechtstitel.Properties.ValueMember = "IkRechtstitelID";
            this.edtRechtstitel.Size = new System.Drawing.Size(460, 24);
            this.edtRechtstitel.TabIndex = 56;
            this.edtRechtstitel.CloseUp += new DevExpress.XtraEditors.Controls.CloseUpEventHandler(this.edtRechtstitel_CloseUp);
            // 
            // qryKind
            // 
            this.qryKind.BatchUpdate = true;
            this.qryKind.CanUpdate = true;
            this.qryKind.HostControl = this;
            this.qryKind.SelectStatement = resources.GetString("qryKind.SelectStatement");
            this.qryKind.TableName = "AmAbKind";
            this.qryKind.BeforePost += new System.EventHandler(this.qryKind_BeforePost);
            this.qryKind.PositionChanged += new System.EventHandler(this.qryKind_PositionChanged);
            this.qryKind.AfterFill += new System.EventHandler(this.qryKind_AfterFill);
            this.qryKind.PositionChanging += new System.EventHandler(this.qryKind_PositionChanging);
            // 
            // qryRechtstitel
            // 
            this.qryRechtstitel.HostControl = this;
            this.qryRechtstitel.SelectStatement = resources.GetString("qryRechtstitel.SelectStatement");
            // 
            // btnUpdate
            // 
            this.btnUpdate.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.btnUpdate.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnUpdate.Location = new System.Drawing.Point(108, 317);
            this.btnUpdate.Name = "btnUpdate";
            this.btnUpdate.Size = new System.Drawing.Size(160, 24);
            this.btnUpdate.TabIndex = 55;
            this.btnUpdate.Text = "Alles neu berechnen";
            this.btnUpdate.UseCompatibleTextRendering = true;
            this.btnUpdate.UseVisualStyleBackColor = false;
            this.btnUpdate.Click += new System.EventHandler(this.btnUpdate_Click);
            // 
            // pnlMigDokumente
            // 
            this.pnlMigDokumente.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.pnlMigDokumente.Controls.Add(this.xDokumentVerfuegung);
            this.pnlMigDokumente.Controls.Add(this.xDokumentBerechnung);
            this.pnlMigDokumente.Controls.Add(this.lblMigVerfuegung);
            this.pnlMigDokumente.Controls.Add(this.lblMigBerechnung);
            this.pnlMigDokumente.Location = new System.Drawing.Point(289, 307);
            this.pnlMigDokumente.Name = "pnlMigDokumente";
            this.pnlMigDokumente.Size = new System.Drawing.Size(463, 34);
            this.pnlMigDokumente.TabIndex = 54;
            this.pnlMigDokumente.Visible = false;
            // 
            // xDokumentVerfuegung
            // 
            this.xDokumentVerfuegung.AllowDrop = true;
            this.xDokumentVerfuegung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.xDokumentVerfuegung.Context = null;
            this.xDokumentVerfuegung.DataMember = "Verfuegung_DocumentID";
            this.xDokumentVerfuegung.DataSource = this.qryAmAnspruchsberechnung;
            this.xDokumentVerfuegung.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.xDokumentVerfuegung.Location = new System.Drawing.Point(331, 3);
            this.xDokumentVerfuegung.Name = "xDokumentVerfuegung";
            this.xDokumentVerfuegung.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.xDokumentVerfuegung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.xDokumentVerfuegung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.xDokumentVerfuegung.Properties.Appearance.Options.UseBackColor = true;
            this.xDokumentVerfuegung.Properties.Appearance.Options.UseBorderColor = true;
            this.xDokumentVerfuegung.Properties.Appearance.Options.UseFont = true;
            this.xDokumentVerfuegung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.xDokumentVerfuegung.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, false, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("xDokumentVerfuegung.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2, "Dokument öffnen")});
            this.xDokumentVerfuegung.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.xDokumentVerfuegung.Properties.ReadOnly = true;
            this.xDokumentVerfuegung.Size = new System.Drawing.Size(100, 24);
            this.xDokumentVerfuegung.TabIndex = 43;
            // 
            // qryAmAnspruchsberechnung
            // 
            this.qryAmAnspruchsberechnung.CanDelete = true;
            this.qryAmAnspruchsberechnung.CanInsert = true;
            this.qryAmAnspruchsberechnung.CanUpdate = true;
            this.qryAmAnspruchsberechnung.HostControl = this;
            this.qryAmAnspruchsberechnung.SelectStatement = resources.GetString("qryAmAnspruchsberechnung.SelectStatement");
            this.qryAmAnspruchsberechnung.TableName = "AmAnspruchsberechnung";
            this.qryAmAnspruchsberechnung.BeforeDelete += new System.EventHandler(this.qryAmAnspruchsberechnung_BeforeDelete);
            this.qryAmAnspruchsberechnung.BeforePost += new System.EventHandler(this.qryAmAnspruchsberechnung_BeforePost);
            this.qryAmAnspruchsberechnung.PositionChanged += new System.EventHandler(this.qryAmAnspruchsberechnung_PositionChanged);
            this.qryAmAnspruchsberechnung.AfterFill += new System.EventHandler(this.qryAmAnspruchsberechnung_AfterFill);
            this.qryAmAnspruchsberechnung.AfterInsert += new System.EventHandler(this.qryAmAnspruchsberechnung_AfterInsert);
            this.qryAmAnspruchsberechnung.AfterPost += new System.EventHandler(this.qryAmAnspruchsberechnung_AfterPost);
            this.qryAmAnspruchsberechnung.AfterDelete += new System.EventHandler(this.qryAmAnspruchsberechnung_AfterDelete);
            this.qryAmAnspruchsberechnung.PostError += new System.UnhandledExceptionEventHandler(this.qryAmAnspruchsberechnung_PostError);
            this.qryAmAnspruchsberechnung.DeleteError += new System.UnhandledExceptionEventHandler(this.qryAmAnspruchsberechnung_DeleteError);
            this.qryAmAnspruchsberechnung.PositionChanging += new System.EventHandler(this.qryAmAnspruchsberechnung_PositionChanging);
            // 
            // xDokumentBerechnung
            // 
            this.xDokumentBerechnung.AllowDrop = true;
            this.xDokumentBerechnung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.xDokumentBerechnung.Context = null;
            this.xDokumentBerechnung.DataMember = "Berechnung_DocumentID";
            this.xDokumentBerechnung.DataSource = this.qryAmAnspruchsberechnung;
            this.xDokumentBerechnung.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.xDokumentBerechnung.Location = new System.Drawing.Point(119, 3);
            this.xDokumentBerechnung.Name = "xDokumentBerechnung";
            this.xDokumentBerechnung.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.xDokumentBerechnung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.xDokumentBerechnung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.xDokumentBerechnung.Properties.Appearance.Options.UseBackColor = true;
            this.xDokumentBerechnung.Properties.Appearance.Options.UseBorderColor = true;
            this.xDokumentBerechnung.Properties.Appearance.Options.UseFont = true;
            this.xDokumentBerechnung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            this.xDokumentBerechnung.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, false, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("xDokumentBerechnung.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3, "Dokument öffnen")});
            this.xDokumentBerechnung.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.xDokumentBerechnung.Properties.ReadOnly = true;
            this.xDokumentBerechnung.Size = new System.Drawing.Size(100, 24);
            this.xDokumentBerechnung.TabIndex = 42;
            // 
            // lblMigVerfuegung
            // 
            this.lblMigVerfuegung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblMigVerfuegung.Location = new System.Drawing.Point(224, 3);
            this.lblMigVerfuegung.Name = "lblMigVerfuegung";
            this.lblMigVerfuegung.Size = new System.Drawing.Size(101, 24);
            this.lblMigVerfuegung.TabIndex = 24;
            this.lblMigVerfuegung.Text = "Verfügung aus ALIM";
            this.lblMigVerfuegung.UseCompatibleTextRendering = true;
            // 
            // lblMigBerechnung
            // 
            this.lblMigBerechnung.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblMigBerechnung.Location = new System.Drawing.Point(3, 3);
            this.lblMigBerechnung.Name = "lblMigBerechnung";
            this.lblMigBerechnung.Size = new System.Drawing.Size(115, 24);
            this.lblMigBerechnung.TabIndex = 24;
            this.lblMigBerechnung.Text = "Berechnung aus ALIM";
            this.lblMigBerechnung.UseCompatibleTextRendering = true;
            // 
            // edtStatusOk
            // 
            this.edtStatusOk.DataMember = "BedingungKKBBErfuellt";
            this.edtStatusOk.DataSource = this.qryAmAnspruchsberechnung;
            this.edtStatusOk.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtStatusOk.Location = new System.Drawing.Point(620, 99);
            this.edtStatusOk.Name = "edtStatusOk";
            this.edtStatusOk.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtStatusOk.Properties.Appearance.Options.UseBackColor = true;
            this.edtStatusOk.Properties.Caption = "Bed. erfüllt";
            this.edtStatusOk.Properties.ReadOnly = true;
            this.edtStatusOk.Size = new System.Drawing.Size(109, 19);
            this.edtStatusOk.TabIndex = 52;
            // 
            // edtStatusKinder
            // 
            this.edtStatusKinder.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtStatusKinder.Location = new System.Drawing.Point(621, 40);
            this.edtStatusKinder.Name = "edtStatusKinder";
            this.edtStatusKinder.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtStatusKinder.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtStatusKinder.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtStatusKinder.Properties.Appearance.Options.UseBackColor = true;
            this.edtStatusKinder.Properties.Appearance.Options.UseBorderColor = true;
            this.edtStatusKinder.Properties.Appearance.Options.UseFont = true;
            this.edtStatusKinder.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtStatusKinder.Properties.ReadOnly = true;
            this.edtStatusKinder.Size = new System.Drawing.Size(112, 24);
            this.edtStatusKinder.TabIndex = 51;
            // 
            // edtStatusPensum
            // 
            this.edtStatusPensum.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtStatusPensum.Location = new System.Drawing.Point(621, 11);
            this.edtStatusPensum.Name = "edtStatusPensum";
            this.edtStatusPensum.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtStatusPensum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtStatusPensum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtStatusPensum.Properties.Appearance.Options.UseBackColor = true;
            this.edtStatusPensum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtStatusPensum.Properties.Appearance.Options.UseFont = true;
            this.edtStatusPensum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtStatusPensum.Properties.ReadOnly = true;
            this.edtStatusPensum.Size = new System.Drawing.Size(112, 24);
            this.edtStatusPensum.TabIndex = 50;
            // 
            // lblKinderbetreuung2
            // 
            this.lblKinderbetreuung2.Location = new System.Drawing.Point(522, 40);
            this.lblKinderbetreuung2.Name = "lblKinderbetreuung2";
            this.lblKinderbetreuung2.Size = new System.Drawing.Size(84, 24);
            this.lblKinderbetreuung2.TabIndex = 49;
            this.lblKinderbetreuung2.Text = "Tage pro Woche";
            this.lblKinderbetreuung2.UseCompatibleTextRendering = true;
            // 
            // lblArbeitspensum2
            // 
            this.lblArbeitspensum2.Location = new System.Drawing.Point(522, 9);
            this.lblArbeitspensum2.Name = "lblArbeitspensum2";
            this.lblArbeitspensum2.Size = new System.Drawing.Size(72, 24);
            this.lblArbeitspensum2.TabIndex = 48;
            this.lblArbeitspensum2.Text = "% pro Monat";
            this.lblArbeitspensum2.UseCompatibleTextRendering = true;
            // 
            // btnCopy
            // 
            this.btnCopy.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.btnCopy.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnCopy.Location = new System.Drawing.Point(12, 317);
            this.btnCopy.Name = "btnCopy";
            this.btnCopy.Size = new System.Drawing.Size(79, 24);
            this.btnCopy.TabIndex = 41;
            this.btnCopy.Text = "Kopieren";
            this.btnCopy.UseCompatibleTextRendering = true;
            this.btnCopy.UseVisualStyleBackColor = false;
            this.btnCopy.Click += new System.EventHandler(this.btnCopy_Click);
            // 
            // lblBezeichnung
            // 
            this.lblBezeichnung.Location = new System.Drawing.Point(11, 70);
            this.lblBezeichnung.Name = "lblBezeichnung";
            this.lblBezeichnung.Size = new System.Drawing.Size(82, 24);
            this.lblBezeichnung.TabIndex = 40;
            this.lblBezeichnung.Text = "Bezeichnung";
            this.lblBezeichnung.UseCompatibleTextRendering = true;
            // 
            // lblKinderbetreuung
            // 
            this.lblKinderbetreuung.Location = new System.Drawing.Point(329, 40);
            this.lblKinderbetreuung.Name = "lblKinderbetreuung";
            this.lblKinderbetreuung.Size = new System.Drawing.Size(117, 24);
            this.lblKinderbetreuung.TabIndex = 39;
            this.lblKinderbetreuung.Tag = "";
            this.lblKinderbetreuung.Text = "Kinderfremdbetreuung";
            this.lblKinderbetreuung.UseCompatibleTextRendering = true;
            // 
            // kissLabel3
            // 
            this.kissLabel3.Location = new System.Drawing.Point(11, 11);
            this.kissLabel3.Name = "kissLabel3";
            this.kissLabel3.Size = new System.Drawing.Size(92, 24);
            this.kissLabel3.TabIndex = 36;
            this.kissLabel3.Text = "zuständige MA";
            this.kissLabel3.UseCompatibleTextRendering = true;
            // 
            // lblArbeitspensum
            // 
            this.lblArbeitspensum.Location = new System.Drawing.Point(364, 10);
            this.lblArbeitspensum.Name = "lblArbeitspensum";
            this.lblArbeitspensum.Size = new System.Drawing.Size(82, 24);
            this.lblArbeitspensum.TabIndex = 34;
            this.lblArbeitspensum.Text = "Arbeitspensum";
            this.lblArbeitspensum.UseCompatibleTextRendering = true;
            // 
            // lblErstkontakt
            // 
            this.lblErstkontakt.Location = new System.Drawing.Point(329, 100);
            this.lblErstkontakt.Name = "lblErstkontakt";
            this.lblErstkontakt.Size = new System.Drawing.Size(80, 24);
            this.lblErstkontakt.TabIndex = 27;
            this.lblErstkontakt.Text = "Erstkontakt";
            this.lblErstkontakt.UseCompatibleTextRendering = true;
            // 
            // lblKinder
            // 
            this.lblKinder.Location = new System.Drawing.Point(14, 168);
            this.lblKinder.Name = "lblKinder";
            this.lblKinder.Size = new System.Drawing.Size(79, 24);
            this.lblKinder.TabIndex = 24;
            this.lblKinder.Text = "Kinder";
            this.lblKinder.UseCompatibleTextRendering = true;
            // 
            // lblEinkommen
            // 
            this.lblEinkommen.Location = new System.Drawing.Point(12, 100);
            this.lblEinkommen.Name = "lblEinkommen";
            this.lblEinkommen.Size = new System.Drawing.Size(91, 24);
            this.lblEinkommen.TabIndex = 19;
            this.lblEinkommen.Text = "Einkommensv.";
            this.lblEinkommen.UseCompatibleTextRendering = true;
            // 
            // grdKinder
            // 
            this.grdKinder.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdKinder.DataSource = this.qryKind;
            this.grdKinder.EmbeddedNavigator.Name = "";
            this.grdKinder.GridStyle = KiSS4.Gui.GridStyleType.Editable;
            this.grdKinder.Location = new System.Drawing.Point(108, 168);
            this.grdKinder.MainView = this.grvAnzahlKinder;
            this.grdKinder.Margin = new System.Windows.Forms.Padding(3, 3, 3, 9);
            this.grdKinder.Name = "grdKinder";
            this.grdKinder.RepositoryItems.AddRange(new DevExpress.XtraEditors.Repository.RepositoryItem[] {
            this.colchkKind,
            this.repedtRechtstitel});
            this.grdKinder.Size = new System.Drawing.Size(644, 137);
            this.grdKinder.TabIndex = 12;
            this.grdKinder.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvAnzahlKinder});
            // 
            // grvAnzahlKinder
            // 
            this.grvAnzahlKinder.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvAnzahlKinder.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAnzahlKinder.Appearance.Empty.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.Empty.Options.UseFont = true;
            this.grvAnzahlKinder.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.grvAnzahlKinder.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAnzahlKinder.Appearance.EvenRow.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.EvenRow.Options.UseFont = true;
            this.grvAnzahlKinder.Appearance.FocusedCell.BackColor = System.Drawing.Color.AliceBlue;
            this.grvAnzahlKinder.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAnzahlKinder.Appearance.FocusedCell.ForeColor = System.Drawing.Color.Black;
            this.grvAnzahlKinder.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.FocusedCell.Options.UseFont = true;
            this.grvAnzahlKinder.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvAnzahlKinder.Appearance.FocusedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.grvAnzahlKinder.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAnzahlKinder.Appearance.FocusedRow.ForeColor = System.Drawing.Color.Black;
            this.grvAnzahlKinder.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.FocusedRow.Options.UseFont = true;
            this.grvAnzahlKinder.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvAnzahlKinder.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvAnzahlKinder.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvAnzahlKinder.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvAnzahlKinder.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvAnzahlKinder.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.GroupRow.Options.UseFont = true;
            this.grvAnzahlKinder.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvAnzahlKinder.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvAnzahlKinder.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvAnzahlKinder.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvAnzahlKinder.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvAnzahlKinder.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvAnzahlKinder.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.AliceBlue;
            this.grvAnzahlKinder.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAnzahlKinder.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvAnzahlKinder.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvAnzahlKinder.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvAnzahlKinder.Appearance.HorzLine.BackColor = System.Drawing.Color.LightGray;
            this.grvAnzahlKinder.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAnzahlKinder.Appearance.OddRow.Options.UseFont = true;
            this.grvAnzahlKinder.Appearance.Row.BackColor = System.Drawing.Color.AliceBlue;
            this.grvAnzahlKinder.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAnzahlKinder.Appearance.Row.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.Row.Options.UseFont = true;
            this.grvAnzahlKinder.Appearance.SelectedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.grvAnzahlKinder.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAnzahlKinder.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.grvAnzahlKinder.Appearance.SelectedRow.Options.UseBackColor = true;
            this.grvAnzahlKinder.Appearance.SelectedRow.Options.UseFont = true;
            this.grvAnzahlKinder.Appearance.SelectedRow.Options.UseForeColor = true;
            this.grvAnzahlKinder.Appearance.VertLine.BackColor = System.Drawing.Color.LightGray;
            this.grvAnzahlKinder.Appearance.VertLine.Options.UseBackColor = true;
            this.grvAnzahlKinder.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvAnzahlKinder.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colName,
            this.colGeburt,
            this.colAlter,
            this.colBerechnung,
            this.colBerechtigt,
            this.colDatumBis,
            this.colRechtstitel,
            this.colAnspruch,
            this.colRTName});
            this.grvAnzahlKinder.GridControl = this.grdKinder;
            this.grvAnzahlKinder.GroupPanelText = "zu gruppierende Kolonnen in diesen Bereich ziehen";
            this.grvAnzahlKinder.Name = "grvAnzahlKinder";
            this.grvAnzahlKinder.OptionsCustomization.AllowFilter = false;
            this.grvAnzahlKinder.OptionsFilter.AllowFilterEditor = false;
            this.grvAnzahlKinder.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvAnzahlKinder.OptionsNavigation.AutoFocusNewRow = true;
            this.grvAnzahlKinder.OptionsSelection.EnableAppearanceFocusedRow = false;
            this.grvAnzahlKinder.OptionsView.ColumnAutoWidth = false;
            this.grvAnzahlKinder.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvAnzahlKinder.OptionsView.ShowGroupPanel = false;
            this.grvAnzahlKinder.CellValueChanging += new DevExpress.XtraGrid.Views.Base.CellValueChangedEventHandler(this.grvAnzahlKinder_CellValueChanging);
            // 
            // colName
            // 
            this.colName.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colName.AppearanceCell.Options.UseBackColor = true;
            this.colName.Caption = "Name";
            this.colName.FieldName = "Name";
            this.colName.Name = "colName";
            this.colName.OptionsColumn.AllowEdit = false;
            this.colName.OptionsColumn.AllowFocus = false;
            this.colName.Visible = true;
            this.colName.VisibleIndex = 0;
            this.colName.Width = 135;
            // 
            // colGeburt
            // 
            this.colGeburt.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colGeburt.AppearanceCell.Options.UseBackColor = true;
            this.colGeburt.Caption = "GebDatum";
            this.colGeburt.DisplayFormat.FormatString = "dd.MM.yyyy";
            this.colGeburt.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colGeburt.FieldName = "Geburtsdatum";
            this.colGeburt.Name = "colGeburt";
            this.colGeburt.OptionsColumn.AllowEdit = false;
            this.colGeburt.OptionsColumn.AllowFocus = false;
            this.colGeburt.Visible = true;
            this.colGeburt.VisibleIndex = 1;
            // 
            // colAlter
            // 
            this.colAlter.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colAlter.AppearanceCell.Options.UseBackColor = true;
            this.colAlter.AppearanceCell.Options.UseTextOptions = true;
            this.colAlter.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.colAlter.AppearanceHeader.Options.UseTextOptions = true;
            this.colAlter.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.colAlter.Caption = "Alter";
            this.colAlter.FieldName = "Alter";
            this.colAlter.Name = "colAlter";
            this.colAlter.OptionsColumn.AllowEdit = false;
            this.colAlter.OptionsColumn.AllowFocus = false;
            this.colAlter.Visible = true;
            this.colAlter.VisibleIndex = 2;
            this.colAlter.Width = 37;
            // 
            // colBerechnung
            // 
            this.colBerechnung.AppearanceHeader.Font = new System.Drawing.Font("Tahoma", 6.75F, System.Drawing.FontStyle.Bold);
            this.colBerechnung.AppearanceHeader.Options.UseFont = true;
            this.colBerechnung.Caption = "Teil d Berechnung";
            this.colBerechnung.ColumnEdit = this.colchkKind;
            this.colBerechnung.FieldName = "Berechnung";
            this.colBerechnung.Name = "colBerechnung";
            this.colBerechnung.Visible = true;
            this.colBerechnung.VisibleIndex = 3;
            this.colBerechnung.Width = 101;
            // 
            // colchkKind
            // 
            this.colchkKind.AutoHeight = false;
            this.colchkKind.Name = "colchkKind";
            // 
            // colBerechtigt
            // 
            this.colBerechtigt.Caption = "Berechtigt";
            this.colBerechtigt.FieldName = "BerechtigtCode";
            this.colBerechtigt.Name = "colBerechtigt";
            this.colBerechtigt.Visible = true;
            this.colBerechtigt.VisibleIndex = 4;
            this.colBerechtigt.Width = 102;
            // 
            // colDatumBis
            // 
            this.colDatumBis.Caption = "max. bis";
            this.colDatumBis.DisplayFormat.FormatString = "dd.MM.yyyy";
            this.colDatumBis.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colDatumBis.FieldName = "DatumBis";
            this.colDatumBis.Name = "colDatumBis";
            this.colDatumBis.Visible = true;
            this.colDatumBis.VisibleIndex = 5;
            this.colDatumBis.Width = 78;
            // 
            // colRechtstitel
            // 
            this.colRechtstitel.Caption = "Rechtstitel";
            this.colRechtstitel.ColumnEdit = this.repedtRechtstitel;
            this.colRechtstitel.FieldName = "IkRechtstitelID";
            this.colRechtstitel.Name = "colRechtstitel";
            this.colRechtstitel.Width = 240;
            // 
            // repedtRechtstitel
            // 
            this.repedtRechtstitel.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.repedtRechtstitel.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.repedtRechtstitel.AppearanceDropDown.Options.UseBackColor = true;
            this.repedtRechtstitel.AppearanceDropDown.Options.UseFont = true;
            this.repedtRechtstitel.AutoHeight = false;
            this.repedtRechtstitel.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.repedtRechtstitel.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text"),
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("IkRechtstitelID", "", 20, DevExpress.Utils.FormatType.None, "", false, DevExpress.Utils.HorzAlignment.Default, DevExpress.Data.ColumnSortOrder.None)});
            this.repedtRechtstitel.DisplayMember = "Text";
            this.repedtRechtstitel.Name = "repedtRechtstitel";
            this.repedtRechtstitel.NullText = "";
            this.repedtRechtstitel.ShowFooter = false;
            this.repedtRechtstitel.ShowHeader = false;
            this.repedtRechtstitel.ValueMember = "IkRechtstitelID";
            // 
            // colAnspruch
            // 
            this.colAnspruch.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colAnspruch.AppearanceCell.Options.UseBackColor = true;
            this.colAnspruch.AppearanceHeader.Options.UseTextOptions = true;
            this.colAnspruch.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colAnspruch.Caption = "Anspruch";
            this.colAnspruch.DisplayFormat.FormatString = "N2";
            this.colAnspruch.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colAnspruch.FieldName = "Anspruch";
            this.colAnspruch.Name = "colAnspruch";
            this.colAnspruch.OptionsColumn.AllowEdit = false;
            this.colAnspruch.OptionsColumn.AllowFocus = false;
            this.colAnspruch.Visible = true;
            this.colAnspruch.VisibleIndex = 6;
            this.colAnspruch.Width = 64;
            // 
            // colRTName
            // 
            this.colRTName.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colRTName.AppearanceCell.Options.UseBackColor = true;
            this.colRTName.Caption = "Rechtstitel";
            this.colRTName.FieldName = "RTName";
            this.colRTName.Name = "colRTName";
            this.colRTName.OptionsColumn.AllowEdit = false;
            this.colRTName.OptionsColumn.AllowFocus = false;
            this.colRTName.Visible = true;
            this.colRTName.VisibleIndex = 7;
            this.colRTName.Width = 200;
            // 
            // edtBerechnungDatum
            // 
            this.edtBerechnungDatum.DataMember = "BerechnungDatumAb";
            this.edtBerechnungDatum.DataSource = this.qryAmAnspruchsberechnung;
            this.edtBerechnungDatum.EditValue = null;
            this.edtBerechnungDatum.Location = new System.Drawing.Point(416, 130);
            this.edtBerechnungDatum.Name = "edtBerechnungDatum";
            this.edtBerechnungDatum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtBerechnungDatum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBerechnungDatum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBerechnungDatum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBerechnungDatum.Properties.Appearance.Options.UseBackColor = true;
            this.edtBerechnungDatum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBerechnungDatum.Properties.Appearance.Options.UseFont = true;
            this.edtBerechnungDatum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            this.edtBerechnungDatum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtBerechnungDatum.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4)});
            this.edtBerechnungDatum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBerechnungDatum.Properties.Name = "edtDatum.Properties";
            this.edtBerechnungDatum.Properties.ShowToday = false;
            this.edtBerechnungDatum.Size = new System.Drawing.Size(100, 24);
            this.edtBerechnungDatum.TabIndex = 11;
            this.edtBerechnungDatum.EditValueChanged += new System.EventHandler(this.edtBerechnungDatum_EditValueChanged);
            // 
            // adtErstkontakt
            // 
            this.adtErstkontakt.DataMember = "ErstkontaktDatum";
            this.adtErstkontakt.DataSource = this.qryAmAnspruchsberechnung;
            this.adtErstkontakt.EditValue = null;
            this.adtErstkontakt.Location = new System.Drawing.Point(416, 100);
            this.adtErstkontakt.Name = "adtErstkontakt";
            this.adtErstkontakt.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.adtErstkontakt.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.adtErstkontakt.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.adtErstkontakt.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.adtErstkontakt.Properties.Appearance.Options.UseBackColor = true;
            this.adtErstkontakt.Properties.Appearance.Options.UseBorderColor = true;
            this.adtErstkontakt.Properties.Appearance.Options.UseFont = true;
            this.adtErstkontakt.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject5.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject5.Options.UseBackColor = true;
            this.adtErstkontakt.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("adtErstkontakt.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject5)});
            this.adtErstkontakt.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.adtErstkontakt.Properties.ShowToday = false;
            this.adtErstkontakt.Size = new System.Drawing.Size(100, 24);
            this.adtErstkontakt.TabIndex = 10;
            // 
            // edtKinderbetreuung
            // 
            this.edtKinderbetreuung.DataMember = "KinderbetreuungKKBBTgWoche";
            this.edtKinderbetreuung.DataSource = this.qryAmAnspruchsberechnung;
            this.edtKinderbetreuung.Location = new System.Drawing.Point(453, 40);
            this.edtKinderbetreuung.Name = "edtKinderbetreuung";
            this.edtKinderbetreuung.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtKinderbetreuung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtKinderbetreuung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtKinderbetreuung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtKinderbetreuung.Properties.Appearance.Options.UseBackColor = true;
            this.edtKinderbetreuung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtKinderbetreuung.Properties.Appearance.Options.UseFont = true;
            this.edtKinderbetreuung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtKinderbetreuung.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtKinderbetreuung.Properties.DisplayFormat.FormatString = "n1";
            this.edtKinderbetreuung.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtKinderbetreuung.Properties.EditFormat.FormatString = "n1";
            this.edtKinderbetreuung.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtKinderbetreuung.Size = new System.Drawing.Size(62, 24);
            this.edtKinderbetreuung.TabIndex = 9;
            this.edtKinderbetreuung.EditValueChanged += new System.EventHandler(this.edtKinderbetreuung_EditValueChanged);
            // 
            // edtArbeitspensum
            // 
            this.edtArbeitspensum.DataMember = "ArbeitspensumKKBBProz";
            this.edtArbeitspensum.DataSource = this.qryAmAnspruchsberechnung;
            this.edtArbeitspensum.Location = new System.Drawing.Point(452, 10);
            this.edtArbeitspensum.Name = "edtArbeitspensum";
            this.edtArbeitspensum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtArbeitspensum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtArbeitspensum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtArbeitspensum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtArbeitspensum.Properties.Appearance.Options.UseBackColor = true;
            this.edtArbeitspensum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtArbeitspensum.Properties.Appearance.Options.UseFont = true;
            this.edtArbeitspensum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtArbeitspensum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtArbeitspensum.Properties.DisplayFormat.FormatString = "n0";
            this.edtArbeitspensum.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtArbeitspensum.Properties.EditFormat.FormatString = "n0";
            this.edtArbeitspensum.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtArbeitspensum.Size = new System.Drawing.Size(63, 24);
            this.edtArbeitspensum.TabIndex = 8;
            this.edtArbeitspensum.EditValueChanged += new System.EventHandler(this.edtArbeitspensum_EditValueChanged);
            // 
            // lblBerechnungstyp
            // 
            this.lblBerechnungstyp.Location = new System.Drawing.Point(11, 40);
            this.lblBerechnungstyp.Name = "lblBerechnungstyp";
            this.lblBerechnungstyp.Size = new System.Drawing.Size(89, 24);
            this.lblBerechnungstyp.TabIndex = 7;
            this.lblBerechnungstyp.Text = "Berechnungstyp";
            this.lblBerechnungstyp.UseCompatibleTextRendering = true;
            // 
            // edtEinkommVar
            // 
            this.edtEinkommVar.DataMember = "AmEinkommensvarianteCode";
            this.edtEinkommVar.DataSource = this.qryAmAnspruchsberechnung;
            this.edtEinkommVar.Location = new System.Drawing.Point(109, 100);
            this.edtEinkommVar.LOVName = "AmEinkommensvariante";
            this.edtEinkommVar.Name = "edtEinkommVar";
            this.edtEinkommVar.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtEinkommVar.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtEinkommVar.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtEinkommVar.Properties.Appearance.Options.UseBackColor = true;
            this.edtEinkommVar.Properties.Appearance.Options.UseBorderColor = true;
            this.edtEinkommVar.Properties.Appearance.Options.UseFont = true;
            this.edtEinkommVar.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtEinkommVar.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtEinkommVar.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtEinkommVar.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtEinkommVar.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject6.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject6.Options.UseBackColor = true;
            this.edtEinkommVar.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject6)});
            this.edtEinkommVar.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtEinkommVar.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text", null, 75)});
            this.edtEinkommVar.Properties.DisplayMember = "Text";
            this.edtEinkommVar.Properties.DropDownRows = 1;
            this.edtEinkommVar.Properties.NullText = "";
            this.edtEinkommVar.Properties.ShowFooter = false;
            this.edtEinkommVar.Properties.ShowHeader = false;
            this.edtEinkommVar.Properties.ValueMember = "Code";
            this.edtEinkommVar.Size = new System.Drawing.Size(213, 24);
            this.edtEinkommVar.TabIndex = 6;
            // 
            // lblBerechnungDatum
            // 
            this.lblBerechnungDatum.Location = new System.Drawing.Point(329, 130);
            this.lblBerechnungDatum.Name = "lblBerechnungDatum";
            this.lblBerechnungDatum.Size = new System.Drawing.Size(80, 24);
            this.lblBerechnungDatum.TabIndex = 5;
            this.lblBerechnungDatum.Text = "Berechnung ab";
            this.lblBerechnungDatum.UseCompatibleTextRendering = true;
            // 
            // edtBezeichnung
            // 
            this.edtBezeichnung.DataMember = "Bezeichnung";
            this.edtBezeichnung.DataSource = this.qryAmAnspruchsberechnung;
            this.edtBezeichnung.Location = new System.Drawing.Point(108, 70);
            this.edtBezeichnung.Name = "edtBezeichnung";
            this.edtBezeichnung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBezeichnung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBezeichnung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBezeichnung.Properties.Appearance.Options.UseBackColor = true;
            this.edtBezeichnung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBezeichnung.Properties.Appearance.Options.UseFont = true;
            this.edtBezeichnung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBezeichnung.Properties.MaxLength = 100;
            this.edtBezeichnung.Size = new System.Drawing.Size(407, 24);
            this.edtBezeichnung.TabIndex = 5;
            // 
            // edtPrivMT
            // 
            this.edtPrivMT.DataMember = "MandUsername";
            this.edtPrivMT.DataSource = this.qryAmAnspruchsberechnung;
            this.edtPrivMT.Location = new System.Drawing.Point(739, 40);
            this.edtPrivMT.Name = "edtPrivMT";
            this.edtPrivMT.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtPrivMT.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtPrivMT.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtPrivMT.Properties.Appearance.Options.UseBackColor = true;
            this.edtPrivMT.Properties.Appearance.Options.UseBorderColor = true;
            this.edtPrivMT.Properties.Appearance.Options.UseFont = true;
            this.edtPrivMT.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject7.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject7.Options.UseBackColor = true;
            this.edtPrivMT.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject7)});
            this.edtPrivMT.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtPrivMT.Size = new System.Drawing.Size(14, 24);
            this.edtPrivMT.TabIndex = 4;
            this.edtPrivMT.Visible = false;
            this.edtPrivMT.ButtonClick += new DevExpress.XtraEditors.Controls.ButtonPressedEventHandler(this.edtPrivMT_ButtonClick);
            this.edtPrivMT.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtPrivMT_UserModifiedFld);
            // 
            // edtAmtMT
            // 
            this.edtAmtMT.DataMember = "MandInst";
            this.edtAmtMT.DataSource = this.qryAmAnspruchsberechnung;
            this.edtAmtMT.Location = new System.Drawing.Point(738, 11);
            this.edtAmtMT.Name = "edtAmtMT";
            this.edtAmtMT.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtAmtMT.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAmtMT.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAmtMT.Properties.Appearance.Options.UseBackColor = true;
            this.edtAmtMT.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAmtMT.Properties.Appearance.Options.UseFont = true;
            this.edtAmtMT.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject8.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject8.Options.UseBackColor = true;
            this.edtAmtMT.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject8)});
            this.edtAmtMT.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtAmtMT.Size = new System.Drawing.Size(14, 24);
            this.edtAmtMT.TabIndex = 3;
            this.edtAmtMT.Visible = false;
            this.edtAmtMT.ButtonClick += new DevExpress.XtraEditors.Controls.ButtonPressedEventHandler(this.edtAmtMT_ButtonClick);
            this.edtAmtMT.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtAmtMT_UserModifiedFld);
            // 
            // edtAmBerechnungTyp
            // 
            this.edtAmBerechnungTyp.DataMember = "AmBerechnungTypCode";
            this.edtAmBerechnungTyp.DataSource = this.qryAmAnspruchsberechnung;
            this.edtAmBerechnungTyp.Location = new System.Drawing.Point(108, 40);
            this.edtAmBerechnungTyp.LOVName = "AmBerechnungTyp";
            this.edtAmBerechnungTyp.Name = "edtAmBerechnungTyp";
            this.edtAmBerechnungTyp.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtAmBerechnungTyp.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtAmBerechnungTyp.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtAmBerechnungTyp.Properties.Appearance.Options.UseBackColor = true;
            this.edtAmBerechnungTyp.Properties.Appearance.Options.UseBorderColor = true;
            this.edtAmBerechnungTyp.Properties.Appearance.Options.UseFont = true;
            this.edtAmBerechnungTyp.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtAmBerechnungTyp.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtAmBerechnungTyp.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtAmBerechnungTyp.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtAmBerechnungTyp.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject9.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject9.Options.UseBackColor = true;
            this.edtAmBerechnungTyp.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject9)});
            this.edtAmBerechnungTyp.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtAmBerechnungTyp.Properties.Name = "edtAiBerechnungTyp.Properties";
            this.edtAmBerechnungTyp.Properties.NullText = "";
            this.edtAmBerechnungTyp.Properties.ShowFooter = false;
            this.edtAmBerechnungTyp.Properties.ShowHeader = false;
            this.edtAmBerechnungTyp.Size = new System.Drawing.Size(213, 24);
            this.edtAmBerechnungTyp.TabIndex = 2;
            this.edtAmBerechnungTyp.EditValueChanged += new System.EventHandler(this.edtAmBerechnungTyp_EditValueChanged);
            this.edtAmBerechnungTyp.CloseUp += new DevExpress.XtraEditors.Controls.CloseUpEventHandler(this.edtAmBerechnungTyp_CloseUp);
            // 
            // edtUser
            // 
            this.edtUser.DataMember = "Username";
            this.edtUser.DataSource = this.qryAmAnspruchsberechnung;
            this.edtUser.Location = new System.Drawing.Point(108, 10);
            this.edtUser.Name = "edtUser";
            this.edtUser.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtUser.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtUser.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtUser.Properties.Appearance.Options.UseBackColor = true;
            this.edtUser.Properties.Appearance.Options.UseBorderColor = true;
            this.edtUser.Properties.Appearance.Options.UseFont = true;
            this.edtUser.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject10.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject10.Options.UseBackColor = true;
            this.edtUser.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject10)});
            this.edtUser.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtUser.Size = new System.Drawing.Size(214, 24);
            this.edtUser.TabIndex = 1;
            this.edtUser.TabStop = false;
            this.edtUser.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtUser_UserModifiedFld);
            // 
            // tabControlSearch
            // 
            this.tabControlSearch.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.tabControlSearch.Controls.Add(this.tpgSuchen);
            this.tabControlSearch.Controls.Add(this.tpgListe);
            this.tabControlSearch.Location = new System.Drawing.Point(9, 10);
            this.tabControlSearch.Margin = new System.Windows.Forms.Padding(10);
            this.tabControlSearch.Name = "tabControlSearch";
            this.tabControlSearch.Padding = new System.Windows.Forms.Padding(4);
            this.tabControlSearch.ShowFixedWidthTooltip = true;
            this.tabControlSearch.Size = new System.Drawing.Size(762, 240);
            this.tabControlSearch.TabIndex = 0;
            this.tabControlSearch.TabPages.AddRange(new SharpLibrary.WinControls.TabPageEx[] {
            this.tpgListe,
            this.tpgSuchen});
            this.tabControlSearch.TabsLineColor = System.Drawing.Color.Black;
            this.tabControlSearch.TabsStyle = SharpLibrary.WinControls.TabsStyle.Flat;
            this.tabControlSearch.SelectedTabChanging += new System.ComponentModel.CancelEventHandler(this.tabControlSearch_SelectedTabChanging);
            this.tabControlSearch.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tabControlSearch_KeyUp);
            this.tabControlSearch.SelectedTabChanged += new SharpLibrary.WinControls.TabControlExTabChangeEventHandler(this.tabControlSearch_SelectedTabChanged);
            // 
            // tpgSuchen
            // 
            this.tpgSuchen.Controls.Add(this.chkSucheOhneMigrierte);
            this.tpgSuchen.Controls.Add(this.edtSucheDefinitivBis);
            this.tpgSuchen.Controls.Add(this.lblBis);
            this.tpgSuchen.Controls.Add(this.edtSucheDefinitivAb);
            this.tpgSuchen.Controls.Add(this.kissLabel4);
            this.tpgSuchen.Controls.Add(this.edtSucheBerechnungstyp);
            this.tpgSuchen.Controls.Add(this.lblBerechnungs);
            this.tpgSuchen.Controls.Add(this.searchTitle);
            this.tpgSuchen.Location = new System.Drawing.Point(6, 6);
            this.tpgSuchen.Name = "tpgSuchen";
            this.tpgSuchen.Size = new System.Drawing.Size(750, 202);
            this.tpgSuchen.TabIndex = 1;
            this.tpgSuchen.Title = "Suche";
            this.tpgSuchen.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tpgSuchen_KeyUp);
            // 
            // chkSucheOhneMigrierte
            // 
            this.chkSucheOhneMigrierte.EditValue = false;
            this.chkSucheOhneMigrierte.Location = new System.Drawing.Point(122, 99);
            this.chkSucheOhneMigrierte.Name = "chkSucheOhneMigrierte";
            this.chkSucheOhneMigrierte.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.chkSucheOhneMigrierte.Properties.Appearance.Options.UseBackColor = true;
            this.chkSucheOhneMigrierte.Properties.Caption = "migrierte Berechnungen nicht anzeigen";
            this.chkSucheOhneMigrierte.Size = new System.Drawing.Size(246, 19);
            this.chkSucheOhneMigrierte.TabIndex = 9;
            this.chkSucheOhneMigrierte.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tpgSuchen_KeyUp);
            // 
            // edtSucheDefinitivBis
            // 
            this.edtSucheDefinitivBis.EditValue = null;
            this.edtSucheDefinitivBis.Location = new System.Drawing.Point(268, 32);
            this.edtSucheDefinitivBis.Name = "edtSucheDefinitivBis";
            this.edtSucheDefinitivBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtSucheDefinitivBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheDefinitivBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheDefinitivBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheDefinitivBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheDefinitivBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheDefinitivBis.Properties.Appearance.Options.UseFont = true;
            this.edtSucheDefinitivBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject11.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject11.Options.UseBackColor = true;
            this.edtSucheDefinitivBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtSucheDefinitivBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject11)});
            this.edtSucheDefinitivBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSucheDefinitivBis.Properties.ShowToday = false;
            this.edtSucheDefinitivBis.Size = new System.Drawing.Size(100, 24);
            this.edtSucheDefinitivBis.TabIndex = 8;
            this.edtSucheDefinitivBis.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tpgSuchen_KeyUp);
            // 
            // lblBis
            // 
            this.lblBis.Location = new System.Drawing.Point(244, 32);
            this.lblBis.Name = "lblBis";
            this.lblBis.Size = new System.Drawing.Size(66, 24);
            this.lblBis.TabIndex = 7;
            this.lblBis.Text = "bis";
            this.lblBis.UseCompatibleTextRendering = true;
            // 
            // edtSucheDefinitivAb
            // 
            this.edtSucheDefinitivAb.EditValue = null;
            this.edtSucheDefinitivAb.Location = new System.Drawing.Point(122, 30);
            this.edtSucheDefinitivAb.Name = "edtSucheDefinitivAb";
            this.edtSucheDefinitivAb.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtSucheDefinitivAb.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheDefinitivAb.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheDefinitivAb.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheDefinitivAb.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheDefinitivAb.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheDefinitivAb.Properties.Appearance.Options.UseFont = true;
            this.edtSucheDefinitivAb.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject12.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject12.Options.UseBackColor = true;
            this.edtSucheDefinitivAb.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtSucheDefinitivAb.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject12)});
            this.edtSucheDefinitivAb.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSucheDefinitivAb.Properties.ShowToday = false;
            this.edtSucheDefinitivAb.Size = new System.Drawing.Size(100, 24);
            this.edtSucheDefinitivAb.TabIndex = 6;
            this.edtSucheDefinitivAb.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tpgSuchen_KeyUp);
            // 
            // kissLabel4
            // 
            this.kissLabel4.Location = new System.Drawing.Point(6, 32);
            this.kissLabel4.Name = "kissLabel4";
            this.kissLabel4.Size = new System.Drawing.Size(100, 23);
            this.kissLabel4.TabIndex = 5;
            this.kissLabel4.Text = "Definitiv ab";
            this.kissLabel4.UseCompatibleTextRendering = true;
            // 
            // edtSucheBerechnungstyp
            // 
            this.edtSucheBerechnungstyp.Location = new System.Drawing.Point(122, 60);
            this.edtSucheBerechnungstyp.LOVName = "AmBerechnungTyp";
            this.edtSucheBerechnungstyp.Name = "edtSucheBerechnungstyp";
            this.edtSucheBerechnungstyp.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheBerechnungstyp.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheBerechnungstyp.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheBerechnungstyp.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheBerechnungstyp.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheBerechnungstyp.Properties.Appearance.Options.UseFont = true;
            this.edtSucheBerechnungstyp.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtSucheBerechnungstyp.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheBerechnungstyp.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtSucheBerechnungstyp.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtSucheBerechnungstyp.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject13.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject13.Options.UseBackColor = true;
            this.edtSucheBerechnungstyp.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject13)});
            this.edtSucheBerechnungstyp.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSucheBerechnungstyp.Properties.NullText = "";
            this.edtSucheBerechnungstyp.Properties.ShowFooter = false;
            this.edtSucheBerechnungstyp.Properties.ShowHeader = false;
            this.edtSucheBerechnungstyp.Size = new System.Drawing.Size(246, 24);
            this.edtSucheBerechnungstyp.TabIndex = 4;
            this.edtSucheBerechnungstyp.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tpgSuchen_KeyUp);
            // 
            // lblBerechnungs
            // 
            this.lblBerechnungs.Location = new System.Drawing.Point(6, 61);
            this.lblBerechnungs.Name = "lblBerechnungs";
            this.lblBerechnungs.Size = new System.Drawing.Size(100, 23);
            this.lblBerechnungs.TabIndex = 3;
            this.lblBerechnungs.Text = "Berechnungstyp";
            this.lblBerechnungs.UseCompatibleTextRendering = true;
            // 
            // searchTitle
            // 
            this.searchTitle.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.searchTitle.Location = new System.Drawing.Point(6, -3);
            this.searchTitle.Name = "searchTitle";
            this.searchTitle.Size = new System.Drawing.Size(728, 24);
            this.searchTitle.TabIndex = 0;
            // 
            // tpgListe
            // 
            this.tpgListe.Controls.Add(this.grdAmAnspruchsberechnung);
            this.tpgListe.Location = new System.Drawing.Point(6, 6);
            this.tpgListe.Name = "tpgListe";
            this.tpgListe.Size = new System.Drawing.Size(750, 202);
            this.tpgListe.TabIndex = 0;
            this.tpgListe.Title = "Liste";
            this.tpgListe.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tpgListe_KeyUp);
            // 
            // grdAmAnspruchsberechnung
            // 
            this.grdAmAnspruchsberechnung.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdAmAnspruchsberechnung.DataSource = this.qryAmAnspruchsberechnung;
            this.grdAmAnspruchsberechnung.EmbeddedNavigator.Appearance.ForeColor = System.Drawing.Color.Black;
            this.grdAmAnspruchsberechnung.EmbeddedNavigator.Appearance.Options.UseForeColor = true;
            this.grdAmAnspruchsberechnung.EmbeddedNavigator.Name = "kissGrid1.EmbeddedNavigator";
            this.grdAmAnspruchsberechnung.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdAmAnspruchsberechnung.Location = new System.Drawing.Point(0, 0);
            this.grdAmAnspruchsberechnung.MainView = this.grvAmAnspruchsberechnung;
            this.grdAmAnspruchsberechnung.Name = "grdAmAnspruchsberechnung";
            this.grdAmAnspruchsberechnung.Size = new System.Drawing.Size(747, 200);
            this.grdAmAnspruchsberechnung.TabIndex = 0;
            this.grdAmAnspruchsberechnung.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvAmAnspruchsberechnung});
            this.grdAmAnspruchsberechnung.KeyUp += new System.Windows.Forms.KeyEventHandler(this.tpgListe_KeyUp);
            // 
            // grvAmAnspruchsberechnung
            // 
            this.grvAmAnspruchsberechnung.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvAmAnspruchsberechnung.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAmAnspruchsberechnung.Appearance.Empty.Options.UseBackColor = true;
            this.grvAmAnspruchsberechnung.Appearance.Empty.Options.UseFont = true;
            this.grvAmAnspruchsberechnung.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAmAnspruchsberechnung.Appearance.EvenRow.Options.UseFont = true;
            this.grvAmAnspruchsberechnung.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvAmAnspruchsberechnung.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAmAnspruchsberechnung.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvAmAnspruchsberechnung.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvAmAnspruchsberechnung.Appearance.FocusedCell.Options.UseFont = true;
            this.grvAmAnspruchsberechnung.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvAmAnspruchsberechnung.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvAmAnspruchsberechnung.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAmAnspruchsberechnung.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvAmAnspruchsberechnung.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvAmAnspruchsberechnung.Appearance.FocusedRow.Options.UseFont = true;
            this.grvAmAnspruchsberechnung.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvAmAnspruchsberechnung.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvAmAnspruchsberechnung.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvAmAnspruchsberechnung.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvAmAnspruchsberechnung.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvAmAnspruchsberechnung.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvAmAnspruchsberechnung.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvAmAnspruchsberechnung.Appearance.GroupRow.Options.UseFont = true;
            this.grvAmAnspruchsberechnung.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvAmAnspruchsberechnung.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvAmAnspruchsberechnung.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvAmAnspruchsberechnung.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvAmAnspruchsberechnung.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvAmAnspruchsberechnung.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvAmAnspruchsberechnung.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvAmAnspruchsberechnung.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvAmAnspruchsberechnung.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAmAnspruchsberechnung.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvAmAnspruchsberechnung.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvAmAnspruchsberechnung.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvAmAnspruchsberechnung.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvAmAnspruchsberechnung.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvAmAnspruchsberechnung.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvAmAnspruchsberechnung.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAmAnspruchsberechnung.Appearance.OddRow.Options.UseFont = true;
            this.grvAmAnspruchsberechnung.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvAmAnspruchsberechnung.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAmAnspruchsberechnung.Appearance.Row.Options.UseBackColor = true;
            this.grvAmAnspruchsberechnung.Appearance.Row.Options.UseFont = true;
            this.grvAmAnspruchsberechnung.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvAmAnspruchsberechnung.Appearance.SelectedRow.Options.UseFont = true;
            this.grvAmAnspruchsberechnung.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvAmAnspruchsberechnung.Appearance.VertLine.Options.UseBackColor = true;
            this.grvAmAnspruchsberechnung.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvAmAnspruchsberechnung.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colBezeichnung,
            this.colAnzahlKinder,
            this.colStatus,
            this.colEntscheidDatum,
            this.colAmBerechnung,
            this.colAmEinkommensvariante,
            this.colBerechnungAb});
            this.grvAmAnspruchsberechnung.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvAmAnspruchsberechnung.GridControl = this.grdAmAnspruchsberechnung;
            this.grvAmAnspruchsberechnung.GroupPanelText = "zu gruppierende Kolonnen in diesen Bereich ziehen";
            this.grvAmAnspruchsberechnung.Name = "grvAmAnspruchsberechnung";
            this.grvAmAnspruchsberechnung.OptionsBehavior.Editable = false;
            this.grvAmAnspruchsberechnung.OptionsCustomization.AllowFilter = false;
            this.grvAmAnspruchsberechnung.OptionsFilter.AllowFilterEditor = false;
            this.grvAmAnspruchsberechnung.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvAmAnspruchsberechnung.OptionsNavigation.AutoFocusNewRow = true;
            this.grvAmAnspruchsberechnung.OptionsNavigation.UseTabKey = false;
            this.grvAmAnspruchsberechnung.OptionsView.ColumnAutoWidth = false;
            this.grvAmAnspruchsberechnung.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvAmAnspruchsberechnung.OptionsView.ShowGroupPanel = false;
            this.grvAmAnspruchsberechnung.OptionsView.ShowIndicator = false;
            // 
            // colBezeichnung
            // 
            this.colBezeichnung.Caption = "Bezeichnung der Berechnung";
            this.colBezeichnung.FieldName = "Bezeichnung";
            this.colBezeichnung.Name = "colBezeichnung";
            this.colBezeichnung.Visible = true;
            this.colBezeichnung.VisibleIndex = 0;
            this.colBezeichnung.Width = 210;
            // 
            // colAnzahlKinder
            // 
            this.colAnzahlKinder.AppearanceCell.Options.UseTextOptions = true;
            this.colAnzahlKinder.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.colAnzahlKinder.AppearanceHeader.Options.UseTextOptions = true;
            this.colAnzahlKinder.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.colAnzahlKinder.Caption = "Kinder";
            this.colAnzahlKinder.FieldName = "AnzKinder";
            this.colAnzahlKinder.Name = "colAnzahlKinder";
            this.colAnzahlKinder.Visible = true;
            this.colAnzahlKinder.VisibleIndex = 1;
            this.colAnzahlKinder.Width = 50;
            // 
            // colStatus
            // 
            this.colStatus.Caption = "Status";
            this.colStatus.FieldName = "TypStatus";
            this.colStatus.Name = "colStatus";
            this.colStatus.Visible = true;
            this.colStatus.VisibleIndex = 2;
            this.colStatus.Width = 124;
            // 
            // colEntscheidDatum
            // 
            this.colEntscheidDatum.Caption = "Entscheid";
            this.colEntscheidDatum.DisplayFormat.FormatString = "dd.MM.yyyy";
            this.colEntscheidDatum.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colEntscheidDatum.FieldName = "EntscheidDatum";
            this.colEntscheidDatum.Name = "colEntscheidDatum";
            this.colEntscheidDatum.Visible = true;
            this.colEntscheidDatum.VisibleIndex = 3;
            // 
            // colAmBerechnung
            // 
            this.colAmBerechnung.Caption = "Berechnungstyp";
            this.colAmBerechnung.FieldName = "AmBerechnungTypCode";
            this.colAmBerechnung.Name = "colAmBerechnung";
            this.colAmBerechnung.Visible = true;
            this.colAmBerechnung.VisibleIndex = 4;
            this.colAmBerechnung.Width = 141;
            // 
            // colAmEinkommensvariante
            // 
            this.colAmEinkommensvariante.Caption = "Einkommen";
            this.colAmEinkommensvariante.FieldName = "AmEinkommensvarianteCode";
            this.colAmEinkommensvariante.Name = "colAmEinkommensvariante";
            this.colAmEinkommensvariante.Visible = true;
            this.colAmEinkommensvariante.VisibleIndex = 5;
            this.colAmEinkommensvariante.Width = 141;
            // 
            // colBerechnungAb
            // 
            this.colBerechnungAb.Caption = "Berechnung ab";
            this.colBerechnungAb.FieldName = "BerechnungDatumAb";
            this.colBerechnungAb.Name = "colBerechnungAb";
            this.colBerechnungAb.Visible = true;
            this.colBerechnungAb.VisibleIndex = 6;
            this.colBerechnungAb.Width = 100;
            // 
            // qryBerechtigtKind
            // 
            this.qryBerechtigtKind.HostControl = this;
            this.qryBerechtigtKind.SelectStatement = "select Code, Text \r\nfrom dbo.XLovCode WITH(READUNCOMMITTED)\r\nwhere LOVName = \'AmB" +
                "erechnungKind\'\r\n  and ((Value3 IS NULL) OR (Value3 = {0}))\r\norder by SortKey";
            // 
            // qryK511
            // 
            this.qryK511.HostControl = this;
            this.qryK511.SelectStatement = resources.GetString("qryK511.SelectStatement");
            // 
            // qryZVV
            // 
            this.qryZVV.HostControl = this;
            this.qryZVV.SelectStatement = resources.GetString("qryZVV.SelectStatement");
            // 
            // CtlAmAnspruchsberechnung
            // 
            this.Controls.Add(this.tabDetail);
            this.Name = "CtlAmAnspruchsberechnung";
            this.Size = new System.Drawing.Size(815, 673);
            this.Load += new System.EventHandler(this.CtlAmAnspruchsberechnung_Load);
            this.AddData += new System.EventHandler(this.CtlAmAnspruchsberechnung_AddData);
            this.SaveData += new System.EventHandler(this.CtlAmAnspruchsberechnung_SaveData);
            this.MoveNext += new System.EventHandler(this.CtlAmAnspruchsberechnung_MoveNext);
            this.MoveLast += new System.EventHandler(this.CtlAmAnspruchsberechnung_MoveLast);
            this.UndoDataChanges += new System.EventHandler(this.CtlAmAnspruchsberechnung_UndoDataChanges);
            this.DeleteData += new System.EventHandler(this.CtlAmAnspruchsberechnung_DeleteData);
            this.MoveFirst += new System.EventHandler(this.CtlAmAnspruchsberechnung_MoveFirst);
            this.RefreshData += new System.EventHandler(this.CtlAmAnspruchsberechnung_RefreshData);
            this.MovePrevious += new System.EventHandler(this.CtlAmAnspruchsberechnung_MovePrevious);
            this.tabDetail.ResumeLayout(false);
            this.tpgVerfuegung.ResumeLayout(false);
            this.tbgBerechnung.ResumeLayout(false);
            this.groupBox1.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.treBerechnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repedtBetrag)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryAbPosition)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repedtTreeCheckEdit)).EndInit();
            this.tbgGrunddaten.ResumeLayout(false);
            this.panelBottom.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.edtAltersBed.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAltersbedingung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRechtstitel.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRechtstitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryKind)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryRechtstitel)).EndInit();
            this.pnlMigDokumente.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.xDokumentVerfuegung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryAmAnspruchsberechnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.xDokumentBerechnung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMigVerfuegung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMigBerechnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtStatusOk.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtStatusKinder.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtStatusPensum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKinderbetreuung2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblArbeitspensum2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBezeichnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKinderbetreuung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel3)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblArbeitspensum)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblErstkontakt)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKinder)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblEinkommen)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdKinder)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvAnzahlKinder)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.colchkKind)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repedtRechtstitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBerechnungDatum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.adtErstkontakt.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKinderbetreuung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtArbeitspensum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBerechnungstyp)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEinkommVar.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtEinkommVar)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBerechnungDatum)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBezeichnung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtPrivMT.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAmtMT.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAmBerechnungTyp.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtAmBerechnungTyp)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtUser.Properties)).EndInit();
            this.tabControlSearch.ResumeLayout(false);
            this.tpgSuchen.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.chkSucheOhneMigrierte.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheDefinitivBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBis)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheDefinitivAb.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel4)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheBerechnungstyp.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheBerechnungstyp)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBerechnungs)).EndInit();
            this.tpgListe.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.grdAmAnspruchsberechnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvAmAnspruchsberechnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBerechtigtKind)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryK511)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryZVV)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Properties

        #region Public Properties

        public override KissUserControl DetailControl
        {
            get
            {
                if (tabDetail.SelectedTab == tpgVerfuegung)
                    return ctlAmVerfuegung;
                else
                    return base.DetailControl;
            }
        }

        #endregion

        #endregion

        #region EventHandlers

        #region Private EventHandlers

        private void CalculatePositions_ALBV()
        {
            // Berechnung aller Zellen
            // Variablen
            decimal tmpVal = (decimal)0.0;
            decimal tmpVal1 = (decimal)0.0;
            decimal sum = (decimal)0.0;
            decimal sum1 = (decimal)0.0;
            decimal sum2 = (decimal)0.0;
            decimal sum3 = (decimal)0.0;
            decimal sumAuslg1 = (decimal)0.0;
            decimal sumAuslg2 = (decimal)0.0;
            decimal sumTotalEinkft = (decimal)0.0;
            decimal valK511 = (decimal)0.0;
            decimal valK513 = (decimal)0.0;
            decimal valH271o = (decimal)0.0;
            decimal valH276 = (decimal)0.0;
            decimal MaxSummeAlleKinder_H288 = (decimal)0.0;
            decimal valMaxBetrag = (decimal)0.0;
            decimal minBetragAlleKinder_H305 = (decimal)0.0;
            int CodeZVV = 0;
            int TageZVV = 0;
            string strComment = "";

            int AnzahlKinderBerechnung = GetChildrenCount();
            int ZivilstandCode = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]);
            int EinkommVariante = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmEinkommensvarianteCode"]);

            // A11
            // Elterngrenze, wird aus der Konfiguration geholt:
            // ElterngrenzeAlleinstehend oder ElterngrenzeVerheiratet
            sum1 = GetValue("A", 11, 0, 3);

            if (ZivilstandCode != 4) // bei allen, ausser bei mündigen Jugendlichen
            {
                // A12
                // Die Anzahl Kinder setzen und Wert berechnen
                SetRowVal("A", 12, 0, 2, AnzahlKinderBerechnung);
                sum1 += CalculateRowValue("A", 12, 0);

                // A13
                // Anspruchsgrenze Elterneinkommen
                // Summe aus A11 und A12
                SetRowVal("A", 13, 0, 3, sum1);
            }

            sum1 = (Decimal)0.0;
            if (EinkommVariante == 1 || EinkommVariante == 2) // bei 1- und 2-Verdiener
            {
                // 1. Verdiener ----------------------------------------
                // Löhne
                // A31 .. A35
                sum1 =  CalculateRowValue("A", 31, 0);
                sum1 += CalculateRowValue("A", 32, 0);
                sum1 += CalculateRowValue("A", 33, 0);
                sum1 += CalculateRowValue("A", 34, 0);
                SetRowVal("A", 35, 0, 3, sum1);

                // abzgl. AHV usw
                // A40
                SetRowVal("A", 40, 0, 1, sum1);
                tmpVal = GetValue("A", 40, 0, 2); // Prozente holen
                tmpVal = Utils.RoundMoney((sum1 * tmpVal / 100), RoundingDecimals);
                SetRowVal("A", 40, 0, 3, tmpVal);
                sum1 -= tmpVal;
            }

            if (EinkommVariante == 1 || EinkommVariante == 2 || EinkommVariante == 7)
            {
                // Reingewinn
                // A42
                sum1 += CalculateRowValue("A", 42, 0);

                if (EinkommVariante == 1 || EinkommVariante == 2)
                {
                    // Jahresverdienst
                    // A43
                    if (sum1<0) sum1 = (decimal)0.0;
                    SetRowVal("A", 43, 0, 3, sum1);

                    // A44
                    SetRowVal("A", 44, 0, 3, sum1);
                }
                sumTotalEinkft = sum1;
            }

            sumAuslg1 = 0;
            if (EinkommVariante == 1 || EinkommVariante == 2)
            {
                // Berufsauslagen
                // A61..A62
                sumAuslg1 += CalculateRowValue("A", 61, 0);
                sumAuslg1 += CalculateRowValue("A", 62, 0);

                // Betrag anhand ZVV Code ermittlen:
                // A63
                CodeZVV = (int)GetValue("A", 63, 0, 2);
                TageZVV = (int)GetValue("A", 63, 0, 1);
                tmpVal = GetZVVBetrag(CodeZVV, TageZVV);
                sumAuslg1 += tmpVal;
                SetRowVal("A", 63, 0, 3, tmpVal);

                // A64
                sumAuslg1 += CalculateRowValue("A", 64, 0);

                // A65
                sumAuslg1 += CalculateRowValue("A", 65, 0);

                // A66
                sumAuslg1 += CalculateRowValue("A", 66, 0);

                // A67
                sumAuslg1 += CalculateRowValue("A", 67, 0);

                // A69
                SetRowVal("A", 69, 0, 3, sumAuslg1);
            }

            if (EinkommVariante == 1 || EinkommVariante == 2 || EinkommVariante == 6) // ohne 3, 4, 7, 5
            {
                // Berechnug Verdienst 1
                // A81
                SetRowVal("A", 81, 0, 3, sum1);

                // A82
                SetRowVal("A", 82, 0, 3, sumAuslg1);

                // A83
                strComment = "";
                tmpVal = sum1-sumAuslg1;
                if (tmpVal<0)
                {
                    tmpVal = (decimal)0.0;
                    strComment = "Verdienst kleiner als Auslagen";
                }
                SetRowVal("A", 83, 0, 3, tmpVal);
                SetBemerkung("A", 83, 0, strComment);

                // A84
                SetRowVal("A", 84, 0, 3, tmpVal);
            }

            sum2 = 0;
            sumAuslg2 = 0;
            if (EinkommVariante == 2)
            {

                // 2. Verdiener ----------------------------------------
                // Löhne
                // E131..E134
                sum2 =  CalculateRowValue("E", 131, 0);
                sum2 += CalculateRowValue("E", 132, 0);
                sum2 += CalculateRowValue("E", 133, 0);
                sum2 += CalculateRowValue("E", 134, 0);

                // E135
                SetRowVal("E", 135, 0, 3, sum2);

                // abzgl. AHV usw
                // E140
                SetRowVal("E", 140, 0, 1, sum2);
                tmpVal = GetValue("E", 140, 0, 2); // Prozente holen
                tmpVal = Utils.RoundMoney((sum2 * tmpVal / 100), RoundingDecimals);
                SetRowVal("E", 140, 0, 3, tmpVal);
                sum2 -= tmpVal;

                // Reingewinn
                // E142
                sum2 += CalculateRowValue("E", 142, 0);

                // Jahresverdienst
                // E143
                SetRowVal("E", 143, 0, 3, sum2);

                // 25.03.2008 : Ist neu 144 -> 185
                // Abzug Doppelverdiener
                // E144
                //tmpVal = GetValue("E", 144, 0, 3);
                //sum2 -= tmpVal;

                // E145
                strComment = "";
                if (sum2<0)
                {
                    sum2 = (decimal)0.0;
                    strComment = "Verdienst kleiner als Auslagen";
                }
                SetRowVal("E", 145, 0, 3, sum2);
                SetBemerkung("E", 145, 0, strComment);

                // Berufsauslagen
                // E161...E162
                sumAuslg2 = 0;
                sumAuslg2 += CalculateRowValue("E", 161, 0);
                sumAuslg2 += CalculateRowValue("E", 162, 0);

                // Betrag anhand ZVV Code ermittlen:
                // E163
                CodeZVV = (int)GetValue("E", 163, 0, 2);
                TageZVV = (int)GetValue("E", 163, 0, 1);
                tmpVal = GetZVVBetrag(CodeZVV, TageZVV);
                sumAuslg2 += tmpVal;
                SetRowVal("E", 163, 0, 3, tmpVal);

                // E164
                sumAuslg2 += CalculateRowValue("E", 164, 0);

                // E165
                sumAuslg2 += CalculateRowValue("E", 165, 0);

                // E166
                sumAuslg2 += CalculateRowValue("E", 166, 0);

                // E167
                sumAuslg2 += CalculateRowValue("E", 167, 0);

                // E169
                SetRowVal("E", 169, 0, 3, sumAuslg2);

                // Berechnug Verdienst 2
                // E181
                SetRowVal("E", 181, 0, 3, sum2);

                // E182
                SetRowVal("E", 182, 0, 3, sumAuslg2);

                // 25.03.2008 : Ist neu 144 -> 185
                // Abzug Doppelverdiener
                // E185
                tmpVal = GetValue("E", 185, 0, 3);
                sum2 -= tmpVal;

                // 25.03.2008 : Ist neu 183 -> 188
                // E188
                strComment = "";
                tmpVal = sum2-sumAuslg2;
                if (tmpVal<0)
                {
                    tmpVal = (decimal)0.0;
                    strComment = "Verdienst kleiner als Auslagen/Abzüge";
                }
                SetRowVal("E", 188, 0, 3, tmpVal);
                SetBemerkung("E", 188, 0, strComment);

                // 25.03.2008 : Ist neu 184 -> 189
                // E189
                SetRowVal("E", 189, 0, 3, tmpVal);
                qryAbPosition.Post();
            }

            // Berechnung Familien Einküfte ------------------------------------------------------
            sum = (decimal)0.0;
            if (EinkommVariante == 1 || EinkommVariante == 2 || EinkommVariante == 4)
            {
                sumTotalEinkft = (decimal)0.0;

                // H201
                strComment = "";
                tmpVal = sum1 - sumAuslg1 + sum2 - sumAuslg2;
                if (tmpVal<0)
                {
                    tmpVal = (decimal)0.0;
                    strComment = "Verdienst kleiner als Auslagen";
                }
                SetRowVal("H", 201, 0, 3, tmpVal);
                SetBemerkung("H", 201, 0, strComment);

                // H202...H205
                if (ZivilstandCode != 4)  // Jugendliche
                  sum +=  CalculateRowValue("H", 202, 0);
                sum += CalculateRowValue("H", 203, 0);
                sum += CalculateRowValue("H", 204, 0);
                sum += CalculateRowValue("H", 205, 0);

                // H206
                tmpVal = tmpVal + sum;
                if (tmpVal<0) tmpVal = (decimal)0.0;
                SetRowVal("H", 206, 0, 3, tmpVal);
                sumTotalEinkft = tmpVal;

                // Familienabzüge
                // H221
                sum = (decimal)0.0;
                if (ZivilstandCode != 4 ) // Jugendliche
                {
                  SetRowVal("H", 221, 0, 2, AnzahlKinderBerechnung);
                  sum = CalculateRowValue("H", 221, 0);
                }

                // H222
                if (ZivilstandCode == 2 || ZivilstandCode == 4 || ZivilstandCode == 5)  // Alleinstehende / Jugendliche / Kind mit Vormundschaft
                  SetRowVal("H", 222, 0, 2, 1);  // Alleinstehende
                else
                  SetRowVal("H", 222, 0, 2, 2); // Verheiratet
                sum += CalculateRowValue("H", 222, 0);

                // H223...H242
                sum += CalculateRowValue("H", 223, 0);
                // H224 (3. Säule) soll nicht sichtbar sein bei "kein Verdienst" und "kein Einkommen"
                if (EinkommVariante != 4 && ZivilstandCode != 4)
                  sum += CalculateRowValue("H", 224, 0);
                sum += CalculateRowValue("H", 231, 0);
                sum += CalculateRowValue("H", 232, 0);
                sum += CalculateRowValue("H", 241, 0);
                sum += CalculateRowValue("H", 242, 0);

                // H249
                SetRowVal("H", 249, 0, 3, sum);

                // H255
                SetRowVal("H", 255, 0, 3, sumTotalEinkft);

                // H256
                SetRowVal("H", 256, 0, 3, sum);
            }

            if (EinkommVariante == 1 || EinkommVariante == 2 || EinkommVariante == 3 || EinkommVariante == 4)
            {
                // H259
                strComment = "";
                tmpVal = sumTotalEinkft - sum;
                if (tmpVal<0)
                {
                    tmpVal = (decimal)0.0;
                    strComment = "Einkünfte kleiner als Abzüge";
                }
                sumTotalEinkft = tmpVal;
                SetRowVal("H", 259, 0, 3, tmpVal);
                SetBemerkung("H", 259, 0, strComment);
            }

            // H271
            // Berechnung Vermögensobergrenze
            // Reinvermögen wird auf 1000.-- abgerundet.
            // sozhew : aber nur wenn Vermögen unter Vermögensobergrenze liegt
            sum = CalculateRowValue("H", 271, 0);
            valH271o = sum;
            tmpVal = Utils.RoundMoney(sum, 1000);
            if (tmpVal > sum) tmpVal = tmpVal - 1000;
            if (tmpVal < 0) tmpVal = (Decimal)0.0;
            sum = tmpVal;
            SetRowVal("H", 271, 0, 3, sum);

            // H272
            // Differenz Monatsanspruchsgrenze
            strComment = "";
            SetRowVal("H", 272, 0, 1, sum);
            sum -= GetValue("H", 272, 0, 2);
            if (sum<0)
            {
                sum = (decimal)0.0;
                strComment = "Reinvermögen kleiner als Grenze";
            }
            SetRowVal("H", 272, 0, 3, sum);
            SetBemerkung("H", 272, 0, strComment);

            // H275
            // anrechenbares Vermögen
            SetRowVal("H", 275, 0, 1, sum);
            sum = Utils.RoundMoney(sum/15, 0);
            SetRowVal("H", 275, 0, 3, sum);

            // H276
            // Vermögensobergrenze
            valH276 = GetValue("H", 276, 0, 3);

            // H281
            // Monatsanspruchsgrenze
            if (ZivilstandCode == 4)
                sum2 = GetValue("A", 11, 0, 3);
            else
                sum2 = GetValue("A", 13, 0, 3);
            SetRowVal("H", 281, 0, 3, sum2);

            // H282
            SetRowVal("H", 282, 0, 3, sumTotalEinkft);
            sum2 -= sumTotalEinkft;

            // H283
            SetRowVal("H", 283, 0, 3, sum);
            sum2 -= sum;

            // H284
            strComment = "";
            if (sum2<0)
            {
                sum2 = (decimal)0.0;
                strComment = "Kein anrechenbares Vermögen";
            }
            if (valH271o >= valH276)
            {
                sum2 = (decimal)0.0;
                strComment = "Reinvermögensgrenze überschritten";
            }
            SetRowVal("H", 284, 0, 3, sum2);
            SetBemerkung("H", 284, 0, strComment);

            // H288
            MaxSummeAlleKinder_H288 = Utils.RoundMoney((sum2 / 12), 0);
            SetRowVal("H", 288, 0, 3, MaxSummeAlleKinder_H288);

            // Gültiger Monatsanspruch
            // H301
            SetRowVal("H", 301, 0, 3, MaxSummeAlleKinder_H288);

            // H303
            // 28.11.2007 : wird nicht mehr verwendet
            //sum2 = GetValue("H", 303, 0, 1);
            //sum2 = Utils.RoundMoney((sum2 / 12), RoundingDecimals);
            //SetRowVal("H", 303, 0, 3, sum2);

            // H305
            minBetragAlleKinder_H305 = GetValue("H", 305, 0, 3);
            strComment = "";
            if (MaxSummeAlleKinder_H288 < minBetragAlleKinder_H305)  // Obergrenze 65.-- ist überschritten
                strComment = "Auszahlungsgrenze unterschritten";
            SetBemerkung("H", 301, 0, strComment);

            // Berechnung für jedes Kind, -------------------------------------------------
            // welches in der Berechnung enthalten ist

            decimal SumKind = (decimal)0.0;
            int KindKey = 0;

            foreach (System.Data.DataRow row in qryKind.DataTable.Rows)
            if (Utils.ConvertToInt(row["BerechtigtCode"]) == 1 || Utils.ConvertToInt(row["BerechtigtCode"]) == 2)
            {
                // Verpflichtung Schuldner
                KindKey = Utils.ConvertToInt(row["AmAbKindID"]);

                // K511
                // Neu soll die Zahl aus den Monatszahlen "TotalAlimente" genommen werden
                strComment = "";
                if (Utils.ConvertToInt(row["BerechtigtCode"])==1)
                {
                    // Bei ALBV kommt die Zahl aus den Monatszahlen, ausser wenn manuell eingestellt ist
                    bool Manuell = (GetValue("K", 511, KindKey, 2) == (decimal)0.0);
                    if (Manuell)
                    {
                        // manuell ist eingestellt:
                        valK511 = GetValue("K", 511, KindKey, 1);
                        strComment = "Manuelle Erfassung";
                    }
                    else
                    {
                        // #32 : K511 muss neu aus Forderungen gerechnet werden.
                        // aus den Monatszahlen:
                        /*
                        qryK511.Fill(
                            qryAmAnspruchsberechnung["BerechnungDatumAb"],
                            row["IkRechtstitelID"],
                            row["BaPersonID"],
                            FaLeistungID
                        );
                         * 
select Top 1 F.TotalAlimentSoll
-- hier kein WITH(READUNCOMMITTED)
from dbo.IkPosition F
where F.FaLeistungID = {3}
and F.Datum <= {0}
and F.IkRechtstitelID = (
  select P.IkRechtstitelID from dbo.IkRechtstitelPosition P
  where P.IkPositionID = F.IkPositionID 
)
and F.Einmalig = 0
and F.BaPersonID = {2}
order by F.Datum desc                         * */


                        /*
                        select Top 1 Betrag = dbo.fnIkAlimenteRunden(
  IsNull(R.IkIndexRundenCode, 1), 
  case 
    when (ISNULL(F.IkAnpassungsRegelCode, 7) = 7 OR R.IkIndexTypCode = 9) then F.Betrag
    else F.Betrag*ISNULL(F.IndexStandBeiBerechnung,100) / ISNULL(R.IndexStandPunkte,100)
  end)
-- hier kein WITH(READUNCOMMITTED)
from dbo.IkForderung F
left join dbo.IkRechtstitel R on R.IkRechtstitelID = F.IkRechtstitelID
where F.IkRechtstitelID = {0}
and F.IkForderungPeriodischCode = 1  -- lov IkForderungPeriodisch
and F.BaPersonID = {1}
and F.DatumAnpassenAb <= {2}
order by F.DatumAnpassenAb desc
                         * */

                        qryK511.Fill(
                            row["IkRechtstitelID"],
                            row["BaPersonID"],
                            qryAmAnspruchsberechnung["BerechnungDatumAb"]
                        );

                        if (DBUtil.IsEmpty(qryK511["TotalAlimentSoll"]))
                        {
                            strComment = "Verpflichtung nicht gefunden";
                            valK511 = (decimal)0.0;
                            SetRowVal("K", 511, KindKey, 1, valK511);
                        }
                        else
                        {
                            strComment = "Verpflichtung gefunden";
                            valK511 = Utils.ConvertToDecimal(qryK511["TotalAlimentSoll"]);
                            SetRowVal("K", 511, KindKey, 1, valK511);
                        }
                    }
                    SetRowVal("K", 511, KindKey, 3, valK511);
                    SetBemerkung("K", 511, KindKey, strComment);
                }
                else
                {
                    // Bei Uebh kommt die Zahl aus Config
                    // 31.03.2008 : Neu soll bei UeBH K511 manuell eingegeben werden
                    SetBemerkung("K", 511, KindKey, strComment);
                    valK511 = CalculateRowValue("K", 511, KindKey);
                }

                // Max. Bevorschuss.
                // K512
                valMaxBetrag = GetValue("K", 512, KindKey, 3);

                // K513
                // berücks. Verpflichtg.
                strComment = "";
                if (valK511 > valMaxBetrag)
                {
                    sum = valMaxBetrag;
                    strComment = "Maximalbetrag überschritten";
                }
                else sum = valK511;
                SetRowVal("K", 513, KindKey, 3, sum);
                SetBemerkung("K", 513, KindKey, strComment);
                valK513 = sum;

                // if (ZivilstandCode == 1 || ZivilstandCode == 2 || ZivilstandCode == 3)
                if (ZivilstandCode != 4)
                {
                    // bei allen ausser mündigen Jugendlichen
                    // Lohn:
                    // K514..K518
                    sum1 =  CalculateRowValue("K", 514, KindKey);
                    sum1 += CalculateRowValue("K", 515, KindKey);
                    sum1 += CalculateRowValue("K", 516, KindKey);
                    sum1 -= CalculateRowValue("K", 517, KindKey);
                    sum1 -= CalculateRowValue("K", 518, KindKey);
                    sum1 -= CalculateRowValue("K", 519, KindKey);

                    // Anrechenbares Einkommen:
                    // K521
                    strComment = "";
                    if (sum1<0)
                    {
                        sum1 = (Decimal)0.0;
                        strComment = "Verdienst kleiner als Auslagen";
                    }
                    SetRowVal("K", 521, KindKey, 3, sum1);
                    SetBemerkung("K", 521, KindKey, strComment);
                    sum3 = sum1;

                    // Kinder-Einkommens Grenze: Differenz K521 - K525.1
                    // K525
                    strComment = "";
                    tmpVal = GetValue("K", 525, KindKey, 1);
                    sum1 = tmpVal - sum1;
                    if (sum1<0)
                    {
                        sum1 = 0;
                        strComment = "Jahresgrenze überschritten";
                    }
                    // sozhew alt   SetRowVal("K", 525, KindKey, 3, sum1);
                    tmpVal1 = Utils.RoundMoney((tmpVal/12), RoundingDecimals);
                    SetRowVal("K", 525, KindKey, 3, tmpVal1);
                    SetBemerkung("K", 525, KindKey, strComment);

                    // abzüglich Kindereinkommen
                    // K526
                    tmpVal1 = Utils.RoundMoney((sum3/12), RoundingDecimals);
                    SetRowVal("K", 526, KindKey, 1, sum3);
                    SetRowVal("K", 526, KindKey, 3, tmpVal1);
                    SetBemerkung("K", 525, KindKey, strComment);

                    // Umgerechnet auf Moant: Theo. Anspruch:
                    // K527
                    strComment = "";
                    tmpVal = Utils.RoundMoney((sum1/12), RoundingDecimals);
                    SetRowVal("K", 527, KindKey, 1, sum1);
                    SetRowVal("K", 527, KindKey, 3, tmpVal);
                }

                // Anspruch:
                // K530
                strComment = "";
                if (ZivilstandCode == 4)
                {
                    // mündige Jugendliche
                    SetBemerkung("K", 530, KindKey, strComment);
                    SetRowVal("K", 530, KindKey, 3, valK513);
                }
                else
                {
                    if (tmpVal > valK513)
                    {
                        sum = valK513;
                        //strComment = "Maximum kleiner als berücksichtigte Verpflichtung";
                    }
                    else sum = tmpVal;
                    SetBemerkung("K", 530, KindKey, strComment);
                    SetRowVal("K", 530, KindKey, 3, sum);
                }

                // 29.10.2007 : sozheo : neu
                // K531 : Effektiver Anspruch
                sum = Utils.RoundMoney(sum, 0);
                if ( (!DBUtil.IsEmpty(row["DatumBis"])) && (DateTime)qryAmAnspruchsberechnung["BerechnungDatumAb"] > (DateTime)row["DatumBis"])
                {
                    sum = (Decimal)0.0;
                    strComment = "Datum-Bis kleiner als Start Berechnung";
                }
                else if (valH276<valH271o)
                {
                    sum = (Decimal)0.0;
                    strComment = "Reinvermögensgrenze überschritten";
                }
                else if (MaxSummeAlleKinder_H288 < minBetragAlleKinder_H305)  // Obergrenze 65.-- ist überschritten
                {
                    sum = (Decimal)0.0;
                    strComment = "Auszahlungsgrenze unterschritten";
                }
                SetRowVal("K", 531, KindKey, 3, sum);
                SetBemerkung("K", 531, KindKey, strComment);

                // Zusammenfassung
                // Y730
                SetRowVal("Y", 730, KindKey, 3, sum);
                SetBemerkung("Y", 730, KindKey, strComment);
                SumKind += sum;
            }

            tmpVal = 0;

            if (SumKind > MaxSummeAlleKinder_H288)
            {
                // Das Gesamttotal (Z740) übersteigt den maximal Betrag (H288 od. H301),
                // deshalb müssen die Beträge aller Kinder prozentual reduziert werden,
                // sodass die Maximal Summe nicht überschritten wird:
                strComment = "Betrag prozentual angeglichen";

                tmpVal = (Decimal)0.0;
                foreach (System.Data.DataRow row in qryKind.DataTable.Rows)
                if (Utils.ConvertToInt(row["BerechtigtCode"]) == 1 || Utils.ConvertToInt(row["BerechtigtCode"]) == 2)
                {
                    KindKey = Utils.ConvertToInt(row["AmAbKindID"]);
                    sum2 = GetValue("Y", 730, KindKey, 3);

                    if (SumKind > 0)
                        sum = Utils.RoundMoney( (MaxSummeAlleKinder_H288 * sum2) / SumKind, 0);
                    else
                        sum = (decimal)0.0;
                    tmpVal += sum;

                    // 29.10.2007 : sozheo : neu
                    // K531
                    SetRowVal("K", 531, KindKey, 3, sum);
                    SetBemerkung("K", 531, KindKey, strComment);
                    // Y730
                    SetRowVal("Y", 730, KindKey, 3, sum);
                    SetBemerkung("Y", 730, KindKey, strComment);
                }
                SumKind = tmpVal;

                // Z740
                SetRowVal("Z", 740, 0, 3, SumKind);
            }
            else if (SumKind < minBetragAlleKinder_H305 && SumKind > 0)
            {
                // Der Minimalbetrag (H305) wurde im Total nicht erreicht (Z740)
                // deshlab muss jetzt alles auf 0.00 gesetzt werden
                strComment = "Minimalbetrag nicht erreicht";
                foreach (System.Data.DataRow row in qryKind.DataTable.Rows)
                if (Utils.ConvertToInt(row["BerechtigtCode"]) == 1 || Utils.ConvertToInt(row["BerechtigtCode"]) == 2)
                {
                    KindKey = Utils.ConvertToInt(row["AmAbKindID"]);
                    SetRowVal("K", 531, KindKey, 3, 0);
                    SetRowVal("Y", 730, KindKey, 3, 0);
                    SetBemerkung("K", 531, KindKey, strComment);
                    SetBemerkung("Y", 730, KindKey, strComment);
                }
                SetRowVal("Z", 740, 0, 3, 0);
            }
            else
            {
                // Das Gesamttotal übersteigt den maximal Betrag nicht
                // Z740
                SetRowVal("Z", 740, 0, 3, SumKind);
            }
            PositionsAreModified = true;
        }

        private void CalculatePositions_KKBB()
        {
            // 20.11.2007 : sozheo : Korrekturen für Typ UeBH entfernen
            // 01.02.2008 : sozheo : H3255 korrigiert, Einkommensvarianten gemacht

            // Variablen
            decimal tmpVal = (decimal)0.0;
            decimal sum = (decimal)0.0;
            decimal sum1 = (decimal)0.0;
            decimal sum2 = (decimal)0.0;
            decimal sumAuslg1 = (decimal)0.0;
            decimal sumAuslg2 = (decimal)0.0;
            decimal tmpVerdienst1 = (decimal)0.0;
            decimal tmpVerdienst2 = (decimal)0.0;
            decimal sumTotalEinkft = (decimal)0.0;
            decimal MaxProFam = (decimal)0.0;
            decimal maxMiete = (decimal)0.0;
            int CodeZVV = 0;
            int TageZVV = 0;
            decimal FamObGrenze = (decimal)0.0;
            string strComment = "";
            int EinkommVariante = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmEinkommensvarianteCode"]);
            int Zivilstand = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]);
            decimal valH3215 = (decimal)0.0;
            decimal valH3249 = (decimal)0.0;
            decimal valH3271o = (decimal)0.0;
            decimal valH3281 = (decimal)0.0;
            decimal valH3282 = (decimal)0.0;
            decimal valH3284 = (decimal)0.0;
            bool HatKKBB_Vermoegensobergrenze = false;
            // Anzahl Kinder holen
            int AnzahlKinderNichtBerechtigt = GetChildrenCountTyp(9);

            // A3011
            // Bedarf Elterngrenze: fixer Betrag aus Konfiguration
            // verheiratet = 25'600.--
            sum1 = GetValue("A", 3011, 0, 3);

            // A3012
            // Bedarf für Kinder: Anzahl ist die Anzahl Kinder,
            // welche in der Berechnung sind, aber nicht KKBB-berechtig sind
            // Der fixe Betrag pro Kind kommt aus der Konfiguration
            // nicht bei: kein Einkommen, 1 Verdiener
            SetRowVal("A", 3012, 0, 2, AnzahlKinderNichtBerechtigt);
            sum1 += CalculateRowValue("A", 3012, 0);

            // A3013
            // Berechnung der Monatsmiete, der Monatsbetrag kann frei einegeben werden
            sum2 = CalculateRowValue("A", 3013, 0);

            // A3014, maxJahresmiete
            // Betrag maximale Jahresmiete: fixer Betrag aus Konfiguration
            // wenn maximale Jahresmiete (A3014 > A3013) überschritten, wird der Betrag auf : fixer Betrag aus Konfiguration
            strComment = "";
            maxMiete = GetValue("A", 3014, 0, 1);
            if (maxMiete < sum2)
            {
                sum2 = maxMiete;
                strComment = "Maximaler Mietbetrag überschritten";
            }
            sum1 += sum2;
            SetRowVal("A", 3014, 0, 3, sum2);
            SetBemerkung("A",3014, 0, strComment);

            // A3025
            // Totalbedarf: Summe aus den Felder A3011, A3012, A3014
            SetRowVal("A", 3025, 0, 3, sum1);
            SetRowVal("H", 3281, 0, 3, sum1);

            sum1 = (Decimal)0.0;
            if (EinkommVariante == 1 || EinkommVariante == 2 || EinkommVariante == 7)
            {
                // A3031 ... A3032
                if (EinkommVariante == 1 || EinkommVariante == 2)
                    sum1 = CalculateRowValue("A", 3031, 0);
                sum1 += CalculateRowValue("A", 3032, 0);

                if (Zivilstand == 2)
                {
                    // A3033: Abzug Erwerb alleinstehende, nur bei Alleinstehende
                    // fix 5000.--
                    sum1 -= GetValue("A", 3033, 0, 3);
                    strComment = "";
                    if (sum1 < 0)
                    {
                        sum1 = (decimal)0.0;
                        strComment = "Negativer Betrag auf 0.-- gesetzt";
                    }
                    SetBemerkung("A",3033, 0, strComment);
                }

                // A3044
                SetRowVal("A", 3044, 0, 3, sum1);
            }

            sumAuslg1 = 0;
            if (EinkommVariante == 1 || EinkommVariante == 2)
            {

                // A3061 ... A3062
                sumAuslg1  = CalculateRowValue("A", 3061, 0);
                //sumAuslg1 += CalculateRowValue("A", 3062, 0);
                // A3063
                CodeZVV = (int)GetValue("A", 3063, 0, 2);
                TageZVV = (int)GetValue("A", 3063, 0, 1);

                tmpVal = GetZVVBetrag(CodeZVV, TageZVV);
                sumAuslg1 += tmpVal;
                SetRowVal("A", 3063, 0, 3, tmpVal);

                // A3064...A3067
                sumAuslg1 += CalculateRowValue("A", 3064, 0);
                sumAuslg1 += CalculateRowValue("A", 3065, 0);
                sumAuslg1 += CalculateRowValue("A", 3066, 0);

                // A3075
                SetRowVal("A", 3075, 0, 3, sumAuslg1);
            }

            tmpVerdienst1 = (Decimal)0.00;
            if (EinkommVariante == 1 || EinkommVariante == 2 || EinkommVariante == 7)
            {
                // alle ausser kein Verdienst, kein Einkommen
                // Berechnung Verdienst 1
                // A3081
                SetRowVal("A", 3081, 0, 3, sum1);
                // A3082, nicht bei 7 = selbständig
                if (EinkommVariante == 1 || EinkommVariante == 2)
                    // bei 7 = selbständig gibt es dieses Feld nicht
                    SetRowVal("A", 3082, 0, 3, sumAuslg1);

                // A3084
                strComment = "";
                 tmpVal = sum1-sumAuslg1;
                if (tmpVal<0)
                {
                    tmpVal = (decimal)0.0;
                    strComment = "Negativer Betrag auf 0.-- gesetzt";
                }
                tmpVerdienst1 = tmpVal;
                SetRowVal("A", 3084, 0, 3, tmpVal);
                SetBemerkung("A",3084, 0, strComment);
            }

            sum2 = (decimal)0.0;
            sumAuslg2 = (decimal)0.0;
            tmpVerdienst2 = (decimal)0.0;

            if (EinkommVariante == 2)
            {
                // 2. Verdiener ----------------------------------------
                // E3131
                sum2  = CalculateRowValue("E", 3131, 0);
                // E3142
                sum2 += CalculateRowValue("E", 3142, 0);
                // E3145
                SetRowVal("E", 3145, 0, 3, sum2);

                // E3161 ... E3162
                sumAuslg2  = CalculateRowValue("E", 3161, 0);

                // E3163
                CodeZVV = (int)GetValue("E", 3163, 0, 2);
                TageZVV = (int)GetValue("E", 3163, 0, 1);
                tmpVal = GetZVVBetrag(CodeZVV, TageZVV);
                sumAuslg2 += tmpVal;
                SetRowVal("E", 3163, 0, 3, tmpVal);

                // E3164...E3167
                sumAuslg2 += CalculateRowValue("E", 3164, 0);
                sumAuslg2 += CalculateRowValue("E", 3165, 0);
                sumAuslg2 += CalculateRowValue("E", 3166, 0);

                // E3175
                SetRowVal("E", 3175, 0, 3, sumAuslg2);

                // Berechnug Verdienst 2
                // E3181
                SetRowVal("E", 3181, 0, 3, sum2);
                // E3182
                SetRowVal("E", 3182, 0, 3, sumAuslg2);
                // E3184
                strComment = "";
                tmpVal = sum2-sumAuslg2;
                if (tmpVal<0)
                {
                    tmpVal = (decimal)0.0;
                    strComment = "Negativer Betrag auf 0.-- gesetzt";
                }
                tmpVerdienst2 = tmpVal;
                SetRowVal("E", 3184, 0, 3, tmpVal);
                SetBemerkung("E",3184, 0, strComment);
            }

            valH3215 = (Decimal)0.0;
            valH3249 = (Decimal)0.0;
            if (EinkommVariante == 1 || EinkommVariante == 2 || EinkommVariante == 4 || EinkommVariante == 7)
            {
                // H3201 : Erstverdiener Totalverdienst
                sum1 = (Decimal)0.0;
                if (EinkommVariante != 4)
                    SetRowVal("H", 3201, 0, 3, tmpVerdienst1);

                // H3202 : Zweitverdiener Totalverdienst
                if (EinkommVariante == 1 || EinkommVariante == 2 || EinkommVariante == 7)
                {
                    SetRowVal("H", 3202, 0, 3, tmpVerdienst2);
                    sum1 = tmpVerdienst1 + tmpVerdienst2;
                }

                // H3203 ... H3208
                sum1 += CalculateRowValue("H", 3203, 0);
                sum1 += CalculateRowValue("H", 3204, 0);
                sum1 += CalculateRowValue("H", 3205, 0);
                sum1 += CalculateRowValue("H", 3206, 0);
                sum1 += CalculateRowValue("H", 3207, 0);
                sum1 += CalculateRowValue("H", 3208, 0);

                // H3215
                SetRowVal("H", 3215, 0, 3, sum1);
                valH3215 = sum1;

                sum2 = (Decimal)0.0;
                sum2 += CalculateRowValue("H", 3223, 0);
                sum2 += CalculateRowValue("H", 3231, 0);
                sum2 += CalculateRowValue("H", 3232, 0);

                // H3249
                SetRowVal("H", 3249, 0, 3, sum2);
                valH3249 = sum2;

                // H3255 (Total Einkünfte)
                // H_3255 ist leer sollte aber = H_3215 sein.
                SetRowVal("H", 3255, 0, 3, valH3215);
                // H3256 (Total Abzüge)
                SetRowVal("H", 3256, 0, 3, valH3249);
                // H3259
                strComment = "";
                tmpVal = valH3215 - valH3249;
                if (tmpVal < 0)
                {
                    tmpVal = (Decimal)0.0;
                    strComment = "Negativer Betrag auf 0.-- gesetzt";
                }
                sumTotalEinkft = tmpVal;
                SetRowVal("H", 3259, 0, 3, tmpVal);
                SetBemerkung("H",3259, 0, strComment);
            }

            if (EinkommVariante == 3) // kein Verdienst
            {
                // H3215
                SetRowVal("H", 3215, 0, 3, (decimal)0.0);
                valH3215 = (decimal)0.0;

                // H3249
                SetRowVal("H", 3249, 0, 3, (decimal)0.0);
                valH3249 = (decimal)0.0;
            }

            // H3271
            // Berechnung Vermögensobergrenze
            // Reinvermögen wird auf 1000.-- abgerundet.
            // sozhew aber nur wenn Vermögen unter Vermögensobergrenze liegt
            sum = GetValue("H", 3271, 0, 1); // eingegebener Betrag
            valH3271o = sum;
            FamObGrenze = sum;

            tmpVal = GetValue("H", 3271, 0, 2); // Grenze von Config
            strComment = "";
            HatKKBB_Vermoegensobergrenze = true;
            if (sum >= tmpVal)
            {
                strComment = "Vermögensobergrenze überschritten";
                HatKKBB_Vermoegensobergrenze = false;
            }

            tmpVal = Utils.RoundMoney(sum, 1000);
            if (tmpVal > sum) tmpVal -= 1000;
            sum = tmpVal;
            SetRowVal("H", 3271, 0, 3, sum);
            SetBemerkung("H", 3271, 0, strComment);

            // H3272
            // Differenz Monatsanspruchsgrenze
            FamObGrenze = (Decimal)0.0;

            // H3281
            // Bedarf
            valH3281 = GetValue("A", 3025, 0, 3);
            SetRowVal("H", 3281, 0, 3, valH3281);

            // H3282
            // abzüglich Anrechebares Einkommen
            valH3282 = (decimal)0.0;
            if (EinkommVariante == 1 || EinkommVariante == 2 || EinkommVariante == 4 || EinkommVariante == 7)
                valH3282 = GetValue("H", 3259, 0, 3);
            SetRowVal("H", 3282, 0, 3, valH3282);

            // H3284, Jahresanspruch
            strComment = "";
            valH3284 = valH3281 - valH3282;

            //  überschreiten der Vermögensobergrenze
            if (valH3284 < 0)
            {
                valH3284 = (decimal)0.0;
                //strComment = "Familienobergrenze überschritten";
                strComment = "Obergrenze überschritten";
            }
            SetRowVal("H", 3284, 0, 3, valH3284);
            SetBemerkung("H",3284, 0, strComment);

            // H3288, : 12 = Monatsanspruch
            sum1 = Utils.RoundMoney((valH3284 / 12), 0);
            SetRowVal("H", 3288, 0, 3, sum1);

            // H3289, max. CHF 2000.00
            strComment = "";
            MaxProFam = GetValue("H", 3289, 0, 1);
            if (MaxProFam < sum1)
            {
                sum1 = MaxProFam;
                strComment = "Maximaler Monatsanspruch überschritten";
            }
            SetRowVal("H", 3289, 0, 3, sum1);
            SetBemerkung("H", 3289, 0, strComment);

            // H3290, Total
            strComment = "";
            if (!Utils.ConvertToBool(qryAmAnspruchsberechnung["BedingungKKBBErfuellt"], false))
            {
                sum1 = (Decimal)0.0;
                strComment = "Bedingungen nicht erfüllt";
            }
            else if (!HatKKBB_Vermoegensobergrenze)
            {
                sum1 = (Decimal)0.0;
                strComment = "Vermögensobergrenze überschritten";
            }

            SetRowVal("H", 3290, 0, 3, sum1);
            SetBemerkung("H", 3290, 0, strComment);

            PositionsAreModified = true;
        }

        private void CtlAmAnspruchsberechnung_AddData(object sender, EventArgs e)
        {
            // Neue Berechnung einfügen
            if (tabDetail.SelectedTabIndex == 0)
            {
                //if (!HasChildrenUnder2Years()) return;
                qryAmAnspruchsberechnung.Insert();
            }
        }

        private void CtlAmAnspruchsberechnung_DeleteData(object sender, EventArgs e)
        {
            if (qryAmAnspruchsberechnung.Count > 0 && !CanEditActiveRow)
            {
                KissMsg.ShowInfo(
                    "Bewilligte, annullierte oder migrierte Anspruchsberechnungen können nicht gelöscht werden."
                );
            }
            if (!CanEditActiveRow) return;

            if (tabDetail.SelectedTabIndex == 0 && qryAmAnspruchsberechnung.CanDelete)
            {
                // Löschen geht nur auf der ersten Seite:
                qryAmAnspruchsberechnung.Delete();
            }
        }

        private void CtlAmAnspruchsberechnung_Load(object sender, System.EventArgs e)
        {
            // select first tab
            this.tabDetail.SelectedTabIndex = 0;
        }

        private void CtlAmAnspruchsberechnung_MoveFirst(object sender, EventArgs e)
        {
            if (tabDetail.SelectedTabIndex == 0 && qryAmAnspruchsberechnung.CanDelete)
            {
                CtlAmAnspruchsberechnung_SaveData(sender, e);
                qryAmAnspruchsberechnung.First();
            }
        }

        private void CtlAmAnspruchsberechnung_MoveLast(object sender, EventArgs e)
        {
            CtlAmAnspruchsberechnung_SaveData(sender, e);
            qryAmAnspruchsberechnung.Last();
        }

        private void CtlAmAnspruchsberechnung_MoveNext(object sender, EventArgs e)
        {
            CtlAmAnspruchsberechnung_SaveData(sender, e);
            qryAmAnspruchsberechnung.Next();
        }

        private void CtlAmAnspruchsberechnung_MovePrevious(object sender, EventArgs e)
        {
            CtlAmAnspruchsberechnung_SaveData(sender, e);
            qryAmAnspruchsberechnung.Previous();
        }

        private void CtlAmAnspruchsberechnung_RefreshData(object sender, EventArgs e)
        {
            CtlAmAnspruchsberechnung_SaveData(sender, e);
            qryAmAnspruchsberechnung.Refresh();
            qryAmAnspruchsberechnung_PositionChanged(null, null);
        }

        private void CtlAmAnspruchsberechnung_SaveData(object sender, EventArgs e)
        {
            if (!AllesSpeichern()) throw new KissCancelException();
        }

        private void CtlAmAnspruchsberechnung_UndoDataChanges(object sender, EventArgs e)
        {
            if (tabDetail.SelectedTabIndex == 0)
            {
                // Undo auf der ersten Seite:
                qryAmAnspruchsberechnung.Cancel();
                qryAmAnspruchsberechnung_PositionChanged(null, null);
            }
            else if (tabDetail.SelectedTabIndex == 1)
            {
                OpenPositions();
            }
        }

        private bool SaveChildrens_WithTransaction()
        {
            // Falls nichts korrigiert wurde:
            if (!qryKind.Post()) return false;
            if (!KinderSindKorrigiert) return true;

            // Kontrolle ALBV:
            // Es muss mindestens ein Kind gewählt sein:
            if (BerechnungTyp_ALBV1_KKBB3 == 1) if (!CheckChildrensALBV()) return false;

            // Kontrolle KKBB:
            if (BerechnungTyp_ALBV1_KKBB3 == 3) if (!CheckChildrensKKBB()) return false;

            // Bei den Kinder muss immer eine Transaktion gestartet werden.
            // Sie wird im qryAnspruchberechnung.AfterPost beendet.
            Session.BeginTransaction();
            try
            {
                SaveChildrensAndPositions();
                Session.Commit();
            }
            catch (Exception ex)
            {
                Session.Rollback();
                KissMsg.ShowInfo(ex.Message);
                return false;
            }
            KinderSindKorrigiert = false;
            return true;
        }

        private void btnCalculate_Click(object sender, System.EventArgs e)
        {
            // Alle Positionen neu berechnen: siehe Tree Methoden
            CalculatePositions();
        }

        private void btnChangeState_Click(object sender, System.EventArgs e)
        {
            // Damit vor dem Drucken alles gespeichert wird
            int MigriertCode = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungsStatusCode"]);
            SqlQuery qry = DBUtil.OpenSQL(@"
                update dbo.AmAnspruchsberechnung set AmBerechnungsStatusCode = {0}
                where AmAnspruchsberechnungID = {1}",
                MigriertCode == 3 ? 6 : 3,
                Utils.ConvertToInt(qryAmAnspruchsberechnung["AmAnspruchsberechnungID"])
            );
            qryAmAnspruchsberechnung.Refresh();
        }

        private void btnCollapse_Click(object sender, System.EventArgs e)
        {
            // Alle Knoten schliessen:
            treBerechnung.CollapseAll();
        }

        private void btnCopy_Click(object sender, System.EventArgs e)
        {
            // 04.11.2007 : sozheo : Anpassungen für ueBH und KKBB
            // 20.11.2007 : sozheo : Korrekturen für Typ UeBH entfernen

            // Zuerst speichern
            CtlAmAnspruchsberechnung_SaveData(sender, e);

            DlgNeueAnspruchsberechnung dlg = new DlgNeueAnspruchsberechnung();
            dlg.FaFallID = FaFallID;
            dlg.edtBezeichnung.Text = "Kopie von "+Utils.ConvertToString(qryAmAnspruchsberechnung["Bezeichnung"]);
            dlg.edtDatum.EditValue = DateTime.Today;

            decimal tmpVal1 = (decimal)0.0;
            decimal tmpVal2 = (decimal)0.0;
            int EinkVar = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmEinkommensvarianteCode"]);

            dlg.edtLohn1.Visible = (EinkVar == 1 || EinkVar == 2);
            dlg.lblLohn1.Visible = (EinkVar == 1 || EinkVar == 2);
            if (EinkVar == 1 || EinkVar == 2)
            {
                if (BerechnungTyp_ALBV1_KKBB3 == 1) tmpVal1 = GetValue("A",   31, 0, 1); else
                if (BerechnungTyp_ALBV1_KKBB3 == 3) tmpVal1 = GetValue("A", 3031, 0, 1);
                dlg.edtLohn1.EditValue = tmpVal1;
            }

            dlg.edtLohn2.Visible = (EinkVar == 2);
            dlg.lblLohn2.Visible = (EinkVar == 2);
            if (EinkVar == 2)
            {
                if (BerechnungTyp_ALBV1_KKBB3 == 1) tmpVal2 = GetValue("E",  131, 0, 1); else
                if (BerechnungTyp_ALBV1_KKBB3 == 3) tmpVal2 = GetValue("E", 3131, 0, 1);
                dlg.edtLohn2.EditValue = tmpVal2;
            }

            // Dialog anzeigen:
            if (dlg.ShowDialog() != DialogResult.OK) return;

            // Daten von Dialog übernehmen:
            string tmpBezeichnung = Utils.ConvertToString(dlg.edtBezeichnung.Text);
            DateTime tmpDatum = dlg.edtDatum.DateTime;
            tmpVal1 = (decimal)0.0;
            tmpVal2 = (decimal)0.0;
            if (EinkVar == 1 || EinkVar == 2) tmpVal1 = Utils.ConvertToDecimal(dlg.edtLohn1.EditValue);
            if (EinkVar == 2) tmpVal2 = Utils.ConvertToDecimal(dlg.edtLohn2.EditValue);

            int CopyOldID = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmAnspruchsberechnungID"]);
            int NewID = 0;
            bool SavingWasOK = true;

            Session.BeginTransaction();
            try
            {
                SqlQuery qry = DBUtil.OpenSQL(string.Format(
                    "EXEC dbo.spAmAnspruchsberechnung_Copy {0}, {1}, '{2}', '{3}', {4}, {5}",
                    BerechnungTyp_ALBV1_KKBB3,
                    CopyOldID,
                    tmpBezeichnung,
                    tmpDatum.ToString("yyyyMMdd"),
                    tmpVal1,
                    tmpVal2
                ));

                if (Utils.ConvertToInt(qry["HasError"]) == 0)
                {
                    NewID = Utils.ConvertToInt(qry["NewAnspruchsberechnungID"]);
                    Session.Commit();
                }
                else
                {
                    throw new KissInfoException(Utils.ConvertToString(qry["ErrorText"]));
                }
            }
            catch (Exception ex)
            {
                Session.Rollback();
                KissMsg.ShowInfo(ex.Message);
                SavingWasOK = false;
            }

            if (SavingWasOK)
            {
                // Daten neu anzeigen:
                qryAmAnspruchsberechnung.Refresh();
                if (!qryAmAnspruchsberechnung.Find("AmAnspruchsberechnungID="+NewID.ToString()))
                {
                    edtSucheDefinitivAb.EditValue = DBNull.Value;
                    edtSucheDefinitivBis.EditValue = DBNull.Value;
                    edtSucheBerechnungstyp.EditValue = DBNull.Value;
                    FillQryAnspruchsberechnung();
                    if (!qryAmAnspruchsberechnung.Find("AmAnspruchsberechnungID="+NewID.ToString()))
                    {
                        KissMsg.ShowInfo(
                            "Die neu erstellte Anspruchsberechnung konnte nicht gefunden werden.\r\n"+
                            "Stellen Sie ev. den Filter neu ein und führen Sie die Berechnung durch.");
                        return;
                    }
                }
                qryAmAnspruchsberechnung_PositionChanged(null, null);

                // Alle Positionen neu berechnen: siehe Tree Methoden
                CalculatePositions();
                // Alle Positionen speichern
                SavePositions(true);
            }
        }

        private void btnExpand_Click(object sender, System.EventArgs e)
        {
            // Alle Knoten öffnen :
            treBerechnung.ExpandAll();
        }

        private void btnUpdate_Click(object sender, System.EventArgs e)
        {
            qryAmAnspruchsberechnung.RowModified = true;
            PositionsAreModified = true;
            qryAmAnspruchsberechnung.Post();
        }

        private void edtAmBerechnungTyp_CloseUp(object sender, DevExpress.XtraEditors.Controls.CloseUpEventArgs e)
        {
            e.AcceptValue = true;
            if (!e.CloseMode.Equals(DevExpress.XtraEditors.PopupCloseMode.Normal)) return;

            int NewType = Utils.ConvertToInt(e.Value);
            if (
                NewType == 4 || NewType == 5 ||
                Old_BerechngTyp_Selection == 4 || Old_BerechngTyp_Selection == 5
            )
            {
                FillQryKind(NewType);
            }
            Old_BerechngTyp_Selection = NewType;

            KinderSindKorrigiert = true;
            if ( (NewType == 4 || NewType == 5) && !Utils.ConvertToBool(qryKind["Berechnung"], false) )
            {
                qryKind["Berechnung"] = true;
                qryKind["BerechtigtCode"] = 1;

                if (NewType == 5 && !DBUtil.IsEmpty(qryKind["Geburtsdatum"]))
                {
                    qryKind["DatumBis"] = ((DateTime)qryKind["Geburtsdatum"]).AddYears(18).AddDays(-1);
                }
            }
        }

        private void edtAmBerechnungTyp_EditValueChanged(object sender, System.EventArgs e)
        {
            // 25.09.2008 : sozheo : Zusätzlicher Status Altersbedingung

            if (!edtAmBerechnungTyp.UserModified) return;
            if (DBUtil.IsEmpty(edtAmBerechnungTyp.EditValue)) return;
            qryAmAnspruchsberechnung["AmBerechnungTypCode"] = Utils.ConvertToInt(edtAmBerechnungTyp.EditValue);

            // Status in Query speichern
            SetStatusToQuery();
        }

        private void edtAmtMT_ButtonClick(object sender, DevExpress.XtraEditors.Controls.ButtonPressedEventArgs e)
        {
            // Wenn ein Mandant erfasst wird, soll der andere gelöscht werden:
            if (!DBUtil.IsEmpty(edtAmtMT.LookupID))
            {
                qryAmAnspruchsberechnung["Mandant_InstitutionID"] = edtAmtMT.LookupID;
                edtPrivMT.LookupID = null;
            }
        }

        private void edtAmtMT_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            string SearchString = edtAmtMT.EditValue.ToString().Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (e.ButtonClicked)
                {
                    SearchString = "%";
                }
                else
                {
                    qryAmAnspruchsberechnung["Mandant_InstitutionID"] = DBNull.Value;
                    qryAmAnspruchsberechnung["MandInst"] = DBNull.Value;
                    return;
                }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
                SELECT ID$ = U.BaInstitutionID,
                  Institution = U.Name
                FROM dbo.BaInstitution U WITH(READUNCOMMITTED)
                WHERE U.Name LIKE '%' + {0} + '%'
                ORDER BY U.Name",
                SearchString,
                e.ButtonClicked,null,null,null
            );

            if (!e.Cancel)
            {
                qryAmAnspruchsberechnung["Mandant_InstitutionID"] = dlg[0];
                qryAmAnspruchsberechnung["MandInst"] = dlg[1];
            }
        }

        private void edtArbeitspensum_EditValueChanged(object sender, System.EventArgs e)
        {
            // 25.09.2008 : sozheo : Zusätzlicher Status Altersbedingung

            if (!edtArbeitspensum.UserModified) return;
            if (DBUtil.IsEmpty(edtArbeitspensum.EditValue)) return;
            qryAmAnspruchsberechnung["ArbeitspensumKKBBProz"] = Utils.ConvertToInt(edtArbeitspensum.EditValue);

            // Status in Query speichern
            SetStatusToQuery();
        }

        private void edtBerechnungDatum_EditValueChanged(object sender, System.EventArgs e)
        {
            if (!edtBerechnungDatum.UserModified) return;
            if (DBUtil.IsEmpty(edtBerechnungDatum.EditValue)) return;
            qryAmAnspruchsberechnung["BerechnungDatumAb"] = (DateTime)edtBerechnungDatum.EditValue;

            // Status in Query speichern
            SetStatusToQuery();
        }

        private void edtKinderbetreuung_EditValueChanged(object sender, System.EventArgs e)
        {
            // 25.09.2008 : sozheo : Zusätzlicher Status Altersbedingung

            if (!edtKinderbetreuung.UserModified) return;
            if (DBUtil.IsEmpty(edtKinderbetreuung.EditValue)) return;
            qryAmAnspruchsberechnung["KinderbetreuungKKBBTgWoche"] = Utils.ConvertToDecimal(edtKinderbetreuung.EditValue);

            // Status in Query speichern
            SetStatusToQuery();
        }

        private void edtPrivMT_ButtonClick(object sender, DevExpress.XtraEditors.Controls.ButtonPressedEventArgs e)
        {
            // Wenn ein Mandant erfasst wird, soll der andere gelöscht werden:
            if (!DBUtil.IsEmpty(edtPrivMT.LookupID))
            {
                qryAmAnspruchsberechnung["Mandant_UserID"] = edtPrivMT.LookupID;
                edtAmtMT.LookupID = null;
            }
        }

        private void edtPrivMT_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            string SearchString = edtPrivMT.EditValue.ToString().Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (e.ButtonClicked)
                {
                    SearchString = "%";
                }
                else
                {
                    qryAmAnspruchsberechnung["Mandant_UserID"] = DBNull.Value;
                    qryAmAnspruchsberechnung["MandUsername"] = DBNull.Value;
                    return;
                }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
                SELECT ID$ = U.UserID,
                  [Kürzel] = U.LogonName,
                  Name = U.LastName + IsNull(' ' + U.Firstname, '')
                FROM dbo.XUser U WITH(READUNCOMMITTED)
                WHERE U.LastName + IsNull(' ' + U.Firstname, '') LIKE '%' + {0} + '%'
                ORDER BY U.LastName",
                SearchString,
                e.ButtonClicked,null,null,null
            );

            if (!e.Cancel)
            {
                qryAmAnspruchsberechnung["Mandant_UserID"] = dlg[0];
                qryAmAnspruchsberechnung["MandUsername"] = dlg[2];
            }
        }

        private void edtRechtstitel_CloseUp(object sender, DevExpress.XtraEditors.Controls.CloseUpEventArgs e)
        {
            e.AcceptValue = true;
            if (!e.CloseMode.Equals(DevExpress.XtraEditors.PopupCloseMode.Normal))
            {
                return;
            }

            if (DBUtil.IsEmpty(e.Value))
            {
                qryKind["IkRechtstitelID"] = DBNull.Value;
                qryKind["RTName"] = DBNull.Value;
            }
            else
            {
                qryKind["IkRechtstitelID"] = Utils.ConvertToInt(e.Value);
                if (qryRechtstitel.Find("IkRechtstitelID=" + Utils.ConvertToInt(e.Value).ToString()))
                {
                    qryKind["RTName"] = Utils.ConvertToString(qryRechtstitel["Text"]);
                }
            }

            KinderSindKorrigiert = true;
        }

        private void edtUser_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            // 10.01.2008 : sozheo : Auswahl Mitarbeiter nach ZH-Standard

            string SearchString = edtUser.EditValue.ToString().Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (e.ButtonClicked)
                    SearchString = "%";
                else
                {
                    qryAmAnspruchsberechnung["UserID"] = DBNull.Value;
                    qryAmAnspruchsberechnung["Username"] = DBNull.Value;
                    qryAmAnspruchsberechnung.RefreshDisplay();
                    return;
                }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
                SELECT
                  ID$ = U.UserID,
                  DisplayText$ = U.DisplayText,
                  [Kürzel] = U.LogonName,
                  [Mitarbeiter/in] = U.NameVorname,
                  [Org. Einheit] = U.OrgUnit
                FROM dbo.vwUser U WITH(READUNCOMMITTED)
                WHERE U.DisplayText LIKE '%' + {0} + '%'
                ORDER BY U.DisplayText",
                SearchString,
                e.ButtonClicked, null, null, null
            );

            if (!e.Cancel)
            {
                qryAmAnspruchsberechnung["UserID"] = dlg[0];
                qryAmAnspruchsberechnung["Username"] = dlg[1];
            }
        }

        private void grvAnzahlKinder_CellValueChanging(object sender, DevExpress.XtraGrid.Views.Base.CellValueChangedEventArgs e)
        {
            // 23.09.2007 : sozheo : Neues Refresh beim Wechslen der Tabs unten
            // 24.09.2007 : sozheo : Angaben Berechnung ohne z.B. "Berechnungstyp"
            // 17.10.2007 : sozheo : SqlQuery.PostError korrigiert
            // 18.10.2007 : sozheo : panelBottom_Leave entfernt
            // 04.11.2007 : sozheo : Anpassungen für ueBH und KKBB
            // 20.11.2007 : sozheo : Korrekturen für Typ UeBH entfernen
            // 22.11.2007 : sozheo : Korrekturen für Typ UeBH entfernen
            // 28.11.2007 : sozheo : Schalter annullieren neu
            // 10.01.2008 : sozheo : Auswahl Mitarbeiter nach ZH-Standard
            // 24.02.2008 : sozheo : Bei mündigen Jugendlichen soll kein BisDatum gesetzt werden
            // 04.03.2008 : sozheo : Bei Anzeige RTFEditKinder kein DatumBis anzeigen
            // 18.03.2008 : sozheo : Datum Bis bei UeBH max vier Jahre
            // 18.03.2008 : sozheo : neu soll Datum Bis ReadOnly sein
            // 25.03.2008 : sozheo : Umbau Bewilligung
            // 15.05.2008 : sozheo : Korrekturen für Kind mit Vormundschaft

            if (!CanEditActiveRow) return;

            int intBerechgTyp = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]);
            if (e.Column.FieldName == "Berechnung")
            {
                if (!Utils.ConvertToBool(e.Value, true))
                {
                    // Kind wird aus Berechnung entfernt
                    qryKind["BerechtigtCode"] = 0;
                    qryKind["DatumBis"] = DBNull.Value;
                    qryKind["IkRechtstitelID"] = DBNull.Value;
                    qryKind["RTName"] = DBNull.Value;
                }
                else
                {
                    // Kind wird hinzugefügt
                    qryKind["BerechtigtCode"] = 9;
                    qryKind["DatumBis"] = DBNull.Value;
                }
                AuswahlRechtstitelOeffnen();
                EditierenRechtstitelEinstellen();
            }
            else if (e.Column.FieldName == "BerechtigtCode")
            {
                int Berechtigt = Utils.ConvertToInt(e.Value);
                qryKind["BerechtigtCode"] = Berechtigt;

                if (Berechtigt == 1 && (!Utils.ConvertToBool(qryKind["Berechnung"], false))) qryKind["Berechnung"] = true;
                if (Berechtigt == 2 && (!Utils.ConvertToBool(qryKind["Berechnung"], false))) qryKind["Berechnung"] = true;
                if (Berechtigt == 3 && (!Utils.ConvertToBool(qryKind["Berechnung"], false))) qryKind["Berechnung"] = true;

                // 18.03.2008 : sozheo : neu soll Datum Bis ReadOnly sein
                //if ( (!DBUtil.IsEmpty(qryKind["Geburtsdatum"])) && DBUtil.IsEmpty(qryKind["DatumBis"]) && intBerechgTyp != 4)  // 4 = Mündige Jugendliche
                if ( (!DBUtil.IsEmpty(qryKind["Geburtsdatum"])) && intBerechgTyp != 4)  // 4 = Mündige Jugendliche
                {
                    DateTime dat = (DateTime)qryKind["Geburtsdatum"];
                    if (Berechtigt == 1) qryKind["DatumBis"] = dat.AddYears(18).AddDays(-1);
                    if (Berechtigt == 2) qryKind["DatumBis"] = dat.AddYears(4).AddDays(-1);
                    if (Berechtigt == 3) qryKind["DatumBis"] = dat.AddYears(2).AddDays(-1);
                }

                // Wenn der Typ gewechselt wird, dann muss der Rechtstitel neu gewählt werden
                qryKind["IkRechtstitelID"] = DBNull.Value;
                qryKind["RTName"] = DBNull.Value;
                AuswahlRechtstitelOeffnen();
                RechtstitelSetzen();
                EditierenRechtstitelEinstellen();
            }
            KinderSindKorrigiert = true;
            qryKind.RowModified = true;
        }

        private void qryAbPosition_AfterFill(object sender, System.EventArgs e)
        {
            // Nach dem Öffnen ist nichts korrigiert:
            PositionsAreModified = false;

            // Schalter einstellen
            btnCalculate.Enabled = (qryAbPosition.Count>0 && CanEditActiveRow);

            // für Berechnung:
            DataColumn[] cols = { qryAbPosition.DataTable.Columns["PositionsID"] };
            qryAbPosition.DataTable.PrimaryKey = cols;

            // Alle Knoten öffnen:
            treBerechnung.ExpandAll();
        }

        private void qryAbPosition_BeforePost(object sender, System.EventArgs e)
        {
            // Damit wir später wissen, dass bei Positionen editiert wurde:
            PositionsAreModified = true;
        }

        private void qryAmAnspruchsberechnung_AfterDelete(object sender, System.EventArgs e)
        {
            // 02.03.2009 : sozheo : Korrekturen für Transaktioshandling
            try
            {
                Session.Commit();
            }
            catch (Exception ex)
            {
                Session.Rollback();
                KissMsg.ShowInfo("Beim Löschen ist ein Fehler aufgetreten.\r\n\r\n" + ex.Message);
            }

            // Wenn keine Daten vorhanden, dann wird PositionChanged nicht ausgelöst.
            if (qryAmAnspruchsberechnung.Count == 0)
            {
                qryAmAnspruchsberechnung_PositionChanged(sender, e);
            }
        }

        private void qryAmAnspruchsberechnung_AfterFill(object sender, System.EventArgs e)
        {
            // Wenn keine Daten vorhanden, dann wird PositionChanged nicht ausgelöst.
            // Deshalb diese Zeile bitte nicht entfernen!!!! :
            if (qryAmAnspruchsberechnung.Count == 0)
            {
                qryAmAnspruchsberechnung_PositionChanged(sender, e);
            }
        }

        private void qryAmAnspruchsberechnung_AfterInsert(object sender, System.EventArgs e)
        {
            // 01.02.2008 : sozheo : Username füllen
            // 25.03.2008 : sozheo : Umbau Bewilligung

            btnCopy.Enabled = false;

            // Schlüssel zur Leistung setzen:
            qryAmAnspruchsberechnung["FaLeistungID"] = FaLeistungID;
            qryAmAnspruchsberechnung["UserID"] = Session.User.UserID;
            qryAmAnspruchsberechnung["Username"] = SessionUserName;
            edtUser.ToolTip = SessionUserName;

            // Erstkontakt übernehmen aus Fallführung:
            SqlQuery qryDat = DBUtil.OpenSQL( @"
                select ErstKontaktDatum from dbo.FaCheckInAlim WITH(READUNCOMMITTED) where FaLeistungID in (
                select FaLeistungID from dbo.FaLeistung WITH(READUNCOMMITTED) where FaFallID = {0} and FaProzessCode=201)",
                FaFallID
            );

            if (!DBUtil.IsEmpty(qryDat["ErstKontaktDatum"]))
                qryAmAnspruchsberechnung["ErstKontaktDatum"] = qryDat["ErstKontaktDatum"];
            else
                qryAmAnspruchsberechnung["ErstKontaktDatum"] = DateTime.Today;

            edtAmBerechnungTyp.Focus();
        }

        private void qryAmAnspruchsberechnung_AfterPost(object sender, System.EventArgs e)
        {
            // 25.03.2008 : sozheo : Umbau Bewilligung
            // 13.02.2009 : sozheo : Verbesserungen Transaktionshandling
            // 02.03.2009 : sozheo : Korrekturen für Transaktioshandling

            if (Session.Transaction == null) return;

            try
            {
                // Bei bewilligten und annulierten soll nichts beu berechnet werden
                int BewilligCode = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmVerfuegungStatusCode"]);
                if (BewilligCode != 3 && BewilligCode != 4 && BewilligCode != 5)
                {
                    // Hier werden Kinder und Positionen gespeichert:
                    SaveChildrensAndPositions();
                }
                Session.Commit();
            }
            catch (Exception ex)
            {
                Session.Rollback();
                KissMsg.ShowInfo(ex.Message);
                return;
            }

            KinderSindKorrigiert = false;
            if (!tbgBerechnung.Enabled) tbgBerechnung.Enabled = true;

            // Damit das Editieren neu eingestellt wird:
            qryAmAnspruchsberechnung_PositionChanged(sender, e);

            // Schalter Kopieren einstellen:
            btnCopy.Enabled = (
                qryAmAnspruchsberechnung.Count > 0 &&
                qryAmAnspruchsberechnung.CanUpdate &&
                Utils.ConvertToInt(qryAmAnspruchsberechnung["AmVerfuegungStatusCode"]) != 5
            );
        }

        private void qryAmAnspruchsberechnung_BeforeDelete(object sender, System.EventArgs e)
        {
            int tmpID = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmAnspruchsberechnungID"]);

            // Transaktion starten:
            Session.BeginTransaction();

            try
            {
                // Positionen löschen:
                DBUtil.ExecSQL("DELETE dbo.AmAbPosition WHERE AmAnspruchsberechnungID = {0}", tmpID);
                // Kinder löschen:
                DBUtil.ExecSQL("DELETE dbo.AmAbKind WHERE AmAnspruchsberechnungID = {0}", tmpID);
            }
            catch (Exception ex)
            {
                Session.Rollback();
                KissMsg.ShowError(ex.Message, ex);
            }
        }

        private void qryAmAnspruchsberechnung_BeforePost(object sender, System.EventArgs e)
        {
            // 23.09.2007 : sozheo : Erstkontakt kein Mussfeld
            // 26.09.2007 : sozheo : DefinitifAbDatum kein Mussfeld
            // 30.10.2007 : sozheo : DefinitifAbDatum gibt es nicht mehr, jetzt Berechnung-Ab-Datum verwenden
            // 04.11.2007 : sozheo : Anpassungen für ueBH und KKBB
            // 29.01.2008 : sozheo : Datum unique entfernt
            // 25.03.2008 : sozheo : Umbau Bewilligung
            // 13.02.2009 : sozheo : Verbesserungen Transaktionshandling
            // 02.03.2009 : sozheo : Korrekturen für Transaktioshandling

            // Bei bewilligten und annulierten soll nichts beu berechnet werden
            int BewilligCode = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmVerfuegungStatusCode"]);
            if (BewilligCode == 3 || BewilligCode == 4 || BewilligCode == 5) return;

            // Mussfelder checken: Codes:
            DBUtil.CheckNotNullField(edtBezeichnung, lblBezeichnung.Text);
            DBUtil.CheckNotNullField(edtAmBerechnungTyp, lblBerechnungstyp.Text);
            DBUtil.CheckNotNullField(edtEinkommVar, "Einkommensvariante");

            if (Utils.ConvertToInt(edtEinkommVar.EditValue)==2 && Utils.ConvertToInt(edtAmBerechnungTyp.EditValue)==2)
            {
                KissMsg.ShowInfo("CtlAmAnspruchsberechnung", "Alleinst2VerdienerNichtErlaubt",
                    "Alleinstehende können nicht die Einkommensvariante '2 Verdiener' haben.");
                throw new KissCancelException();
            }

            // Mussfelder checken: Datumsfelder:
            DBUtil.CheckNotNullField(edtBerechnungDatum, lblBerechnungDatum.Text);

            // Status Sezten
            bool stat = StatusSetzen();
            qryAmAnspruchsberechnung["BedingungKKBBErfuellt"] = stat;

            // Kontrollle, dass jedes Datum nur einmal vorkommt
            /*
            int tmpID = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmAnspruchsberechnungID"]);
            SqlQuery qry = DBUtil.OpenSQL(@"
              select Count(*) as Anzahl from AmAnspruchsberechnung A
              where A.FaLeistungID = {0}
                and A.BerechnungDatumAb = {1}
                and not A.AmAnspruchsberechnungID = {2}",
              FaLeistungID,
              qryAmAnspruchsberechnung["BerechnungDatumAb"],
              tmpID);

            int Anzahl = Utils.ConvertToInt(qry["Anzahl"]);
            if (Anzahl > 0)
            {
              KissMsg.ShowInfo("CtlAmAnspruchsberechnung", "BerechnungDatumExistiert",
                "Es existiert bereits eine Anspruchsberechnung mit dem gleichen Berechnung-ab-Datum.");
              throw new KissCancelException();
            }
            */

            // Damit die Anzahl Kinder korrekt gerechnet wird:
            if (qryKind.RowModified) if (!qryKind.Post()) throw new KissCancelException();

            // Kontrolle ALBV:
            // Es muss mindestens ein Kind gewählt sein:
            if (BerechnungTyp_ALBV1_KKBB3 == 1) if (!CheckChildrensALBV()) throw new KissCancelException();

            // Kontrolle KKBB:
            if (BerechnungTyp_ALBV1_KKBB3 == 3) if (!CheckChildrensKKBB()) throw new KissCancelException();

            // Es fanden Änderungen statt, welche die Berechnung grundlegend ändern.
            // Deshalb wird hier vor dem Speichern noch eine Zusatzfrage gestellt:
            if (!ChecksCorrectionsBeforePost()) throw new KissCancelException();

            // Neue Felder anzeigen:
            qryAmAnspruchsberechnung["TypBerechng"] = edtAmBerechnungTyp.Properties.GetDisplayText(edtAmBerechnungTyp.EditValue);
            qryAmAnspruchsberechnung["TypEinkomm"] = edtEinkommVar.Properties.GetDisplayText(edtEinkommVar.EditValue);
            qryAmAnspruchsberechnung["AnzKinder"] = qryKind.Count;

            // Transaktion starten
            Session.BeginTransaction();
        }

        private void qryAmAnspruchsberechnung_DeleteError(object sender, UnhandledExceptionEventArgs e)
        {
            // Fehler beim Löschen:
            KissMsg.ShowInfo(
                "CtlAmAnspruchsberechnung", "DeleteFehler",
                "Beim Löschen ist ein unbekannter Fehler aufgetreten."
            );
        }

        private void qryAmAnspruchsberechnung_PositionChanged(object sender, System.EventArgs e)
        {
            // 04.02.2008 : sozheo : Status neu
            // 11.02.2008 : sozheo : Sperren provisorisch ausgeschaltet
            // 15.03.2008 : sozheo : Sperren von Felder ergänzt
            // 25.03.2008 : sozheo : Umbau Bewilligung
            // 25.09.2008 : sozheo : Altersbedingung neu implementiert

            // Felder ein/ausschalten
            bool CanEdit = false;
            EditModeType aEditMode = EditModeType.ReadOnly;

            int BewilligCode = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmVerfuegungStatusCode"]);
            int MigriertCode = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungsStatusCode"]);

            if (
                !FaLeistungIstGeschlossen &&
                qryAmAnspruchsberechnung.Count > 0 &&
                qryAmAnspruchsberechnung.CanUpdate &&
                (BewilligCode == 0 || BewilligCode == 1) &&
                MigriertCode != 5 &&
                DBUtil.IsEmpty(qryAmAnspruchsberechnung["AmVerfuegungID"])
            )
            {
                aEditMode = EditModeType.Normal;
                CanEdit = true;
            }
            CanEditActiveRow = CanEdit;
            qryAmAnspruchsberechnung.CanDelete = CanEditActiveRow;
            btnUpdate.Enabled = CanEditActiveRow;

            // Editierfelder:
            edtBezeichnung.EditMode = aEditMode;
            edtUser.EditMode = aEditMode;
            edtAmtMT.EditMode = aEditMode;
            edtPrivMT.EditMode = aEditMode;
            edtAmBerechnungTyp.EditMode = aEditMode;
            edtEinkommVar.EditMode = aEditMode;
            adtErstkontakt.EditMode = aEditMode;
            edtBerechnungDatum.EditMode = aEditMode;
            edtArbeitspensum.EditMode = aEditMode;
            edtKinderbetreuung.EditMode = aEditMode;

            btnChangeState.Enabled = (
                !FaLeistungIstGeschlossen &&
                qryAmAnspruchsberechnung.Count > 0 &&
                qryAmAnspruchsberechnung.CanUpdate &&
                (BewilligCode == 3) &&
                (MigriertCode == 3 || MigriertCode == 6) &&
                !DBUtil.IsEmpty(qryAmAnspruchsberechnung["AmVerfuegungID"])
            );
            if (MigriertCode == 3)
                btnChangeState.Text = "ersetzen";
            else if (MigriertCode == 6)
                btnChangeState.Text = "wieder bewilligen";
            else
                btnChangeState.Text = "";

            // Kopieren soll immer möglich sein
            CanEdit = false;
            CanEdit = (qryAmAnspruchsberechnung.Count > 0 && qryAmAnspruchsberechnung.CanInsert);
            btnCopy.Enabled = CanEdit;

            // migrierte, alte PDFs:
            bool migBerechnung = qryAmAnspruchsberechnung.Count > 0 &&
                MigriertCode == 5 &&
                Utils.ConvertToInt(qryAmAnspruchsberechnung["Berechnung_DocumentID"] ) > 0;
            bool migVerfuegung = qryAmAnspruchsberechnung.Count > 0 &&
                MigriertCode == 5 &&
                Utils.ConvertToInt(qryAmAnspruchsberechnung["Verfuegung_DocumentID"] ) > 0;
            pnlMigDokumente.Visible = migBerechnung || migVerfuegung;
            edtRechtstitel.Visible = ((!pnlMigDokumente.Visible) && MigriertCode != 5);

            // Wenn keine Daten vorhanden, dann ist die Tab-Seite Berechnung nicht aktiv:
            tbgBerechnung.Enabled = (qryAmAnspruchsberechnung.Count > 0 && BewilligCode != 5);

            // ToolTip User anzeigen
            edtUser.ToolTip = Utils.ConvertToString(qryAmAnspruchsberechnung["Username"]);

            // Für eine Kontrollabfrage im BeforePost müssen wir wissen,
            // ob der Berechnungstyp geändert wurde
            Old_BerechngTyp = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]);
            Old_EinkommsTyp = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmEinkommensvarianteCode"]);

            // Nach einem Wechsel der Anspruchsberechnung müssen die Kinder neu angezeigt werden:
            Old_BerechngTyp_Selection = Old_BerechngTyp;

            FillQryKind(Old_BerechngTyp);
            Old_Kinder = GetChildrenCount();
            Old_KinderALBV = GetChildrenCountTyp(1);
            Old_KinderUEBH = GetChildrenCountTyp(2);
            Old_KinderKKBB = GetChildrenCountTyp(3);

            // Status anzeigen
            StatusSetzen();

            // Die Parameter der Berechnung anzeigen:
            SetCalculationParamText();

            // Anzeigen der Zusammenfassung:
            SetAddedChildText();

            // Der Tree wird auch geöffnet:
            OpenPositions();
        }

        private void qryAmAnspruchsberechnung_PositionChanging(object sender, System.EventArgs e)
        {
            CtlAmAnspruchsberechnung_SaveData(sender, e);
        }

        private void qryAmAnspruchsberechnung_PostError(object sender, UnhandledExceptionEventArgs e)
        {
            // Fehler beim Posten:
            KissMsg.ShowInfo(
                "CtlAmAnspruchsberechnung", "PostFehler",
                "Beim Speichern ist ein unbekannter Fehler aufgetreten."
            );
        }

        private void qryKind_AfterFill(object sender, System.EventArgs e)
        {
            KinderSindKorrigiert = false;

            // Einstellen Editierbarkeit Gitter Kinder und Tree:
            SetEditChildren();

            if (qryKind.Count == 0) qryKind_PositionChanged(sender, e);
        }

        private void qryKind_BeforePost(object sender, System.EventArgs e)
        {
            // 20.11.2007 : sozheo : Korrekturen für Typ UeBH entfernen
            // 22.11.2007 : sozheo : Korrekturen für Typ UeBH entfernen
            // 17.04.2008 : sozheo : Bei mündigen Jugendlichen kein DatumBis
            // 15.05.2008 : sozheo : Korrekturen für Kind mit Vormundschaft
            // 02.03.2009 : sozheo : Korrekturen für Transaktioshandling

            if (!Utils.ConvertToBool(qryKind["Berechnung"], false)) return;

            if (DBUtil.IsEmpty(qryKind["Geburtsdatum"]))
            {
                KissMsg.ShowInfo("Das Geburtsdatum des Kindes darf nicht leer sein.");
                throw new KissCancelException();
            }

            int BCode = Utils.ConvertToInt(qryKind["BerechtigtCode"]);
            int BerechngTyp = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]);
            if (DBUtil.IsEmpty(qryKind["DatumBis"]) && (BCode == 1 || BCode == 2 || BCode == 3) && BerechngTyp != 4)
            {
                KissMsg.ShowInfo("Das Bis-Datum der Berechnung darf nicht leer sein.");
                throw new KissCancelException();
            }

            DateTime DatMax = (DateTime)qryKind["Geburtsdatum"];
            int intBerechgTyp = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]);

            if (BCode == 1 && intBerechgTyp != 4) // KKBB
            {
                DatMax = DatMax.AddYears(18).AddDays(-1);
                if ((DateTime)qryKind["DatumBis"] > DatMax)
                {
                    KissMsg.ShowInfo(string.Format(
                        "ALBV-berechtigt sind Kinder höchstens bis zum 18. Lebensjahr ({0}).",
                        DatMax.ToString("dd.MM.yyyy")
                    ));
                    throw new KissCancelException();
                }
            }
            else if (BCode == 2)  // UeBH
            {
                // #4931: Neu soll bei UEBH das Datum bis zum 18. Lebensjahr möglich sein
                DateTime DatMax18 = DatMax.AddYears(18).AddDays(-1);
                DatMax = DatMax.AddYears(4).AddDays(-1);

                if ((DateTime)qryKind["DatumBis"] > DatMax18)
                {
                    KissMsg.ShowInfo(string.Format(
                        "UeBH-berechtigt sind Kinder höchstens bis zum 4. Lebensjahr ({0}),\r\n" +
                        "mit Ausnahmebewilligungen höchstens bis zum 18. Lebensjahr ({1}).",
                        DatMax.ToString("dd.MM.yyyy"),
                        DatMax18.ToString("dd.MM.yyyy")
                    ));
                    throw new KissCancelException();
                }
            }

            // Status in Query speichern
            SetStatusToQuery();

            // Damit wir später wissen, dass im Gitter Kinder editiert wurde:
            KinderSindKorrigiert = true;
        }

        private void qryKind_PositionChanged(object sender, System.EventArgs e)
        {
            // Hack: why this is necessary?
            //if (qryKind.RowModified) qryKind.RowModified = false;

            AuswahlRechtstitelOeffnen();
            EditierenRechtstitelEinstellen();
        }

        private void qryKind_PositionChanging(object sender, EventArgs e)
        {
            if (qryKind.Row != null && qryKind.Row.RowState != DataRowState.Unchanged)
            {
                if (!qryKind.Post()) throw new KissCancelException();
            }
        }

        private void tabControlSearch_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode != Keys.F3) return;
            if (tabControlSearch.SelectedTabIndex == 0)
                tabControlSearch.SelectedTabIndex = 1;
            else
                tabControlSearch.SelectedTabIndex = 0;
        }

        private void tabControlSearch_SelectedTabChanged(SharpLibrary.WinControls.TabPageEx page)
        {
            // Beim Wechseln der Tab-Seiten bei Suche:
            if (tabControlSearch.SelectedTabIndex == 0)
            {
                // Daten neu öffnen:
                FillQryAnspruchsberechnung();
            }
            else
            {
                // Hier ev. Felder löschen:
            }
        }

        private void tabControlSearch_SelectedTabChanging(object sender, CancelEventArgs e)
        {
            // Beim Wechsel oben muss alles gespeichert werden
            e.Cancel = CancelBeforeTabChange(false);
            if (e.Cancel) panelBottom.Focus();
        }

        private void tabDetail_SelectedTabChanged(SharpLibrary.WinControls.TabPageEx page)
        {
            if (tabDetail.SelectedTabIndex == 1)
            {
                qryAbPosition.First();
            }
            else if (tabDetail.SelectedTabIndex == 2)
            {
                ctlAmVerfuegung.OpenData();
            }
        }

        private void tabDetail_SelectedTabChanging(object sender, CancelEventArgs e)
        {
            // Beim Wechseln der Seiten wird immer die aktuelle Seite gespeichert:
            e.Cancel = CancelBeforeTabChange(true);
        }

        private void tpgListe_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.F3)
            tabControlSearch.SelectedTabIndex = 1;
        }

        private void tpgSuchen_KeyUp(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.F3)
            tabControlSearch.SelectedTabIndex = 0;
        }

        private void treBerechnung_AfterFocusNode(object sender, DevExpress.XtraTreeList.NodeEventArgs e)
        {
            // e.Node
            //KissMsg.ShowInfo("After Focus Node "+e.Node.GetValue("Wert1").ToString());
        }

        private void treBerechnung_BeforeFocusNode(object sender, DevExpress.XtraTreeList.BeforeFocusNodeEventArgs e)
        {
            // TODO
            // Datenkontrolle
            //e.CanFocus = CanEditCell(e.Node, e.Column.FieldName);
        }

        private void treBerechnung_CellValueChanged(object sender, DevExpress.XtraTreeList.CellValueChangedEventArgs e)
        {
            // Nach dem Ändern einer Zelle im Baum Positionen:
            if (!CanEditActiveRow) return;

            PositionsAreModified = true;
            if (e.Column.FieldName == "Bemerkung" || e.Column.FieldName == "Text" || e.Column.FieldName == "DatumVon")
            {
                qryAbPosition.Post();
                return;
            }

            // Berechnen:
            CalculatePositions();
        }

        private void treBerechnung_CustomDrawNodeCell(object sender, DevExpress.XtraTreeList.CustomDrawNodeCellEventArgs e)
        {
            // Zeichnet die Zellen abhängig davon, ob sie editierbar sind oder nicht:
            bool CanEdit = CanEditCell(e.Node, e.Column.FieldName);

            if (DBUtil.IsEmpty(e.Node.GetValue("ParentID")))
                e.Appearance.Font = new Font(e.Appearance.Font, FontStyle.Bold);
            else
                e.Appearance.Font = new Font(e.Appearance.Font, FontStyle.Regular);

            if (e.Node != treBerechnung.FocusedNode)
            {
                if (CanEdit)
                {
                    // Zelle ist editierbar:
                    e.Appearance.BackColor = Color.AliceBlue;
                    e.Appearance.ForeColor = Color.Black;
                }
                else if (DBUtil.IsEmpty(e.Node.GetValue("ParentID")))
                {
                    // Titelzeile hat spezielle Farbe:
                    e.Appearance.BackColor = Color.LightSalmon;
                    e.Appearance.ForeColor = Color.Black;
                }
                else
                {
                    // Zelle ist nicht editierbar:
                    e.Appearance.BackColor = Color.Bisque;
                    e.Appearance.ForeColor = Color.Black;
                }
            }
            else
            {
                // Zelle ist fokussiert:
                if (e.Column.FieldName == treBerechnung.FocusedColumn.FieldName && CanEdit)
                {
                    // Zelle kann editiert werden und ist fokussiert:
                    e.Appearance.BackColor = Color.White;
                    e.Appearance.ForeColor = Color.Black;
                }
                else
                {
                    // Zelle ist nicht editierbar:
                    e.Appearance.BackColor = Color.DarkBlue;
                    e.Appearance.ForeColor = Color.PeachPuff;
                }
            }

            if (e.Column.FieldName == "Wert2")
            {
                if (e.CellValue is decimal)
                {
                    decimal val = Utils.ConvertToDecimal(e.CellValue);
                    string format = e.Node.GetValue("Format2").ToString();
                    if (format == "") format = DefaultFormat2;
                    e.CellText = val.ToString(format);
                }
            }

            if ((e.Column.FieldName == "Mengeneinheit3") && (DBUtil.IsEmpty(e.Node.GetValue("ParentID"))))
            {
                e.CellText = "Total";
            }

            if ((e.Column.FieldName == "Wert3") && (DBUtil.IsEmpty(e.Node.GetValue("ParentID"))))
            {
                string tmpPos = e.Node.GetValue("PositionsID").ToString();
                int EinkommVariante = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmEinkommensvarianteCode"]);
                int Zivilstand = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]);
                int tmpKnd = 0;
                if (tmpPos.StartsWith("J"))
                {
                    tmpKnd = Convert.ToInt32(tmpPos.Substring(1,tmpPos.Length-1));
                    tmpPos = "J";
                }
                decimal val = (decimal)0.0;
                if (BerechnungTyp_ALBV1_KKBB3 == 1)
                {
                    // ALBV
                    switch (tmpPos)
                    {
                        case "A10"   :
                            if (Zivilstand == 4)
                                val = GetValue("A",  11, 0, 3);
                            else
                                val = GetValue("A",  13, 0, 3);
                            break;
                        case "A30"   :
                            if (EinkommVariante == 7)
                                val = GetValue("A",  42, 0, 3);
                            else
                                val = GetValue("A",  44, 0, 3);
                            break;
                        case "A60"   : val = GetValue("A",  69, 0, 3); break;
                        case "A80"   : val = GetValue("A",  84, 0, 3); break;
                        case "E130"  : val = GetValue("E", 145, 0, 3); break;
                        case "E160"  : val = GetValue("E", 169, 0, 3); break;
                        case "E180"  : val = GetValue("E", 189, 0, 3); break;
                        case "H200"  : val = GetValue("H", 206, 0, 3); break;
                        case "H220"  : val = GetValue("H", 249, 0, 3); break;
                        case "H250"  : val = GetValue("H", 259, 0, 3); break;
                        case "H270"  : val = GetValue("H", 275, 0, 3); break;
                        case "H280"  : val = GetValue("H", 288, 0, 3); break;
                        case "H300"  : val = GetValue("H", 301, 0, 3); break;
                        case "J"     : val = GetValue("K", 531, tmpKnd, 3); break;
                        case "X720"  : val = GetValue("Z", 740, 0, 3); break;
                    }
                }
                else
                {
                    // KKBB
                    switch (tmpPos)
                    {
                        case "A3010" : val = GetValue("A", 3025, 0, 3); break;
                        case "A3030" : val = GetValue("A", 3044, 0, 3); break;
                        case "A3060" :
                            if (EinkommVariante == 1 || EinkommVariante == 2 || EinkommVariante == 7)
                                val = GetValue("A", 3075, 0, 3);
                            break;
                        case "A3080" : val = GetValue("A", 3084, 0, 3); break;
                        case "E3130" : val = GetValue("E", 3145, 0, 3); break;
                        case "E3160" : val = GetValue("E", 3175, 0, 3); break;
                        case "E3180" : val = GetValue("E", 3184, 0, 3); break;
                        case "H3200" : val = GetValue("H", 3215, 0, 3); break;
                        case "H3220" : val = GetValue("H", 3249, 0, 3); break;
                        case "H3250" : val = GetValue("H", 3259, 0, 3); break;
                        case "H3270" : val = GetValue("H", 3271, 0, 3); break;
                        case "H3280" : val = GetValue("H", 3290, 0, 3); break;
                    }
                }
                e.CellText = val.ToString("N2");
            }

            // Wir lassen aber den Text automatisch hineinschreiben:
            e.Handled = false;
        }

        private void treBerechnung_ShowingEditor(object sender, CancelEventArgs e)
        {
            // Kann Zelle editiert werden?:
            bool CanEdit = CanEditCell(treBerechnung.FocusedNode, treBerechnung.FocusedColumn.FieldName);
            e.Cancel = !CanEdit;

            if (CanEdit)
            {
                if (treBerechnung.FocusedColumn.FieldName == "Wert1")
                {
                    string format = treBerechnung.FocusedNode.GetValue("Format1").ToString();
                    if (format == "") format = DefaultFormat1;
                    repedtBetrag.EditFormat.FormatString = format;
                }
                else if (treBerechnung.FocusedColumn.FieldName == "Wert2")
                {
                    string format = treBerechnung.FocusedNode.GetValue("Format2").ToString();
                    if (format == "") format = DefaultFormat2;
                    repedtBetrag.EditFormat.FormatString = format;
                }
            }
        }

        private void kissDocumentButton1_Click(object sender, System.EventArgs e)
        {
            // Damit vor dem Drucken alles gespeichert wird
            CtlAmAnspruchsberechnung_SaveData(null, null);
        }

        #endregion

        #endregion

        #region Methods

        #region Public Methods

        public override object GetContextValue(string FieldName)
        {
            switch (FieldName.ToUpper())
            {
                case "ID":
                    return qryAmAnspruchsberechnung["AmAnspruchsberechnungID"];
                case "ABSENDER":
                    return 0;
            }
            return base.GetContextValue(FieldName);
        }

        #endregion

        #region Private Methods

        private bool AllesSpeichern()
        {
            if (!CanEditActiveRow) return true;
            if (tabDetail.SelectedTabIndex == 0)
            {
                // Speichern der 1. Tabseite
                return SavingCalculationAndChildrenWasOk();
            }
            else
            if (tabDetail.SelectedTabIndex == 1)
            {
                // Speichern der 2. Tabseite
                return SavePositions(true);
            }
            else if (tabDetail.SelectedTabIndex == 2)
            {
                // Speichern der 3. Tabseite
                bool Result = ctlAmVerfuegung.qryAmVerfuegung.Post();
                if (Result) qryAmAnspruchsberechnung.Refresh();
                return Result;
            }
            return true;
        }

        private void AuswahlRechtstitelOeffnen()
        {
            // 22.07.2009 : Rechtstitel auch anzeigen, wenn GültigBis erfasst ist
            // in WHERE Klausel entfernt:
            // AND (R.IkRechtstitelGueltigBis IS NULL OR L.FaProzessCode = 407)
            qryRechtstitel.Fill(
                FaFallID,
                Utils.ConvertToInt(qryKind["BaPersonID"]),
                Utils.ConvertToInt(qryKind["BerechtigtCode"])
            );

            // Ist notwendig, da sonst plötzlich nur noch 1 Zeile sichtbar ist:
            edtRechtstitel.Properties.DropDownRows = 7;
        }

        private decimal CalculateFinalValueNew(DataRow row, string PosID)
        {
            // Berechnet 'Wert3' anhand der Mengeneinheit2
            decimal Wert = (decimal)0.00;
            if (PosID == "A3032")
                Wert = GetValFromQuery(row, "Wert1");
            else
                Wert = GetValFromQuery(row, "Wert1") * GetValFromQuery(row, "Wert2");
            Wert = Utils.RoundMoney(Wert, RoundingDecimals);
            row["Wert3"] = Wert;
            return Wert;
        }

        private void CalculatePositions()
        {
            // 24.08.2007 : sozheo : Berechnung korrigiert
            // 28.08.2007 : sozheo : Berechnung korrigiert
            // 10.10.2007 : sozheo : Berechnung ZVV korrigiert
            // 29.10.2007 : sozheo : A41 und E141 aus Berechnung entfernt
            // 04.11.2007 : sozheo : Anpassungen für ueBH und KKBB
            // 20.11.2007 : sozheo : Korrekturen für Typ UeBH entfernen
            // 29.01.2008 : sozheo : K511 jetzt aus den Monatszahlen holen (nur bei ALBV)
            // 14.02.2008 : sozheo : K511 korrigiert
            // 24.02.2008 : sozheo : GetChildrenCount: Korrektur für mündige Jugendliche
            // 25.02.2008 : sozhew : Vermögensobergrenze wenn max erreicht dann nicht auf 1000 kürzen
            // 03.04.2008 : sozheo : Korrektur K511 UeBH
            // 15.05.2008 : sozheo : Korrektur für Kind mit Vormundschaft

            if (!CanEditActiveRow) return;

            // Damit der Bildschirm ruhig bleibt:...
            treBerechnung.BeginUpdate();
            string OldKey = Utils.ConvertToString(qryAbPosition["PositionsID"]);

            try
            {
                if (BerechnungTyp_ALBV1_KKBB3 == 1)
                    CalculatePositions_ALBV();
                else if (BerechnungTyp_ALBV1_KKBB3 == 3)
                    CalculatePositions_KKBB();
            }
            finally
            {
                treBerechnung.EndUpdate();
            }
        }

        private decimal CalculateRowValue(string Sort, int PosNrID, int Kind)
        {
            decimal Wert = (decimal)0.00;
            string PosID = GetPosString(Sort, PosNrID, Kind);
            DataRow row = qryAbPosition.DataTable.Rows.Find(PosID);
            if (row == null)
            {
                KissMsg.ShowInfo(string.Format("PositionsID '{0}' nicht gefunden (CalculateRowValue).", PosID));
                if (PosID.StartsWith("K531") && BerechnungTyp_ALBV1_KKBB3 == 1)
                {
                    KissMsg.ShowInfo(
                        "Sie verwenden eine Berechnung einer älteren Version.\r\n\r\n" +
                        "Löschen Sie diese Anspruchsberechnung oder verändern Sie die Kopfdaten,\r\n" +
                        "damit die Berechnung neu ausgeführt wird."
                    );
                    return Wert;
                }
            }
            Wert = CalculateFinalValueNew(row, PosID);
            return Wert;
        }

        private bool CanEditCell(DevExpress.XtraTreeList.Nodes.TreeListNode Node, string FieldName)
        {
            // Liefert TRUE zurück, wenn die Zelle bearbeitet werden darf:

            bool CanEditCol = CanEditColumn(FieldName);
            if (!CanEditCol) return false;

            bool CanEdit1 = (Utils.ConvertToInt(Node.GetValue("Editierbar1")) == 1);
            bool CanEdit2 = (Utils.ConvertToInt(Node.GetValue("Editierbar2")) == 1);

            string tmpPos = Node.GetValue("PositionsID").ToString();
            int BerechtigtCode = Utils.ConvertToInt(Node.GetValue("BerechtigtCode"));
            if (FieldName == "Wert1" && tmpPos.StartsWith("K511_") && BerechtigtCode == 1 && CanEdit1)
            {
                // Speziell K511:
                // Wenn "Anzahl"=1: dann soll der Wert aus den Alimenten genommen werden
                // Wenn "Anzahl"=0: dann soll eine manuelle Eingabe erfolgen
                int KindKey = Utils.ConvertToInt(Node.GetValue("AmAbKindID"));
                bool Manuell = (GetValue("K", 511, KindKey, 2) == (decimal)0.0);
                CanEdit1 = CanEdit1 && Manuell;
            }

            if (FieldName == "Wert2" && tmpPos.StartsWith("K511_") && BerechtigtCode == 2 && CanEdit2)
            {
                // bei UeBH kann Manuell/Totallaiment nicht erfasst werden:
                CanEdit2 = false;
            }

            if (FieldName == "Wert1")
                return CanEdit1;
            else if (FieldName == "Wert2")
                return CanEdit2;
            else
                return (CanEdit1 || CanEdit2);
        }

        private bool CanEditColumn(string FieldName)
        {
            // Liefert TRUE zurück, wenn die Spalte bearbeitet werden darf:
            if (!CanEditActiveRow) return false;
            return (
                FieldName == "DatumAb" ||
                FieldName == "Text" ||
                FieldName == "Wert1" ||
                FieldName == "Wert2" ||
                FieldName == "Bemerkung"
            );
        }

        private bool CancelBeforeTabChange(bool DoRefresh)
        {
            bool DoCancel = true;
            if (tabDetail.SelectedTabIndex == 0 || tabDetail.SelectedTabIndex == 1)
            {
                // Wenn von der 1. Seite zur 2. gewechselt werden soll,
                // sollen zuerst die Hauptdaten kontrolliert werden:
                DoCancel = !AllesSpeichern();
            }
            else if (tabDetail.SelectedTabIndex == 2)
            {
                // Tab Verfügung
                DoCancel = (!ctlAmVerfuegung.qryAmVerfuegung.Post());
                if (!DoCancel && DoRefresh) qryAmAnspruchsberechnung.Refresh();
            }
            return DoCancel;
        }

        private bool CheckChildrensALBV()
        {
            DateTime BisDat = DateTime.Today;
            DateTime GebDat = DateTime.Today;
            int AnzALBVBerechtigt = 0;
            int AnzUEBHBerechtigt = 0;
            string DatumBisFalsch = "";
            bool GebDatIstOk = true;
            bool BisDatIstOk = true;
            int Berechtigt;
            int intBerechgTyp = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]);

            foreach (System.Data.DataRow row in qryKind.DataTable.Rows)
            if (Utils.ConvertToBool(row["Berechnung"], false))
            {
                Berechtigt = Utils.ConvertToInt(row["BerechtigtCode"]);
                if (Berechtigt == 1) AnzALBVBerechtigt += 1;
                if (Berechtigt == 2) AnzUEBHBerechtigt += 1;

                if (DBUtil.IsEmpty(row["Geburtsdatum"]))
                    GebDatIstOk = false;
                else
                    GebDat = (DateTime)row["Geburtsdatum"];

                if (DBUtil.IsEmpty(row["DatumBis"]) && (Berechtigt == 1 || Berechtigt == 2))
                    BisDatIstOk = false;
                else if (Berechtigt != 9 && intBerechgTyp != 4 && (!DBUtil.IsEmpty(row["DatumBis"])) )
                    BisDat = (DateTime)row["DatumBis"];

                if (
                    GebDatIstOk && BisDatIstOk &&
                    BisDat > GebDat.AddYears(18).AddDays(-1) &&
                    (Berechtigt == 1 || Berechtigt == 2) &&
                    intBerechgTyp != 4
                )
                {
                    DatumBisFalsch += Utils.ConvertToString(row["Name"]) + "\r\n";
                }
            }

            string strMsg = "";
            if (!GebDatIstOk)
            {
                strMsg = "Erfassen Sie zuerst bei allen Kindern das Geburtsdatum.";
                KissMsg.ShowInfo(strMsg);
                return false;
            }
            if ( (!BisDatIstOk) && intBerechgTyp != 4 ) // mündige Judendliche
            {
                strMsg = "Das Bis-Datum der berechtigten Kinder darf nicht leer sein.";
                KissMsg.ShowInfo(strMsg);
                return false;
            }
            if (AnzALBVBerechtigt == 0 && AnzUEBHBerechtigt == 0)
            {
                strMsg = "Es muss mindestens ein Kind ALBV- oder UeBH-berechtigt sein.";
                KissMsg.ShowInfo(strMsg);
                return false;
            }
            if (DatumBisFalsch != "")
            {
                strMsg = string.Format(
                    "Die Berechtigung darf im Normalfall nur bis zum 18. Lebensjahr dauern.\r\n"+
                    "Bei folgenden Kindern wurde diese Grenze überschritten:\r\n\r\n{0}",
                    DatumBisFalsch
                );
                KissMsg.ShowInfo(strMsg);
            }
            return true;
        }

        private bool CheckChildrensKKBB()
        {
            // Es darf immer nur das jüngste Kind KKBB berechtigt sein
            DateTime GebDatJuengstesKind = DateTime.Today.AddYears(-100);
            DateTime GebDat = DateTime.Today;
            DateTime BisDat = DateTime.Today;
            DateTime GebDatBerechtigt = DateTime.Today;
            int AnzKKBBBerechtigt = 0;
            int Berechtigt = 0;
            bool GebDatIstOk = true;
            bool BisDatIstOk = true;

            foreach (System.Data.DataRow row in qryKind.DataTable.Rows)
            if (Utils.ConvertToBool(row["Berechnung"], false))
            {
                Berechtigt = Utils.ConvertToInt(row["BerechtigtCode"]);
                if (DBUtil.IsEmpty(row["Geburtsdatum"]))
                    GebDatIstOk = false;
                else
                    GebDat = (DateTime)row["Geburtsdatum"];

                if (Berechtigt == 3)
                {
                    AnzKKBBBerechtigt += 1;
                    BisDatIstOk = !DBUtil.IsEmpty(row["DatumBis"]);
                    if (BisDatIstOk) BisDat = (DateTime)row["DatumBis"];
                    if (!DBUtil.IsEmpty(row["Geburtsdatum"])) GebDatBerechtigt = (DateTime)row["Geburtsdatum"];
                }
            }

            string strMsg = "";
            if (!BisDatIstOk)
                strMsg = "Das Bis-Datum des KKBB-berechtigten Kindes darf nicht leer sein.";
            if (BisDat > GebDatBerechtigt.AddYears(2).AddDays(-1))
                strMsg = "Die KKBB-Berechtigung darf nur bis 2. Altersjahr des Kindes dauern.";
            if (AnzKKBBBerechtigt > 1)
                strMsg = "Nur ein Kind kann KKBB-berechtigt sein.";
            if (AnzKKBBBerechtigt == 0)
                strMsg = "Mindestens 1 Kind muss KKBB-berechtigt sein.";
            if (!GebDatIstOk)
                strMsg = "Erfassen Sie zuerst bei allen Kindern das Geburtsdatum.";

            if (strMsg != "")
            {
                KissMsg.ShowInfo(strMsg);
                return false;
            }
            return true;
        }

        private bool ChecksCorrectionsBeforePost()
        {
            // Zuerst kontrollieren, ob die Änderungen am Datensatz
            // zum Löschen / Hinzufuegen von Daten führen
            int AnzKinder = GetChildrenCount();
            int AnzKinderALBV = GetChildrenCountTyp(1);
            int AnzKinderUEBH = GetChildrenCountTyp(2);
            int AnzKinderKKBB = GetChildrenCountTyp(3);
            bool SignifikanteDatenWurdeGeaendert = false;

            SignifikanteDatenWurdeGeaendert = (
                (Old_BerechngTyp != Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]) && Old_BerechngTyp > 0) ||
                (Old_EinkommsTyp != Utils.ConvertToInt(qryAmAnspruchsberechnung["AmEinkommensvarianteCode"]) && Old_EinkommsTyp > 0) ||
                (Old_Kinder != AnzKinder) ||
                (Old_KinderALBV != AnzKinderALBV) ||
                (Old_KinderUEBH != AnzKinderUEBH) ||
                (Old_KinderKKBB != AnzKinderKKBB)
            );

            bool RowInserted = (qryAmAnspruchsberechnung.Row.RowState == System.Data.DataRowState.Added);
            if ((!RowInserted) && SignifikanteDatenWurdeGeaendert)
            {
                // Abfrage, ob der Datensatz wirklich geändert werden soll:
                string aQuestion = "";
                aQuestion += "Sie haben den Berechnungstyp oder die Einkommensvariante geändert\r\n";
                aQuestion += "oder Kinder hinzugefügt / entfernt oder deren Berechtigung gewechselt.\r\n\r\n";
                aQuestion += "Dadurch werden ev. bereits erfasste Daten gelöscht oder neue Daten hinzugefügt.\r\n\r\n";
                aQuestion += "Wie wollen Sie fortfahren?";
                string[] Btns = {"Änderungen &speichern", "Änderungen &rückgängig machen", "&Abbrechen" };

                int ResultButton = KissMsg.ShowButtonDlg(aQuestion, Btns);
                if (ResultButton == 0)
                {
                    // Daten speichern: Weiter zu StartTransaction und dann After Post
                }
                else if (ResultButton == 1)
                {
                    // Rückgängig machen gedrückt:
                    CtlAmAnspruchsberechnung_UndoDataChanges(null, null);
                    qryAmAnspruchsberechnung.Refresh();
                    return false;
                }
                else
                    // Schalter Abbrechen gedrückt:
                    return false;
            }
            return true;
        }

        private void EditierenRechtstitelEinstellen()
        {
            // Felder ein/ausschalten
            EditModeType aEditMode = EditModeType.ReadOnly;

            //int BewilligCode = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmVerfuegungStatusCode"]);
            //int MigriertCode = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungsStatusCode"]);
            if (
                CanEditActiveRow &&
                Utils.ConvertToBool(qryKind["Berechnung"], false)
            )
            {
                aEditMode = EditModeType.Normal;
            }
            edtRechtstitel.EditMode = aEditMode;
        }

        private void FillQryAnspruchsberechnung()
        {
            // SQL erstellen:
            string strSQL = @"
                select ABE.*,
                  MonatsAnspruch = case when L.FaProzessCode = 404
                    then (select P.Wert3 from dbo.AmAbPosition P where P.AmAnspruchsberechnungID = ABE.AmAnspruchsberechnungID and AmAbPositionsartID = 3290)
                    else (select P.Wert3 from dbo.AmAbPosition P where P.AmAnspruchsberechnungID = ABE.AmAnspruchsberechnungID and AmAbPositionsartID = 740)
                  end,
                  TypBerechng = dbo.fnLOVText('AmBerechnungTyp', ABE.AmBerechnungTypCode),
                  TypEinkomm = dbo.fnLOVText('AmEinkommensvariante', ABE.AmEinkommensvarianteCode),
                  TypStatus = dbo.fnLOVText('AmBerechnungsStatus', VER.AmVerfuegungStatusCode) + case
                    when ABE.AmBerechnungsStatusCode = 6 then ', ersetzt'
                    else ''
                  end,
                  VER.AmVerfuegungStatusCode,
                  AnzKinder = (
                    select count(*) from AmAbKind
                    where AmAnspruchsberechnungID = ABE.AmAnspruchsberechnungID
                    and BerechtigtCode in (1,2,3)
                  ),
                  Username = U.DisplayText,
                  MandUsername = UM.LastName + IsNull(' ' + UM.Firstname, ''),
                  MandInst = IM.Name,
                  VER.EntscheidDatum
                from dbo.AmAnspruchsberechnung ABE
                Left outer join dbo.AmVerfuegung VER on VER.AmVerfuegungID = ABE.AmVerfuegungID
                Left outer join dbo.vwUser U WITH(READUNCOMMITTED) on U.UserID = ABE.UserID
                Left outer join dbo.XUser UM WITH(READUNCOMMITTED) on UM.UserID = ABE.Mandant_UserID
                Left outer join dbo.BaInstitution IM WITH(READUNCOMMITTED) on IM.BaInstitutionID = ABE.Mandant_InstitutionID
                Left outer join dbo.FaLeistung L WITH(READUNCOMMITTED) on L.FaLeistungID = ABE.FaLeistungID";

            // WHERE erstellen:
            strSQL += " where ABE.FaLeistungID = " + FaLeistungID.ToString();

            // Suche DefinitivAb VON-Datumsfelder:
            if (!DBUtil.IsEmpty(edtSucheDefinitivAb.EditValue))
                strSQL += " and ABE.DefinitivAbDatum >= " + edtSucheDefinitivAb.EditValue.ToString();

            // Suche DefinitivAb BIS-Datumsfelder:
            if (!DBUtil.IsEmpty(edtSucheDefinitivBis.EditValue))
                strSQL += " and ABE.DefinitivAbDatum <= " + edtSucheDefinitivBis.EditValue.ToString();

            // Suche Berechnungstyp:
            if (!DBUtil.IsEmpty(edtSucheBerechnungstyp.EditValue))
                strSQL += " and ABE.AmBerechnungTypCode = " + edtSucheBerechnungstyp.EditValue.ToString();

            // Suche OhneMigrierte:
            if (chkSucheOhneMigrierte.Checked)
                strSQL += " and not ABE.AmBerechnungsStatusCode = 5 ";

            strSQL += " order by VER.EntscheidDatum desc, ABE.BerechnungDatumAb desc, ABE.AmAnspruchsberechnungID desc ";

            // SQL erstellen:
            qryAmAnspruchsberechnung.Fill(strSQL);
        }

        private void FillQryKind(int TypBerechnung)
        {
            // Alle Kinder anzeigen, welche bei den FallPersonen vorhanden sind:
            int tmpID = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmAnspruchsberechnungID"]);
            // Wenn kein Datensatz vorhanden, dann sollen auch keine Kinder angezeigt werden:
            int tmpFall = FaFallID;
            if (qryAmAnspruchsberechnung.Row == null) tmpFall = 0;

            // Daten öffnen:
            // Wenn kontrolliert werden soll, ob die Person in den Relationen als Kind erfasst wurde.
            // Wenn auch Grosseltern usw. erfasst werden können, dann muss dieses SQL verwendet werden:
            qryKind.Fill(tmpID, tmpFall, ClientID, TypBerechnung);
        }

        private int GetChildrenCount()
        {
            // Bei mündigen Jugendlichen soll immer 0 zurückgeliefert werden
            if (Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]) == 4) return 0;

            // Die Anzahl Kinder bestimmen, welche im in dieser Berechnung aktiv sind
            int Anzahl = 0;
            foreach (System.Data.DataRow row in qryKind.DataTable.Rows)
            if (Utils.ConvertToBool(row["Berechnung"], false)) Anzahl += 1;
            return Anzahl;
        }

        private int GetChildrenCountTyp(int Typ)
        {
            // Die Anzahl Kinder eines Typ (ALBV, UeBH) bestimmen, welche im in dieser Berechnung aktiv sind
            int Anzahl = 0;
            foreach (System.Data.DataRow row in qryKind.DataTable.Rows)
                if (Utils.ConvertToBool(row["Berechnung"], false))
                if (Utils.ConvertToInt(row["BerechtigtCode"]) == Typ) Anzahl += 1;
            return Anzahl;
        }

        private string GetPosString(string Sort, int PosNrID, int KindID)
        {
            string strPosID = Sort + PosNrID.ToString();
            if (KindID > 0) strPosID  += "_" + KindID.ToString();
            return strPosID;
        }

        private decimal GetValFromQuery(DataRow row, string FieldName)
        {
            return Utils.ConvertToDecimal(row[FieldName]);
        }

        private decimal GetValue(string Sort, int PosNrID, int Kind, int FieldNr)
        {
            // Holt den Wert einer Zeile:
            decimal Wert = (decimal)0.00;
            string PosID = GetPosString(Sort, PosNrID, Kind);
            DataRow row = qryAbPosition.DataTable.Rows.Find(PosID);
            if (row != null)
                Wert = GetValFromQuery(row, "Wert"+FieldNr.ToString());
            else
                KissMsg.ShowInfo(string.Format("PositionsID '{0}' nicht gefunden (GetValue).", PosID));
            return Wert;
        }

        private Decimal GetZVVBetrag(int CodeZVV, int TageZVV)
        {
            // 05.02.2009 : sozheo : Neu jetzt aus neuer Tabelle IkZVVTarife
            Decimal val;
            qryZVV.Fill(CodeZVV, qryAmAnspruchsberechnung["BerechnungDatumAb"]);

            val = (Decimal)0.00;
            if (TageZVV==1)
                val = Utils.RoundMoney(Utils.ConvertToDecimal(qryZVV["Value1"]), RoundingDecimals);
            else if (TageZVV==2)
                val = Utils.RoundMoney(Utils.ConvertToDecimal(qryZVV["Value2"]), RoundingDecimals);
            else if (TageZVV>2)
                val = Utils.RoundMoney(Utils.ConvertToDecimal(qryZVV["Value3"]), RoundingDecimals);
            return val;
        }

        private void OpenPositions()
        {
            // Positionen neu öffnen:
            qryAbPosition.Fill(qryAmAnspruchsberechnung["AmAnspruchsberechnungID"]);

            // expand tree
            treBerechnung.OptionsBehavior.Editable = true;
            treBerechnung.ExpandAll();
        }

        private void RechtstitelSetzen()
        {
            if (DBUtil.IsEmpty(qryKind["BerechtigtCode"])) return;
            if (!DBUtil.IsEmpty(qryKind["IkRechtstitelID"])) return;

            // 23.07.2009 : 
            // es sollen auch RT angezeigt werden, bei welchen das Gültig-Bis erfasst ist
            // and (R.IkRechtstitelGueltigBis IS NULL OR L.FaProzessCode = 407) entfernt
            SqlQuery qry = DBUtil.OpenSQL(@"
                select G.IkRechtstitelID from dbo.IkGlaeubiger G WITH(READUNCOMMITTED)
                left join IkRechtstitel R on R.IkRechtstitelID = G.IkRechtstitelID
                left join FaLeistung L on L.FaLeistungID = R.FaLeistungID
                where L.FaFallID = {0}
                  and (L.FaProzessCode - 404 = {1} and {1} in (1,2,3))
                  and G.BaPersonID = {2}",
                FaFallID,
                Utils.ConvertToInt(qryKind["BerechtigtCode"]),
                Utils.ConvertToInt(qryKind["BaPersonID"])
            );

            if (qry.Count != 1) return;
            int NewID = Utils.ConvertToInt(qry["IkRechtstitelID"]);
            AuswahlRechtstitelOeffnen();
            if (!qryRechtstitel.Find("IkRechtstitelID="+NewID.ToString())) return;
            qryKind["IkRechtstitelID"] = NewID;
            qryKind["RTName"] = qryRechtstitel["Text"];
        }

        private bool SaveChildrensAndPositions()
        {
            try
            {
                // Alle Kinder speichern / entfernen
                foreach (System.Data.DataRow row in qryKind.DataTable.Rows)
                {
                    //string aDat = (row["DatumBis"] is DateTime) ? "'"+((DateTime)row["DatumBis"]).ToString("yyyyMMdd")+"'" : "NULL";
                    int Berechtigt = Utils.ConvertToInt(row["BerechtigtCode"]);
                    if (Berechtigt == 0) Berechtigt = 9;

                    DBUtil.ExecSQL("EXEC dbo.spAmAnspruchsberechnung_UpdateKind {0}, {1}, {2}, {3}, {4}, {5}",
                        Utils.ConvertToInt(qryAmAnspruchsberechnung["AmAnspruchsberechnungID"]),
                        Utils.ConvertToInt(row["BaPersonID"]),
                        Utils.ConvertToBool(row["Berechnung"], false) ? 1 : 0,
                        Berechtigt,
                        row["DatumBis"], //aDat,
                        row["IkRechtstitelID"]
                    );
                }

                // Alle Daten hinzufuegen / löschen:
                DBUtil.ExecSQL("EXEC dbo.spAmAnspruchsberechnung_Update {0}, {1}, {2}, {3}, {4}",
                    BerechnungTyp_ALBV1_KKBB3,
                    Utils.ConvertToInt(qryAmAnspruchsberechnung["AmAnspruchsberechnungID"]),
                    Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]),
                    Utils.ConvertToInt(qryAmAnspruchsberechnung["AmEinkommensvarianteCode"]),
                    (DateTime)qryAmAnspruchsberechnung["BerechnungDatumAb"]
                );

                // Kinder neu anzeigen:
                // Das muss hier gemacht werden,
                // damit CalculatePositions() die ev. neuen Keys AmAbKind geholt werden können:
                FillQryKind(Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]));

                // Positionen neu anzeigen:
                OpenPositions();
                CalculatePositions();
                SavePositions(false);
            }
            catch (Exception ex)
            {
                // Speichern nicht ok, also Rückgängig machen
                throw new KissInfoException(ex.Message);
            }

            Old_BerechngTyp = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]);
            Old_EinkommsTyp = Utils.ConvertToInt(qryAmAnspruchsberechnung["AmEinkommensvarianteCode"]);
            Old_Kinder = GetChildrenCount();
            Old_KinderALBV = GetChildrenCountTyp(1);
            Old_KinderUEBH = GetChildrenCountTyp(2);
            Old_KinderKKBB = GetChildrenCountTyp(3);
            Old_KinderNone = GetChildrenCountTyp(9);

            // Die Parameter der Berechnung anzeigen:
            SetCalculationParamText();

            // Anzeigen der Zusammenfassung:
            SetAddedChildText();

            return true;
        }

        private bool SavePositions(bool WithTransaction)
        {
            // Alle Positionen speichern:
            treBerechnung.EndCurrentEdit();
            if (!PositionsAreModified) return true;

            bool HasErrors = false;
            if (WithTransaction) Session.BeginTransaction();
            try
            {
                // zuerst alle Daten im Gitter speichern:
                foreach (System.Data.DataRow row in qryAbPosition.DataTable.Rows)
                if (row.RowState != System.Data.DataRowState.Unchanged)
                if (!DBUtil.IsEmpty(row["AmAbPositionID"]))
                {
                    DBUtil.ExecSQL(@"
                        UPDATE dbo.AmAbPosition SET Text = {0}, Wert1 = {1}, Wert2 = {2}, Wert3 = {3}, Bemerkung = {4}
                        where AmAbPositionID = {5}",
                        row["Text"],
                        row["Wert1"],
                        row["Wert2"],
                        row["Wert3"],
                        row["Bemerkung"],
                        row["AmAbPositionID"]
                    );
                }
                // Transaktion beenden:
                if (WithTransaction) Session.Commit();
            }
            catch (Exception ex)
            {
                if (WithTransaction) Session.Rollback();
                HasErrors = true;
                KissMsg.ShowInfo(ex.Message);
            }

            if (!HasErrors)
            {
                qryKind.Refresh();
                PositionsAreModified = false;
            }

            return (!HasErrors);
        }

        private bool SavingCalculationAndChildrenWasOk()
        {
            // 24.02.2007 : sozheo : bei mündige Judendlichen keine Kontrolle des DatumsBis
            // 25.03.2008 : sozheo : Umbau Bewilligung
            // 15.05.2008 : sozheo : Korrekturen für Kind mit Vormundschaft
            // 13.02.2009 : sozheo : Verbesserungen Transaktionshandling
            // 02.03.2009 : sozheo : Korrekturen für Transaktioshandling

            // Kopfdaten speichern?
            bool PostingWasOk = true;
            qryAmAnspruchsberechnung.EndCurrentEdit();
            qryKind.EndCurrentEdit();

            if (!qryKind.Post()) return false;

            if (qryAmAnspruchsberechnung.RowModified || KinderSindKorrigiert)
            {
                if (qryAmAnspruchsberechnung.RowModified)
                {
                    if (!qryAmAnspruchsberechnung.Post()) PostingWasOk = false;
                }
                else if (KinderSindKorrigiert)
                {
                    // Es fanden Änderungen statt, welche die Berechnung grundlegend ändern.
                    // Deshalb wird hier vor dem Speichern noch eine Zusatzfrage gestellt:
                    PostingWasOk = ChecksCorrectionsBeforePost();
                    if (PostingWasOk) if (!SaveChildrens_WithTransaction()) PostingWasOk = false;
                }
            }
            return PostingWasOk;
        }

        private void SetAddedChildText()
        {
            // Anzeigen der Zusammenfassung:
            string NewText = "";
            int Berechtigt = 0;

            if (qryKind.Count > 0)
            {
                foreach (System.Data.DataRow row in qryKind.DataTable.Rows)
                {
                    NewText += row["Name"].ToString();
                    if (Utils.ConvertToBool(row["Berechnung"], false))
                    {
                        Berechtigt = Utils.ConvertToInt(row["BerechtigtCode"]);
                        NewText += " (hinzugefügt, ";
                        if (Berechtigt == 1) NewText += "ALBV berechtigt)"; else
                        if (Berechtigt == 2) NewText += "UeBH berechtigt)"; else
                        if (Berechtigt == 3) NewText += "KKBB berechtigt)"; else
                            NewText += "nicht " + TypText + " berechtigt)";

                    }
                    else
                        NewText += " (nicht hinzugefügt)";
                    NewText += "\r\n";
                }
            }
            RTFEditKinder.Text = NewText;
        }

        private void SetBemerkung(string Sort, int PosNrID, int Kind, string Comment)
        {
            string PosID = GetPosString(Sort, PosNrID, Kind);
            DataRow row = qryAbPosition.DataTable.Rows.Find(PosID);
            if (row == null)
            {
                KissMsg.ShowInfo(string.Format("PositionsID '{0}' nicht gefunden (SetBemerkung).", PosID));
                return;
            }
            row["Bemerkung"] = Comment;
        }

        private void SetCalculationParamText()
        {
            // Die Parameter der Berechnung anzeigen:
            string NewText = "";
            NewText += Utils.ConvertToString(qryAmAnspruchsberechnung["TypBerechng"])+"\r\n";
            NewText += Utils.ConvertToString(qryAmAnspruchsberechnung["TypEinkomm"])+"\r\n";
            NewText += Utils.ConvertToString(qryAmAnspruchsberechnung["TypStatus"])+"\r\n";
            if (!DBUtil.IsEmpty(qryAmAnspruchsberechnung["BerechnungDatumAb"]))
                NewText += "Berechnung ab " + ((DateTime)qryAmAnspruchsberechnung["BerechnungDatumAb"]).ToString("dd.MM.yyyy");

            rtfedtParams.Text = NewText;
        }

        private void SetEditChildren()
        {
            // Einstellen Editierbarkeit Gitter Kinder:
            // Bei einer neuen Anspruchsberechnung darf im Gitter Kinder nicht editiert werden,
            // weil der PrimaryKey "AmAnspruchsberechnungID" noch nicht definiert ist:

            colBerechnung.OptionsColumn.AllowEdit = CanEditActiveRow;
            colBerechtigt.OptionsColumn.AllowEdit = CanEditActiveRow;
            colRechtstitel.OptionsColumn.AllowEdit = CanEditActiveRow;
            colDatumBis.OptionsColumn.AllowEdit = CanEditActiveRow;

            if (CanEditActiveRow)
            {
                colBerechnung.AppearanceCell.BackColor = Color.AliceBlue;
                colBerechtigt.AppearanceCell.BackColor = Color.AliceBlue;
                colRechtstitel.AppearanceCell.BackColor = Color.AliceBlue;
                colDatumBis.AppearanceCell.BackColor = Color.AliceBlue;
                grvAnzahlKinder.Appearance.FocusedCell.BackColor = Color.AliceBlue;
            }
            else
            {
                colBerechnung.AppearanceCell.BackColor = Color.BlanchedAlmond;
                colBerechtigt.AppearanceCell.BackColor = Color.BlanchedAlmond;
                colRechtstitel.AppearanceCell.BackColor = Color.BlanchedAlmond;
                colDatumBis.AppearanceCell.BackColor = Color.BlanchedAlmond;
                grvAnzahlKinder.Appearance.FocusedCell.BackColor = Color.BlanchedAlmond;
            }
        }

        private void SetRowVal(string Sort, int PosNrID, int Kind, int FieldNr, decimal Wert )
        {
            // Setzt den Wert einer Zeile:
            string PosID = GetPosString(Sort, PosNrID, Kind);
            DataRow row = qryAbPosition.DataTable.Rows.Find(PosID);
            if (row != null)
            row["Wert" + FieldNr.ToString()] = Utils.RoundMoney(Wert,RoundingDecimals);
        }

        private void SetStatusToQuery()
        {
            // 25.09.2008 : sozheo : Zusätzlicher Status Altersbedingung
            bool stat = StatusSetzen();
            qryAmAnspruchsberechnung["BedingungKKBBErfuellt"] = stat;
            qryAmAnspruchsberechnung.RefreshDisplay();
        }

        private bool StatusSetzen()
        {
            if (BerechnungTyp_ALBV1_KKBB3 != 3) return true;
            bool Status = true;

            // Wenn Berechnungstype = Verheiratet oder eingetragene Partnerschaft,
            // dann muss das Arbeitspensum zwischen 100% - 150% liegen.
            edtStatusPensum.Text = "Anspruch OK";
            if (
                DBUtil.IsEmpty(qryAmAnspruchsberechnung["AmBerechnungTypCode"]) ||
                DBUtil.IsEmpty(qryAmAnspruchsberechnung["ArbeitspensumKKBBProz"]) ||
                (
                    (Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]) == 1 ||
                    Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]) == 3) &&
                    (Utils.ConvertToInt(qryAmAnspruchsberechnung["ArbeitspensumKKBBProz"]) < 100 ||
                    Utils.ConvertToInt(qryAmAnspruchsberechnung["ArbeitspensumKKBBProz"]) > 150)
                )
            )
            {
                edtStatusPensum.Text = "kein Anspruch";
                Status = false;
            }

            // Bei alleinstehenden oder mündigen jugentlichen muss das Arbeitspensum zwischen 0% - 50% liegen
            if (
                DBUtil.IsEmpty(qryAmAnspruchsberechnung["AmBerechnungTypCode"]) ||
                DBUtil.IsEmpty(qryAmAnspruchsberechnung["ArbeitspensumKKBBProz"]) ||
                (
                    (Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]) == 2 ||
                    Utils.ConvertToInt(qryAmAnspruchsberechnung["AmBerechnungTypCode"]) == 4) &&
                    (Utils.ConvertToInt(qryAmAnspruchsberechnung["ArbeitspensumKKBBProz"]) < 0 ||
                    Utils.ConvertToInt(qryAmAnspruchsberechnung["ArbeitspensumKKBBProz"]) > 50)
                )
            )
            {
                edtStatusPensum.Text = "kein Anspruch";
                Status = false;
            }

            // Bedingungen in den Grunddaten ->> Kinderbetreuung generell <= 2.5 Tage pro Woche
            edtStatusKinder.Text = "Anspruch OK";
            if (
                DBUtil.IsEmpty(qryAmAnspruchsberechnung["KinderbetreuungKKBBTgWoche"]) ||
                Utils.ConvertToDecimal(qryAmAnspruchsberechnung["KinderbetreuungKKBBTgWoche"]) > (Decimal)2.5
            )
            {
                edtStatusKinder.Text = "kein Anspruch";
                Status = false;
            }

            edtAltersBed.Text ="Anspruch OK";
            DateTime DatBerechgBis = DateTime.Today;
            bool UpperLimitFound = false;
            foreach (System.Data.DataRow row in qryKind.DataTable.Rows)
            if (Utils.ConvertToInt(row["BerechtigtCode"]) == 3) // KKBB berechtigt
            {
                if (!DBUtil.IsEmpty(row["DatumBis"]))
                {
                    DatBerechgBis = (DateTime)row["DatumBis"];
                    UpperLimitFound = true;
                }
                break;
            }

            if (!UpperLimitFound)
            {
                edtAltersBed.Text = "kein Anspruch";
                Status = false;
            }
            else if (DBUtil.IsEmpty(qryAmAnspruchsberechnung["BerechnungDatumAb"]))
            {
                edtAltersBed.Text = "kein Anspruch";
                Status = false;
            }
            else if ((DateTime)qryAmAnspruchsberechnung["BerechnungDatumAb"] > DatBerechgBis)
            {
                edtAltersBed.Text = "kein Anspruch";
                Status = false;
            }

            return Status;
        }

        #endregion

        #endregion
    }
}