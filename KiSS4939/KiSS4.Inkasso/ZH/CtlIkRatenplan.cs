#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Drawing;
using KiSS4.Common;
using KiSS4.DB;

namespace KiSS4.Inkasso.ZH
{
    public class CtlIkRatenplan : KiSS4.Gui.KissUserControl
    {
        #region Fields

        private int FaFallID = 0;

        // Letzte Bearbeitung
        // 01.06.2008 : sozheo : neu
        // ------------------------------------------------------------------------
        private int FaLeistungID = 0;
        private bool LeistungIstGeschlossen = false;
        private KiSS4.Gui.KissButton btnCalculate;
        private DevExpress.XtraGrid.Columns.GridColumn colBetrag;
        private DevExpress.XtraGrid.Columns.GridColumn colBezeichnung;
        private DevExpress.XtraGrid.Columns.GridColumn colFordDatum;
        private DevExpress.XtraGrid.Columns.GridColumn colFordGruppe;
        private DevExpress.XtraGrid.Columns.GridColumn colFordSelektiert;
        private DevExpress.XtraGrid.Columns.GridColumn colFordTyp;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrDatumBis;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrGueltigvon;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrMonatlicherBetrag;
        private DevExpress.XtraGrid.Columns.GridColumn colVerrechnungsArt;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissCalcEdit edtBetragProMonat;
        private KiSS4.Gui.KissTextEdit edtBezeichnung;
        private KiSS4.Gui.KissDateEdit edtDatumBis;
        private KiSS4.Gui.KissDateEdit edtDatumVon;
        private KiSS4.Gui.KissCalcEdit edtGrundforderung;
        private KiSS4.Gui.KissLookUpEdit edtRatenplanVereinbarung;
        private KiSS4.Gui.KissDateEdit edtVereinbarungVom;
        private KiSS4.Gui.KissGrid grdForderung;
        private KiSS4.Gui.KissGrid grdVerrechnung;
        private DevExpress.XtraGrid.Views.Grid.GridView gvwFordderung;
        private DevExpress.XtraGrid.Views.Grid.GridView gvwRatenplan;
        private KiSS4.Gui.KissLabel lblBemerkungen;
        private KiSS4.Gui.KissLabel lblBetragProMonat;
        private KiSS4.Gui.KissLabel lblBezeichnung;
        private KiSS4.Gui.KissLabel lblDatumVon;
        private KiSS4.Gui.KissLabel lblGrundforderung;
        private KiSS4.Gui.KissLabel lblGueltigBis;
        private KiSS4.Gui.KissLabel lblRatenplanVereinbarung;
        private KiSS4.Gui.KissLabel lblVereinbarung;
        private KiSS4.Gui.KissMemoEdit memBemerkungen;
        private KiSS4.DB.SqlQuery qryDatumCheck;
        private KiSS4.DB.SqlQuery qryForderung;

        public KiSS4.DB.SqlQuery qryRatenplan;

        #endregion

        #region Constructors

        public CtlIkRatenplan()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlIkRatenplan));
            this.grdVerrechnung = new KiSS4.Gui.KissGrid();
            this.edtVereinbarungVom = new KiSS4.Gui.KissDateEdit();
            this.edtGrundforderung = new KiSS4.Gui.KissCalcEdit();
            this.edtBetragProMonat = new KiSS4.Gui.KissCalcEdit();
            this.edtRatenplanVereinbarung = new KiSS4.Gui.KissLookUpEdit();
            this.edtDatumVon = new KiSS4.Gui.KissDateEdit();
            this.memBemerkungen = new KiSS4.Gui.KissMemoEdit();
            this.btnCalculate = new KiSS4.Gui.KissButton();
            this.edtDatumBis = new KiSS4.Gui.KissDateEdit();
            this.lblGrundforderung = new KiSS4.Gui.KissLabel();
            this.lblBetragProMonat = new KiSS4.Gui.KissLabel();
            this.lblDatumVon = new KiSS4.Gui.KissLabel();
            this.lblGueltigBis = new KiSS4.Gui.KissLabel();
            this.lblBemerkungen = new KiSS4.Gui.KissLabel();
            this.lblVereinbarung = new KiSS4.Gui.KissLabel();
            this.lblRatenplanVereinbarung = new KiSS4.Gui.KissLabel();
            this.grdForderung = new KiSS4.Gui.KissGrid();
            this.lblBezeichnung = new KiSS4.Gui.KissLabel();
            this.edtBezeichnung = new KiSS4.Gui.KissTextEdit();
            this.colBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBezeichnung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFordDatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFordGruppe = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFordSelektiert = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFordTyp = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrDatumBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrechnungsArt = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrGueltigvon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerrMonatlicherBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.gvwFordderung = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.gvwRatenplan = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.qryDatumCheck = new KiSS4.DB.SqlQuery(this.components);
            this.qryForderung = new KiSS4.DB.SqlQuery(this.components);
            this.qryRatenplan = new KiSS4.DB.SqlQuery(this.components);
            ((System.ComponentModel.ISupportInitialize)(this.grdVerrechnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVereinbarungVom.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtGrundforderung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBetragProMonat.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRatenplanVereinbarung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRatenplanVereinbarung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.memBemerkungen.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGrundforderung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetragProMonat)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumVon)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGueltigBis)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkungen)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVereinbarung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRatenplanVereinbarung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdForderung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBezeichnung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBezeichnung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwFordderung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwRatenplan)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryDatumCheck)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryForderung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryRatenplan)).BeginInit();
            this.SuspendLayout();
            //
            // grdVerrechnung
            //
            this.grdVerrechnung.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdVerrechnung.DataSource = this.qryRatenplan;
            this.grdVerrechnung.EmbeddedNavigator.Name = "";
            this.grdVerrechnung.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdVerrechnung.Location = new System.Drawing.Point(12, 12);
            this.grdVerrechnung.MainView = this.gvwRatenplan;
            this.grdVerrechnung.Name = "grdVerrechnung";
            this.grdVerrechnung.Size = new System.Drawing.Size(688, 106);
            this.grdVerrechnung.TabIndex = 0;
            this.grdVerrechnung.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
                        this.gvwRatenplan});
            //
            // edtVereinbarungVom
            //
            this.edtVereinbarungVom.DataMember = "VereinbarungVom";
            this.edtVereinbarungVom.DataSource = this.qryRatenplan;
            this.edtVereinbarungVom.EditValue = null;
            this.edtVereinbarungVom.Location = new System.Drawing.Point(118, 159);
            this.edtVereinbarungVom.Name = "edtVereinbarungVom";
            this.edtVereinbarungVom.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtVereinbarungVom.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtVereinbarungVom.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtVereinbarungVom.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtVereinbarungVom.Properties.Appearance.Options.UseBackColor = true;
            this.edtVereinbarungVom.Properties.Appearance.Options.UseBorderColor = true;
            this.edtVereinbarungVom.Properties.Appearance.Options.UseFont = true;
            this.edtVereinbarungVom.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            this.edtVereinbarungVom.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtVereinbarungVom.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3)});
            this.edtVereinbarungVom.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtVereinbarungVom.Properties.ShowToday = false;
            this.edtVereinbarungVom.Size = new System.Drawing.Size(100, 24);
            this.edtVereinbarungVom.TabIndex = 2;
            //
            // edtGrundforderung
            //
            this.edtGrundforderung.DataMember = "Gesamtbetrag";
            this.edtGrundforderung.DataSource = this.qryRatenplan;
            this.edtGrundforderung.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtGrundforderung.Location = new System.Drawing.Point(344, 221);
            this.edtGrundforderung.Name = "edtGrundforderung";
            this.edtGrundforderung.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtGrundforderung.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtGrundforderung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtGrundforderung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtGrundforderung.Properties.Appearance.Options.UseBackColor = true;
            this.edtGrundforderung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtGrundforderung.Properties.Appearance.Options.UseFont = true;
            this.edtGrundforderung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtGrundforderung.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtGrundforderung.Properties.DisplayFormat.FormatString = "n2";
            this.edtGrundforderung.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtGrundforderung.Properties.EditFormat.FormatString = "n2";
            this.edtGrundforderung.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtGrundforderung.Properties.Mask.EditMask = "n2";
            this.edtGrundforderung.Properties.ReadOnly = true;
            this.edtGrundforderung.Size = new System.Drawing.Size(100, 24);
            this.edtGrundforderung.TabIndex = 3;
            this.edtGrundforderung.Visible = false;
            //
            // edtBetragProMonat
            //
            this.edtBetragProMonat.DataMember = "BetragProMonat";
            this.edtBetragProMonat.DataSource = this.qryRatenplan;
            this.edtBetragProMonat.Location = new System.Drawing.Point(344, 191);
            this.edtBetragProMonat.Name = "edtBetragProMonat";
            this.edtBetragProMonat.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtBetragProMonat.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBetragProMonat.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBetragProMonat.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBetragProMonat.Properties.Appearance.Options.UseBackColor = true;
            this.edtBetragProMonat.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBetragProMonat.Properties.Appearance.Options.UseFont = true;
            this.edtBetragProMonat.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBetragProMonat.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBetragProMonat.Properties.DisplayFormat.FormatString = "n2";
            this.edtBetragProMonat.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtBetragProMonat.Properties.EditFormat.FormatString = "n2";
            this.edtBetragProMonat.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtBetragProMonat.Properties.Mask.EditMask = "n2";
            this.edtBetragProMonat.Size = new System.Drawing.Size(100, 24);
            this.edtBetragProMonat.TabIndex = 4;
            //
            // edtRatenplanVereinbarung
            //
            this.edtRatenplanVereinbarung.DataMember = "IkRatenplanVereinbarungCode";
            this.edtRatenplanVereinbarung.DataSource = this.qryRatenplan;
            this.edtRatenplanVereinbarung.Location = new System.Drawing.Point(344, 161);
            this.edtRatenplanVereinbarung.LOVName = "IkRatenplanVereinbarung";
            this.edtRatenplanVereinbarung.Name = "edtRatenplanVereinbarung";
            this.edtRatenplanVereinbarung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtRatenplanVereinbarung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtRatenplanVereinbarung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtRatenplanVereinbarung.Properties.Appearance.Options.UseBackColor = true;
            this.edtRatenplanVereinbarung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtRatenplanVereinbarung.Properties.Appearance.Options.UseFont = true;
            this.edtRatenplanVereinbarung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtRatenplanVereinbarung.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtRatenplanVereinbarung.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtRatenplanVereinbarung.Properties.NullText = "";
            this.edtRatenplanVereinbarung.Properties.ShowFooter = false;
            this.edtRatenplanVereinbarung.Properties.ShowHeader = false;
            this.edtRatenplanVereinbarung.Size = new System.Drawing.Size(279, 24);
            this.edtRatenplanVereinbarung.TabIndex = 5;
            //
            // edtDatumVon
            //
            this.edtDatumVon.DataMember = "DatumVon";
            this.edtDatumVon.DataSource = this.qryRatenplan;
            this.edtDatumVon.EditValue = null;
            this.edtDatumVon.Location = new System.Drawing.Point(118, 189);
            this.edtDatumVon.Name = "edtDatumVon";
            this.edtDatumVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtDatumVon.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumVon.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumVon.Properties.Appearance.Options.UseFont = true;
            this.edtDatumVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtDatumVon.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDatumVon.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtDatumVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumVon.Properties.DisplayFormat.FormatString = "MM.yyyy";
            this.edtDatumVon.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumVon.Properties.EditFormat.FormatString = "MM.yyyy";
            this.edtDatumVon.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumVon.Properties.Mask.EditMask = "MM.yyyy";
            this.edtDatumVon.Properties.ShowToday = false;
            this.edtDatumVon.Size = new System.Drawing.Size(100, 24);
            this.edtDatumVon.TabIndex = 6;
            this.edtDatumVon.Closed += new DevExpress.XtraEditors.Controls.ClosedEventHandler(this.edtDatumVon_Closed);
            //
            // memBemerkungen
            //
            this.memBemerkungen.DataMember = "Bemerkung";
            this.memBemerkungen.DataSource = this.qryRatenplan;
            this.memBemerkungen.Location = new System.Drawing.Point(118, 257);
            this.memBemerkungen.Name = "memBemerkungen";
            this.memBemerkungen.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.memBemerkungen.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.memBemerkungen.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.memBemerkungen.Properties.Appearance.Options.UseBackColor = true;
            this.memBemerkungen.Properties.Appearance.Options.UseBorderColor = true;
            this.memBemerkungen.Properties.Appearance.Options.UseFont = true;
            this.memBemerkungen.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.memBemerkungen.Size = new System.Drawing.Size(505, 57);
            this.memBemerkungen.TabIndex = 7;
            //
            // btnCalculate
            //
            this.btnCalculate.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnCalculate.Location = new System.Drawing.Point(541, 219);
            this.btnCalculate.Name = "btnCalculate";
            this.btnCalculate.Size = new System.Drawing.Size(82, 24);
            this.btnCalculate.TabIndex = 8;
            this.btnCalculate.Text = "berechnen";
            this.btnCalculate.UseCompatibleTextRendering = true;
            this.btnCalculate.UseVisualStyleBackColor = false;
            this.btnCalculate.Visible = false;
            //
            // edtDatumBis
            //
            this.edtDatumBis.DataMember = "DatumBis";
            this.edtDatumBis.DataSource = this.qryRatenplan;
            this.edtDatumBis.EditValue = null;
            this.edtDatumBis.Location = new System.Drawing.Point(118, 219);
            this.edtDatumBis.Name = "edtDatumBis";
            this.edtDatumBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtDatumBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumBis.Properties.Appearance.Options.UseFont = true;
            this.edtDatumBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtDatumBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtDatumBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtDatumBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumBis.Properties.DisplayFormat.FormatString = "MM.yyyy";
            this.edtDatumBis.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumBis.Properties.EditFormat.FormatString = "MM.yyyy";
            this.edtDatumBis.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.edtDatumBis.Properties.Mask.EditMask = "MM.yyyy";
            this.edtDatumBis.Properties.ShowToday = false;
            this.edtDatumBis.Size = new System.Drawing.Size(100, 24);
            this.edtDatumBis.TabIndex = 40;
            this.edtDatumBis.TabStop = false;
            this.edtDatumBis.Closed += new DevExpress.XtraEditors.Controls.ClosedEventHandler(this.edtDatumBis_Closed);
            //
            // lblGrundforderung
            //
            this.lblGrundforderung.Location = new System.Drawing.Point(228, 219);
            this.lblGrundforderung.Name = "lblGrundforderung";
            this.lblGrundforderung.Size = new System.Drawing.Size(77, 24);
            this.lblGrundforderung.TabIndex = 43;
            this.lblGrundforderung.Text = "Gesamtbetrag";
            this.lblGrundforderung.UseCompatibleTextRendering = true;
            this.lblGrundforderung.Visible = false;
            //
            // lblBetragProMonat
            //
            this.lblBetragProMonat.Location = new System.Drawing.Point(228, 191);
            this.lblBetragProMonat.Name = "lblBetragProMonat";
            this.lblBetragProMonat.Size = new System.Drawing.Size(110, 24);
            this.lblBetragProMonat.TabIndex = 44;
            this.lblBetragProMonat.Text = "Monatlicher Betrag";
            this.lblBetragProMonat.UseCompatibleTextRendering = true;
            //
            // lblDatumVon
            //
            this.lblDatumVon.Location = new System.Drawing.Point(12, 189);
            this.lblDatumVon.Name = "lblDatumVon";
            this.lblDatumVon.Size = new System.Drawing.Size(65, 24);
            this.lblDatumVon.TabIndex = 45;
            this.lblDatumVon.Text = "Dauer von";
            this.lblDatumVon.UseCompatibleTextRendering = true;
            //
            // lblGueltigBis
            //
            this.lblGueltigBis.Location = new System.Drawing.Point(12, 219);
            this.lblGueltigBis.Name = "lblGueltigBis";
            this.lblGueltigBis.Size = new System.Drawing.Size(63, 24);
            this.lblGueltigBis.TabIndex = 46;
            this.lblGueltigBis.Text = "Dauer  bis";
            this.lblGueltigBis.UseCompatibleTextRendering = true;
            //
            // lblBemerkungen
            //
            this.lblBemerkungen.Location = new System.Drawing.Point(12, 257);
            this.lblBemerkungen.Name = "lblBemerkungen";
            this.lblBemerkungen.Size = new System.Drawing.Size(100, 23);
            this.lblBemerkungen.TabIndex = 47;
            this.lblBemerkungen.Text = "Bemerkung, Info";
            this.lblBemerkungen.UseCompatibleTextRendering = true;
            //
            // lblVereinbarung
            //
            this.lblVereinbarung.Location = new System.Drawing.Point(12, 160);
            this.lblVereinbarung.Name = "lblVereinbarung";
            this.lblVereinbarung.Size = new System.Drawing.Size(100, 23);
            this.lblVereinbarung.TabIndex = 48;
            this.lblVereinbarung.Text = "Vereinbarung vom";
            this.lblVereinbarung.UseCompatibleTextRendering = true;
            //
            // lblRatenplanVereinbarung
            //
            this.lblRatenplanVereinbarung.Location = new System.Drawing.Point(228, 159);
            this.lblRatenplanVereinbarung.Name = "lblRatenplanVereinbarung";
            this.lblRatenplanVereinbarung.Size = new System.Drawing.Size(77, 24);
            this.lblRatenplanVereinbarung.TabIndex = 60;
            this.lblRatenplanVereinbarung.Text = "Vereinbarung";
            this.lblRatenplanVereinbarung.UseCompatibleTextRendering = true;
            //
            // grdForderung
            //
            this.grdForderung.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdForderung.DataSource = this.qryForderung;
            this.grdForderung.EmbeddedNavigator.Name = "";
            this.grdForderung.Location = new System.Drawing.Point(12, 320);
            this.grdForderung.MainView = this.gvwFordderung;
            this.grdForderung.Name = "grdForderung";
            this.grdForderung.Size = new System.Drawing.Size(688, 244);
            this.grdForderung.TabIndex = 61;
            this.grdForderung.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
                        this.gvwFordderung});
            //
            // lblBezeichnung
            //
            this.lblBezeichnung.Location = new System.Drawing.Point(12, 129);
            this.lblBezeichnung.Name = "lblBezeichnung";
            this.lblBezeichnung.Size = new System.Drawing.Size(100, 23);
            this.lblBezeichnung.TabIndex = 62;
            this.lblBezeichnung.Text = "Bezeichnung";
            this.lblBezeichnung.UseCompatibleTextRendering = true;
            //
            // edtBezeichnung
            //
            this.edtBezeichnung.DataMember = "Bezeichnung";
            this.edtBezeichnung.DataSource = this.qryRatenplan;
            this.edtBezeichnung.Location = new System.Drawing.Point(118, 129);
            this.edtBezeichnung.Name = "edtBezeichnung";
            this.edtBezeichnung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBezeichnung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBezeichnung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBezeichnung.Properties.Appearance.Options.UseBackColor = true;
            this.edtBezeichnung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBezeichnung.Properties.Appearance.Options.UseFont = true;
            this.edtBezeichnung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBezeichnung.Size = new System.Drawing.Size(505, 24);
            this.edtBezeichnung.TabIndex = 63;
            //
            // colBetrag
            //
            this.colBetrag.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colBetrag.AppearanceCell.Options.UseBackColor = true;
            this.colBetrag.AppearanceHeader.Options.UseTextOptions = true;
            this.colBetrag.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colBetrag.Caption = "Grundforderung";
            this.colBetrag.DisplayFormat.FormatString = "N2";
            this.colBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colBetrag.FieldName = "Betrag";
            this.colBetrag.Name = "colBetrag";
            this.colBetrag.OptionsColumn.AllowEdit = false;
            this.colBetrag.Visible = true;
            this.colBetrag.VisibleIndex = 4;
            this.colBetrag.Width = 110;
            //
            // colBezeichnung
            //
            this.colBezeichnung.Caption = "Bezeichnung";
            this.colBezeichnung.FieldName = "Bezeichnung";
            this.colBezeichnung.Name = "colBezeichnung";
            this.colBezeichnung.Visible = true;
            this.colBezeichnung.VisibleIndex = 0;
            this.colBezeichnung.Width = 182;
            //
            // colFordDatum
            //
            this.colFordDatum.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colFordDatum.AppearanceCell.Options.UseBackColor = true;
            this.colFordDatum.Caption = "Datum";
            this.colFordDatum.DisplayFormat.FormatString = "MM.yyyy";
            this.colFordDatum.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colFordDatum.FieldName = "Datum";
            this.colFordDatum.Name = "colFordDatum";
            this.colFordDatum.OptionsColumn.AllowEdit = false;
            this.colFordDatum.Visible = true;
            this.colFordDatum.VisibleIndex = 3;
            this.colFordDatum.Width = 83;
            //
            // colFordGruppe
            //
            this.colFordGruppe.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colFordGruppe.AppearanceCell.Options.UseBackColor = true;
            this.colFordGruppe.Caption = "Gruppe";
            this.colFordGruppe.FieldName = "Gruppe";
            this.colFordGruppe.Name = "colFordGruppe";
            this.colFordGruppe.OptionsColumn.AllowEdit = false;
            this.colFordGruppe.Visible = true;
            this.colFordGruppe.VisibleIndex = 1;
            this.colFordGruppe.Width = 180;
            //
            // colFordSelektiert
            //
            this.colFordSelektiert.AppearanceCell.BackColor = System.Drawing.Color.AliceBlue;
            this.colFordSelektiert.AppearanceCell.Options.UseBackColor = true;
            this.colFordSelektiert.Caption = "sel.";
            this.colFordSelektiert.FieldName = "Selektiert";
            this.colFordSelektiert.Name = "colFordSelektiert";
            this.colFordSelektiert.Visible = true;
            this.colFordSelektiert.VisibleIndex = 0;
            this.colFordSelektiert.Width = 44;
            //
            // colFordTyp
            //
            this.colFordTyp.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colFordTyp.AppearanceCell.Options.UseBackColor = true;
            this.colFordTyp.Caption = "Typ";
            this.colFordTyp.DisplayFormat.FormatString = "MM.yyyy";
            this.colFordTyp.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colFordTyp.FieldName = "Typ";
            this.colFordTyp.Name = "colFordTyp";
            this.colFordTyp.OptionsColumn.AllowEdit = false;
            this.colFordTyp.Visible = true;
            this.colFordTyp.VisibleIndex = 2;
            this.colFordTyp.Width = 230;
            //
            // colVerrDatumBis
            //
            this.colVerrDatumBis.Caption = "Dauer bis";
            this.colVerrDatumBis.DisplayFormat.FormatString = "MM.yyyy";
            this.colVerrDatumBis.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colVerrDatumBis.FieldName = "DatumBis";
            this.colVerrDatumBis.Name = "colVerrDatumBis";
            this.colVerrDatumBis.Visible = true;
            this.colVerrDatumBis.VisibleIndex = 3;
            this.colVerrDatumBis.Width = 73;
            //
            // colVerrechnungsArt
            //
            this.colVerrechnungsArt.Caption = "Verreinbarung";
            this.colVerrechnungsArt.FieldName = "IkRatenplanVereinbarungCode";
            this.colVerrechnungsArt.Name = "colVerrechnungsArt";
            this.colVerrechnungsArt.Visible = true;
            this.colVerrechnungsArt.VisibleIndex = 1;
            this.colVerrechnungsArt.Width = 227;
            //
            // colVerrGueltigvon
            //
            this.colVerrGueltigvon.Caption = "Dauer von";
            this.colVerrGueltigvon.DisplayFormat.FormatString = "MM.yyyy";
            this.colVerrGueltigvon.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colVerrGueltigvon.FieldName = "DatumVon";
            this.colVerrGueltigvon.Name = "colVerrGueltigvon";
            this.colVerrGueltigvon.Visible = true;
            this.colVerrGueltigvon.VisibleIndex = 2;
            this.colVerrGueltigvon.Width = 83;
            //
            // colVerrMonatlicherBetrag
            //
            this.colVerrMonatlicherBetrag.AppearanceHeader.Options.UseTextOptions = true;
            this.colVerrMonatlicherBetrag.AppearanceHeader.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Far;
            this.colVerrMonatlicherBetrag.Caption = "Monatl Betrag";
            this.colVerrMonatlicherBetrag.DisplayFormat.FormatString = "N2";
            this.colVerrMonatlicherBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colVerrMonatlicherBetrag.FieldName = "BetragProMonat";
            this.colVerrMonatlicherBetrag.Name = "colVerrMonatlicherBetrag";
            this.colVerrMonatlicherBetrag.OptionsFilter.AllowAutoFilter = false;
            this.colVerrMonatlicherBetrag.OptionsFilter.AllowFilter = false;
            this.colVerrMonatlicherBetrag.Visible = true;
            this.colVerrMonatlicherBetrag.VisibleIndex = 4;
            this.colVerrMonatlicherBetrag.Width = 92;
            //
            // gvwFordderung
            //
            this.gvwFordderung.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gvwFordderung.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwFordderung.Appearance.Empty.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.Empty.Options.UseFont = true;
            this.gvwFordderung.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.gvwFordderung.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwFordderung.Appearance.EvenRow.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.EvenRow.Options.UseFont = true;
            this.gvwFordderung.Appearance.FocusedCell.BackColor = System.Drawing.Color.AliceBlue;
            this.gvwFordderung.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwFordderung.Appearance.FocusedCell.ForeColor = System.Drawing.Color.Black;
            this.gvwFordderung.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.FocusedCell.Options.UseFont = true;
            this.gvwFordderung.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gvwFordderung.Appearance.FocusedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.gvwFordderung.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwFordderung.Appearance.FocusedRow.ForeColor = System.Drawing.Color.Black;
            this.gvwFordderung.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.FocusedRow.Options.UseFont = true;
            this.gvwFordderung.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gvwFordderung.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwFordderung.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwFordderung.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.gvwFordderung.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwFordderung.Appearance.GroupRow.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.GroupRow.Options.UseFont = true;
            this.gvwFordderung.Appearance.GroupRow.Options.UseForeColor = true;
            this.gvwFordderung.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gvwFordderung.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gvwFordderung.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.gvwFordderung.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gvwFordderung.Appearance.HeaderPanel.Options.UseFont = true;
            this.gvwFordderung.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.AliceBlue;
            this.gvwFordderung.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwFordderung.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwFordderung.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gvwFordderung.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gvwFordderung.Appearance.HorzLine.BackColor = System.Drawing.Color.LightGray;
            this.gvwFordderung.Appearance.HorzLine.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwFordderung.Appearance.OddRow.Options.UseFont = true;
            this.gvwFordderung.Appearance.Row.BackColor = System.Drawing.Color.AliceBlue;
            this.gvwFordderung.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwFordderung.Appearance.Row.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.Row.Options.UseFont = true;
            this.gvwFordderung.Appearance.SelectedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.gvwFordderung.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwFordderung.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.gvwFordderung.Appearance.SelectedRow.Options.UseBackColor = true;
            this.gvwFordderung.Appearance.SelectedRow.Options.UseFont = true;
            this.gvwFordderung.Appearance.SelectedRow.Options.UseForeColor = true;
            this.gvwFordderung.Appearance.VertLine.BackColor = System.Drawing.Color.LightGray;
            this.gvwFordderung.Appearance.VertLine.Options.UseBackColor = true;
            this.gvwFordderung.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gvwFordderung.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
                        this.colFordSelektiert,
                        this.colFordGruppe,
                        this.colFordTyp,
                        this.colFordDatum,
                        this.colBetrag});
            this.gvwFordderung.GridControl = this.grdForderung;
            this.gvwFordderung.GroupPanelText = "zu gruppierende Kolonnen in diesen Bereich ziehen";
            this.gvwFordderung.Name = "gvwFordderung";
            this.gvwFordderung.OptionsCustomization.AllowFilter = false;
            this.gvwFordderung.OptionsFilter.AllowFilterEditor = false;
            this.gvwFordderung.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gvwFordderung.OptionsMenu.EnableColumnMenu = false;
            this.gvwFordderung.OptionsNavigation.AutoFocusNewRow = true;
            this.gvwFordderung.OptionsView.ColumnAutoWidth = false;
            this.gvwFordderung.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gvwFordderung.OptionsView.ShowGroupPanel = false;
            //
            // gvwRatenplan
            //
            this.gvwRatenplan.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gvwRatenplan.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwRatenplan.Appearance.Empty.Options.UseBackColor = true;
            this.gvwRatenplan.Appearance.Empty.Options.UseFont = true;
            this.gvwRatenplan.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwRatenplan.Appearance.EvenRow.Options.UseFont = true;
            this.gvwRatenplan.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwRatenplan.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwRatenplan.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gvwRatenplan.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gvwRatenplan.Appearance.FocusedCell.Options.UseFont = true;
            this.gvwRatenplan.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gvwRatenplan.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gvwRatenplan.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwRatenplan.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gvwRatenplan.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gvwRatenplan.Appearance.FocusedRow.Options.UseFont = true;
            this.gvwRatenplan.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gvwRatenplan.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwRatenplan.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gvwRatenplan.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gvwRatenplan.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.gvwRatenplan.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwRatenplan.Appearance.GroupRow.Options.UseBackColor = true;
            this.gvwRatenplan.Appearance.GroupRow.Options.UseFont = true;
            this.gvwRatenplan.Appearance.GroupRow.Options.UseForeColor = true;
            this.gvwRatenplan.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gvwRatenplan.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gvwRatenplan.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.gvwRatenplan.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gvwRatenplan.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gvwRatenplan.Appearance.HeaderPanel.Options.UseFont = true;
            this.gvwRatenplan.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gvwRatenplan.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwRatenplan.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gvwRatenplan.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gvwRatenplan.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gvwRatenplan.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gvwRatenplan.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gvwRatenplan.Appearance.HorzLine.Options.UseBackColor = true;
            this.gvwRatenplan.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwRatenplan.Appearance.OddRow.Options.UseFont = true;
            this.gvwRatenplan.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gvwRatenplan.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwRatenplan.Appearance.Row.Options.UseBackColor = true;
            this.gvwRatenplan.Appearance.Row.Options.UseFont = true;
            this.gvwRatenplan.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gvwRatenplan.Appearance.SelectedRow.Options.UseFont = true;
            this.gvwRatenplan.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gvwRatenplan.Appearance.VertLine.Options.UseBackColor = true;
            this.gvwRatenplan.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gvwRatenplan.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
                        this.colBezeichnung,
                        this.colVerrechnungsArt,
                        this.colVerrGueltigvon,
                        this.colVerrDatumBis,
                        this.colVerrMonatlicherBetrag});
            this.gvwRatenplan.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gvwRatenplan.GridControl = this.grdVerrechnung;
            this.gvwRatenplan.GroupPanelText = "zu gruppierende Kolonnen in diesen Bereich ziehen";
            this.gvwRatenplan.Name = "gvwRatenplan";
            this.gvwRatenplan.OptionsBehavior.Editable = false;
            this.gvwRatenplan.OptionsCustomization.AllowFilter = false;
            this.gvwRatenplan.OptionsFilter.AllowFilterEditor = false;
            this.gvwRatenplan.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gvwRatenplan.OptionsMenu.EnableColumnMenu = false;
            this.gvwRatenplan.OptionsNavigation.AutoFocusNewRow = true;
            this.gvwRatenplan.OptionsNavigation.UseTabKey = false;
            this.gvwRatenplan.OptionsView.ColumnAutoWidth = false;
            this.gvwRatenplan.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gvwRatenplan.OptionsView.ShowGroupPanel = false;
            this.gvwRatenplan.OptionsView.ShowIndicator = false;
            this.gvwRatenplan.CustomDrawCell += new DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventHandler(this.gvwRatenplan_CustomDrawCell);
            //
            // qryDatumCheck
            //
            this.qryDatumCheck.HostControl = this;
            this.qryDatumCheck.SelectStatement = resources.GetString("qryDatumCheck.SelectStatement");
            //
            // qryForderung
            //
            this.qryForderung.BatchUpdate = true;
            this.qryForderung.CanUpdate = true;
            this.qryForderung.HostControl = this;
            this.qryForderung.SelectStatement = resources.GetString("qryForderung.SelectStatement");
            this.qryForderung.ColumnChanged += new System.Data.DataColumnChangeEventHandler(this.qryForderung_ColumnChanged);
            this.qryForderung.PositionChanging += new System.EventHandler(this.qryForderung_PositionChanging);
            //
            // qryRatenplan
            //
            this.qryRatenplan.CanDelete = true;
            this.qryRatenplan.CanInsert = true;
            this.qryRatenplan.CanUpdate = true;
            this.qryRatenplan.HostControl = this;
            this.qryRatenplan.SelectStatement = "select B.*\r\nfrom dbo.IkRatenplan B with(readuncommitted)\r\nwhere B.FaLeistungID = " +
                "{0}\r\norder by \r\n  B.VereinbarungVom desc";
            this.qryRatenplan.TableName = "IkRatenplan";
            this.qryRatenplan.AfterFill += new System.EventHandler(this.qryRatenplan_AfterFill);
            this.qryRatenplan.PositionChanged += new System.EventHandler(this.qryRatenplan_PositionChanged);
            this.qryRatenplan.BeforePost += new System.EventHandler(this.qryRatenplan_BeforePost);
            this.qryRatenplan.AfterPost += new System.EventHandler(this.qryRatenplan_AfterPost);
            this.qryRatenplan.AfterInsert += new System.EventHandler(this.qryRatenplan_AfterInsert);
            this.qryRatenplan.BeforeDelete += new System.EventHandler(this.qryRatenplan_BeforeDelete);
            this.qryRatenplan.PositionChanging += new System.EventHandler(this.qryRatenplan_PositionChanging);
            //
            // CtlIkRatenplan
            //
            this.ActiveSQLQuery = this.qryRatenplan;
            this.Controls.Add(this.edtBezeichnung);
            this.Controls.Add(this.lblBezeichnung);
            this.Controls.Add(this.grdForderung);
            this.Controls.Add(this.lblRatenplanVereinbarung);
            this.Controls.Add(this.lblVereinbarung);
            this.Controls.Add(this.lblBemerkungen);
            this.Controls.Add(this.lblGueltigBis);
            this.Controls.Add(this.lblDatumVon);
            this.Controls.Add(this.lblBetragProMonat);
            this.Controls.Add(this.lblGrundforderung);
            this.Controls.Add(this.edtDatumBis);
            this.Controls.Add(this.btnCalculate);
            this.Controls.Add(this.memBemerkungen);
            this.Controls.Add(this.edtDatumVon);
            this.Controls.Add(this.edtRatenplanVereinbarung);
            this.Controls.Add(this.edtBetragProMonat);
            this.Controls.Add(this.edtGrundforderung);
            this.Controls.Add(this.edtVereinbarungVom);
            this.Controls.Add(this.grdVerrechnung);
            this.Name = "CtlIkRatenplan";
            this.Size = new System.Drawing.Size(710, 580);
            this.AddData += new System.EventHandler(this.CtlIkRatenplan_AddData);
            this.DeleteData += new System.EventHandler(this.CtlIkRatenplan_DeleteData);
            this.SaveData += new System.EventHandler(this.CtlIkRatenplan_SaveData);
            this.UndoDataChanges += new System.EventHandler(this.CtlIkRatenplan_UndoDataChanges);
            ((System.ComponentModel.ISupportInitialize)(this.grdVerrechnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtVereinbarungVom.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtGrundforderung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBetragProMonat.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRatenplanVereinbarung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRatenplanVereinbarung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.memBemerkungen.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGrundforderung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetragProMonat)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumVon)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGueltigBis)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkungen)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVereinbarung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRatenplanVereinbarung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdForderung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBezeichnung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBezeichnung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwFordderung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gvwRatenplan)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryDatumCheck)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryForderung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryRatenplan)).EndInit();
            this.ResumeLayout(false);
        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Private Properties

        // Letzte Bearbeitung
        // 01.06.2008 : sozheo : neu
        // ------------------------------------------------------------------------
        // Wenn annuliert oder erledigt oder IstVonPscdVerwendet, darf nichts mehr verndert werden
        private bool CanEdit
        {
            get
              {
            return (
              qryRatenplan.CanUpdate &&
              qryRatenplan.Count>0 &&
              FaLeistungID > 0 &&
              !LeistungIstGeschlossen
            );
              }
        }

        private bool CanEditDetails
        {
            get
              {
            return (
              CanEdit &&
              qryForderung.Count>0
            );
              }
        }

        #endregion

        #region Public Methods

        public void Activate()
        {
            //if (GestartetVonRTitel)
              //  edtBaPersonID.Focus();
              //else
              edtVereinbarungVom.Focus();
        }

        public void Init(int LeistungID, int FallID, bool LeistgGeschlossen)
        {
            FaLeistungID = LeistungID;
              FaFallID = FallID;
              LeistungIstGeschlossen = LeistgGeschlossen;
              if (LeistungIstGeschlossen)
              {
            qryRatenplan.CanUpdate = false;
            qryRatenplan.CanInsert = false;
            qryRatenplan.CanDelete = false;
              }

              colVerrechnungsArt.ColumnEdit = grdVerrechnung.GetLOVLookUpEdit("IkRatenplanVereinbarung");

              qryRatenplan.Fill(FaLeistungID);
        }

        public void InitFromATree(int LeistungID, bool LeistgGeschlossen)
        {
            FaLeistungID = LeistungID;

              LeistungIstGeschlossen = LeistgGeschlossen;
              if (LeistungIstGeschlossen)
              {
            qryRatenplan.CanUpdate = false;
            qryRatenplan.CanInsert = false;
            qryRatenplan.CanDelete = false;
              }

              colVerrechnungsArt.ColumnEdit = grdVerrechnung.GetLOVLookUpEdit("IkRatenplanVereinbarung");

              qryRatenplan.Fill(FaLeistungID);
        }

        #endregion

        #region Private Methods

        /*
        private void SetCalculatedValues(object DatumVon, object DatumBis)
        {
          Decimal SummeGesamt = (Decimal)0.0;
          Decimal SummeMonat = (Decimal)0.0;
          int AnzahlMonate = 1;

          foreach (System.Data.DataRow row in qryForderung.DataTable.Rows)
          {
            if (Utils.ConvertToBool(row["Selektiert"],false))
            {
              if (Utils.ConvertToInt(row["Sortierung"])== 2)
              {
                SummeGesamt += Utils.ConvertToDecimal(row["Betrag"]);
              }
              else
              if (Utils.ConvertToInt(row["Sortierung"])== 3)
              {
                SummeGesamt += AnzahlMonate*Utils.ConvertToDecimal(row["Betrag"]);
                SummeMonat += Utils.ConvertToDecimal(row["Betrag"]);
              }
            }
          }

          qryRatenplan["GesamtBetrag"] = SummeGesamt;
          qryRatenplan["BetragProMonat"] = SummeMonat;
          qryRatenplan.RefreshDisplay();
        }
        */
        // Letzte Bearbeitung
        // 07.06.2008 : sozheo : neu
        // ------------------------------------------------------------------------
        private void CtlIkRatenplan_AddData(object sender, EventArgs e)
        {
            if (qryRatenplan.RowModified) if (!qryRatenplan.Post()) return;
              qryRatenplan.Insert();
        }

        private void CtlIkRatenplan_DeleteData(object sender, EventArgs e)
        {
            if (Utils.ConvertToInt(qryRatenplan["IkRatenplanID"]) == 0)
            CtlIkRatenplan_UndoDataChanges(sender, e);
              else
            qryRatenplan.Delete();
        }

        private void CtlIkRatenplan_SaveData(object sender, EventArgs e)
        {
            qryRatenplan.Post();
        }

        private void CtlIkRatenplan_UndoDataChanges(object sender, EventArgs e)
        {
            qryForderung.Cancel();
              qryRatenplan.Cancel();
              qryRatenplan.Refresh();
        }

        // Letzte Bearbeitung
        // 01.06.2008 : sozheo : neu
        // ------------------------------------------------------
        private void DetailsSpeichern()
        {
            if (qryForderung.Count == 0) return;

              //Decimal Guthaben = (Decimal)0.0;
              //Decimal Saldo = (Decimal)0.0;
              int RPlanID = Utils.ConvertToInt(qryRatenplan["IkRatenplanID"]);
              if (RPlanID == 0) return;

              foreach (System.Data.DataRow row in qryForderung.DataTable.Rows)
              {
            if (Utils.ConvertToBool(row["Selektiert"], false))
            {
              if (Utils.ConvertToInt(row["Sortierung"])== 2)
                DBUtil.ExecSQL(@"
                  IF NOT EXISTS(
                    SELECT IkRatenplanForderungID FROM dbo.IkRatenplanForderung
                    WHERE IkRatenplanID = {0} AND IkPositionID = {1})
                  INSERT INTO dbo.IkRatenplanForderung (IkRatenplanID, IkPositionID)
                  VALUES ({0}, {1})",
                  RPlanID,
                  Utils.ConvertToInt(row["ID"])
                );
              else
              if (Utils.ConvertToInt(row["Sortierung"])== 3)
                DBUtil.ExecSQL(@"
                  IF NOT EXISTS(
                    SELECT IkRatenplanForderungID FROM dbo.IkRatenplanForderung
                    WHERE IkRatenplanID = {0} AND IkForderungID = {1})
                  INSERT INTO dbo.IkRatenplanForderung (IkRatenplanID, IkForderungID)
                  VALUES ({0}, {1})",
                  RPlanID,
                  Utils.ConvertToInt(row["ID"])
                );
            }
            else
            {
              if (Utils.ConvertToInt(row["Sortierung"])== 2)
                DBUtil.ExecSQL(@"
                  DELETE dbo.IkRatenplanForderung
                  WHERE IkRatenplanID = {0} AND IkPositionID = {1}",
                  RPlanID,
                  Utils.ConvertToInt(row["ID"])
                );
              else
              if (Utils.ConvertToInt(row["Sortierung"])== 3)
                DBUtil.ExecSQL(@"
                  DELETE dbo.IkRatenplanForderung
                  WHERE IkRatenplanID = {0} AND IkForderungID = {1}",
                  RPlanID,
                  Utils.ConvertToInt(row["ID"])
                );
            }
              }
        }

        private void edtDatumBis_Closed(object sender, DevExpress.XtraEditors.Controls.ClosedEventArgs e)
        {
            if (e.CloseMode != DevExpress.XtraEditors.PopupCloseMode.Normal) return;
              qryRatenplan["DatumBis"] = edtDatumBis.EditValue;
              if (!DBUtil.IsEmpty(qryRatenplan["DatumBis"]))
            qryRatenplan["DatumBis"] = Utils.firstDayOfMonth((DateTime)qryRatenplan["DatumBis"]);
        }

        // Letzte Bearbeitung
        // 01.06.2008 : sozheo : neu
        // ------------------------------------------------------------------------
        private void edtDatumVon_Closed(object sender, DevExpress.XtraEditors.Controls.ClosedEventArgs e)
        {
            if (e.CloseMode != DevExpress.XtraEditors.PopupCloseMode.Normal) return;
              qryRatenplan["DatumVon"] = edtDatumVon.EditValue;
              qryRatenplan["DatumVon"] = Utils.firstDayOfMonth((DateTime)qryRatenplan["DatumVon"]);
        }

        // Letzte Bearbeitung
        // 16.09.2007 : sozheo : neu
        // ------------------------------------------------------------------------
        private void gvwRatenplan_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e)
        {
            e.Handled = false;

            /*
              if (gvwRatenplan.FocusedRowHandle == e.RowHandle) return;
              object erl = gvwRatenplan.GetRowCellValue(e.RowHandle, gvwRatenplan.Columns["IstErledigt"]);
              bool erledigt = (erl is bool) ? (bool)erl : false;
              object vwt = gvwRatenplan.GetRowCellValue(e.RowHandle, gvwRatenplan.Columns["IstVonPscdVerwendet"]);
              bool vonPSCDverwendet = (vwt is bool) ? (bool)vwt : false;
              object anu = gvwRatenplan.GetRowCellValue(e.RowHandle, gvwRatenplan.Columns["IstAnnulliert"]);
              bool annulliert = (anu is bool) ? (bool)anu : false;

              bool erledigt = false;
              if (erledigt)
            e.Appearance.BackColor = Color.LightSalmon;
              else
            e.Appearance.BackColor = Color.Bisque;

            */
        }

        private void qryForderung_ColumnChanged(object sender, System.Data.DataColumnChangeEventArgs e)
        {
            // Letzte Bearbeitung
            // 07.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------

            qryRatenplan.RowModified = true;
        }

        private void qryForderung_PositionChanging(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 01.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------

            if (qryForderung.RowModified) qryForderung.Post();
        }

        private void qryRatenplan_AfterFill(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 01.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------

            if (qryRatenplan.Count==0) qryRatenplan_PositionChanged(sender, e);
        }

        private void qryRatenplan_AfterInsert(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 01.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------

            qryRatenplan["FaLeistungID"] = FaLeistungID;
            qryRatenplan["VereinbarungVom"] = DateTime.Today;
            qryRatenplan["DatumVon"] = Utils.firstDayOfMonth(DateTime.Today);
            //qryRatenplan["DatumBis"] = Utils.lastDayOfMonth(DateTime.Today);

            //if (GestartetVonRTitel)
            //  edtBaPersonID.Focus();
            //else
            edtVereinbarungVom.Focus();
        }

        private void qryRatenplan_AfterPost(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 01.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------

            DetailsSpeichern();
            qryRatenplan_PositionChanged(sender, e);
        }

        private void qryRatenplan_BeforeDelete(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 01.06.2008 : sozheo : neu
            // ------------------------------------------------------

            int RPlanID = Utils.ConvertToInt(qryRatenplan["IkRatenplanID"]);
            if (RPlanID == 0) return;

            DBUtil.ExecSQL(@"
              DELETE dbo.IkRatenplanForderung
              WHERE IkRatenplanID = {0}",
              RPlanID
            );
        }

        private void qryRatenplan_BeforePost(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 01.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------

            DBUtil.CheckNotNullField(edtBezeichnung, lblBezeichnung.Text);
            DBUtil.CheckNotNullField(edtDatumVon, lblDatumVon.Text);

            DBUtil.CheckNotNullField(edtBetragProMonat, lblBetragProMonat.Text);
            if (Utils.ConvertToDecimal(qryRatenplan["BetragProMonat"])<=0)
            {
              KissMsg.ShowInfo("Der monatliche Betrag muss grsser als 0 sein.");
              throw new KissCancelException();
            }

            if (qryForderung.RowModified) qryForderung.Post();

            qryRatenplan["DatumVon"] = Utils.firstDayOfMonth((DateTime)qryRatenplan["DatumVon"]);
            if (!DBUtil.IsEmpty(qryRatenplan["DatumBis"]))
            {
              qryRatenplan["DatumBis"] = Utils.firstDayOfMonth((DateTime)qryRatenplan["DatumBis"]);
              if ((DateTime)qryRatenplan["DatumVon"] > (DateTime)qryRatenplan["DatumBis"])
              {
                KissMsg.ShowInfo("Das Datum-Von darf nicht grsser als das Datum-Bis sein.");
                throw new KissCancelException();
              }
            }

            qryDatumCheck.Fill(
              Utils.ConvertToInt(qryRatenplan["FaLeistungID"]),
              Utils.ConvertToInt(qryRatenplan["IkRatenplanID"]),
              qryRatenplan["DatumVon"],
              qryRatenplan["DatumBis"]
            );
            if (Utils.ConvertToBool(qryDatumCheck["HatUeberschneidung"], false))
            {
              KissMsg.ShowInfo("Die Ratenplne drfen sich zeitlich nicht berschneiden.");
              throw new KissCancelException();
            }
        }

        private void qryRatenplan_PositionChanged(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 01.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------

            qryRatenplan.EnableBoundFields(CanEdit);

            qryForderung.Fill(FaLeistungID, Utils.ConvertToInt(qryRatenplan["IkRatenplanID"]), qryRatenplan.Count);

            colFordSelektiert.OptionsColumn.AllowEdit = CanEditDetails;
            colFordSelektiert.AppearanceCell.BackColor = CanEditDetails ? Color.AliceBlue : Color.BlanchedAlmond;
        }

        private void qryRatenplan_PositionChanging(object sender, System.EventArgs e)
        {
            // Letzte Bearbeitung
            // 01.06.2008 : sozheo : neu
            // ------------------------------------------------------------------------

            if (qryForderung.RowModified) qryForderung.Post();
        }

        #endregion
    }
}