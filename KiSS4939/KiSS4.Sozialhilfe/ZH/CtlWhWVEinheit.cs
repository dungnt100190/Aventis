#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.832
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Windows.Forms;
using KiSS4.Common.ZH;
using KiSS4.DB;

namespace KiSS4.Sozialhilfe.ZH
{
    public class CtlWhWVEinheit : KiSS4.Gui.KissUserControl
    {
        #region Fields

        private KiSS4.Gui.KissButton btnAendern;
        private KiSS4.Gui.KissButton btnUngueltig;
        private DevExpress.XtraGrid.Columns.GridColumn colBEDebitor;
        private DevExpress.XtraGrid.Columns.GridColumn colBuchungCount;
        private DevExpress.XtraGrid.Columns.GridColumn colBuchungen;
        private DevExpress.XtraGrid.Columns.GridColumn colDatumBis;
        private DevExpress.XtraGrid.Columns.GridColumn colDatumVon;
        private DevExpress.XtraGrid.Columns.GridColumn colGebDatum;
        private DevExpress.XtraGrid.Columns.GridColumn colPerson;
        private DevExpress.XtraGrid.Columns.GridColumn colPersonMitglied;
        private DevExpress.XtraGrid.Columns.GridColumn colStatus;
        private DevExpress.XtraGrid.Columns.GridColumn colUT;
        private DevExpress.XtraGrid.Columns.GridColumn colWVCode;
        private System.ComponentModel.IContainer components = null;
        private KiSS4.Gui.KissDateEdit datBis;
        private KiSS4.Gui.KissDateEdit datVon;
        private KiSS4.Gui.KissLookUpEdit ddlBED;
        private KiSS4.Gui.KissLookUpEdit ddlWVCode;
        private KiSS4.Gui.KissLookUpEdit edtBaPersonID;
        private KiSS4.Gui.KissTextEdit edtHeimatkantonNr;
        private KiSS4.Gui.KissDateEdit edtRekurs;
        private KiSS4.Gui.KissCalcEdit edtSKZNummer;
        private KiSS4.Gui.KissCheckEdit edtUngueltig;
        private bool einheitUngueltig;
        private int faFallID;
        private KiSS4.Gui.KissGrid grdWVEinheit;
        private KiSS4.Gui.KissGrid grdWVMitglied;
        private DevExpress.XtraGrid.Views.Grid.GridView grvMitglieder;
        private DevExpress.XtraGrid.Views.Grid.GridView grvWVEinheit;
        private System.Windows.Forms.PictureBox imgTitel;
        private KiSS4.Gui.KissLabel lblBED;
        private KiSS4.Gui.KissLabel lblBis;
        private KiSS4.Gui.KissLabel lblGueltigVon;
        private KiSS4.Gui.KissLabel lblHeimatkanton;
        private KiSS4.Gui.KissLabel lblRekurs;
        private KiSS4.Gui.KissLabel lblSKZNummer;
        private KiSS4.Gui.KissLabel lblTitel;
        private KiSS4.Gui.KissLabel lblVerfahren;
        private KiSS4.Gui.KissLabel lblWVCode;
        private KiSS4.Gui.KissLabel lblWVTraeger;
        private System.Windows.Forms.Panel pnTitle;
        private System.Windows.Forms.Panel pnlFill;
        private KiSS4.DB.SqlQuery qryBaWVCode;
        private KiSS4.DB.SqlQuery qryBaWVCodeUngueltig;
        private KiSS4.DB.SqlQuery qryWVEinheit;
        private KiSS4.DB.SqlQuery qryWVMitglied;
        private DevExpress.XtraEditors.Repository.RepositoryItemGridLookUpEdit repositoryItemGridLookUpEdit1;
        private DevExpress.XtraGrid.Views.Grid.GridView repositoryItemGridLookUpEdit1View;
        private KiSS4.Common.ZH.CtlTimeline timeline;
        private KiSS4.Gui.KissDateEdit edtRekursAbgeschlossen;
        private KiSS4.Gui.KissLabel lblRekursAbgeschlossenMutiert;
        private KiSS4.Gui.KissLabel lblRekursMutiert;

        bool wvTraegerChanged = false;
        private KiSS4.Gui.KissLabel lblRekursAbgeschlossenMutiertCaption;
        private KiSS4.Gui.KissLabel lblRekursMutiertCaption;
        ToolTip toolTip;
        private DevExpress.XtraGrid.Columns.GridColumn colFaFallID;
        private DevExpress.XtraGrid.Columns.GridColumn colFinanzplanIDs;
        bool userMayEditRekurs;

        #endregion

        #region Constructors

        public CtlWhWVEinheit(Image TitleImage, string TitelText, int faFallID)
            : this()
        {
            this.grdWVEinheit.LostFocus += grdWVEinheit_LostFocus;
            this.qryWVEinheit.PostCompleted += qryWVEinheit_PostCompleted;

            this.imgTitel.Image = TitleImage;
            this.lblTitel.Text = TitelText;

            this.faFallID = faFallID;

            qryWVEinheit.Fill(faFallID);
            qryBaWVCode.Fill(faFallID);
            qryBaWVCodeUngueltig.Fill(faFallID);
            if (qryWVEinheit.Count > 0)
            {
                this.qryWVMitglied.Fill(qryWVEinheit["WhWVEinheitID"]);
                this.edtBaPersonID.Properties.DataSource = this.qryWVMitglied;
                this.grdWVMitglied.DataSource = this.qryWVMitglied;
            }
            SetColors();
            FillTimeline();
        }

        public CtlWhWVEinheit()
        {
            this.InitializeComponent();
            toolTip = new ToolTip();

            ddlWVCode.Properties.DataSource = DBUtil.OpenSQL(@"
                select  Code,
                    Text = Shorttext + '  ' + Text
                from    XLOVCode
                where   LOVName = 'BaWVCode'");

            ddlBED.Properties.DataSource = DBUtil.OpenSQL(@"
                select  Code,
                    Text = CAST( Code AS varchar ) + ',  ' + Text
                from    XLOVCode
                where   LOVName = 'BaBED'");

            colWVCode.ColumnEdit = grdWVEinheit.GetLOVLookUpEdit(DBUtil.OpenSQL(@"
                select  Code,
                    Text = Shorttext
                    from    XLOVCode
                    where   LOVName = 'BaWVCode'"));

            colBEDebitor.ColumnEdit = grdWVEinheit.GetLOVLookUpEdit("BaBED");

            userMayEditRekurs = DBUtil.UserHasRight("CtlWhWVEinheit_RekursBewirtschaften");
            SetEditMode();

            bool userHasButtonRights = DBUtil.UserHasRight("CtlWhWVEinheit_ManuelleEingriffe");
            btnAendern.Visible = userHasButtonRights;
            btnUngueltig.Visible = userHasButtonRights;
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlWhWVEinheit));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject5 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject6 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject7 = new DevExpress.Utils.SerializableAppearanceObject();
            this.components = new System.ComponentModel.Container();
            this.pnTitle = new System.Windows.Forms.Panel();
            this.lblTitel = new KiSS4.Gui.KissLabel();
            this.imgTitel = new System.Windows.Forms.PictureBox();
            this.edtUngueltig = new KiSS4.Gui.KissCheckEdit();
            this.btnAendern = new KiSS4.Gui.KissButton();
            this.timeline = new KiSS4.Common.ZH.CtlTimeline();
            this.pnlFill = new System.Windows.Forms.Panel();
            this.lblRekursAbgeschlossenMutiertCaption = new KiSS4.Gui.KissLabel();
            this.lblRekursMutiertCaption = new KiSS4.Gui.KissLabel();
            this.lblRekursAbgeschlossenMutiert = new KiSS4.Gui.KissLabel();
            this.lblRekursMutiert = new KiSS4.Gui.KissLabel();
            this.lblHeimatkanton = new KiSS4.Gui.KissLabel();
            this.lblSKZNummer = new KiSS4.Gui.KissLabel();
            this.lblVerfahren = new KiSS4.Gui.KissLabel();
            this.lblRekurs = new KiSS4.Gui.KissLabel();
            this.grdWVMitglied = new KiSS4.Gui.KissGrid();
            this.grvMitglieder = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colPersonMitglied = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBuchungCount = new DevExpress.XtraGrid.Columns.GridColumn();
            this.lblWVTraeger = new KiSS4.Gui.KissLabel();
            this.lblBED = new KiSS4.Gui.KissLabel();
            this.lblBis = new KiSS4.Gui.KissLabel();
            this.lblGueltigVon = new KiSS4.Gui.KissLabel();
            this.lblWVCode = new KiSS4.Gui.KissLabel();
            this.edtBaPersonID = new KiSS4.Gui.KissLookUpEdit();
            this.qryWVEinheit = new KiSS4.DB.SqlQuery();
            this.edtRekursAbgeschlossen = new KiSS4.Gui.KissDateEdit();
            this.edtRekurs = new KiSS4.Gui.KissDateEdit();
            this.edtHeimatkantonNr = new KiSS4.Gui.KissTextEdit();
            this.edtSKZNummer = new KiSS4.Gui.KissCalcEdit();
            this.ddlBED = new KiSS4.Gui.KissLookUpEdit();
            this.ddlWVCode = new KiSS4.Gui.KissLookUpEdit();
            this.btnUngueltig = new KiSS4.Gui.KissButton();
            this.datBis = new KiSS4.Gui.KissDateEdit();
            this.datVon = new KiSS4.Gui.KissDateEdit();
            this.grdWVEinheit = new KiSS4.Gui.KissGrid();
            this.grvWVEinheit = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colFaFallID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFinanzplanIDs = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDatumVon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDatumBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colWVCode = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBEDebitor = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBuchungen = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colUT = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colPerson = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colGebDatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colStatus = new DevExpress.XtraGrid.Columns.GridColumn();
            this.repositoryItemGridLookUpEdit1 = new DevExpress.XtraEditors.Repository.RepositoryItemGridLookUpEdit();
            this.repositoryItemGridLookUpEdit1View = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.qryBaWVCode = new KiSS4.DB.SqlQuery();
            this.qryBaWVCodeUngueltig = new KiSS4.DB.SqlQuery();
            this.qryWVMitglied = new KiSS4.DB.SqlQuery();
            this.pnTitle.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.imgTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtUngueltig.Properties)).BeginInit();
            this.pnlFill.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblRekursAbgeschlossenMutiertCaption)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRekursMutiertCaption)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRekursAbgeschlossenMutiert)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRekursMutiert)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblHeimatkanton)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSKZNummer)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVerfahren)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRekurs)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdWVMitglied)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvMitglieder)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblWVTraeger)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBED)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBis)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGueltigVon)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblWVCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryWVEinheit)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRekursAbgeschlossen.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRekurs.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtHeimatkantonNr.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSKZNummer.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.ddlBED)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.ddlBED.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.ddlWVCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.ddlWVCode.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.datBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.datVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdWVEinheit)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvWVEinheit)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemGridLookUpEdit1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemGridLookUpEdit1View)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBaWVCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBaWVCodeUngueltig)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryWVMitglied)).BeginInit();
            this.SuspendLayout();
            // 
            // pnTitle
            // 
            this.pnTitle.Controls.Add(this.lblTitel);
            this.pnTitle.Controls.Add(this.imgTitel);
            this.pnTitle.Controls.Add(this.edtUngueltig);
            this.pnTitle.Controls.Add(this.btnAendern);
            this.pnTitle.Dock = System.Windows.Forms.DockStyle.Top;
            this.pnTitle.Location = new System.Drawing.Point(0, 0);
            this.pnTitle.Name = "pnTitle";
            this.pnTitle.Size = new System.Drawing.Size(1072, 40);
            this.pnTitle.TabIndex = 0;
            // 
            // lblTitel
            // 
            this.lblTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitel.Location = new System.Drawing.Point(35, 10);
            this.lblTitel.Name = "lblTitel";
            this.lblTitel.Size = new System.Drawing.Size(107, 20);
            this.lblTitel.TabIndex = 1;
            this.lblTitel.Text = "WhWVEinheit";
            this.lblTitel.UseCompatibleTextRendering = true;
            // 
            // imgTitel
            // 
            this.imgTitel.Location = new System.Drawing.Point(10, 9);
            this.imgTitel.Name = "imgTitel";
            this.imgTitel.Size = new System.Drawing.Size(25, 20);
            this.imgTitel.TabIndex = 1;
            this.imgTitel.TabStop = false;
            // 
            // edtUngueltig
            // 
            this.edtUngueltig.EditValue = true;
            this.edtUngueltig.Location = new System.Drawing.Point(306, 11);
            this.edtUngueltig.Name = "edtUngueltig";
            this.edtUngueltig.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtUngueltig.Properties.Appearance.Options.UseBackColor = true;
            this.edtUngueltig.Properties.Caption = "Ungültige anzeigen";
            this.edtUngueltig.Size = new System.Drawing.Size(122, 19);
            this.edtUngueltig.TabIndex = 1;
            this.edtUngueltig.EditValueChanged += new System.EventHandler(this.edtUngueltig_EditValueChanged);
            // 
            // btnAendern
            // 
            this.btnAendern.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnAendern.Location = new System.Drawing.Point(148, 8);
            this.btnAendern.Name = "btnAendern";
            this.btnAendern.Size = new System.Drawing.Size(152, 24);
            this.btnAendern.TabIndex = 0;
            this.btnAendern.Text = "Einheiten anpassen";
            this.btnAendern.UseCompatibleTextRendering = true;
            this.btnAendern.UseVisualStyleBackColor = false;
            this.btnAendern.Click += new System.EventHandler(this.btnAendern_Click);
            // 
            // timeline
            // 
            this.timeline.BackColor = System.Drawing.Color.Transparent;
            this.timeline.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
            this.timeline.Dock = System.Windows.Forms.DockStyle.Top;
            this.timeline.FromDate = new System.DateTime(2008, 1, 19, 0, 0, 0, 0);
            this.timeline.Location = new System.Drawing.Point(0, 40);
            this.timeline.Name = "timeline";
            this.timeline.ShowToday = true;
            this.timeline.Size = new System.Drawing.Size(1072, 25);
            this.timeline.TabIndex = 1;
            this.timeline.ToDate = new System.DateTime(2008, 1, 20, 0, 0, 0, 0);
            this.timeline.Visible = false;
            // 
            // pnlFill
            // 
            this.pnlFill.Controls.Add(this.lblRekursAbgeschlossenMutiertCaption);
            this.pnlFill.Controls.Add(this.lblRekursMutiertCaption);
            this.pnlFill.Controls.Add(this.lblRekursAbgeschlossenMutiert);
            this.pnlFill.Controls.Add(this.lblRekursMutiert);
            this.pnlFill.Controls.Add(this.lblHeimatkanton);
            this.pnlFill.Controls.Add(this.lblSKZNummer);
            this.pnlFill.Controls.Add(this.lblVerfahren);
            this.pnlFill.Controls.Add(this.lblRekurs);
            this.pnlFill.Controls.Add(this.grdWVMitglied);
            this.pnlFill.Controls.Add(this.lblWVTraeger);
            this.pnlFill.Controls.Add(this.lblBED);
            this.pnlFill.Controls.Add(this.lblBis);
            this.pnlFill.Controls.Add(this.lblGueltigVon);
            this.pnlFill.Controls.Add(this.lblWVCode);
            this.pnlFill.Controls.Add(this.edtBaPersonID);
            this.pnlFill.Controls.Add(this.edtRekursAbgeschlossen);
            this.pnlFill.Controls.Add(this.edtRekurs);
            this.pnlFill.Controls.Add(this.edtHeimatkantonNr);
            this.pnlFill.Controls.Add(this.edtSKZNummer);
            this.pnlFill.Controls.Add(this.ddlBED);
            this.pnlFill.Controls.Add(this.ddlWVCode);
            this.pnlFill.Controls.Add(this.btnUngueltig);
            this.pnlFill.Controls.Add(this.datBis);
            this.pnlFill.Controls.Add(this.datVon);
            this.pnlFill.Controls.Add(this.grdWVEinheit);
            this.pnlFill.Dock = System.Windows.Forms.DockStyle.Fill;
            this.pnlFill.Location = new System.Drawing.Point(0, 65);
            this.pnlFill.Name = "pnlFill";
            this.pnlFill.Size = new System.Drawing.Size(1072, 627);
            this.pnlFill.TabIndex = 2;
            // 
            // lblRekursAbgeschlossenMutiertCaption
            // 
            this.lblRekursAbgeschlossenMutiertCaption.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblRekursAbgeschlossenMutiertCaption.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.lblRekursAbgeschlossenMutiertCaption.LabelStyle = KiSS4.Gui.LabelStyleType.Custom;
            this.lblRekursAbgeschlossenMutiertCaption.Location = new System.Drawing.Point(213, 593);
            this.lblRekursAbgeschlossenMutiertCaption.Name = "lblRekursAbgeschlossenMutiertCaption";
            this.lblRekursAbgeschlossenMutiertCaption.Size = new System.Drawing.Size(48, 18);
            this.lblRekursAbgeschlossenMutiertCaption.TabIndex = 135;
            this.lblRekursAbgeschlossenMutiertCaption.Text = "Mutation";
            this.lblRekursAbgeschlossenMutiertCaption.UseCompatibleTextRendering = true;
            // 
            // lblRekursMutiertCaption
            // 
            this.lblRekursMutiertCaption.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblRekursMutiertCaption.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.lblRekursMutiertCaption.LabelStyle = KiSS4.Gui.LabelStyleType.Custom;
            this.lblRekursMutiertCaption.Location = new System.Drawing.Point(213, 563);
            this.lblRekursMutiertCaption.Name = "lblRekursMutiertCaption";
            this.lblRekursMutiertCaption.Size = new System.Drawing.Size(48, 18);
            this.lblRekursMutiertCaption.TabIndex = 135;
            this.lblRekursMutiertCaption.Text = "Mutation";
            this.lblRekursMutiertCaption.UseCompatibleTextRendering = true;
            // 
            // lblRekursAbgeschlossenMutiert
            // 
            this.lblRekursAbgeschlossenMutiert.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblRekursAbgeschlossenMutiert.LabelStyle = KiSS4.Gui.LabelStyleType.DataView;
            this.lblRekursAbgeschlossenMutiert.Location = new System.Drawing.Point(261, 593);
            this.lblRekursAbgeschlossenMutiert.Name = "lblRekursAbgeschlossenMutiert";
            this.lblRekursAbgeschlossenMutiert.Size = new System.Drawing.Size(144, 18);
            this.lblRekursAbgeschlossenMutiert.TabIndex = 134;
            this.lblRekursAbgeschlossenMutiert.Text = "";
            this.lblRekursAbgeschlossenMutiert.UseCompatibleTextRendering = true;
            // 
            // lblRekursMutiert
            // 
            this.lblRekursMutiert.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblRekursMutiert.LabelStyle = KiSS4.Gui.LabelStyleType.DataView;
            this.lblRekursMutiert.Location = new System.Drawing.Point(261, 563);
            this.lblRekursMutiert.Name = "lblRekursMutiert";
            this.lblRekursMutiert.Size = new System.Drawing.Size(144, 18);
            this.lblRekursMutiert.TabIndex = 133;
            this.lblRekursMutiert.Text = "";
            this.lblRekursMutiert.UseCompatibleTextRendering = true;
            // 
            // lblHeimatkanton
            // 
            this.lblHeimatkanton.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblHeimatkanton.Location = new System.Drawing.Point(213, 529);
            this.lblHeimatkanton.Name = "lblHeimatkanton";
            this.lblHeimatkanton.Size = new System.Drawing.Size(88, 24);
            this.lblHeimatkanton.TabIndex = 128;
            this.lblHeimatkanton.Text = "Heimatkanton Nr";
            this.lblHeimatkanton.UseCompatibleTextRendering = true;
            // 
            // lblSKZNummer
            // 
            this.lblSKZNummer.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblSKZNummer.Location = new System.Drawing.Point(4, 529);
            this.lblSKZNummer.Name = "lblSKZNummer";
            this.lblSKZNummer.Size = new System.Drawing.Size(79, 24);
            this.lblSKZNummer.TabIndex = 126;
            this.lblSKZNummer.Text = "KSA-Nummer";
            this.lblSKZNummer.UseCompatibleTextRendering = true;
            // 
            // lblVerfahren
            // 
            this.lblVerfahren.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblVerfahren.LabelStyle = KiSS4.Gui.LabelStyleType.DataViewLabel;
            this.lblVerfahren.Location = new System.Drawing.Point(4, 585);
            this.lblVerfahren.Name = "lblVerfahren";
            this.lblVerfahren.Size = new System.Drawing.Size(92, 30);
            this.lblVerfahren.TabIndex = 124;
            this.lblVerfahren.Text = "Rekurs\r\nabgeschlossen";
            this.lblVerfahren.UseCompatibleTextRendering = true;
            // 
            // lblRekurs
            // 
            this.lblRekurs.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblRekurs.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.lblRekurs.LabelStyle = KiSS4.Gui.LabelStyleType.Custom;
            this.lblRekurs.Location = new System.Drawing.Point(3, 559);
            this.lblRekurs.Name = "lblRekurs";
            this.lblRekurs.Size = new System.Drawing.Size(93, 24);
            this.lblRekurs.TabIndex = 122;
            this.lblRekurs.Text = "Rekurshängiges Verfahren";
            this.lblRekurs.UseCompatibleTextRendering = true;
            // 
            // grdWVMitglied
            // 
            this.grdWVMitglied.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            // 
            // 
            // 
            this.grdWVMitglied.EmbeddedNavigator.Name = "";
            this.grdWVMitglied.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdWVMitglied.Location = new System.Drawing.Point(445, 470);
            this.grdWVMitglied.MainView = this.grvMitglieder;
            this.grdWVMitglied.Name = "grdWVMitglied";
            this.grdWVMitglied.Size = new System.Drawing.Size(391, 143);
            this.grdWVMitglied.TabIndex = 118;
            this.grdWVMitglied.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvMitglieder});
            // 
            // grvMitglieder
            // 
            this.grvMitglieder.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvMitglieder.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvMitglieder.Appearance.Empty.Options.UseBackColor = true;
            this.grvMitglieder.Appearance.Empty.Options.UseFont = true;
            this.grvMitglieder.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvMitglieder.Appearance.EvenRow.Options.UseFont = true;
            this.grvMitglieder.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvMitglieder.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvMitglieder.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvMitglieder.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvMitglieder.Appearance.FocusedCell.Options.UseFont = true;
            this.grvMitglieder.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvMitglieder.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvMitglieder.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvMitglieder.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvMitglieder.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvMitglieder.Appearance.FocusedRow.Options.UseFont = true;
            this.grvMitglieder.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvMitglieder.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvMitglieder.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvMitglieder.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvMitglieder.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvMitglieder.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvMitglieder.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvMitglieder.Appearance.GroupRow.Options.UseFont = true;
            this.grvMitglieder.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvMitglieder.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvMitglieder.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvMitglieder.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvMitglieder.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvMitglieder.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvMitglieder.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvMitglieder.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvMitglieder.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvMitglieder.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvMitglieder.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvMitglieder.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvMitglieder.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvMitglieder.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvMitglieder.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvMitglieder.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvMitglieder.Appearance.OddRow.Options.UseFont = true;
            this.grvMitglieder.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvMitglieder.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvMitglieder.Appearance.Row.Options.UseBackColor = true;
            this.grvMitglieder.Appearance.Row.Options.UseFont = true;
            this.grvMitglieder.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvMitglieder.Appearance.SelectedRow.Options.UseFont = true;
            this.grvMitglieder.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvMitglieder.Appearance.VertLine.Options.UseBackColor = true;
            this.grvMitglieder.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvMitglieder.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colPersonMitglied,
            this.colBuchungCount});
            this.grvMitglieder.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvMitglieder.GridControl = this.grdWVMitglied;
            this.grvMitglieder.HorzScrollVisibility = DevExpress.XtraGrid.Views.Base.ScrollVisibility.Never;
            this.grvMitglieder.Name = "grvMitglieder";
            this.grvMitglieder.OptionsBehavior.Editable = false;
            this.grvMitglieder.OptionsCustomization.AllowFilter = false;
            this.grvMitglieder.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvMitglieder.OptionsNavigation.AutoFocusNewRow = true;
            this.grvMitglieder.OptionsNavigation.UseTabKey = false;
            this.grvMitglieder.OptionsView.ColumnAutoWidth = false;
            this.grvMitglieder.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvMitglieder.OptionsView.ShowGroupPanel = false;
            this.grvMitglieder.OptionsView.ShowIndicator = false;
            // 
            // colPersonMitglied
            // 
            this.colPersonMitglied.Caption = "WV-Einheit";
            this.colPersonMitglied.FieldName = "PersonName";
            this.colPersonMitglied.Name = "colPersonMitglied";
            this.colPersonMitglied.Visible = true;
            this.colPersonMitglied.VisibleIndex = 0;
            this.colPersonMitglied.Width = 332;
            // 
            // colBuchungCount
            // 
            this.colBuchungCount.Caption = "WV-EPs";
            this.colBuchungCount.FieldName = "Buchungen";
            this.colBuchungCount.Name = "colBuchungCount";
            this.colBuchungCount.ToolTip = "Anzahl WV-Einzelposten";
            this.colBuchungCount.Visible = true;
            this.colBuchungCount.VisibleIndex = 1;
            this.colBuchungCount.Width = 55;
            // 
            // lblWVTraeger
            // 
            this.lblWVTraeger.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblWVTraeger.LabelStyle = KiSS4.Gui.LabelStyleType.DataViewLabel;
            this.lblWVTraeger.Location = new System.Drawing.Point(445, 421);
            this.lblWVTraeger.Name = "lblWVTraeger";
            this.lblWVTraeger.Size = new System.Drawing.Size(112, 16);
            this.lblWVTraeger.TabIndex = 117;
            this.lblWVTraeger.Text = "WV-Einheitsträger";
            this.lblWVTraeger.UseCompatibleTextRendering = true;
            // 
            // lblBED
            // 
            this.lblBED.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblBED.Location = new System.Drawing.Point(4, 499);
            this.lblBED.Name = "lblBED";
            this.lblBED.Size = new System.Drawing.Size(72, 24);
            this.lblBED.TabIndex = 115;
            this.lblBED.Text = "BED";
            this.lblBED.UseCompatibleTextRendering = true;
            // 
            // lblBis
            // 
            this.lblBis.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblBis.Location = new System.Drawing.Point(207, 439);
            this.lblBis.Name = "lblBis";
            this.lblBis.Size = new System.Drawing.Size(17, 24);
            this.lblBis.TabIndex = 114;
            this.lblBis.Text = "bis";
            this.lblBis.UseCompatibleTextRendering = true;
            // 
            // lblGueltigVon
            // 
            this.lblGueltigVon.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblGueltigVon.Location = new System.Drawing.Point(4, 439);
            this.lblGueltigVon.Name = "lblGueltigVon";
            this.lblGueltigVon.Size = new System.Drawing.Size(72, 24);
            this.lblGueltigVon.TabIndex = 113;
            this.lblGueltigVon.Text = "Gültig ab";
            this.lblGueltigVon.UseCompatibleTextRendering = true;
            // 
            // lblWVCode
            // 
            this.lblWVCode.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblWVCode.Location = new System.Drawing.Point(4, 469);
            this.lblWVCode.Name = "lblWVCode";
            this.lblWVCode.Size = new System.Drawing.Size(72, 24);
            this.lblWVCode.TabIndex = 112;
            this.lblWVCode.Text = "WV-Code";
            this.lblWVCode.UseCompatibleTextRendering = true;
            // 
            // edtBaPersonID
            // 
            this.edtBaPersonID.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBaPersonID.DataMember = "BaPersonID";
            this.edtBaPersonID.DataSource = this.qryWVEinheit;
            this.edtBaPersonID.Location = new System.Drawing.Point(445, 440);
            this.edtBaPersonID.Name = "edtBaPersonID";
            this.edtBaPersonID.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBaPersonID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBaPersonID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaPersonID.Properties.Appearance.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBaPersonID.Properties.Appearance.Options.UseFont = true;
            this.edtBaPersonID.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtBaPersonID.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaPersonID.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtBaPersonID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtBaPersonID.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBaPersonID.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("PersonName")});
            this.edtBaPersonID.Properties.DisplayMember = "PersonName";
            this.edtBaPersonID.Properties.NullText = "";
            this.edtBaPersonID.Properties.ShowFooter = false;
            this.edtBaPersonID.Properties.ShowHeader = false;
            this.edtBaPersonID.Properties.ValueMember = "BaPersonID";
            this.edtBaPersonID.Size = new System.Drawing.Size(391, 24);
            this.edtBaPersonID.TabIndex = 10;
            this.edtBaPersonID.EditValueChanged += new System.EventHandler(this.edtBaPersonID_EditValueChanged);
            // 
            // qryWVEinheit
            // 
            this.qryWVEinheit.CanUpdate = true;
            this.qryWVEinheit.HostControl = this;
            this.qryWVEinheit.SelectStatement = resources.GetString("qryWVEinheit.SelectStatement");
            this.qryWVEinheit.TableName = "WhWVEinheit";
            this.qryWVEinheit.AfterFill += new System.EventHandler(this.qryWVEinheit_AfterFill);
            this.qryWVEinheit.AfterInsert += new System.EventHandler(this.qryWVEinheit_AfterInsert);
            this.qryWVEinheit.BeforePost += new System.EventHandler(this.qryWVEinheit_BeforePost);
            this.qryWVEinheit.AfterPost += new System.EventHandler(this.qryWVEinheit_AfterPost);
            this.qryWVEinheit.AfterDelete += new System.EventHandler(this.qryWVEinheit_AfterDelete);
            this.qryWVEinheit.PositionChanged += new System.EventHandler(this.qryWVEinheit_PositionChanged);
            // 
            // edtRekursAbgeschlossen
            // 
            this.edtRekursAbgeschlossen.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtRekursAbgeschlossen.DataMember = "RekursAbgeschlossen";
            this.edtRekursAbgeschlossen.DataSource = this.qryWVEinheit;
            this.edtRekursAbgeschlossen.EditValue = null;
            this.edtRekursAbgeschlossen.Location = new System.Drawing.Point(101, 589);
            this.edtRekursAbgeschlossen.Name = "edtRekursAbgeschlossen";
            this.edtRekursAbgeschlossen.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtRekursAbgeschlossen.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtRekursAbgeschlossen.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtRekursAbgeschlossen.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtRekursAbgeschlossen.Properties.Appearance.Options.UseBackColor = true;
            this.edtRekursAbgeschlossen.Properties.Appearance.Options.UseBorderColor = true;
            this.edtRekursAbgeschlossen.Properties.Appearance.Options.UseFont = true;
            this.edtRekursAbgeschlossen.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtRekursAbgeschlossen.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtRekursAbgeschlossen.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtRekursAbgeschlossen.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtRekursAbgeschlossen.Properties.Name = "kissDateEdit10.Properties";
            this.edtRekursAbgeschlossen.Properties.ShowToday = false;
            this.edtRekursAbgeschlossen.Size = new System.Drawing.Size(100, 24);
            this.edtRekursAbgeschlossen.TabIndex = 8;
            this.edtRekursAbgeschlossen.EditValueChanged += new System.EventHandler(this.edtRekursAbgeschlossen_EditValueChanged);
            // 
            // edtRekurs
            // 
            this.edtRekurs.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtRekurs.DataMember = "Rekurs";
            this.edtRekurs.DataSource = this.qryWVEinheit;
            this.edtRekurs.EditValue = null;
            this.edtRekurs.Location = new System.Drawing.Point(101, 559);
            this.edtRekurs.Name = "edtRekurs";
            this.edtRekurs.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtRekurs.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtRekurs.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtRekurs.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtRekurs.Properties.Appearance.Options.UseBackColor = true;
            this.edtRekurs.Properties.Appearance.Options.UseBorderColor = true;
            this.edtRekurs.Properties.Appearance.Options.UseFont = true;
            this.edtRekurs.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            this.edtRekurs.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtRekurs.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3)});
            this.edtRekurs.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtRekurs.Properties.Name = "kissDateEdit10.Properties";
            this.edtRekurs.Properties.ShowToday = false;
            this.edtRekurs.Size = new System.Drawing.Size(100, 24);
            this.edtRekurs.TabIndex = 8;
            this.edtRekurs.EditValueChanged += new System.EventHandler(this.edtRekurs_EditValueChanged);
            // 
            // edtHeimatkantonNr
            // 
            this.edtHeimatkantonNr.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtHeimatkantonNr.DataMember = "HeimatkantonNr";
            this.edtHeimatkantonNr.DataSource = this.qryWVEinheit;
            this.edtHeimatkantonNr.Location = new System.Drawing.Point(309, 529);
            this.edtHeimatkantonNr.Name = "edtHeimatkantonNr";
            this.edtHeimatkantonNr.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtHeimatkantonNr.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtHeimatkantonNr.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtHeimatkantonNr.Properties.Appearance.Options.UseBackColor = true;
            this.edtHeimatkantonNr.Properties.Appearance.Options.UseBorderColor = true;
            this.edtHeimatkantonNr.Properties.Appearance.Options.UseFont = true;
            this.edtHeimatkantonNr.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtHeimatkantonNr.Size = new System.Drawing.Size(113, 24);
            this.edtHeimatkantonNr.TabIndex = 7;
            // 
            // edtSKZNummer
            // 
            this.edtSKZNummer.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtSKZNummer.DataMember = "SKZNummer";
            this.edtSKZNummer.DataSource = this.qryWVEinheit;
            this.edtSKZNummer.Location = new System.Drawing.Point(101, 529);
            this.edtSKZNummer.Name = "edtSKZNummer";
            this.edtSKZNummer.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtSKZNummer.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSKZNummer.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSKZNummer.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSKZNummer.Properties.Appearance.Options.UseBackColor = true;
            this.edtSKZNummer.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSKZNummer.Properties.Appearance.Options.UseFont = true;
            this.edtSKZNummer.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtSKZNummer.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSKZNummer.Size = new System.Drawing.Size(100, 24);
            this.edtSKZNummer.TabIndex = 6;
            // 
            // ddlBED
            // 
            this.ddlBED.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.ddlBED.DataMember = "BEDCode";
            this.ddlBED.DataSource = this.qryWVEinheit;
            this.ddlBED.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.ddlBED.Location = new System.Drawing.Point(101, 499);
            this.ddlBED.Name = "ddlBED";
            this.ddlBED.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.ddlBED.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.ddlBED.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.ddlBED.Properties.Appearance.Options.UseBackColor = true;
            this.ddlBED.Properties.Appearance.Options.UseBorderColor = true;
            this.ddlBED.Properties.Appearance.Options.UseFont = true;
            this.ddlBED.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.ddlBED.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.ddlBED.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.ddlBED.Properties.AppearanceDropDown.Options.UseFont = true;
            this.ddlBED.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            this.ddlBED.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4)});
            this.ddlBED.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.ddlBED.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text")});
            this.ddlBED.Properties.DisplayMember = "Text";
            this.ddlBED.Properties.NullText = "";
            this.ddlBED.Properties.ReadOnly = true;
            this.ddlBED.Properties.ShowFooter = false;
            this.ddlBED.Properties.ShowHeader = false;
            this.ddlBED.Properties.ValueMember = "Code";
            this.ddlBED.Size = new System.Drawing.Size(321, 24);
            this.ddlBED.TabIndex = 5;
            // 
            // ddlWVCode
            // 
            this.ddlWVCode.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.ddlWVCode.DataMember = "WVCode";
            this.ddlWVCode.DataSource = this.qryWVEinheit;
            this.ddlWVCode.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.ddlWVCode.Location = new System.Drawing.Point(101, 469);
            this.ddlWVCode.Name = "ddlWVCode";
            this.ddlWVCode.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.ddlWVCode.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.ddlWVCode.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.ddlWVCode.Properties.Appearance.Options.UseBackColor = true;
            this.ddlWVCode.Properties.Appearance.Options.UseBorderColor = true;
            this.ddlWVCode.Properties.Appearance.Options.UseFont = true;
            this.ddlWVCode.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.ddlWVCode.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.ddlWVCode.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.ddlWVCode.Properties.AppearanceDropDown.Options.UseFont = true;
            this.ddlWVCode.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject5.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject5.Options.UseBackColor = true;
            this.ddlWVCode.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject5)});
            this.ddlWVCode.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.ddlWVCode.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text")});
            this.ddlWVCode.Properties.DisplayMember = "Text";
            this.ddlWVCode.Properties.Name = "kissLookUpEdit5.Properties";
            this.ddlWVCode.Properties.NullText = "";
            this.ddlWVCode.Properties.ReadOnly = true;
            this.ddlWVCode.Properties.ShowFooter = false;
            this.ddlWVCode.Properties.ShowHeader = false;
            this.ddlWVCode.Properties.ValueMember = "Code";
            this.ddlWVCode.Size = new System.Drawing.Size(321, 24);
            this.ddlWVCode.TabIndex = 4;
            // 
            // btnUngueltig
            // 
            this.btnUngueltig.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.btnUngueltig.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnUngueltig.Location = new System.Drawing.Point(340, 439);
            this.btnUngueltig.Name = "btnUngueltig";
            this.btnUngueltig.Size = new System.Drawing.Size(82, 24);
            this.btnUngueltig.TabIndex = 3;
            this.btnUngueltig.Text = "-> Ungültig";
            this.btnUngueltig.UseCompatibleTextRendering = true;
            this.btnUngueltig.UseVisualStyleBackColor = false;
            this.btnUngueltig.Click += new System.EventHandler(this.btnUngueltig_Click);
            // 
            // datBis
            // 
            this.datBis.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.datBis.DataMember = "DatumBis";
            this.datBis.DataSource = this.qryWVEinheit;
            this.datBis.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.datBis.EditValue = null;
            this.datBis.Location = new System.Drawing.Point(234, 439);
            this.datBis.Name = "datBis";
            this.datBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.datBis.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.datBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.datBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.datBis.Properties.Appearance.Options.UseBackColor = true;
            this.datBis.Properties.Appearance.Options.UseBorderColor = true;
            this.datBis.Properties.Appearance.Options.UseFont = true;
            this.datBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject6.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject6.Options.UseBackColor = true;
            this.datBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("datBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject6)});
            this.datBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.datBis.Properties.Name = "kissDateEdit9.Properties";
            this.datBis.Properties.ReadOnly = true;
            this.datBis.Properties.ShowToday = false;
            this.datBis.Size = new System.Drawing.Size(100, 24);
            this.datBis.TabIndex = 2;
            // 
            // datVon
            // 
            this.datVon.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.datVon.DataMember = "DatumVon";
            this.datVon.DataSource = this.qryWVEinheit;
            this.datVon.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.datVon.EditValue = null;
            this.datVon.Location = new System.Drawing.Point(101, 439);
            this.datVon.Name = "datVon";
            this.datVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.datVon.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.datVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.datVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.datVon.Properties.Appearance.Options.UseBackColor = true;
            this.datVon.Properties.Appearance.Options.UseBorderColor = true;
            this.datVon.Properties.Appearance.Options.UseFont = true;
            this.datVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject7.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject7.Options.UseBackColor = true;
            this.datVon.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("datVon.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject7)});
            this.datVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.datVon.Properties.Name = "kissDateEdit8.Properties";
            this.datVon.Properties.ReadOnly = true;
            this.datVon.Properties.ShowToday = false;
            this.datVon.Size = new System.Drawing.Size(100, 24);
            this.datVon.TabIndex = 1;
            // 
            // grdWVEinheit
            // 
            this.grdWVEinheit.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
            | System.Windows.Forms.AnchorStyles.Left)
            | System.Windows.Forms.AnchorStyles.Right)));
            this.grdWVEinheit.DataSource = this.qryWVEinheit;
            // 
            // 
            // 
            this.grdWVEinheit.EmbeddedNavigator.Name = "";
            this.grdWVEinheit.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdWVEinheit.Location = new System.Drawing.Point(3, 6);
            this.grdWVEinheit.MainView = this.grvWVEinheit;
            this.grdWVEinheit.Name = "grdWVEinheit";
            this.grdWVEinheit.RepositoryItems.AddRange(new DevExpress.XtraEditors.Repository.RepositoryItem[] {
            this.repositoryItemGridLookUpEdit1});
            this.grdWVEinheit.Size = new System.Drawing.Size(1065, 411);
            this.grdWVEinheit.TabIndex = 0;
            this.grdWVEinheit.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvWVEinheit});
            // 
            // grvWVEinheit
            // 
            this.grvWVEinheit.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvWVEinheit.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinheit.Appearance.Empty.Options.UseBackColor = true;
            this.grvWVEinheit.Appearance.Empty.Options.UseFont = true;
            this.grvWVEinheit.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinheit.Appearance.EvenRow.Options.UseFont = true;
            this.grvWVEinheit.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvWVEinheit.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinheit.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvWVEinheit.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvWVEinheit.Appearance.FocusedCell.Options.UseFont = true;
            this.grvWVEinheit.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvWVEinheit.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvWVEinheit.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinheit.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvWVEinheit.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvWVEinheit.Appearance.FocusedRow.Options.UseFont = true;
            this.grvWVEinheit.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvWVEinheit.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvWVEinheit.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvWVEinheit.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvWVEinheit.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvWVEinheit.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvWVEinheit.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvWVEinheit.Appearance.GroupRow.Options.UseFont = true;
            this.grvWVEinheit.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvWVEinheit.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvWVEinheit.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvWVEinheit.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvWVEinheit.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvWVEinheit.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvWVEinheit.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvWVEinheit.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvWVEinheit.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinheit.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvWVEinheit.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvWVEinheit.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvWVEinheit.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvWVEinheit.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvWVEinheit.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvWVEinheit.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinheit.Appearance.OddRow.Options.UseFont = true;
            this.grvWVEinheit.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvWVEinheit.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinheit.Appearance.Row.Options.UseBackColor = true;
            this.grvWVEinheit.Appearance.Row.Options.UseFont = true;
            this.grvWVEinheit.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinheit.Appearance.SelectedRow.Options.UseFont = true;
            this.grvWVEinheit.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvWVEinheit.Appearance.VertLine.Options.UseBackColor = true;
            this.grvWVEinheit.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvWVEinheit.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colFaFallID,
            this.colFinanzplanIDs,
            this.colDatumVon,
            this.colDatumBis,
            this.colWVCode,
            this.colBEDebitor,
            this.colBuchungen,
            this.colUT,
            this.colPerson,
            this.colGebDatum,
            this.colStatus});
            this.grvWVEinheit.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvWVEinheit.GridControl = this.grdWVEinheit;
            this.grvWVEinheit.Name = "grvWVEinheit";
            this.grvWVEinheit.OptionsBehavior.Editable = false;
            this.grvWVEinheit.OptionsCustomization.AllowFilter = false;
            this.grvWVEinheit.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvWVEinheit.OptionsNavigation.AutoFocusNewRow = true;
            this.grvWVEinheit.OptionsNavigation.UseTabKey = false;
            this.grvWVEinheit.OptionsView.ColumnAutoWidth = false;
            this.grvWVEinheit.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvWVEinheit.OptionsView.ShowGroupPanel = false;
            this.grvWVEinheit.OptionsView.ShowIndicator = false;
            // 
            // colFaFallID
            // 
            this.colFaFallID.Caption = "Fall";
            this.colFaFallID.FieldName = "FaFallID";
            this.colFaFallID.Name = "colFaFallID";
            this.colFaFallID.Visible = true;
            this.colFaFallID.VisibleIndex = 0;
            this.colFaFallID.Width = 60;
            // 
            // colFinanzplanIDs
            // 
            this.colFinanzplanIDs.Caption = "Finanzplan";
            this.colFinanzplanIDs.FieldName = "BgFinanzplanIDs";
            this.colFinanzplanIDs.Name = "colFinanzplanIDs";
            this.colFinanzplanIDs.Visible = true;
            this.colFinanzplanIDs.VisibleIndex = 1;
            this.colFinanzplanIDs.Width = 90;
            // 
            // colDatumVon
            // 
            this.colDatumVon.Caption = "Von";
            this.colDatumVon.FieldName = "DatumVon";
            this.colDatumVon.Name = "colDatumVon";
            this.colDatumVon.Visible = true;
            this.colDatumVon.VisibleIndex = 2;
            this.colDatumVon.Width = 80;
            // 
            // colDatumBis
            // 
            this.colDatumBis.Caption = "Bis";
            this.colDatumBis.FieldName = "DatumBis";
            this.colDatumBis.Name = "colDatumBis";
            this.colDatumBis.Visible = true;
            this.colDatumBis.VisibleIndex = 3;
            this.colDatumBis.Width = 80;
            // 
            // colWVCode
            // 
            this.colWVCode.Caption = "WVCode";
            this.colWVCode.FieldName = "WVCode";
            this.colWVCode.Name = "colWVCode";
            this.colWVCode.Visible = true;
            this.colWVCode.VisibleIndex = 4;
            this.colWVCode.Width = 61;
            // 
            // colBEDebitor
            // 
            this.colBEDebitor.Caption = "BE-Debitor";
            this.colBEDebitor.FieldName = "BEDCode";
            this.colBEDebitor.Name = "colBEDebitor";
            this.colBEDebitor.Visible = true;
            this.colBEDebitor.VisibleIndex = 5;
            this.colBEDebitor.Width = 145;
            // 
            // colBuchungen
            // 
            this.colBuchungen.Caption = "WV-EPs";
            this.colBuchungen.FieldName = "AnzahlEinzelposten";
            this.colBuchungen.Name = "colBuchungen";
            this.colBuchungen.ToolTip = "Anzahl WV-Einzelosten";
            this.colBuchungen.Visible = true;
            this.colBuchungen.VisibleIndex = 6;
            this.colBuchungen.Width = 58;
            // 
            // colUT
            // 
            this.colUT.Caption = "WV-Einheitsträger";
            this.colUT.FieldName = "UT";
            this.colUT.Name = "colUT";
            this.colUT.Visible = true;
            this.colUT.VisibleIndex = 8;
            this.colUT.Width = 168;
            // 
            // colPerson
            // 
            this.colPerson.Caption = "Weitere Personen";
            this.colPerson.FieldName = "WeitereMitglieder";
            this.colPerson.Name = "colPerson";
            this.colPerson.Visible = true;
            this.colPerson.VisibleIndex = 10;
            this.colPerson.Width = 500;
            // 
            // colGebDatum
            // 
            this.colGebDatum.Caption = "Geb.Datum";
            this.colGebDatum.FieldName = "Geburtsdatum";
            this.colGebDatum.Name = "colGebDatum";
            this.colGebDatum.Visible = true;
            this.colGebDatum.VisibleIndex = 9;
            // 
            // colStatus
            // 
            this.colStatus.Caption = "Ungültig";
            this.colStatus.FieldName = "Status";
            this.colStatus.Name = "colStatus";
            this.colStatus.Visible = true;
            this.colStatus.VisibleIndex = 7;
            this.colStatus.Width = 55;
            // 
            // repositoryItemGridLookUpEdit1
            // 
            this.repositoryItemGridLookUpEdit1.AutoHeight = false;
            this.repositoryItemGridLookUpEdit1.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.repositoryItemGridLookUpEdit1.Name = "repositoryItemGridLookUpEdit1";
            this.repositoryItemGridLookUpEdit1.View = this.repositoryItemGridLookUpEdit1View;
            // 
            // repositoryItemGridLookUpEdit1View
            // 
            this.repositoryItemGridLookUpEdit1View.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.RowFocus;
            this.repositoryItemGridLookUpEdit1View.Name = "repositoryItemGridLookUpEdit1View";
            this.repositoryItemGridLookUpEdit1View.OptionsSelection.EnableAppearanceFocusedCell = false;
            this.repositoryItemGridLookUpEdit1View.OptionsView.ShowGroupPanel = false;
            // 
            // qryBaWVCode
            // 
            this.qryBaWVCode.HostControl = this;
            this.qryBaWVCode.SelectStatement = resources.GetString("qryBaWVCode.SelectStatement");
            // 
            // qryBaWVCodeUngueltig
            // 
            this.qryBaWVCodeUngueltig.HostControl = this;
            this.qryBaWVCodeUngueltig.SelectStatement = resources.GetString("qryBaWVCodeUngueltig.SelectStatement");
            // 
            // qryWVMitglied
            // 
            this.qryWVMitglied.CanUpdate = true;
            this.qryWVMitglied.HostControl = this;
            this.qryWVMitglied.SelectStatement = resources.GetString("qryWVMitglied.SelectStatement");
            this.qryWVMitglied.TableName = "WhWVEinheitMitglied";
            this.qryWVMitglied.PositionChanged += new System.EventHandler(this.qryWVMitglied_PositionChanged);
            // 
            // CtlWhWVEinheit
            // 
            this.ActiveSQLQuery = this.qryWVEinheit;
            this.Controls.Add(this.pnlFill);
            this.Controls.Add(this.timeline);
            this.Controls.Add(this.pnTitle);
            this.Name = "CtlWhWVEinheit";
            this.Size = new System.Drawing.Size(1072, 692);
            this.pnTitle.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.imgTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtUngueltig.Properties)).EndInit();
            this.pnlFill.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblRekursAbgeschlossenMutiertCaption)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRekursMutiertCaption)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRekursAbgeschlossenMutiert)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRekursMutiert)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblHeimatkanton)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSKZNummer)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblVerfahren)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblRekurs)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdWVMitglied)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvMitglieder)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblWVTraeger)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBED)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBis)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblGueltigVon)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblWVCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryWVEinheit)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRekursAbgeschlossen.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtRekurs.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtHeimatkantonNr.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSKZNummer.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.ddlBED.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.ddlBED)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.ddlWVCode.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.ddlWVCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.datBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.datVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdWVEinheit)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvWVEinheit)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemGridLookUpEdit1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemGridLookUpEdit1View)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBaWVCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBaWVCodeUngueltig)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryWVMitglied)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Protected Methods

        public override void OnRefreshData()
        {
            base.OnRefreshData();
            qryBaWVCode.Refresh();
            FillTimeline();
        }

        #endregion

        #region Private Methods

        private void FillTimeline()
        {
            this.SuspendLayout();
            try
            {
                List<TimelineItem> persons = new List<TimelineItem>();
                List<TimelineItem> personsUngueltig = new List<TimelineItem>();
                if (qryBaWVCode.Count == 0)
                {
                    timeline.Visible = false;
                    return;
                }
                timeline.Clear();
                timeline.Visible = true;

                foreach (DataRow wvCode in qryBaWVCode.DataTable.Rows)
                {
                    int baPersonID = (int)wvCode["BaPersonID"];
                    int baWvCode = (int)wvCode["WVCode"];
                    DateTime from = (DateTime)wvCode["DatumVon"];
                    object toObj = wvCode["DatumBis"];
                    DateTime to = toObj is DateTime ? (DateTime)(toObj) : new DateTime(9999, 12, 31);
                    TimelineItem person = persons.Find(delegate(TimelineItem itemToSearch) { return itemToSearch.ID == baPersonID; });
                    if (person == null)
                    {
                        person = new TimelineItem(baPersonID, wvCode["NameVorname"] as string);
                        persons.Add(person);
                    }
                    person.Sections.Add(new TimelineSection(from, to, baWvCode));
                }

                foreach (TimelineItem person in persons)
                    timeline.AddItem(person);

                bool ungueltigeZeigen = edtUngueltig.Checked && qryWVEinheit.DataTable.Select("Ungueltig = 1").Length > 0;

                if (ungueltigeZeigen)
                {
                    foreach (DataRow wvCode in qryBaWVCodeUngueltig.DataTable.Rows)
                    {
                        int baPersonID = (int)wvCode["BaPersonID"];
                        int baWvCode = (int)wvCode["WVCode"];
                        DateTime from = (DateTime)wvCode["DatumVon"];
                        object toObj = wvCode["DatumBis"];
                        DateTime to = toObj is DateTime ? (DateTime)(toObj) : new DateTime(9999, 12, 31);
                        TimelineItem personUngueltig = personsUngueltig.Find(delegate(TimelineItem itemToSearch) { return itemToSearch.ID == -baPersonID; });
                        if (personUngueltig == null)
                        {
                            personUngueltig = new TimelineItem(-baPersonID, wvCode["NameVorname"] as string);
                            personsUngueltig.Add(personUngueltig);
                        }
                        personUngueltig.Sections.Add(new TimelineSection(from, to, baWvCode));
                    }
                    timeline.AddItem(new TimelineItem(0, "(Ungültige:)"));

                    foreach (TimelineItem person in personsUngueltig)
                        timeline.AddItem(person);
                }

                DateTime min;
                DateTime max;
                timeline.GetBorderDates(out min, out max);
                timeline.FromDate = min;
                timeline.ToDate = max;

                SqlQuery qry = DBUtil.OpenSQL(@"
                  SELECT DatumVon = IsNull(BFP.DatumVon,BFP.GeplantVon), DatumBis = IsNull(BFP.DatumBis,BFP.GeplantBis)
                  FROM FaLeistung           LEI
                    INNER JOIN BgFinanzplan BFP ON BFP.FaLeistungID = LEI.FaLeistungID
                  WHERE LEI.FaFallID = {0}", this.faFallID);
                if (qry.Count > 0)
                {
                    TimelineItem finanzplanItem = new TimelineItem(1, "Finanzpläne");
                    foreach (DataRow finanzplan in qry.DataTable.Rows)
                    {
                        DateTime from = (DateTime)finanzplan["DatumVon"];
                        object toObj = finanzplan["DatumBis"];
                        DateTime to = toObj is DateTime ? (DateTime)(toObj) : new DateTime(9999, 12, 31);
                        finanzplanItem.Sections.Add(new TimelineSection(from, to, 110));
                    }
                    timeline.AddItem(finanzplanItem);
                }
            }
            finally
            {
                this.ResumeLayout();
            }
        }

        private void HighlightTimeline()
        {
            if (qryWVEinheit.Count == 0)
                return;
            int factor = (bool)qryWVEinheit["Ungueltig"] == true ? -1 : 1;
            List<int> ids = new List<int>();
            foreach (DataRow person in qryWVMitglied.DataTable.Rows)
                ids.Add((int)person["BaPersonID"] * factor);
            DateTime dateTo = DBUtil.IsEmpty(qryWVEinheit["DatumBis"]) ? DateTime.MaxValue.Date : (DateTime)qryWVEinheit["DatumBis"];
            object personID = qryWVEinheit["BaPersonID"];
            timeline.HighlightSection((DateTime)qryWVEinheit["DatumVon"], dateTo, ids, 100, DBUtil.IsEmpty(personID) ? (int?)null : (int?)((int)personID * factor), 101);
        }

        private void SetColors()
        {
            //	timeline.FromDate = new DateTime(2000, 1, 1);
            //	timeline.ToDate = new DateTime(2008, 1, 1);

            Dictionary<int, Color> colors = new Dictionary<int, Color>();
            colors[1] = Color.LawnGreen;
            colors[2] = Color.LightBlue;
            colors[3] = Color.LightSeaGreen;
            colors[4] = Color.IndianRed;
            colors[5] = Color.SandyBrown;
            colors[6] = Color.DarkOrange;
            colors[7] = Color.Goldenrod;
            colors[8] = Color.Olive;
            colors[9] = Color.GreenYellow;
            colors[10] = Color.SpringGreen;
            colors[11] = Color.Violet;
            colors[12] = Color.Pink;
            colors[13] = Color.Thistle;
            colors[14] = Color.CornflowerBlue;
            colors[15] = Color.Yellow;
            colors[16] = Color.LightYellow;
            colors[17] = Color.Beige;
            colors[18] = Color.Khaki;
            colors[19] = Color.Gold;
            colors[20] = Color.Wheat;
            colors[21] = Color.NavajoWhite;
            colors[22] = Color.Tan;
            colors[23] = Color.LightSalmon;
            colors[24] = Color.Tomato;
            colors[25] = Color.RosyBrown;
            colors[26] = Color.LightCoral;
            colors[27] = Color.LightGreen;

            SqlQuery qryWVCodes = DBUtil.OpenSQL("SELECT Code, ShortText FROM XLOVCode WHERE LOVName = 'BaWVCode'");
            foreach (DataRow codeRow in qryWVCodes.DataTable.Rows)
            {
                int code = (int)codeRow["Code"];
                timeline.Colors[code] = new KeyValuePair<string, SolidBrush>((string)codeRow["ShortText"], new SolidBrush(colors[code]));
            }
            // highlight
            timeline.Colors[100] = new KeyValuePair<string, SolidBrush>("", new SolidBrush(Color.Crimson));
            timeline.Colors[101] = new KeyValuePair<string, SolidBrush>("", new SolidBrush(Color.Crimson));
            timeline.Colors[110] = new KeyValuePair<string, SolidBrush>("", new SolidBrush(Color.Red));
        }

        private void btnAendern_Click(object sender, System.EventArgs e)
        {
            // Refresh WV-Codes
            qryBaWVCode.Fill(faFallID);
            FillTimeline();

            try
            {
                DBUtil.ExecSQLThrowingException("EXEC spWhWVModifyUnits {0}", this.faFallID);
            }
            catch (KissCancelException ex)
            {
                ex.ShowMessage();
            }
            qryWVEinheit.Refresh();
        }

        private void btnUngueltig_Click(object sender, System.EventArgs e)
        {
            if (KissMsg.ShowQuestion("CtlWhWVEinheit", "UngueltigSetzten", "Wollen Sie wirklich diese WV-Einheit ungültig setzen? Sie kann danach nicht mehr auf gültig gesetzt werden."))
            {
                qryWVEinheit["Ungueltig"] = true;
                qryWVEinheit.Post();
            }
        }

        private void edtBaPersonID_EditValueChanged(object sender, System.EventArgs e)
        {
            HighlightTimeline();
            qryWVMitglied_PositionChanged(null, System.EventArgs.Empty);
            wvTraegerChanged = true;
        }

        private void edtUngueltig_EditValueChanged(object sender, System.EventArgs e)
        {
            if (edtUngueltig.Checked)
                qryWVEinheit.DataTable.DefaultView.RowFilter = "";
            else
                qryWVEinheit.DataTable.DefaultView.RowFilter = "Ungueltig = 0";

            FillTimeline();
        }

        private void grdWVEinheit_LostFocus(object sender, System.EventArgs e)
        {
            //btnEinheitVerbinden.Visible = false;
            //Event wird nicht ausgelöst!
        }

        private void qryWVEinheit_AfterDelete(object sender, System.EventArgs e)
        {
            FillTimeline();
        }

        private void qryWVEinheit_AfterInsert(object sender, System.EventArgs e)
        {
            qryWVEinheit["FaFallID"] = faFallID;

            Control firstControl = null;
            int minTabIndex = int.MaxValue;
            foreach (Control ctrl in this.Controls)
            {
                IKissBindableEdit edt = ctrl as IKissBindableEdit;
                if (edt != null && edt.DataMember != string.Empty && ctrl.Visible)
                {
                    if (ctrl.TabIndex < minTabIndex)
                    {
                        minTabIndex = ctrl.TabIndex;
                        firstControl = ctrl;
                    }
                }
            }
            if (firstControl != null)
            {
                firstControl.Focus();
            }
        }

        private void qryWVEinheit_BeforePost(object sender, EventArgs e)
        {
            bool rekursChanged = !qryWVEinheit["Rekurs", DataRowVersion.Original].Equals(qryWVEinheit["Rekurs", DataRowVersion.Current]);
            bool rekursAbgeschlossenChanged = !qryWVEinheit["RekursAbgeschlossen", DataRowVersion.Original].Equals(qryWVEinheit["RekursAbgeschlossen", DataRowVersion.Current]);

            if (DBUtil.IsEmpty(qryWVEinheit["Rekurs"]) &&
                !DBUtil.IsEmpty(qryWVEinheit["RekursAbgeschlossen"]))
            {
                qryWVEinheit["RekursAbgeschlossen"] = null;
                throw new KissErrorException(KissMsg.GetMLMessage("CtlWhWVEinheit",
                                                                  "RekursLeerAbschlussNicht",
                                                                  "Wenn 'Rekurs abgeschlossen' ausgefüllt ist, darf 'Rekurshängiges Verfahren' nicht leer sein."));
            }

            if (rekursChanged)
            {
                qryWVEinheit["RekursMutiertUserID"] = Session.User.UserID;
                qryWVEinheit["RekursMutiertDatum"] = DateTime.Now;
            }
            if (rekursAbgeschlossenChanged)
            {
                qryWVEinheit["RekursAbgeschlossenMutiertUserID"] = Session.User.UserID;
                qryWVEinheit["RekursAbgeschlossenMutiertDatum"] = DateTime.Now;
            }

            if (userMayEditRekurs)
            {
                DateTime? rekurs = qryWVEinheit["Rekurs"] as DateTime?;
                DateTime? rekursAbgeschlossen = qryWVEinheit["RekursAbgeschlossen"] as DateTime?;
                if (rekurs.HasValue && rekursAbgeschlossen.HasValue && rekurs.Value > rekursAbgeschlossen.Value)
                {
                    throw new KissErrorException(KissMsg.GetMLMessage("CtlWhWVEinheit",
                                                                      "RekursNachAbschluss",
                                                                      "'Rekurs abgeschlossen' muss nach 'Rekurshängiges Verfahren' liegen."));
                }
            }

            // SKZ-Nummer korrekt?
            bool skzChangedChanged = !qryWVEinheit["SKZNummer", DataRowVersion.Original].Equals(qryWVEinheit["SKZNummer", DataRowVersion.Current]);
            if (skzChangedChanged)
            {
                SqlQuery qrySKZ = DBUtil.OpenSQL(@"SELECT WhSKZNummerID, SKZNummer FROM WhSKZNummer WHERE BaPersonID = {0}", qryWVEinheit["BaPersonID"]);
                if (qrySKZ.Count > 0)
                {
                    int? skzNummer_Saved = qrySKZ["SKZNummer"] as int?;
                    if (!skzNummer_Saved.Equals(qryWVEinheit["SKZNummer"]) && !DBUtil.IsEmpty(qryWVEinheit["SKZNummer"]))
                    {
                        if (KissMsg.ShowQuestion(string.Format("Die eingegebene KSA-Nummer '{0}' entspricht nicht der früher eingegebenen KSA-Nummer '{1}'. Soll die neue Nummer übernommen werden?", qryWVEinheit["SKZNummer"], skzNummer_Saved)))
                        {
                            DBUtil.ExecSQLThrowingException(@"UPDATE WhSKZNummer SET SKZNummer = {0} WHERE WhSKZNummerID = {1}", qryWVEinheit["SKZNummer"], qrySKZ["WhSKZNummerID"]);
                        }
                        else
                        {
                            qryWVEinheit["SKZNummer"] = skzNummer_Saved;
                        }
                    }
                }
                else
                {
                    if (!DBUtil.IsEmpty(qryWVEinheit["SKZNummer"]))
                    {
                        DBUtil.ExecSQLThrowingException(@"INSERT INTO WhSKZNummer (BaPersonID, SKZNummer, DatumZuletztEingegeben) VALUES ({0}, {1}, GETDATE())", qryWVEinheit["BaPersonID"], qryWVEinheit["SKZNummer"]);
                    }
                }
            }

            // Heimatkanton-Nummer korrekt?
            bool heimatkantonNrChanged = !qryWVEinheit["HeimatkantonNr", DataRowVersion.Original].Equals(qryWVEinheit["HeimatkantonNr", DataRowVersion.Current]);
            if (rekursChanged || rekursAbgeschlossenChanged || heimatkantonNrChanged)
            {
                SqlQuery qryHeimatkantonNr = DBUtil.OpenSQL(@"SELECT WhHeimatKantonNr_RekursID, HeimatkantonNr, Rekurs, RekursMutiertUserID, RekursMutiertDatum, RekursAbgeschlossen, RekursAbgeschlossenMutiertUserID, RekursAbgeschlossenMutiertDatum
                                                              FROM WhHeimatKantonNr_Rekurs
                                                              WHERE BaPersonID = {0} AND WVCode = {1} AND BEDCode = {2}", qryWVEinheit["BaPersonID"], qryWVEinheit["WVCode"], qryWVEinheit["BEDCode"]);
                if (heimatkantonNrChanged)
                {
                    if (qryHeimatkantonNr.Count > 0)
                    {
                        string heimatKantonNummer_Saved = qryHeimatkantonNr["HeimatkantonNr"] as string;
                        if (heimatKantonNummer_Saved == null || !heimatKantonNummer_Saved.Equals(qryWVEinheit["HeimatkantonNr"]))
                        {
                            if (heimatKantonNummer_Saved == null || KissMsg.ShowQuestion(string.Format("Die eingegebene Heimatkanton-Nr '{0}' entspricht nicht der früher eingegebenen Heimatkanton-Nr '{1}'. Soll die neue Nummer übernommen werden?", qryWVEinheit["HeimatkantonNr"], heimatKantonNummer_Saved)))
                            {
                                DBUtil.ExecSQLThrowingException(@"UPDATE WhHeimatKantonNr_Rekurs SET HeimatkantonNr = {0} WHERE WhHeimatKantonNr_RekursID = {1}", qryWVEinheit["HeimatkantonNr"], qryHeimatkantonNr["WhHeimatKantonNr_RekursID"]);
                            }
                            else
                            {
                                qryWVEinheit["HeimatkantonNr"] = heimatKantonNummer_Saved;
                            }
                        }
                    }
                    else
                    {
                        DBUtil.ExecSQLThrowingException(@"INSERT INTO WhHeimatKantonNr_Rekurs (BaPersonID, WVCode, BEDCode, HeimatkantonNr, DatumZuletztEingegeben)
                                                          VALUES ({0}, {1}, {2}, {3}, GETDATE())",
                                                        qryWVEinheit["BaPersonID"],
                                                        qryWVEinheit["WVCode"],
                                                        qryWVEinheit["BEDCode"],
                                                        qryWVEinheit["HeimatkantonNr"]);
                    }
                }
                if (rekursChanged)
                {
                    if (qryHeimatkantonNr.Count > 0)
                    {
                        DateTime? rekurs_Saved = qryHeimatkantonNr["Rekurs"] as DateTime?;
                        if (!rekurs_Saved.Equals(qryWVEinheit["Rekurs"]))
                        {
                            if (!rekurs_Saved.HasValue || KissMsg.ShowQuestion(string.Format("Das eingegebene Rekursdatum '{0:d}' entspricht nicht dem früher eingegebenen Rekursdatum '{1:d}'. Soll das neue Datum übernommen werden?", qryWVEinheit["Rekurs"], rekurs_Saved)))
                            {
                                DBUtil.ExecSQLThrowingException(@"UPDATE WhHeimatKantonNr_Rekurs SET Rekurs = {0}, RekursMutiertUserID = {1}, RekursMutiertDatum = {2} WHERE WhHeimatKantonNr_RekursID = {3}", qryWVEinheit["Rekurs"], qryWVEinheit["RekursMutiertUserID"], qryWVEinheit["RekursMutiertDatum"], qryHeimatkantonNr["WhHeimatKantonNr_RekursID"]);
                            }
                            else
                            {
                                qryWVEinheit["Rekurs"] = rekurs_Saved;
                                qryWVEinheit["RekursMutiertUserID"] = qryHeimatkantonNr["RekursMutiertUserID"];
                                qryWVEinheit["RekursMutiertDatum"] = qryHeimatkantonNr["RekursMutiertDatum"];
                            }
                        }
                    }
                    else
                    {
                        DBUtil.ExecSQLThrowingException(@"INSERT INTO WhHeimatKantonNr_Rekurs (BaPersonID, WVCode, BEDCode, Rekurs, RekursMutiertUserID, RekursMutiertDatum, DatumZuletztEingegeben)
                                                          VALUES ({0}, {1}, {2}, {3}, {4}, {5}, GETDATE())",
                                                        qryWVEinheit["BaPersonID"],
                                                        qryWVEinheit["WVCode"],
                                                        qryWVEinheit["BEDCode"],
                                                        qryWVEinheit["Rekurs"],
                                                        qryWVEinheit["RekursMutiertUserID"],
                                                        qryWVEinheit["RekursMutiertDatum"]);
                    }
                }
                if (rekursAbgeschlossenChanged)
                {
                    if (qryHeimatkantonNr.Count > 0)
                    {
                        DateTime? rekursAbgeschlossen_Saved = qryHeimatkantonNr["RekursAbgeschlossen"] as DateTime?;
                        if (!rekursAbgeschlossen_Saved.Equals(qryWVEinheit["RekursAbgeschlossen"]))
                        {
                            if (!rekursAbgeschlossen_Saved.HasValue || KissMsg.ShowQuestion(string.Format("Das eingegebene Datum 'Rekurs abgeschlossen' '{0:d}' entspricht nicht dem früher eingegebenen Datum 'Rekurs abgeschlossen' '{1:d}'. Soll das neue Datum übernommen werden?", qryWVEinheit["RekursAbgeschlossen"], rekursAbgeschlossen_Saved)))
                            {
                                DBUtil.ExecSQLThrowingException(@"UPDATE WhHeimatKantonNr_Rekurs SET RekursAbgeschlossen = {0}, RekursAbgeschlossenMutiertUserID = {1}, RekursAbgeschlossenMutiertDatum = {2}
                                                                  WHERE WhHeimatKantonNr_RekursID = {3}", qryWVEinheit["RekursAbgeschlossen"], qryWVEinheit["RekursAbgeschlossenMutiertUserID"], qryWVEinheit["RekursAbgeschlossenMutiertDatum"], qryHeimatkantonNr["WhHeimatKantonNr_RekursID"]);
                            }
                            else
                            {
                                qryWVEinheit["RekursAbgeschlossen"] = rekursAbgeschlossen_Saved;
                                qryWVEinheit["RekursAbgeschlossenMutiertUserID"] = qryHeimatkantonNr["RekursAbgeschlossenMutiertUserID"];
                                qryWVEinheit["RekursAbgeschlossenMutiertDatum"] = qryHeimatkantonNr["RekursAbgeschlossenMutiertDatum"];
                            }
                        }
                    }
                    else
                    {
                        DBUtil.ExecSQLThrowingException(@"INSERT INTO WhHeimatKantonNr_Rekurs (BaPersonID, WVCode, BEDCode, RekursAbgeschlossen, RekursAbgeschlossenMutiertUserID, RekursAbgeschlossenMutiertDatum, DatumZuletztEingegeben)
                                                          VALUES ({0}, {1}, {2}, {3}, {4}, {5}, GETDATE())",
                                                        qryWVEinheit["BaPersonID"],
                                                        qryWVEinheit["WVCode"],
                                                        qryWVEinheit["BEDCode"],
                                                        qryWVEinheit["RekursAbgeschlossen"],
                                                        qryWVEinheit["RekursAbgeschlossenMutiertUserID"],
                                                        qryWVEinheit["RekursAbgeschlossenMutiertDatum"]);
                    }
                }
            }
        }

        private void qryWVEinheit_AfterPost(object sender, System.EventArgs e)
        {
            HighlightTimeline();
            qryWVMitglied_PositionChanged(null, System.EventArgs.Empty);
            ShowRekursInfo();
        }

        private void qryWVEinheit_PositionChanged(object sender, System.EventArgs e)
        {
            if (qryWVEinheit.Count > 0)
            {
                this.qryWVMitglied.Fill(qryWVEinheit["WhWVEinheitID"]);
                this.edtBaPersonID.Properties.DataSource = this.qryWVMitglied;
                this.grdWVMitglied.DataSource = this.qryWVMitglied;
                einheitUngueltig = (bool)qryWVEinheit["Ungueltig"] == true;
                //bool einzelpostenVorhanden = (int)qryWVEinheit["AnzahlEinzelposten"] > 0;
                //qryWVEinheit.CanDelete = !einzelpostenVorhanden;
                btnUngueltig.Visible = !einheitUngueltig && DBUtil.UserHasRight("CtlWhWVEinheit_ManuelleEingriffe");// && einzelpostenVorhanden;

                HighlightTimeline();

                qryWVMitglied_PositionChanged(null, System.EventArgs.Empty);

                ShowRekursInfo();
                SetEditMode();
            }
        }

        private void qryWVEinheit_PostCompleted(object sender, EventArgs e)
        {
            if (wvTraegerChanged)
            {
                // Ergänzende Informationen holen
                SqlQuery qry = DBUtil.OpenSQL(@"
                  SELECT UT = PRS.NameVorname, PRS.Geburtsdatum, WeitereMitglieder = dbo.[fnGetWVUnitMembers] (WVE.WhWvEinheitID, WVE.BaPersonID)
                  FROM WhWVEinheit     WVE
                    LEFT JOIN vwPerson PRS ON PRS.BaPersonID = WVE.BaPersonID
                  WHERE WhWVEinheitID = {0}", qryWVEinheit["WhWVEinheitID"]);
                qryWVEinheit["UT"] = qry["UT"];
                qryWVEinheit["Geburtsdatum"] = qry["Geburtsdatum"];
                qryWVEinheit["WeitereMitglieder"] = qry["WeitereMitglieder"];

                wvTraegerChanged = false;
                qryWVEinheit.Post();
            }
            qryWVEinheit_PositionChanged(null, System.EventArgs.Empty);
        }

        private void qryWVMitglied_PositionChanged(object sender, System.EventArgs e)
        {
            if (DBUtil.IsEmpty(qryWVEinheit["BaPersonID"]) || DBUtil.IsEmpty(qryWVMitglied["BaPersonID"]))
                return;

            bool mitgliedIstUT = (qryWVEinheit["BaPersonID"].ToString() == qryWVMitglied["BaPersonID"].ToString());
        }

        private void qryWVEinheit_AfterFill(object sender, EventArgs e)
        {
            ShowRekursInfo();
        }

        private void ShowRekursInfo()
        {
            try
            {
                SqlQuery qry = DBUtil.OpenSQL(@"
                    select MutationRekurs              = isNull((select LogonName + ', ' + convert(varchar,{1},104) from XUser where UserID = {0}),'---'),
                           MutationRekursAbgeschlossen = isNull((select LogonName + ', ' + convert(varchar,{3},104) from XUser where UserID = {2}),'---'),
                           ToolTipRekurs               = isNull((select LogonNameVornameOrgUnit from vwUser where UserID = {0}),''),
                           ToolTipRekursAbgeschlossen  = isNull((select LogonNameVornameOrgUnit from vwUser where UserID = {2}),'')",
                    qryWVEinheit["RekursMutiertUserID"],
                    qryWVEinheit["RekursMutiertDatum"],
                    qryWVEinheit["RekursAbgeschlossenMutiertUserID"],
                    qryWVEinheit["RekursAbgeschlossenMutiertDatum"]);

                if (qry.Count > 0)
                {
                    lblRekursMutiert.Text = qry["MutationRekurs"].ToString();
                    lblRekursAbgeschlossenMutiert.Text = qry["MutationRekursAbgeschlossen"].ToString();
                    toolTip.SetToolTip(lblRekursMutiert, qry["ToolTipRekurs"].ToString());
                    toolTip.SetToolTip(lblRekursAbgeschlossenMutiert, qry["ToolTipRekursAbgeschlossen"].ToString());
                }
            }
            catch
            {
                lblRekursMutiert.Text = "---";
                lblRekursAbgeschlossenMutiert.Text = "---";
                toolTip.SetToolTip(lblRekursMutiert, String.Empty);
                toolTip.SetToolTip(lblRekursAbgeschlossenMutiert, String.Empty);
            }
        }

        private void SetEditMode()
        {
            string kuerzel = qryWVEinheit["CodeKuerzel"] as string;
            bool isRekursNotPossible = string.IsNullOrEmpty(kuerzel) || kuerzel.Length < 3 || kuerzel[2] == 'E';
            bool rekursEmpty = DBUtil.IsEmpty(qryWVEinheit["Rekurs"]) && DBUtil.IsEmpty(edtRekurs.EditValue);
            bool rekursAbgeschlossenEmpty = DBUtil.IsEmpty(qryWVEinheit["RekursAbgeschlossen"]) && DBUtil.IsEmpty(edtRekursAbgeschlossen.EditValue);

            edtRekurs.EditMode = !isRekursNotPossible && userMayEditRekurs && rekursAbgeschlossenEmpty ? Kiss.Interfaces.UI.EditModeType.Normal : Kiss.Interfaces.UI.EditModeType.ReadOnly;
            edtRekursAbgeschlossen.EditMode = !isRekursNotPossible && userMayEditRekurs && !rekursEmpty ? Kiss.Interfaces.UI.EditModeType.Normal : Kiss.Interfaces.UI.EditModeType.ReadOnly;
        }

        private void edtRekurs_EditValueChanged(object sender, EventArgs e)
        {
            SetEditMode();
        }

        private void edtRekursAbgeschlossen_EditValueChanged(object sender, EventArgs e)
        {
            SetEditMode();
        }

        #endregion
    }
}