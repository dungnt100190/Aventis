#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Data;
using System.Windows.Forms;

using Kiss.Infrastructure;
using Kiss.Interfaces.UI;
using KiSS4.Common;
using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Sozialhilfe.ZH
{
    public class DlgWhWeitereZahlinfo : KiSS4.Gui.KissDialog, IBelegleser
    {
        #region Enumerations

        public enum KiSSKunde
        {
            BSS = 1,	//BSS ist Standard
            FAMOZ = 2	//ZH
        }

        #endregion

        #region Fields

        public int BgPositionID;
        public bool ReadOnly;
        private DevExpress.XtraGrid.Views.BandedGrid.BandedGridView bandedGridView1;
        private KiSS4.Gui.KissButton btnAbbrechen;
        private KiSS4.Gui.KissButton btnOk;
        private DevExpress.XtraGrid.Columns.GridColumn colAuszahlung;
        private DevExpress.XtraGrid.Columns.GridColumn colKlient;
        private DevExpress.XtraGrid.Columns.GridColumn colKreditor;
        private DevExpress.XtraGrid.Columns.GridColumn colLT;
        private DevExpress.XtraGrid.Columns.GridColumn colTermin;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissLookUpEdit edtBgAuszahlungsTerminCode;
        private SharpLibrary.WinControls.MonthCalendarEx edtCalendar;
        private KiSS4.Gui.KissLookUpEdit edtKbAuszahlungsArtCode;
        private KiSS4.Gui.KissButtonEdit edtKreditor;
        private KiSS4.Gui.KissTextEdit edtMitteilungZeile1;
        private KiSS4.Gui.KissTextEdit edtMitteilungZeile2;
        private KiSS4.Gui.KissTextEdit edtMitteilungZeile3;
        private KiSS4.Common.KissReferenzNrEdit edtReferenzNummer;
        private KiSS4.Gui.KissDateEdit edtValutaDatum;
        private KiSS4.Gui.KissTextEdit edtValutaTermine;
        private KiSS4.Gui.KissCheckedLookupEdit edtWochentagCodes;
        private DevExpress.XtraGrid.Views.BandedGrid.GridBand gridBand1;
        private DevExpress.XtraGrid.Views.Grid.GridView gridView1;
        private KiSSKunde kiSSKunde = KiSSKunde.FAMOZ;
        private KiSS4.Gui.KissGrid kissGrid1;
        private KiSS4.Gui.KissMemoEdit kissMemoEdit1;
        private KiSS4.Gui.KissTextEdit kissTextEdit1;
        private KiSS4.Gui.KissLabel lblBaPersonID;
        private KiSS4.Gui.KissLabel lblBgAuszahlungsTerminCode;
        private KiSS4.Gui.KissLabel lblKbAuszahlungsArtCode;
        private KiSS4.Gui.KissLabel lblKreditor;
        private KiSS4.Gui.KissLabel lblMitteilung;
        private KiSS4.Gui.KissLabel lblReferenzNummer;
        private KiSS4.Gui.KissLabel lblValutaDatum;
        private KiSS4.Gui.KissLabel lblZahlbarAn;
        private KiSS4.DB.SqlQuery qryBgAuszahlungPerson;
        private KiSS4.DB.SqlQuery qryBgAuszahlungPersonTermin;
        private KiSS4.Gui.KissTabControlEx tabZahlinfo;
        private System.Windows.Forms.Timer timer1;
        private SharpLibrary.WinControls.TabPageEx tpgKalender;
        private SharpLibrary.WinControls.TabPageEx tpgMitteilung;
        private SharpLibrary.WinControls.TabPageEx tpgZahlinfo;
        private bool CalendarFilling = false;

        #endregion

        #region Constructors

        public DlgWhWeitereZahlinfo(int BgPositionID, bool ReadOnly)
            : this()
        {
            this.BgPositionID = BgPositionID;
            this.ReadOnly = ReadOnly;

            lblZahlbarAn.Left = lblMitteilung.Left;
            edtValutaTermine.Left = edtValutaDatum.Left;

            edtCalendar.DateChanged += new DateRangeEventHandler(edtCalendar_DateChanged);
            timer1.Tick += new System.EventHandler(this.timer1_Tick);

            colAuszahlung.ColumnEdit = kissGrid1.GetLOVLookUpEdit(DBUtil.OpenSQL(@"select * from XLOVCode where LOVName = 'KbAuszahlungsArt'"), "Code", "ShortText");
            colTermin.ColumnEdit = kissGrid1.GetLOVLookUpEdit("BgAuszahlungsTermin");
            qryBgAuszahlungPerson.CanUpdate = !ReadOnly;

            if (!ReadOnly)
                DBUtil.ExecSQL("exec spWhBudget_CreateQuotedZahlinfo {0}", BgPositionID); //erzeugt personenbezogene Zahlinfos, falls noch nicht vorhanden
            qryBgAuszahlungPerson.Fill(BgPositionID);
        }

        public DlgWhWeitereZahlinfo()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(DlgWhWeitereZahlinfo));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            this.kissGrid1 = new KiSS4.Gui.KissGrid();
            this.btnOk = new KiSS4.Gui.KissButton();
            this.edtKbAuszahlungsArtCode = new KiSS4.Gui.KissLookUpEdit();
            this.btnAbbrechen = new KiSS4.Gui.KissButton();
            this.edtBgAuszahlungsTerminCode = new KiSS4.Gui.KissLookUpEdit();
            this.lblKbAuszahlungsArtCode = new KiSS4.Gui.KissLabel();
            this.lblBgAuszahlungsTerminCode = new KiSS4.Gui.KissLabel();
            this.tabZahlinfo = new KiSS4.Gui.KissTabControlEx();
            this.tpgZahlinfo = new SharpLibrary.WinControls.TabPageEx();
            this.edtValutaDatum = new KiSS4.Gui.KissDateEdit();
            this.edtKreditor = new KiSS4.Gui.KissButtonEdit();
            this.edtReferenzNummer = new KiSS4.Common.KissReferenzNrEdit(this.components);
            this.lblValutaDatum = new KiSS4.Gui.KissLabel();
            this.lblKreditor = new KiSS4.Gui.KissLabel();
            this.lblReferenzNummer = new KiSS4.Gui.KissLabel();
            this.kissMemoEdit1 = new KiSS4.Gui.KissMemoEdit();
            this.edtValutaTermine = new KiSS4.Gui.KissTextEdit();
            this.tpgMitteilung = new SharpLibrary.WinControls.TabPageEx();
            this.edtMitteilungZeile1 = new KiSS4.Gui.KissTextEdit();
            this.edtMitteilungZeile2 = new KiSS4.Gui.KissTextEdit();
            this.edtMitteilungZeile3 = new KiSS4.Gui.KissTextEdit();
            this.lblMitteilung = new KiSS4.Gui.KissLabel();
            this.lblZahlbarAn = new KiSS4.Gui.KissLabel();
            this.tpgKalender = new SharpLibrary.WinControls.TabPageEx();
            this.edtCalendar = new SharpLibrary.WinControls.MonthCalendarEx();
            this.edtWochentagCodes = new KiSS4.Gui.KissCheckedLookupEdit();
            this.lblBaPersonID = new KiSS4.Gui.KissLabel();
            this.kissTextEdit1 = new KiSS4.Gui.KissTextEdit();
            this.bandedGridView1 = new DevExpress.XtraGrid.Views.BandedGrid.BandedGridView();
            this.colAuszahlung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colKlient = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colKreditor = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLT = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colTermin = new DevExpress.XtraGrid.Columns.GridColumn();
            this.gridBand1 = new DevExpress.XtraGrid.Views.BandedGrid.GridBand();
            this.gridView1 = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.qryBgAuszahlungPerson = new KiSS4.DB.SqlQuery(this.components);
            this.qryBgAuszahlungPersonTermin = new KiSS4.DB.SqlQuery(this.components);
            this.timer1 = new System.Windows.Forms.Timer(this.components);
            ((System.ComponentModel.ISupportInitialize)(this.kissGrid1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKbAuszahlungsArtCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKbAuszahlungsArtCode.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgAuszahlungsTerminCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgAuszahlungsTerminCode.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKbAuszahlungsArtCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBgAuszahlungsTerminCode)).BeginInit();
            this.tabZahlinfo.SuspendLayout();
            this.tpgZahlinfo.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.edtValutaDatum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKreditor.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtReferenzNummer.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblValutaDatum)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKreditor)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblReferenzNummer)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissMemoEdit1.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtValutaTermine.Properties)).BeginInit();
            this.tpgMitteilung.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.edtMitteilungZeile1.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtMitteilungZeile2.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtMitteilungZeile3.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMitteilung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblZahlbarAn)).BeginInit();
            this.tpgKalender.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.edtCalendar)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtWochentagCodes)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissTextEdit1.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.bandedGridView1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gridView1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgAuszahlungPerson)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgAuszahlungPersonTermin)).BeginInit();
            this.SuspendLayout();
            //
            // kissGrid1
            //
            this.kissGrid1.DataSource = this.qryBgAuszahlungPerson;
            this.kissGrid1.EmbeddedNavigator.Name = "";
            this.kissGrid1.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.kissGrid1.Location = new System.Drawing.Point(5, 5);
            this.kissGrid1.MainView = this.gridView1;
            this.kissGrid1.Name = "kissGrid1";
            this.kissGrid1.Size = new System.Drawing.Size(529, 152);
            this.kissGrid1.TabIndex = 0;
            this.kissGrid1.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
                        this.bandedGridView1,
                        this.gridView1});
            //
            // btnOk
            //
            this.btnOk.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnOk.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnOk.Location = new System.Drawing.Point(347, 485);
            this.btnOk.Name = "btnOk";
            this.btnOk.Size = new System.Drawing.Size(90, 24);
            this.btnOk.TabIndex = 1;
            this.btnOk.Text = "OK";
            this.btnOk.UseCompatibleTextRendering = true;
            this.btnOk.UseVisualStyleBackColor = false;
            this.btnOk.Click += new System.EventHandler(this.btnOk_Click);
            //
            // edtKbAuszahlungsArtCode
            //
            this.edtKbAuszahlungsArtCode.AllowNull = false;
            this.edtKbAuszahlungsArtCode.DataMember = "KbAuszahlungsArtCode";
            this.edtKbAuszahlungsArtCode.DataSource = this.qryBgAuszahlungPerson;
            this.edtKbAuszahlungsArtCode.Location = new System.Drawing.Point(92, 200);
            this.edtKbAuszahlungsArtCode.LOVFilter = "S";
            this.edtKbAuszahlungsArtCode.LOVName = "KbAuszahlungsArt";
            this.edtKbAuszahlungsArtCode.Name = "edtKbAuszahlungsArtCode";
            this.edtKbAuszahlungsArtCode.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtKbAuszahlungsArtCode.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtKbAuszahlungsArtCode.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtKbAuszahlungsArtCode.Properties.Appearance.Options.UseBackColor = true;
            this.edtKbAuszahlungsArtCode.Properties.Appearance.Options.UseBorderColor = true;
            this.edtKbAuszahlungsArtCode.Properties.Appearance.Options.UseFont = true;
            this.edtKbAuszahlungsArtCode.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtKbAuszahlungsArtCode.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtKbAuszahlungsArtCode.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtKbAuszahlungsArtCode.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtKbAuszahlungsArtCode.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            this.edtKbAuszahlungsArtCode.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4)});
            this.edtKbAuszahlungsArtCode.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtKbAuszahlungsArtCode.Properties.NullText = "";
            this.edtKbAuszahlungsArtCode.Properties.ShowFooter = false;
            this.edtKbAuszahlungsArtCode.Properties.ShowHeader = false;
            this.edtKbAuszahlungsArtCode.Size = new System.Drawing.Size(362, 24);
            this.edtKbAuszahlungsArtCode.TabIndex = 1;
            this.edtKbAuszahlungsArtCode.EditValueChanged += new System.EventHandler(this.edtKbAuszahlungsArtCode_EditValueChanged);
            //
            // btnAbbrechen
            //
            this.btnAbbrechen.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnAbbrechen.DialogResult = System.Windows.Forms.DialogResult.Cancel;
            this.btnAbbrechen.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnAbbrechen.Location = new System.Drawing.Point(443, 485);
            this.btnAbbrechen.Name = "btnAbbrechen";
            this.btnAbbrechen.Size = new System.Drawing.Size(90, 24);
            this.btnAbbrechen.TabIndex = 2;
            this.btnAbbrechen.Text = "Abbrechen";
            this.btnAbbrechen.UseCompatibleTextRendering = true;
            this.btnAbbrechen.UseVisualStyleBackColor = true;
            this.btnAbbrechen.Click += new System.EventHandler(this.btnAbbrechen_Click);
            //
            // edtBgAuszahlungsTerminCode
            //
            this.edtBgAuszahlungsTerminCode.AllowNull = false;
            this.edtBgAuszahlungsTerminCode.DataMember = "BgAuszahlungsTerminCode";
            this.edtBgAuszahlungsTerminCode.DataSource = this.qryBgAuszahlungPerson;
            this.edtBgAuszahlungsTerminCode.Location = new System.Drawing.Point(92, 230);
            this.edtBgAuszahlungsTerminCode.LOVFilter = "aktiv";
            this.edtBgAuszahlungsTerminCode.LOVName = "BgAuszahlungsTermin";
            this.edtBgAuszahlungsTerminCode.Name = "edtBgAuszahlungsTerminCode";
            this.edtBgAuszahlungsTerminCode.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBgAuszahlungsTerminCode.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBgAuszahlungsTerminCode.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBgAuszahlungsTerminCode.Properties.Appearance.Options.UseBackColor = true;
            this.edtBgAuszahlungsTerminCode.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBgAuszahlungsTerminCode.Properties.Appearance.Options.UseFont = true;
            this.edtBgAuszahlungsTerminCode.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtBgAuszahlungsTerminCode.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtBgAuszahlungsTerminCode.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtBgAuszahlungsTerminCode.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtBgAuszahlungsTerminCode.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            this.edtBgAuszahlungsTerminCode.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3)});
            this.edtBgAuszahlungsTerminCode.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBgAuszahlungsTerminCode.Properties.NullText = "";
            this.edtBgAuszahlungsTerminCode.Properties.ShowFooter = false;
            this.edtBgAuszahlungsTerminCode.Properties.ShowHeader = false;
            this.edtBgAuszahlungsTerminCode.Size = new System.Drawing.Size(363, 24);
            this.edtBgAuszahlungsTerminCode.TabIndex = 2;
            this.edtBgAuszahlungsTerminCode.EditValueChanged += new System.EventHandler(this.edtBgAuszahlungsTerminCode_EditValueChanged);
            //
            // lblKbAuszahlungsArtCode
            //
            this.lblKbAuszahlungsArtCode.Location = new System.Drawing.Point(5, 200);
            this.lblKbAuszahlungsArtCode.Name = "lblKbAuszahlungsArtCode";
            this.lblKbAuszahlungsArtCode.Size = new System.Drawing.Size(86, 24);
            this.lblKbAuszahlungsArtCode.TabIndex = 61;
            this.lblKbAuszahlungsArtCode.Text = "Auszahlungsart";
            this.lblKbAuszahlungsArtCode.UseCompatibleTextRendering = true;
            //
            // lblBgAuszahlungsTerminCode
            //
            this.lblBgAuszahlungsTerminCode.Location = new System.Drawing.Point(5, 230);
            this.lblBgAuszahlungsTerminCode.Name = "lblBgAuszahlungsTerminCode";
            this.lblBgAuszahlungsTerminCode.Size = new System.Drawing.Size(48, 24);
            this.lblBgAuszahlungsTerminCode.TabIndex = 63;
            this.lblBgAuszahlungsTerminCode.Text = "Termin";
            this.lblBgAuszahlungsTerminCode.UseCompatibleTextRendering = true;
            //
            // tabZahlinfo
            //
            this.tabZahlinfo.Controls.Add(this.tpgKalender);
            this.tabZahlinfo.Controls.Add(this.tpgMitteilung);
            this.tabZahlinfo.Controls.Add(this.tpgZahlinfo);
            this.tabZahlinfo.Location = new System.Drawing.Point(92, 262);
            this.tabZahlinfo.Name = "tabZahlinfo";
            this.tabZahlinfo.ShowFixedWidthTooltip = true;
            this.tabZahlinfo.Size = new System.Drawing.Size(363, 223);
            this.tabZahlinfo.TabIndex = 64;
            this.tabZahlinfo.TabPages.AddRange(new SharpLibrary.WinControls.TabPageEx[] {
                        this.tpgZahlinfo,
                        this.tpgMitteilung,
                        this.tpgKalender});
            this.tabZahlinfo.TabsLineColor = System.Drawing.Color.Black;
            this.tabZahlinfo.TabsStyle = SharpLibrary.WinControls.TabsStyle.Flat;
            //
            // tpgZahlinfo
            //
            this.tpgZahlinfo.Controls.Add(this.edtValutaTermine);
            this.tpgZahlinfo.Controls.Add(this.kissMemoEdit1);
            this.tpgZahlinfo.Controls.Add(this.lblReferenzNummer);
            this.tpgZahlinfo.Controls.Add(this.lblKreditor);
            this.tpgZahlinfo.Controls.Add(this.lblValutaDatum);
            this.tpgZahlinfo.Controls.Add(this.edtReferenzNummer);
            this.tpgZahlinfo.Controls.Add(this.edtKreditor);
            this.tpgZahlinfo.Controls.Add(this.edtValutaDatum);
            this.tpgZahlinfo.Location = new System.Drawing.Point(6, 6);
            this.tpgZahlinfo.Name = "tpgZahlinfo";
            this.tpgZahlinfo.Size = new System.Drawing.Size(351, 185);
            this.tpgZahlinfo.TabIndex = 0;
            this.tpgZahlinfo.Title = "Zahlinfo";
            //
            // edtValutaDatum
            //
            this.edtValutaDatum.DataMember = "ValutaDatum";
            this.edtValutaDatum.DataSource = this.qryBgAuszahlungPerson;
            this.edtValutaDatum.EditValue = null;
            this.edtValutaDatum.Location = new System.Drawing.Point(62, 3);
            this.edtValutaDatum.Name = "edtValutaDatum";
            this.edtValutaDatum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtValutaDatum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtValutaDatum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtValutaDatum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtValutaDatum.Properties.Appearance.Options.UseBackColor = true;
            this.edtValutaDatum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtValutaDatum.Properties.Appearance.Options.UseFont = true;
            this.edtValutaDatum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtValutaDatum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtValutaDatum.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtValutaDatum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtValutaDatum.Properties.ShowToday = false;
            this.edtValutaDatum.Size = new System.Drawing.Size(100, 24);
            this.edtValutaDatum.TabIndex = 0;
            //
            // edtKreditor
            //
            this.edtKreditor.DataMember = "Kreditor";
            this.edtKreditor.DataSource = this.qryBgAuszahlungPerson;
            this.edtKreditor.Location = new System.Drawing.Point(62, 32);
            this.edtKreditor.Name = "edtKreditor";
            this.edtKreditor.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtKreditor.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtKreditor.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtKreditor.Properties.Appearance.Options.UseBackColor = true;
            this.edtKreditor.Properties.Appearance.Options.UseBorderColor = true;
            this.edtKreditor.Properties.Appearance.Options.UseFont = true;
            this.edtKreditor.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtKreditor.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtKreditor.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtKreditor.Size = new System.Drawing.Size(272, 24);
            this.edtKreditor.TabIndex = 1;
            this.edtKreditor.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtKreditor_UserModifiedFld);
            //
            // edtReferenzNummer
            //
            this.edtReferenzNummer.DataMember = "ReferenzNummer";
            this.edtReferenzNummer.DataSource = this.qryBgAuszahlungPerson;
            this.edtReferenzNummer.Location = new System.Drawing.Point(62, 156);
            this.edtReferenzNummer.Name = "edtReferenzNummer";
            this.edtReferenzNummer.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtReferenzNummer.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtReferenzNummer.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtReferenzNummer.Properties.Appearance.Options.UseBackColor = true;
            this.edtReferenzNummer.Properties.Appearance.Options.UseBorderColor = true;
            this.edtReferenzNummer.Properties.Appearance.Options.UseFont = true;
            this.edtReferenzNummer.Properties.Appearance.Options.UseTextOptions = true;
            this.edtReferenzNummer.Properties.Appearance.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Near;
            this.edtReferenzNummer.Properties.AppearanceDisabled.Options.UseTextOptions = true;
            this.edtReferenzNummer.Properties.AppearanceDisabled.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Near;
            this.edtReferenzNummer.Properties.AppearanceFocused.Options.UseTextOptions = true;
            this.edtReferenzNummer.Properties.AppearanceFocused.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Near;
            this.edtReferenzNummer.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtReferenzNummer.Size = new System.Drawing.Size(272, 24);
            this.edtReferenzNummer.TabIndex = 2;
            //
            // lblValutaDatum
            //
            this.lblValutaDatum.Location = new System.Drawing.Point(5, 3);
            this.lblValutaDatum.Name = "lblValutaDatum";
            this.lblValutaDatum.Size = new System.Drawing.Size(55, 24);
            this.lblValutaDatum.TabIndex = 25;
            this.lblValutaDatum.Text = "Valuta";
            this.lblValutaDatum.UseCompatibleTextRendering = true;
            //
            // lblKreditor
            //
            this.lblKreditor.Location = new System.Drawing.Point(5, 32);
            this.lblKreditor.Name = "lblKreditor";
            this.lblKreditor.Size = new System.Drawing.Size(51, 24);
            this.lblKreditor.TabIndex = 47;
            this.lblKreditor.Text = "Kreditor";
            this.lblKreditor.UseCompatibleTextRendering = true;
            //
            // lblReferenzNummer
            //
            this.lblReferenzNummer.Location = new System.Drawing.Point(5, 156);
            this.lblReferenzNummer.Name = "lblReferenzNummer";
            this.lblReferenzNummer.Size = new System.Drawing.Size(51, 24);
            this.lblReferenzNummer.TabIndex = 50;
            this.lblReferenzNummer.Text = "Ref-Nr.";
            this.lblReferenzNummer.UseCompatibleTextRendering = true;
            //
            // kissMemoEdit1
            //
            this.kissMemoEdit1.DataMember = "Zusatzinfo";
            this.kissMemoEdit1.DataSource = this.qryBgAuszahlungPerson;
            this.kissMemoEdit1.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.kissMemoEdit1.Location = new System.Drawing.Point(62, 55);
            this.kissMemoEdit1.Name = "kissMemoEdit1";
            this.kissMemoEdit1.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.kissMemoEdit1.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.kissMemoEdit1.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.kissMemoEdit1.Properties.Appearance.Options.UseBackColor = true;
            this.kissMemoEdit1.Properties.Appearance.Options.UseBorderColor = true;
            this.kissMemoEdit1.Properties.Appearance.Options.UseFont = true;
            this.kissMemoEdit1.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.kissMemoEdit1.Properties.ReadOnly = true;
            this.kissMemoEdit1.Size = new System.Drawing.Size(272, 102);
            this.kissMemoEdit1.TabIndex = 52;
            //
            // edtValutaTermine
            //
            this.edtValutaTermine.DataMember = "ValutaTermine";
            this.edtValutaTermine.DataSource = this.qryBgAuszahlungPerson;
            this.edtValutaTermine.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtValutaTermine.Location = new System.Drawing.Point(84, 3);
            this.edtValutaTermine.Name = "edtValutaTermine";
            this.edtValutaTermine.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtValutaTermine.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtValutaTermine.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtValutaTermine.Properties.Appearance.Options.UseBackColor = true;
            this.edtValutaTermine.Properties.Appearance.Options.UseBorderColor = true;
            this.edtValutaTermine.Properties.Appearance.Options.UseFont = true;
            this.edtValutaTermine.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtValutaTermine.Properties.ReadOnly = true;
            this.edtValutaTermine.Size = new System.Drawing.Size(272, 24);
            this.edtValutaTermine.TabIndex = 54;
            //
            // tpgMitteilung
            //
            this.tpgMitteilung.Controls.Add(this.lblZahlbarAn);
            this.tpgMitteilung.Controls.Add(this.lblMitteilung);
            this.tpgMitteilung.Controls.Add(this.edtMitteilungZeile3);
            this.tpgMitteilung.Controls.Add(this.edtMitteilungZeile2);
            this.tpgMitteilung.Controls.Add(this.edtMitteilungZeile1);
            this.tpgMitteilung.Location = new System.Drawing.Point(6, 6);
            this.tpgMitteilung.Name = "tpgMitteilung";
            this.tpgMitteilung.Size = new System.Drawing.Size(351, 185);
            this.tpgMitteilung.TabIndex = 1;
            this.tpgMitteilung.Title = "Mitteilung";
            //
            // edtMitteilungZeile1
            //
            this.edtMitteilungZeile1.DataMember = "MitteilungZeile1";
            this.edtMitteilungZeile1.DataSource = this.qryBgAuszahlungPerson;
            this.edtMitteilungZeile1.Location = new System.Drawing.Point(68, 63);
            this.edtMitteilungZeile1.Name = "edtMitteilungZeile1";
            this.edtMitteilungZeile1.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtMitteilungZeile1.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtMitteilungZeile1.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtMitteilungZeile1.Properties.Appearance.Options.UseBackColor = true;
            this.edtMitteilungZeile1.Properties.Appearance.Options.UseBorderColor = true;
            this.edtMitteilungZeile1.Properties.Appearance.Options.UseFont = true;
            this.edtMitteilungZeile1.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtMitteilungZeile1.Properties.MaxLength = 35;
            this.edtMitteilungZeile1.Size = new System.Drawing.Size(208, 24);
            this.edtMitteilungZeile1.TabIndex = 12;
            //
            // edtMitteilungZeile2
            //
            this.edtMitteilungZeile2.DataMember = "MitteilungZeile2";
            this.edtMitteilungZeile2.DataSource = this.qryBgAuszahlungPerson;
            this.edtMitteilungZeile2.Location = new System.Drawing.Point(68, 86);
            this.edtMitteilungZeile2.Name = "edtMitteilungZeile2";
            this.edtMitteilungZeile2.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtMitteilungZeile2.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtMitteilungZeile2.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtMitteilungZeile2.Properties.Appearance.Options.UseBackColor = true;
            this.edtMitteilungZeile2.Properties.Appearance.Options.UseBorderColor = true;
            this.edtMitteilungZeile2.Properties.Appearance.Options.UseFont = true;
            this.edtMitteilungZeile2.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtMitteilungZeile2.Properties.MaxLength = 35;
            this.edtMitteilungZeile2.Size = new System.Drawing.Size(208, 24);
            this.edtMitteilungZeile2.TabIndex = 13;
            //
            // edtMitteilungZeile3
            //
            this.edtMitteilungZeile3.DataMember = "MitteilungZeile3";
            this.edtMitteilungZeile3.DataSource = this.qryBgAuszahlungPerson;
            this.edtMitteilungZeile3.Location = new System.Drawing.Point(68, 109);
            this.edtMitteilungZeile3.Name = "edtMitteilungZeile3";
            this.edtMitteilungZeile3.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtMitteilungZeile3.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtMitteilungZeile3.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtMitteilungZeile3.Properties.Appearance.Options.UseBackColor = true;
            this.edtMitteilungZeile3.Properties.Appearance.Options.UseBorderColor = true;
            this.edtMitteilungZeile3.Properties.Appearance.Options.UseFont = true;
            this.edtMitteilungZeile3.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtMitteilungZeile3.Properties.MaxLength = 35;
            this.edtMitteilungZeile3.Size = new System.Drawing.Size(208, 24);
            this.edtMitteilungZeile3.TabIndex = 14;
            //
            // lblMitteilung
            //
            this.lblMitteilung.Location = new System.Drawing.Point(68, 36);
            this.lblMitteilung.Name = "lblMitteilung";
            this.lblMitteilung.Size = new System.Drawing.Size(51, 24);
            this.lblMitteilung.TabIndex = 15;
            this.lblMitteilung.Text = "Mitteilung";
            this.lblMitteilung.UseCompatibleTextRendering = true;
            //
            // lblZahlbarAn
            //
            this.lblZahlbarAn.Location = new System.Drawing.Point(218, 37);
            this.lblZahlbarAn.Name = "lblZahlbarAn";
            this.lblZahlbarAn.Size = new System.Drawing.Size(58, 24);
            this.lblZahlbarAn.TabIndex = 18;
            this.lblZahlbarAn.Text = "zahlbar an";
            this.lblZahlbarAn.UseCompatibleTextRendering = true;
            //
            // tpgKalender
            //
            this.tpgKalender.Controls.Add(this.edtWochentagCodes);
            this.tpgKalender.Controls.Add(this.edtCalendar);
            this.tpgKalender.Location = new System.Drawing.Point(6, 6);
            this.tpgKalender.Name = "tpgKalender";
            this.tpgKalender.Size = new System.Drawing.Size(351, 185);
            this.tpgKalender.TabIndex = 2;
            this.tpgKalender.Title = "Kalender";
            //
            // edtCalendar
            //
            this.edtCalendar.AllowRangeSelection = false;
            this.edtCalendar.BoldedDates = new System.DateTime[] {
                    new System.DateTime(2007, 10, 10, 0, 0, 0, 0),
                    new System.DateTime(2007, 10, 12, 0, 0, 0, 0),
                    new System.DateTime(2007, 12, 15, 0, 0, 0, 0),
                    new System.DateTime(2007, 12, 16, 0, 0, 0, 0)};
            this.edtCalendar.BoldedDatesBackColor = System.Drawing.Color.FromArgb(((int)(((byte)(255)))), ((int)(((byte)(192)))), ((int)(((byte)(128)))));
            this.edtCalendar.BoldedDatesForeColor = System.Drawing.SystemColors.ControlText;
            this.edtCalendar.BorderStyleEx = SharpLibrary.WinControls.BorderStyleEx.FixedSingle;
            this.edtCalendar.CalendarDimensions = new System.Drawing.Size(2, 1);
            this.edtCalendar.DrawNextMonthDays = false;
            this.edtCalendar.DrawPreviousMonthDays = false;
            this.edtCalendar.DrawWeekNumbersBorder = true;
            this.edtCalendar.FooterFont = new System.Drawing.Font("Microsoft Sans Serif", 8.25F);
            this.edtCalendar.GoToTodayLocalizedString = "heute";
            //
            //
            //
            this.edtCalendar.LeftButtonPoupMenu.Font = new System.Drawing.Font("Tahoma", 11F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.World);
            this.edtCalendar.Location = new System.Drawing.Point(6, 11);
            this.edtCalendar.MaxSelectionCount = 1;
            this.edtCalendar.Name = "edtCalendar";
            this.edtCalendar.NextMonthForeColor = System.Drawing.SystemColors.GrayText;
            //
            //
            //
            this.edtCalendar.RightButtonPoupMenu.Font = new System.Drawing.Font("Tahoma", 11F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.World);
            this.edtCalendar.SelectionEnd = new System.DateTime(2007, 12, 15, 0, 0, 0, 0);
            this.edtCalendar.SelectionStart = new System.DateTime(2007, 12, 15, 0, 0, 0, 0);
            this.edtCalendar.ShowFooter = false;
            this.edtCalendar.ShowLeftButtonPopupMenu = false;
            this.edtCalendar.ShowRightButtonPopupMenu = false;
            this.edtCalendar.ShowTodayCircle = false;
            this.edtCalendar.ShowWeekNumbers = true;
            this.edtCalendar.Size = new System.Drawing.Size(340, 160);
            this.edtCalendar.TabIndex = 14;
            this.edtCalendar.TitleBackgroundStyle = SharpLibrary.WinControls.BackgroundStyle.SolidColor;
            this.edtCalendar.TitleFont = new System.Drawing.Font("Microsoft Sans Serif", 8.25F);
            this.edtCalendar.TodayCircleImage = null;
            this.edtCalendar.TodayCircleImageToTextMargin = 0;
            this.edtCalendar.TodayDate = new System.DateTime(2007, 12, 15, 0, 0, 0, 0);
            this.edtCalendar.TodayLocalizedString = "heute";
            this.edtCalendar.WeekNumbersToWeekDaysMargin = 5;
            //
            // edtWochentagCodes
            //
            this.edtWochentagCodes.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(244)))), ((int)(((byte)(240)))), ((int)(((byte)(230)))));
            this.edtWochentagCodes.Appearance.Options.UseBackColor = true;
            this.edtWochentagCodes.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.NoBorder;
            this.edtWochentagCodes.CheckOnClick = true;
            this.edtWochentagCodes.Items.AddRange(new DevExpress.XtraEditors.Controls.CheckedListBoxItem[] {
                        new DevExpress.XtraEditors.Controls.CheckedListBoxItem("Mo"),
                        new DevExpress.XtraEditors.Controls.CheckedListBoxItem("Di"),
                        new DevExpress.XtraEditors.Controls.CheckedListBoxItem("Mi"),
                        new DevExpress.XtraEditors.Controls.CheckedListBoxItem("Do"),
                        new DevExpress.XtraEditors.Controls.CheckedListBoxItem("Fr")});
            this.edtWochentagCodes.Location = new System.Drawing.Point(74, 60);
            this.edtWochentagCodes.LOVName = "KgWochentag";
            this.edtWochentagCodes.Name = "edtWochentagCodes";
            this.edtWochentagCodes.Size = new System.Drawing.Size(50, 95);
            this.edtWochentagCodes.TabIndex = 16;
            this.edtWochentagCodes.Visible = false;
            //
            // lblBaPersonID
            //
            this.lblBaPersonID.Location = new System.Drawing.Point(5, 170);
            this.lblBaPersonID.Name = "lblBaPersonID";
            this.lblBaPersonID.Size = new System.Drawing.Size(81, 24);
            this.lblBaPersonID.TabIndex = 70;
            this.lblBaPersonID.Text = "Betrifft Person";
            this.lblBaPersonID.UseCompatibleTextRendering = true;
            //
            // kissTextEdit1
            //
            this.kissTextEdit1.DataMember = "Person";
            this.kissTextEdit1.DataSource = this.qryBgAuszahlungPerson;
            this.kissTextEdit1.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.kissTextEdit1.Location = new System.Drawing.Point(92, 170);
            this.kissTextEdit1.Name = "kissTextEdit1";
            this.kissTextEdit1.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.kissTextEdit1.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.kissTextEdit1.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.kissTextEdit1.Properties.Appearance.Options.UseBackColor = true;
            this.kissTextEdit1.Properties.Appearance.Options.UseBorderColor = true;
            this.kissTextEdit1.Properties.Appearance.Options.UseFont = true;
            this.kissTextEdit1.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.kissTextEdit1.Properties.ReadOnly = true;
            this.kissTextEdit1.Size = new System.Drawing.Size(363, 24);
            this.kissTextEdit1.TabIndex = 71;
            //
            // bandedGridView1
            //
            this.bandedGridView1.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.bandedGridView1.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.bandedGridView1.Appearance.Empty.Options.UseBackColor = true;
            this.bandedGridView1.Appearance.Empty.Options.UseFont = true;
            this.bandedGridView1.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.bandedGridView1.Appearance.EvenRow.Options.UseFont = true;
            this.bandedGridView1.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.bandedGridView1.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.bandedGridView1.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.bandedGridView1.Appearance.FocusedCell.Options.UseBackColor = true;
            this.bandedGridView1.Appearance.FocusedCell.Options.UseFont = true;
            this.bandedGridView1.Appearance.FocusedCell.Options.UseForeColor = true;
            this.bandedGridView1.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.bandedGridView1.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.bandedGridView1.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.bandedGridView1.Appearance.FocusedRow.Options.UseBackColor = true;
            this.bandedGridView1.Appearance.FocusedRow.Options.UseFont = true;
            this.bandedGridView1.Appearance.FocusedRow.Options.UseForeColor = true;
            this.bandedGridView1.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.bandedGridView1.Appearance.GroupPanel.Options.UseBackColor = true;
            this.bandedGridView1.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.bandedGridView1.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.bandedGridView1.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.bandedGridView1.Appearance.GroupRow.Options.UseBackColor = true;
            this.bandedGridView1.Appearance.GroupRow.Options.UseFont = true;
            this.bandedGridView1.Appearance.GroupRow.Options.UseForeColor = true;
            this.bandedGridView1.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.bandedGridView1.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.bandedGridView1.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.bandedGridView1.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.bandedGridView1.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.bandedGridView1.Appearance.HeaderPanel.Options.UseFont = true;
            this.bandedGridView1.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.bandedGridView1.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.bandedGridView1.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.bandedGridView1.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.bandedGridView1.Appearance.HideSelectionRow.Options.UseFont = true;
            this.bandedGridView1.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.bandedGridView1.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.bandedGridView1.Appearance.HorzLine.Options.UseBackColor = true;
            this.bandedGridView1.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.bandedGridView1.Appearance.OddRow.Options.UseFont = true;
            this.bandedGridView1.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.bandedGridView1.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.bandedGridView1.Appearance.Row.Options.UseBackColor = true;
            this.bandedGridView1.Appearance.Row.Options.UseFont = true;
            this.bandedGridView1.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.bandedGridView1.Appearance.SelectedRow.Options.UseFont = true;
            this.bandedGridView1.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.bandedGridView1.Appearance.VertLine.Options.UseBackColor = true;
            this.bandedGridView1.Bands.AddRange(new DevExpress.XtraGrid.Views.BandedGrid.GridBand[] {
                        this.gridBand1});
            this.bandedGridView1.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.bandedGridView1.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.bandedGridView1.GridControl = this.kissGrid1;
            this.bandedGridView1.Name = "bandedGridView1";
            this.bandedGridView1.OptionsBehavior.Editable = false;
            this.bandedGridView1.OptionsCustomization.AllowFilter = false;
            this.bandedGridView1.OptionsFilter.UseNewCustomFilterDialog = true;
            this.bandedGridView1.OptionsNavigation.AutoFocusNewRow = true;
            this.bandedGridView1.OptionsNavigation.UseTabKey = false;
            this.bandedGridView1.OptionsView.ColumnAutoWidth = false;
            this.bandedGridView1.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.bandedGridView1.OptionsView.ShowGroupPanel = false;
            this.bandedGridView1.OptionsView.ShowIndicator = false;
            //
            // colAuszahlung
            //
            this.colAuszahlung.Caption = "Auszahl.";
            this.colAuszahlung.FieldName = "KbAuszahlungsArtCode";
            this.colAuszahlung.Name = "colAuszahlung";
            this.colAuszahlung.Visible = true;
            this.colAuszahlung.VisibleIndex = 2;
            this.colAuszahlung.Width = 65;
            //
            // colKlient
            //
            this.colKlient.Caption = "Betrifft Person";
            this.colKlient.FieldName = "Person";
            this.colKlient.Name = "colKlient";
            this.colKlient.Visible = true;
            this.colKlient.VisibleIndex = 1;
            this.colKlient.Width = 198;
            //
            // colKreditor
            //
            this.colKreditor.Caption = "Kreditor";
            this.colKreditor.FieldName = "Kreditor";
            this.colKreditor.Name = "colKreditor";
            this.colKreditor.Visible = true;
            this.colKreditor.VisibleIndex = 4;
            this.colKreditor.Width = 127;
            //
            // colLT
            //
            this.colLT.AppearanceCell.Font = new System.Drawing.Font("Wingdings", 8.25F);
            this.colLT.AppearanceCell.Options.HighPriority = true;
            this.colLT.AppearanceCell.Options.UseFont = true;
            this.colLT.AppearanceCell.Options.UseTextOptions = true;
            this.colLT.AppearanceCell.TextOptions.HAlignment = DevExpress.Utils.HorzAlignment.Center;
            this.colLT.Caption = "LT";
            this.colLT.FieldName = "LT";
            this.colLT.Name = "colLT";
            this.colLT.Visible = true;
            this.colLT.VisibleIndex = 0;
            this.colLT.Width = 25;
            //
            // colTermin
            //
            this.colTermin.Caption = "Termin";
            this.colTermin.FieldName = "BgAuszahlungsTerminCode";
            this.colTermin.Name = "colTermin";
            this.colTermin.Visible = true;
            this.colTermin.VisibleIndex = 3;
            this.colTermin.Width = 91;
            //
            // gridBand1
            //
            this.gridBand1.Caption = "gridBand1";
            this.gridBand1.Name = "gridBand1";
            //
            // gridView1
            //
            this.gridView1.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gridView1.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.Empty.Options.UseBackColor = true;
            this.gridView1.Appearance.Empty.Options.UseFont = true;
            this.gridView1.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.EvenRow.Options.UseFont = true;
            this.gridView1.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gridView1.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gridView1.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gridView1.Appearance.FocusedCell.Options.UseFont = true;
            this.gridView1.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gridView1.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gridView1.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gridView1.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gridView1.Appearance.FocusedRow.Options.UseFont = true;
            this.gridView1.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gridView1.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gridView1.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gridView1.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gridView1.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gridView1.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gridView1.Appearance.GroupRow.Options.UseBackColor = true;
            this.gridView1.Appearance.GroupRow.Options.UseFont = true;
            this.gridView1.Appearance.GroupRow.Options.UseForeColor = true;
            this.gridView1.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gridView1.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gridView1.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gridView1.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gridView1.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gridView1.Appearance.HeaderPanel.Options.UseFont = true;
            this.gridView1.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gridView1.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gridView1.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gridView1.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gridView1.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gridView1.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gridView1.Appearance.HorzLine.Options.UseBackColor = true;
            this.gridView1.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.OddRow.Options.UseFont = true;
            this.gridView1.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gridView1.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.Row.Options.UseBackColor = true;
            this.gridView1.Appearance.Row.Options.UseFont = true;
            this.gridView1.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.SelectedRow.Options.UseFont = true;
            this.gridView1.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gridView1.Appearance.VertLine.Options.UseBackColor = true;
            this.gridView1.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gridView1.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
                        this.colLT,
                        this.colKlient,
                        this.colAuszahlung,
                        this.colTermin,
                        this.colKreditor});
            this.gridView1.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gridView1.GridControl = this.kissGrid1;
            this.gridView1.Name = "gridView1";
            this.gridView1.OptionsBehavior.Editable = false;
            this.gridView1.OptionsCustomization.AllowFilter = false;
            this.gridView1.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gridView1.OptionsNavigation.AutoFocusNewRow = true;
            this.gridView1.OptionsNavigation.UseTabKey = false;
            this.gridView1.OptionsView.ColumnAutoWidth = false;
            this.gridView1.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gridView1.OptionsView.ShowGroupPanel = false;
            this.gridView1.OptionsView.ShowIndicator = false;
            //
            // qryBgAuszahlungPerson
            //
            this.qryBgAuszahlungPerson.CanUpdate = true;
            this.qryBgAuszahlungPerson.HostControl = this;
            this.qryBgAuszahlungPerson.SelectStatement = resources.GetString("qryBgAuszahlungPerson.SelectStatement");
            this.qryBgAuszahlungPerson.TableName = "BgAuszahlungPerson";
            this.qryBgAuszahlungPerson.PositionChanged += new System.EventHandler(this.qryBgAuszahlungPerson_PositionChanged);
            this.qryBgAuszahlungPerson.BeforePost += new System.EventHandler(this.qryBgAuszahlungPerson_BeforePost);
            this.qryBgAuszahlungPerson.AfterPost += new System.EventHandler(this.qryBgAuszahlungPerson_AfterPost);
            //
            // qryBgAuszahlungPersonTermin
            //
            this.qryBgAuszahlungPersonTermin.BatchUpdate = true;
            this.qryBgAuszahlungPersonTermin.CanInsert = true;
            this.qryBgAuszahlungPersonTermin.CanUpdate = true;
            this.qryBgAuszahlungPersonTermin.SelectStatement = "SELECT *\r\nFROM   BgAuszahlungPersonTermin\r\nWHERE  BgAuszahlungPersonID = {0}\r\nORD" +
                "ER BY Datum";
            this.qryBgAuszahlungPersonTermin.TableName = "BgAuszahlungPersonTermin";
            //
            // DlgWhWeitereZahlinfo
            //
            this.ActiveSQLQuery = this.qryBgAuszahlungPerson;
            this.CancelButton = this.btnAbbrechen;
            this.ClientSize = new System.Drawing.Size(541, 515);
            this.Controls.Add(this.kissTextEdit1);
            this.Controls.Add(this.lblBaPersonID);
            this.Controls.Add(this.tabZahlinfo);
            this.Controls.Add(this.lblBgAuszahlungsTerminCode);
            this.Controls.Add(this.lblKbAuszahlungsArtCode);
            this.Controls.Add(this.edtBgAuszahlungsTerminCode);
            this.Controls.Add(this.btnAbbrechen);
            this.Controls.Add(this.edtKbAuszahlungsArtCode);
            this.Controls.Add(this.btnOk);
            this.Controls.Add(this.kissGrid1);
            this.Name = "DlgWhWeitereZahlinfo";
            this.Text = "Weitere Zahlinfos";
            ((System.ComponentModel.ISupportInitialize)(this.kissGrid1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKbAuszahlungsArtCode.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKbAuszahlungsArtCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgAuszahlungsTerminCode.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgAuszahlungsTerminCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKbAuszahlungsArtCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBgAuszahlungsTerminCode)).EndInit();
            this.tabZahlinfo.ResumeLayout(false);
            this.tpgZahlinfo.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.edtValutaDatum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKreditor.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtReferenzNummer.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblValutaDatum)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKreditor)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblReferenzNummer)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissMemoEdit1.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtValutaTermine.Properties)).EndInit();
            this.tpgMitteilung.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.edtMitteilungZeile1.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtMitteilungZeile2.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtMitteilungZeile3.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblMitteilung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblZahlbarAn)).EndInit();
            this.tpgKalender.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.edtCalendar)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtWochentagCodes)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissTextEdit1.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.bandedGridView1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gridView1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgAuszahlungPerson)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgAuszahlungPersonTermin)).EndInit();
            this.ResumeLayout(false);
        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Private Methods

        void IBelegleser.ProcessBelegleser(Belegleser beleg)
        {
            if (ReadOnly)
            {
                KissMsg.ShowInfo("Neue Daten vom Belegleser: Die Daten sind schreibgeschtzt");
                return;
            }

            Common.ZH.DlgAuswahlBaZahlungsweg dlg = new Common.ZH.DlgAuswahlBaZahlungsweg();
            ApplicationFacade.DoEvents();

            bool transfer = false;
            dlg.SucheBaZahlungsweg(beleg);
            switch (dlg.Count)
            {
                case 0: KissMsg.ShowInfo("Keine zutreffenden Kreditor-Eintrge im Institutionenstamm gefunden!");
                    qryBgAuszahlungPerson["BaZahlungswegID"] = DBNull.Value;
                    qryBgAuszahlungPerson["Kreditor"] = DBNull.Value;
                    qryBgAuszahlungPerson["ZusatzInfo"] = DBNull.Value;
                    if (beleg.Betrag > 0)
                        qryBgAuszahlungPerson["Betrag"] = beleg.Betrag;
                    qryBgAuszahlungPerson["ReferenzNummer"] = beleg.ReferenzNummer;
                    break;

                case 1: transfer = true;
                    break;

                default: transfer = dlg.ShowDialog(this) == DialogResult.OK;
                    break;
            }

            if (transfer)
            {
                qryBgAuszahlungPerson["BaZahlungswegID"] = dlg["BaZahlungswegID"];
                qryBgAuszahlungPerson["Kreditor"] = dlg["Kreditor"];
                qryBgAuszahlungPerson["ZusatzInfo"] = dlg["ZusatzInfo"];
                qryBgAuszahlungPerson["ReferenzNummer"] = beleg.ReferenzNummer;
                qryBgAuszahlungPerson["EinzahlungsscheinCode"] = dlg["EinzahlungsscheinCode"];
                if (beleg.Betrag > 0)
                    qryBgAuszahlungPerson["Betrag"] = beleg.Betrag;
            }

            qryBgAuszahlungPerson.RefreshDisplay();
            SetEditMode();
        }

        private bool AuswahlKreditorBSS(string SearchString, bool ButtonClicked)
        {
            bool Cancel = false;
            SearchString = SearchString.Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (ButtonClicked)
                {
                    SearchString = "%";
                }
                else
                {
                    qryBgAuszahlungPerson["Kreditor"] = DBNull.Value;
                    qryBgAuszahlungPerson["ZusatzInfo"] = DBNull.Value;
                    qryBgAuszahlungPerson["BaZahlungswegID"] = DBNull.Value;
                    qryBgAuszahlungPerson["EinzahlungsscheinCode"] = DBNull.Value;
                    SetEditMode();
                    return false;
                }
            }

            int kategorie = (int)qryBgAuszahlungPerson["BgKategorieCode"];
            /*
            Wird in Bern (vorerst?) nicht eingeschrnkt!

            if (kategorie == 101 && !DBUtil.IsEmpty(qryBgAuszahlungPerson["BgSpezkontoID"])) //Einzelzahlung mit Spezialkonto
            {
                object BaInstitutionID = GetFieldFromSpezkonto(qryBgAuszahlungPerson["BgSpezkontoID"],"BaInstitutionID");
                if (!DBUtil.IsEmpty(BaInstitutionID)) //Zahlwegbindung an Institution
                {
                    KissLookupDialog dlg3 = new KissLookupDialog();
                    Cancel = !dlg3.SearchData(@"
                        SELECT ID$          = KRE.BaZahlungswegID,
                               Institution  = KRE.InstitutionName,
                               Zahlungsweg  = KRE.Zahlungsweg,
                               ESCode$      = KRE.EinzahlungsscheinCode,
                               Kreditor$    = KRE.Kreditor,
                               ZusatzInfo$  = KRE.ZusatzInfo
                        FROM   vwKreditor KRE
                        WHERE  KRE.BaInstitutionID = " + BaInstitutionID.ToString(),
                        "",
                        ButtonClicked,null,null,null);

                    if (!Cancel)
                    {
                        qryBgAuszahlungPerson["Kreditor"]              = dlg3["Kreditor$"];
                        qryBgAuszahlungPerson["ZusatzInfo"]            = dlg3["ZusatzInfo$"];
                        qryBgAuszahlungPerson["BaZahlungswegID"]       = dlg3["ID$"];
                        qryBgAuszahlungPerson["EinzahlungsscheinCode"] = dlg3["ESCode$"];

                        if ((int) qryBgAuszahlungPerson["EinzahlungsscheinCode"] != 1) // != oranger ES
                            qryBgAuszahlungPerson["ReferenzNummer"] = DBNull.Value;
                    }
                    SetPositionEditMode();
                    return Cancel;
                }
            }
            */

            if (SearchString == ".")
            // Auszahlung an
            // Klientensystem       	 - FaFallPerson
            // Involvierte Institutionen - FaFallPerson / BaPerson_Institution
            {
                KissLookupDialog dlg = new KissLookupDialog();
                Cancel = !dlg.SearchData(@"
                        -- Klientensystem
                        SELECT  ID$          = KRE.BaZahlungswegID,
                                Typ          = 'Klientensystem',
                                Name         = KRE.InstitutionName,
                                Zahlungsweg  = KRE.Zahlungsweg,
                                ESCode$      = KRE.EinzahlungsscheinCode,
                                Kreditor$    = KRE.Kreditor,
                                ZusatzInfo$  = KRE.ZusatzInfo,
                                SortKey$     = 1
                        FROM    FaFallPerson FAP
                          INNER JOIN vwKreditor KRE ON KRE.BaPersonID = FAP.BaPersonID
                        WHERE   FAP.FaFallID = {0}

                        UNION

                        -- Involvierte Institutionen
                        SELECT	ID$               = KRE.BaZahlungswegID,
                                Typ               = 'Institutionen',
                                Name              = KRE.InstitutionName,
                                Zahlungsweg       = KRE.Zahlungsweg,
                                ESCode$           = KRE.EinzahlungsscheinCode,
                                Kreditor$         = KRE.Kreditor,
                                ZusatzInfo$       = KRE.ZusatzInfo,
                                SortKey$          = 2
                        FROM FaFallPerson                 FFP
                          INNER JOIN BaPerson_Institution PIN ON PIN.BaPersonID = FFP.BaPersonID
                          INNER JOIN vwKreditor           KRE ON KRE.BaInstitutionID = PIN.BaInstitutionID
                        WHERE FaFallID = {0}

                        ORDER BY SortKey$,Name,Zahlungsweg",
                    qryBgAuszahlungPerson["FaFallID"].ToString(),
                    ButtonClicked, null, null, null);

                if (!Cancel)
                {
                    qryBgAuszahlungPerson["Kreditor"] = dlg["Kreditor$"];
                    qryBgAuszahlungPerson["ZusatzInfo"] = dlg["ZusatzInfo$"];
                    qryBgAuszahlungPerson["BaZahlungswegID"] = dlg["ID$"];
                    qryBgAuszahlungPerson["EinzahlungsscheinCode"] = dlg["ESCode$"];

                    if ((int)qryBgAuszahlungPerson["EinzahlungsscheinCode"] != 1) // != oranger ES
                        qryBgAuszahlungPerson["ReferenzNummer"] = DBNull.Value;

                    SetEditMode();
                    return Cancel;
                }
            }
            else // Auszahlung Dritte
            {
                Common.ZH.DlgAuswahlBaZahlungsweg dlg2 = new Common.ZH.DlgAuswahlBaZahlungsweg();
                ApplicationFacade.DoEvents();

                bool transfer = false;
                dlg2.SucheBaZahlungsweg(SearchString);
                switch (dlg2.Count)
                {
                    case 0: KissMsg.ShowInfo("Keine zutreffenden Kreditor-Eintrge im Institutionenstamm gefunden!");
                        break;

                    case 1: transfer = true;
                        break;

                    default: transfer = dlg2.ShowDialog(this) == DialogResult.OK;
                        break;
                }

                if (transfer)
                {
                    SqlQuery qry2 = DBUtil.OpenSQL(@"
                        select VornameName,WohnsitzStrasseHausNr,WohnsitzPLZOrt
                        from   vwPerson
                        where  BaPersonID = {0}",
                        qryBgAuszahlungPerson["LeistungBaPersonID"]);

                    qryBgAuszahlungPerson["BaZahlungswegID"] = dlg2["BaZahlungswegID"];
                    qryBgAuszahlungPerson["Kreditor"] = dlg2["Kreditor"];
                    qryBgAuszahlungPerson["ZusatzInfo"] = dlg2["ZusatzInfo"];
                    qryBgAuszahlungPerson["EinzahlungsscheinCode"] = dlg2["EinzahlungsscheinCode"];
                    qryBgAuszahlungPerson["MitteilungZeile1"] = TruncateString(qry2["VornameName"], 35);

                    if ((int)qryBgAuszahlungPerson["EinzahlungsscheinCode"] != 1) // != oranger ES
                        qryBgAuszahlungPerson["ReferenzNummer"] = DBNull.Value;
                }

                qryBgAuszahlungPerson.RefreshDisplay();
                SetEditMode();
            }
            return Cancel;
        }

        private bool AuswahlKreditorFAMOZ(string SearchString, bool ButtonClicked)
        {
            bool Cancel = false;
            SearchString = SearchString.Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (ButtonClicked)
                {
                    SearchString = "%";
                }
                else
                {
                    qryBgAuszahlungPerson["Kreditor"] = DBNull.Value;
                    qryBgAuszahlungPerson["ZusatzInfo"] = DBNull.Value;
                    qryBgAuszahlungPerson["BaZahlungswegID"] = DBNull.Value;
                    qryBgAuszahlungPerson["EinzahlungsscheinCode"] = DBNull.Value;
                    SetEditMode();
                    return false;
                }
            }

            int kategorie = (int)qryBgAuszahlungPerson["BgKategorieCode"];

            if (SearchString == ".")
            // Auszahlung an
            // Klientensystem       - FaFallPerson
            // Involvierte Stellen  - FaInvolvierteInstitution
            // Krankenkasse         - BaKrankenversicherung
            // Vermieter            - BaWohnsituation
            // Arbeitgeber          - BaArbeit
            {
                KissLookupDialog dlg = new KissLookupDialog();
                Cancel = !dlg.SearchData(@"
                    -- Personen im Haushalt
                    SELECT ID$          = KRE.BaZahlungswegID,
                           Typ          = 'Klientensystem',
                           Name         = KRE.PersonNameVorname,
                           Zahlungsweg  = KRE.Zahlungsweg,
                           ESCode$      = KRE.EinzahlungsscheinCode,
                           Kreditor$    = KRE.Kreditor,
                           ZusatzInfo$  = KRE.ZUsatzInfo,
                           SortKey$     = 1
                    FROM   FaFallPerson FAP
                           INNER JOIN vwKreditor KRE ON KRE.BaPersonID = FAP.BaPersonID
                    WHERE  FAP.FaFallID = {0}

                    UNION

                    -- Involvierte Stellen
                    SELECT ID$          = KRE.BaZahlungswegID,
                           Typ          = 'involvierte Stelle',
                           Name         = KRE.InstitutionName,
                           Zahlungsweg  = KRE.Zahlungsweg,
                           ESCode$      = KRE.EinzahlungsscheinCode,
                           Kreditor$    = KRE.Kreditor,
                           ZusatzInfo$  = KRE.ZusatzInfo,
                           SortKey$     = 2
                    FROM   FaInvolvierteInstitution INV
                           INNER JOIN vwKreditor KRE ON KRE.BaInstitutionID = INV.BaInstitutionID
                    WHERE  INV.FaFallID = {0}

                    UNION

                    -- Krankenkasse
                    SELECT ID$          = KRE.BaZahlungswegID,
                           Typ          = 'Krankenkasse',
                           Name         = KRE.InstitutionName,
                           Zahlungsweg  = KRE.Zahlungsweg,
                           ESCode$      = KRE.EinzahlungsscheinCode,
                           Kreditor$    = KRE.Kreditor,
                           ZusatzInfo$  = KRE.ZusatzInfo,
                           SortKey$     = 3
                    FROM   FaFallPerson FAP
                           INNER JOIN BaKrankenversicherung KKV ON KKV.BaPersonID = FAP.BaPersonID
                           INNER JOIN vwKreditor            KRE ON KRE.BaInstitutionID = KKV.BaInstitutionID
                    WHERE  FAP.FaFallID = {0}

                    UNION

                    -- Vermieter
                    SELECT ID$          = KRE.BaZahlungswegID,
                           Typ          = 'Vermieter',
                           Name         = KRE.InstitutionName,
                           Zahlungsweg  = KRE.Zahlungsweg,
                           ESCode$      = KRE.EinzahlungsscheinCode,
                           Kreditor$    = KRE.Kreditor,
                           ZusatzInfo$  = KRE.ZusatzInfo,
                           SortKey$     = 4
                    FROM   FaFallPerson FAP
                           INNER JOIN BaWohnsituationPerson WOP ON WOP.BaPersonID = FAP.BaPersonID
                           INNER JOIN BaWohnsituation       WOH ON WOH.BaWohnsituationID = WOP.BaWohnsituationID
                           INNER JOIN vwKreditor            KRE ON KRE.BaInstitutionID = WOH.BaInstitutionID
                    WHERE  FAP.FaFallID = {0}

                    UNION

                    -- Abeitgeber
                    SELECT ID$          = KRE.BaZahlungswegID,
                           Typ          = 'Arbeitbeger',
                           Name         = KRE.InstitutionName,
                           Zahlungsweg  = KRE.Zahlungsweg,
                           ESCode$      = KRE.EinzahlungsscheinCode,
                           Kreditor$    = KRE.Kreditor,
                           ZusatzInfo$  = KRE.ZusatzInfo,
                           SortKey$     = 5
                    FROM   FaFallPerson FAP
                           INNER JOIN BaArbeit   ARB ON ARB.BaPersonID = FAP.BaPersonID
                           INNER JOIN vwKreditor KRE ON KRE.BaInstitutionID = ARB.BaInstitutionID
                    WHERE  FAP.FaFallID = {0}
                    ORDER BY SortKey$,Name,Zahlungsweg",
                    qryBgAuszahlungPerson["FaFallID"].ToString(),
                    ButtonClicked, null, null, null);

                if (!Cancel)
                {
                    qryBgAuszahlungPerson["Kreditor"] = dlg["Kreditor$"];
                    qryBgAuszahlungPerson["ZusatzInfo"] = dlg["ZusatzInfo$"];
                    qryBgAuszahlungPerson["BaZahlungswegID"] = dlg["ID$"];
                    qryBgAuszahlungPerson["EinzahlungsscheinCode"] = dlg["ESCode$"];

                    if ((int)qryBgAuszahlungPerson["EinzahlungsscheinCode"] != 1) // != oranger ES
                        qryBgAuszahlungPerson["ReferenzNummer"] = DBNull.Value;

                    SetEditMode();
                    return Cancel;
                }
            }
            else // Auszahlung Dritte
            {
                Common.ZH.DlgAuswahlBaZahlungsweg dlg2 = new Common.ZH.DlgAuswahlBaZahlungsweg();
                ApplicationFacade.DoEvents();

                bool transfer = false;
                dlg2.SucheBaZahlungsweg(SearchString);
                switch (dlg2.Count)
                {
                    case 0: KissMsg.ShowInfo("Keine zutreffenden Kreditor-Eintrge im Institutionenstamm gefunden!");
                        break;

                    case 1: transfer = true;
                        break;

                    default: transfer = dlg2.ShowDialog(this) == DialogResult.OK;
                        break;
                }

                if (transfer)
                {
                    SqlQuery qry2 = DBUtil.OpenSQL(@"
                        select VornameName,WohnsitzStrasseHausNr,WohnsitzPLZOrt
                        from   vwPerson
                        where  BaPersonID = {0}",
                        qryBgAuszahlungPerson["LeistungBaPersonID"]);

                    qryBgAuszahlungPerson["BaZahlungswegID"] = dlg2["BaZahlungswegID"];
                    qryBgAuszahlungPerson["Kreditor"] = dlg2["Kreditor"];
                    qryBgAuszahlungPerson["ZusatzInfo"] = dlg2["ZusatzInfo"];
                    qryBgAuszahlungPerson["EinzahlungsscheinCode"] = dlg2["EinzahlungsscheinCode"];
                    qryBgAuszahlungPerson["MitteilungZeile1"] = TruncateString(qry2["VornameName"], 35);

                    if ((int)qryBgAuszahlungPerson["EinzahlungsscheinCode"] != 1) // != oranger ES
                        qryBgAuszahlungPerson["ReferenzNummer"] = DBNull.Value;
                }

                qryBgAuszahlungPerson.RefreshDisplay();
                SetEditMode();
            }
            return Cancel;
        }

        private void CheckNotNullFieldOnTabPage(IKissBindableEdit ctl, String text, SharpLibrary.WinControls.TabPageEx page)
        {
            try { ((KissTabControlEx)page.Parent).SelectTab(page); }
            catch { }
            DBUtil.CheckNotNullField(ctl, text);
        }

        private void DisplayCalendarBoldDates()
        {
            CalendarFilling = true;

            edtCalendar.TodayDate = DateTime.Today;

            this.edtCalendar.BoldedDates = null;

            int BudgetJahr = (int)qryBgAuszahlungPerson["BudgetJahr"];
            int BudgetMonat = (int)qryBgAuszahlungPerson["BudgetMonat"];
            DateTime firstDate = new DateTime(BudgetJahr, BudgetMonat, 1);
            edtCalendar.MaxSelectionCount = 2;
            edtCalendar.SelectionRange = new SelectionRange(firstDate, firstDate.AddDays(1));

            CalendarFilling = true;
            try
            {
                foreach (DataRow R in qryBgAuszahlungPerson.DataTable.Rows)
                {
                    this.edtCalendar.AddBoldedDate((DateTime)R["Datum"]);
                }
            }
            catch { }
            CalendarFilling = false;
        }

        private void DisplayValutaTermine()
        {
            String ValutaTermine = "";
            foreach (DataRow R in qryBgAuszahlungPersonTermin.DataTable.Rows)
            {
                if (ValutaTermine != "") ValutaTermine += @"  ";
                ValutaTermine += ((DateTime)R["Datum"]).ToString("d.M");
            }
            qryBgAuszahlungPerson["ValutaTermine"] = ValutaTermine;
            qryBgAuszahlungPerson.RefreshDisplay();
        }

        private void LoadValutaTermine()
        {
            if (DBUtil.IsEmpty(qryBgAuszahlungPerson["BgAuszahlungsTerminCode"]))
            {
                qryBgAuszahlungPersonTermin.Fill("select top 0 * from BgAuszahlungPersonTermin");
                return;
            };

            int BudgetJahr = (int)qryBgAuszahlungPerson["BudgetJahr"];
            int BudgetMonat = (int)qryBgAuszahlungPerson["BudgetMonat"];
            int BgAuszahlungsTerminCode = (int)qryBgAuszahlungPerson["BgAuszahlungsTerminCode"];
            switch (BgAuszahlungsTerminCode)
            {
                case 1:  // 1x pro Monat
                case 2:  // 2x pro Monat
                case 3:  // wchentlich
                case 5:  // 14-tglich

                    qryBgAuszahlungPersonTermin.Fill(@"
                        select T.Datum
                        from   fnKbAuszahlTermine({0},{1}) T
                        where  T.BgAuszahlungsTerminCode = {2}
             		        order by T.Datum",
                       BudgetJahr,
                       BudgetMonat,
                       BgAuszahlungsTerminCode);
                    break;

                case 4:  // Valuta
                    break;

                case 6:  // Wochentage
                    qryBgAuszahlungPersonTermin.Fill(@"
                        select T.Datum
                        from   fnKbAuszahlTermine({0},{1}) T
                        where  T.BgAuszahlungsTerminCode = {2} and
                                   {3} like '%' + convert(varchar,T.BgWochentagCode) + '%'
             		        order by T.Datum",
                       BudgetJahr,
                       BudgetMonat,
                       BgAuszahlungsTerminCode,
                       qryBgAuszahlungPerson["BgWochentagCodes"]);
                    break;

                case 99: //Individuell
                    break;
            }
        }

        private void SaveCalendarBoldDates()
        {
            qryBgAuszahlungPersonTermin.DataTable.Rows.Clear();
            DateTime[] Dates = (DateTime[])edtCalendar.BoldedDates.Clone();
            Array.Sort(Dates);
            foreach (object D in Dates)
            {
                qryBgAuszahlungPersonTermin.Insert();
                qryBgAuszahlungPersonTermin["Datum"] = D;
                qryBgAuszahlungPersonTermin.RowModified = false;
                qryBgAuszahlungPersonTermin.Row.AcceptChanges();
            }
        }

        private void SaveValutaTermine()
        {
            int AuszahlungsTermin = ShUtil.GetCode(qryBgAuszahlungPerson["BgAuszahlungsTerminCode"]);
            int AuszahlungsArt = ShUtil.GetCode(qryBgAuszahlungPerson["KbAuszahlungsArtCode"]);

            try
            {
                //Lschen der alten Daten
                DBUtil.ExecSQLThrowingException(@"
                    delete BgAuszahlungPersonTermin where BgAuszahlungPersonID = {0}", qryBgAuszahlungPerson["BgAuszahlungPersonID"]);

                if (AuszahlungsTermin == 0) return; 	//keine neuen Daten, falls kein gltiger Auszahltermin

                //Neue Datenstze in BgAuszahlungPersonTermin
                String sql = "";
                if (AuszahlungsTermin == 4) //Valuta
                {
                    sql += @" insert BgAuszahlungPersonTermin (BgAuszahlungPersonID,Datum) values ({0}," +
                                  DBUtil.SqlLiteral(qryBgAuszahlungPerson["ValutaDatum"]) + ") ";
                }
                else
                {
                    foreach (DataRow R in qryBgAuszahlungPersonTermin.DataTable.Rows)
                    {
                        sql += @" insert BgAuszahlungPersonTermin (BgAuszahlungPersonID,Datum) values ({0}," +
                                      DBUtil.SqlLiteral(R["Datum"]) + ") ";
                    }
                }
                if (sql.Length > 0)
                    DBUtil.ExecSQLThrowingException(sql, qryBgAuszahlungPerson["BgAuszahlungPersonID"]);
            }
            catch (Exception ex)
            {
                Session.Rollback();
                KissMsg.ShowInfo(ex.Message);
                return;
            }
        }

        private void SetEditMode()
        {
            if (qryBgAuszahlungPerson.Count == 0) return;

            try
            {
                int kategorie = ShUtil.GetCode(qryBgAuszahlungPerson["BgKategorieCode"]);

                qryBgAuszahlungPerson.EnableBoundFields(!this.ReadOnly);

                int ES = ShUtil.GetCode(qryBgAuszahlungPerson["EinzahlungsscheinCode"]);
                int AuszahlungsTermin = ShUtil.GetCode(qryBgAuszahlungPerson["BgAuszahlungsTerminCode"]);
                int AuszahlungsArt = ShUtil.GetCode(qryBgAuszahlungPerson["KbAuszahlungsArtCode"]);

                //Kategorienabhngige Einstellungen
                switch (kategorie)
                {
                    case 2: //Ausgaben
                    case 100: //Zusatzleistung
                    case 101: //Einzelzahlung
                        edtValutaDatum.EditMode = (AuszahlungsTermin == 4) && !this.ReadOnly ? EditModeType.Normal : EditModeType.ReadOnly;
                        edtValutaDatum.Visible = (AuszahlungsTermin == 4);
                        edtValutaTermine.Visible = (AuszahlungsTermin != 4);
                        lblValutaDatum.Text = "Valuta";
                        edtReferenzNummer.EditMode = (ES == 1) && (!this.ReadOnly) ? EditModeType.Normal : EditModeType.ReadOnly;
                        edtReferenzNummer.Visible = true;
                        lblReferenzNummer.Visible = true;
                        tpgZahlinfo.Title = lblKreditor.Text;

                        if (AuszahlungsArt == 101)  //elektronisch
                        {
                            //Kreditor, ReferenzNr, Mitteilung mutierbar, wenn  PositionStatus = 5 (Zahlauftrag fehlerhaft)
                            edtKreditor.EditMode = !this.ReadOnly ? EditModeType.Normal : EditModeType.ReadOnly;
                            tpgMitteilung.HideTab = (ES != 2) && (ES != 3) && (ES != 5); //roter ES
                            lblMitteilung.Visible = true;
                            lblZahlbarAn.Visible = false;
                            tpgMitteilung.Title = lblMitteilung.Text;
                            edtMitteilungZeile1.EditMode = !this.ReadOnly ? EditModeType.Normal : EditModeType.ReadOnly;
                            edtMitteilungZeile2.EditMode = !this.ReadOnly ? EditModeType.Normal : EditModeType.ReadOnly;
                            edtMitteilungZeile3.EditMode = !this.ReadOnly ? EditModeType.Normal : EditModeType.ReadOnly;
                        }
                        else if (AuszahlungsArt == 103) //bar
                        {
                            edtKreditor.EditMode = EditModeType.ReadOnly;
                            tpgMitteilung.HideTab = false;
                            lblMitteilung.Visible = false;
                            lblZahlbarAn.Visible = true;
                            tpgMitteilung.Title = lblZahlbarAn.Text;
                        }

                        tpgKalender.HideTab = (AuszahlungsTermin == 4);

                        if (!tpgKalender.HideTab)
                        {
                            int BudgetJahr = (int)qryBgAuszahlungPerson["BudgetJahr"];
                            int BudgetMonat = (int)qryBgAuszahlungPerson["BudgetMonat"];
                            DateTime firstDate = new DateTime(BudgetJahr, BudgetMonat, 1);
                            switch (AuszahlungsTermin)
                            {
                                case 6:  //Wochentage
                                    edtWochentagCodes.Visible = true;
                                    edtCalendar.Visible = true;
                                    edtCalendar.Enabled = false;
                                    edtCalendar.MinDate = firstDate;
                                    edtCalendar.MaxDate = firstDate.AddMonths(1).AddDays(-1);
                                    edtCalendar.CalendarDimensions = new System.Drawing.Size(1, 1);
                                    edtCalendar.Left = tpgKalender.Width - edtCalendar.Width - 5;
                                    break;

                                case 5:  //14-tglich
                                case 99: //individuell
                                    edtWochentagCodes.Visible = false;
                                    edtCalendar.Visible = true;
                                    edtCalendar.Enabled = !this.ReadOnly && (AuszahlungsTermin == 99);
                                    edtCalendar.MinDate = firstDate;
                                    edtCalendar.MaxDate = firstDate.AddMonths(1).AddDays(-1);
                                    edtCalendar.CalendarDimensions = new System.Drawing.Size(1, 1);
                                    edtCalendar.Left = (tpgKalender.Width - edtCalendar.Width) / 2;
                                    break;

                                default: edtWochentagCodes.Visible = false;
                                    edtCalendar.Visible = true;
                                    edtCalendar.Enabled = false;
                                    edtCalendar.MinDate = firstDate.AddMonths(-1);
                                    edtCalendar.MaxDate = firstDate.AddMonths(1).AddDays(-1);
                                    edtCalendar.CalendarDimensions = new System.Drawing.Size(2, 1);
                                    edtCalendar.Left = (tpgKalender.Width - edtCalendar.Width) / 2;
                                    break;
                            }
                        }

                        break;

                    case 1:	//Einnahme
                        break;

                    case 4: //Sanktion/Krzung
                        break;
                }
            }
            catch (Exception ex)
            {
                KissMsg.ShowError("CtlWhBudget", "FehlerSetEditMode", "Fehler in SetEditMode: " + ex.Message, null, ex, 0, 0, null);
            }
        }

        private object TruncateString(object s, int MaxLength)
        {
            if (DBUtil.IsEmpty(s)) return s;
            if (!(s is String)) return s;
            if (s.ToString().Length > MaxLength) return s.ToString().Substring(0, MaxLength);
            return s;
        }

        private void btnAbbrechen_Click(object sender, System.EventArgs e)
        {
            this.userCancel = true;
        }

        private void btnOk_Click(object sender, System.EventArgs e)
        {
            if (!qryBgAuszahlungPerson.Post()) return;

            this.userCancel = false;
            this.DialogResult = DialogResult.OK;
        }

        private void edtBgAuszahlungsTerminCode_EditValueChanged(object sender, System.EventArgs e)
        {
            if (qryBgAuszahlungPerson.IsFilling) return;
            if (!edtBgAuszahlungsTerminCode.Focused) return;

            qryBgAuszahlungPerson["BgAuszahlungsTerminCode"] = edtBgAuszahlungsTerminCode.EditValue;
            int BgAuszahlungsTerminCode = (int)qryBgAuszahlungPerson["BgAuszahlungsTerminCode"];

            switch (BgAuszahlungsTerminCode)
            {
                case 6:  // Wochentage
                    qryBgAuszahlungPerson["BgWochentagCodes"] = DBNull.Value;
                    break;

                case 99: //individuell
                    qryBgAuszahlungPersonTermin.DataTable.Rows.Clear();
                    break;
            }

            LoadValutaTermine();
            DisplayValutaTermine();
            //KissMsg.ShowInfo("d: " + qryKgPositionValuta.Count.ToString());
            DisplayCalendarBoldDates();

            SetEditMode();

            switch (BgAuszahlungsTerminCode)
            {
                case 1:  // 1x pro Monat
                case 2:  // 2x pro Monat
                case 3:  // wchentlich
                case 5:  // 14-tglich
                    break;

                case 4:  // Valuta
                    tabZahlinfo.SelectTab(tpgZahlinfo);
                    break;

                case 6:  // Wochentage
                case 99: //Individuell
                    tabZahlinfo.SelectTab(tpgKalender);
                    break;
            }
        }

        private void edtCalendar_DateChanged(object sender, System.Windows.Forms.DateRangeEventArgs e)
        {
            if (CalendarFilling) return;

            if (Array.IndexOf(edtCalendar.BoldedDates, e.Start) >= 0)
                edtCalendar.RemoveBoldedDate(e.Start);
            else
                edtCalendar.AddBoldedDate(e.Start);

            SaveCalendarBoldDates();
            DisplayValutaTermine();
            timer1.Enabled = true;
        }

        private void edtKbAuszahlungsArtCode_EditValueChanged(object sender, System.EventArgs e)
        {
            if (qryBgAuszahlungPerson.IsFilling) return;
            if (!edtKbAuszahlungsArtCode.Focused) return;

            qryBgAuszahlungPerson["KbAuszahlungsArtCode"] = edtKbAuszahlungsArtCode.EditValue;

            SetEditMode();

            SqlQuery qry = DBUtil.OpenSQL(@"
                select VornameName,WohnsitzStrasseHausNr,WohnsitzPLZOrt
                from   vwPerson
                where  BaPersonID = {0}",
                qryBgAuszahlungPerson["LeistungBaPersonID"]);

            int AuszahlungsArt = ShUtil.GetCode(qryBgAuszahlungPerson["KbAuszahlungsArtCode"]);
            switch (AuszahlungsArt)
            {
                case 101: qryBgAuszahlungPerson["MitteilungZeile1"] = TruncateString(qry["VornameName"], 35);
                    qryBgAuszahlungPerson["MitteilungZeile2"] = DBNull.Value;
                    qryBgAuszahlungPerson["MitteilungZeile3"] = DBNull.Value;

                    tabZahlinfo.SelectTab(tpgZahlinfo);
                    break;

                case 103: qryBgAuszahlungPerson["MitteilungZeile1"] = TruncateString(qry["VornameName"], 35);
                    qryBgAuszahlungPerson["MitteilungZeile2"] = TruncateString(qry["WohnsitzStrasseHausNr"], 35);
                    qryBgAuszahlungPerson["MitteilungZeile3"] = TruncateString(qry["WohnsitzPLZOrt"], 35);

                    qryBgAuszahlungPerson["BaZahlungswegID"] = DBNull.Value;
                    qryBgAuszahlungPerson["Kreditor"] = DBNull.Value;
                    qryBgAuszahlungPerson["ZusatzInfo"] = DBNull.Value;
                    qryBgAuszahlungPerson["EinzahlungsscheinCode"] = DBNull.Value;
                    qryBgAuszahlungPerson["ReferenzNummer"] = DBNull.Value;

                    tabZahlinfo.SelectTab(tpgMitteilung);
                    break;
            }
            qryBgAuszahlungPerson.RefreshDisplay();
        }

        private void edtKreditor_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            if (kiSSKunde == KiSSKunde.BSS)
                e.Cancel = AuswahlKreditorBSS(edtKreditor.EditValue.ToString(), e.ButtonClicked);

            if (kiSSKunde == KiSSKunde.FAMOZ)
                e.Cancel = AuswahlKreditorFAMOZ(edtKreditor.EditValue.ToString(), e.ButtonClicked);
        }

        private void qryBgAuszahlungPerson_AfterPost(object sender, System.EventArgs e)
        {
            //Valuta-Termine speichern
            SaveValutaTermine();
        }

        private void qryBgAuszahlungPerson_BeforePost(object sender, System.EventArgs e)
        {
            int AuszahlungsTermin = ShUtil.GetCode(qryBgAuszahlungPerson["BgAuszahlungsTerminCode"]);
            int AuszahlungsArt = ShUtil.GetCode(qryBgAuszahlungPerson["KbAuszahlungsArtCode"]);
            int ES = ShUtil.GetCode(qryBgAuszahlungPerson["EinzahlungsscheinCode"]);

            DBUtil.CheckNotNullField(edtKbAuszahlungsArtCode, lblKbAuszahlungsArtCode.Text);
            DBUtil.CheckNotNullField(edtBgAuszahlungsTerminCode, lblBgAuszahlungsTerminCode.Text);

            //Valuta
            if (AuszahlungsTermin == 4)
                CheckNotNullFieldOnTabPage(edtValutaDatum, lblValutaDatum.Text, tpgZahlinfo);

            //Wochentag
            if (AuszahlungsTermin == 6)
                CheckNotNullFieldOnTabPage(edtWochentagCodes, "Wochentage", tpgKalender);

            //individuell
            if (AuszahlungsTermin == 99 && qryBgAuszahlungPersonTermin.Count == 0)
            {
                throw new KissInfoException("Es sind noch keine individuellen Auszahltermine erfasst.");
            }

            // elektronische Auszahlung
            if (AuszahlungsArt == 101)
                CheckNotNullFieldOnTabPage(edtKreditor, lblKreditor.Text, tpgZahlinfo);

            // bar
            if (AuszahlungsArt == 103)
                CheckNotNullFieldOnTabPage(edtMitteilungZeile1, lblZahlbarAn.Text, tpgMitteilung);

            //oranger ES
            if (ES == 1)
                CheckNotNullFieldOnTabPage(edtReferenzNummer, lblReferenzNummer.Text, tpgZahlinfo);

            //Mitteilungszeilen begrenzen auf 35 Zeichen
            qryBgAuszahlungPerson["MitteilungZeile1"] = TruncateString(qryBgAuszahlungPerson["MitteilungZeile1"], 35);
            qryBgAuszahlungPerson["MitteilungZeile2"] = TruncateString(qryBgAuszahlungPerson["MitteilungZeile2"], 35);
            qryBgAuszahlungPerson["MitteilungZeile3"] = TruncateString(qryBgAuszahlungPerson["MitteilungZeile3"], 35);
        }

        private void qryBgAuszahlungPerson_PositionChanged(object sender, System.EventArgs e)
        {
            if (qryBgAuszahlungPerson.Count == 0) return;
            if (qryBgAuszahlungPerson.Row.RowState == DataRowState.Added) return;

            int kategorie = ShUtil.GetCode(qryBgAuszahlungPerson["BgKategorieCode"]);

            SetEditMode();

            qryBgAuszahlungPersonTermin.Fill("SELECT * FROM BgAuszahlungPersonTermin WHERE BgAuszahlungPersonID = {0} ORDER BY Datum", qryBgAuszahlungPerson["BgAuszahlungPersonID"]);
            DisplayCalendarBoldDates();
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            ApplicationFacade.DoEvents();
            timer1.Enabled = false;

            int BudgetJahr = (int)qryBgAuszahlungPerson["BudgetJahr"];
            int BudgetMonat = (int)qryBgAuszahlungPerson["BudgetMonat"];
            DateTime firstDate = new DateTime(BudgetJahr, BudgetMonat, 1);
            CalendarFilling = true;
            edtCalendar.SelectionRange = new SelectionRange(firstDate, firstDate.AddDays(1));
            CalendarFilling = false;
        }

        #endregion
    }
}