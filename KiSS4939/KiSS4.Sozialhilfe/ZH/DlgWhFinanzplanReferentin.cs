#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.832
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Windows.Forms;
using KiSS4.DB;

namespace KiSS4.Sozialhilfe.ZH
{
    public class DlgWhFinanzplanReferentin : KiSS4.Gui.KissDialog
    {
        #region Fields

        private KiSS4.Gui.KissButton btnAbbrechen;
        private KiSS4.Gui.KissButton btnAblehnen;
        private KiSS4.Gui.KissButton btnVisieren;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissMemoEdit edtBemerkung;
        private KiSS4.Gui.KissDateEdit edtDatumVisum;
        private KiSS4.Gui.KissTextEdit edtNameReferentin;
        private KiSS4.Gui.KissLabel lblBemerkung;
        private KiSS4.Gui.KissLabel lblDatumVisum;
        private KiSS4.Gui.KissLabel lblTitel;
        private KiSS4.Gui.KissLabel lblXUser;
        private KiSS4.DB.SqlQuery qryBgBewilligung;
        private bool userYes;

        #endregion

        #region Constructors

        // ComponentName: qryBgBewilligung
        public DlgWhFinanzplanReferentin(int BgFinanzplanID)
            : this()
        {
            qryBgBewilligung.Fill( "SELECT TOP 0 * FROM BgBewilligung" );
            qryBgBewilligung.Insert(qryBgBewilligung.TableName);

            qryBgBewilligung["BgFinanzPlanID"] = BgFinanzplanID;
        }

        public DlgWhFinanzplanReferentin()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            this.edtNameReferentin = new KiSS4.Gui.KissTextEdit();
            this.lblTitel = new KiSS4.Gui.KissLabel();
            this.edtDatumVisum = new KiSS4.Gui.KissDateEdit();
            this.lblXUser = new KiSS4.Gui.KissLabel();
            this.edtBemerkung = new KiSS4.Gui.KissMemoEdit();
            this.btnAblehnen = new KiSS4.Gui.KissButton();
            this.btnVisieren = new KiSS4.Gui.KissButton();
            this.btnAbbrechen = new KiSS4.Gui.KissButton();
            this.lblBemerkung = new KiSS4.Gui.KissLabel();
            this.lblDatumVisum = new KiSS4.Gui.KissLabel();
            this.qryBgBewilligung = new KiSS4.DB.SqlQuery(this.components);
            ((System.ComponentModel.ISupportInitialize)(this.edtNameReferentin.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVisum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblXUser)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBemerkung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumVisum)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgBewilligung)).BeginInit();
            this.SuspendLayout();
            //
            // edtNameReferentin
            //
            this.edtNameReferentin.Location = new System.Drawing.Point(8, 53);
            this.edtNameReferentin.Name = "edtNameReferentin";
            this.edtNameReferentin.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtNameReferentin.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtNameReferentin.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtNameReferentin.Properties.Appearance.Options.UseBackColor = true;
            this.edtNameReferentin.Properties.Appearance.Options.UseBorderColor = true;
            this.edtNameReferentin.Properties.Appearance.Options.UseFont = true;
            this.edtNameReferentin.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtNameReferentin.Size = new System.Drawing.Size(304, 24);
            this.edtNameReferentin.TabIndex = 0;
            //
            // lblTitel
            //
            this.lblTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitel.Location = new System.Drawing.Point(8, 8);
            this.lblTitel.Name = "lblTitel";
            this.lblTitel.Size = new System.Drawing.Size(472, 16);
            this.lblTitel.TabIndex = 0;
            this.lblTitel.Text = "Visieren";
            this.lblTitel.UseCompatibleTextRendering = true;
            //
            // edtDatumVisum
            //
            this.edtDatumVisum.DataMember = "Datum";
            this.edtDatumVisum.DataSource = this.qryBgBewilligung;
            this.edtDatumVisum.EditValue = null;
            this.edtDatumVisum.Location = new System.Drawing.Point(135, 83);
            this.edtDatumVisum.Name = "edtDatumVisum";
            this.edtDatumVisum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.False;
            this.edtDatumVisum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtDatumVisum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtDatumVisum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtDatumVisum.Properties.Appearance.Options.UseBackColor = true;
            this.edtDatumVisum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtDatumVisum.Properties.Appearance.Options.UseFont = true;
            this.edtDatumVisum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtDatumVisum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
                        new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.edtDatumVisum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtDatumVisum.Properties.ShowToday = false;
            this.edtDatumVisum.Size = new System.Drawing.Size(100, 24);
            this.edtDatumVisum.TabIndex = 1;
            //
            // lblXUser
            //
            this.lblXUser.LabelStyle = KiSS4.Gui.LabelStyleType.DataViewLabel;
            this.lblXUser.Location = new System.Drawing.Point(8, 32);
            this.lblXUser.Name = "lblXUser";
            this.lblXUser.Size = new System.Drawing.Size(304, 16);
            this.lblXUser.TabIndex = 1;
            this.lblXUser.Text = "Name ReferentIn";
            this.lblXUser.UseCompatibleTextRendering = true;
            //
            // edtBemerkung
            //
            this.edtBemerkung.Location = new System.Drawing.Point(8, 166);
            this.edtBemerkung.Name = "edtBemerkung";
            this.edtBemerkung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBemerkung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBemerkung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBemerkung.Properties.Appearance.Options.UseBackColor = true;
            this.edtBemerkung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBemerkung.Properties.Appearance.Options.UseFont = true;
            this.edtBemerkung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBemerkung.Size = new System.Drawing.Size(472, 66);
            this.edtBemerkung.TabIndex = 2;
            //
            // btnAblehnen
            //
            this.btnAblehnen.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnAblehnen.Location = new System.Drawing.Point(8, 240);
            this.btnAblehnen.Name = "btnAblehnen";
            this.btnAblehnen.Size = new System.Drawing.Size(112, 24);
            this.btnAblehnen.TabIndex = 3;
            this.btnAblehnen.Text = "Rückfragen";
            this.btnAblehnen.UseCompatibleTextRendering = true;
            this.btnAblehnen.UseVisualStyleBackColor = false;
            this.btnAblehnen.Click += new System.EventHandler(this.btnAblehnen_Click);
            //
            // btnVisieren
            //
            this.btnVisieren.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnVisieren.Location = new System.Drawing.Point(126, 240);
            this.btnVisieren.Name = "btnVisieren";
            this.btnVisieren.Size = new System.Drawing.Size(96, 24);
            this.btnVisieren.TabIndex = 4;
            this.btnVisieren.Text = "Visieren";
            this.btnVisieren.UseCompatibleTextRendering = true;
            this.btnVisieren.UseVisualStyleBackColor = false;
            this.btnVisieren.Click += new System.EventHandler(this.btnVisieren_Click);
            //
            // btnAbbrechen
            //
            this.btnAbbrechen.DialogResult = System.Windows.Forms.DialogResult.Cancel;
            this.btnAbbrechen.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnAbbrechen.Location = new System.Drawing.Point(360, 240);
            this.btnAbbrechen.Name = "btnAbbrechen";
            this.btnAbbrechen.Size = new System.Drawing.Size(120, 24);
            this.btnAbbrechen.TabIndex = 5;
            this.btnAbbrechen.Text = "Abbrechen";
            this.btnAbbrechen.UseCompatibleTextRendering = true;
            this.btnAbbrechen.UseVisualStyleBackColor = false;
            this.btnAbbrechen.Click += new System.EventHandler(this.btnAbbrechen_Click);
            //
            // lblBemerkung
            //
            this.lblBemerkung.LabelStyle = KiSS4.Gui.LabelStyleType.DataViewLabel;
            this.lblBemerkung.Location = new System.Drawing.Point(8, 147);
            this.lblBemerkung.Name = "lblBemerkung";
            this.lblBemerkung.Size = new System.Drawing.Size(144, 16);
            this.lblBemerkung.TabIndex = 8;
            this.lblBemerkung.Text = "Mitteilung";
            this.lblBemerkung.UseCompatibleTextRendering = true;
            //
            // lblDatumVisum
            //
            this.lblDatumVisum.Location = new System.Drawing.Point(8, 83);
            this.lblDatumVisum.Name = "lblDatumVisum";
            this.lblDatumVisum.Size = new System.Drawing.Size(121, 24);
            this.lblDatumVisum.TabIndex = 16;
            this.lblDatumVisum.Text = "Datum Visum";
            this.lblDatumVisum.UseCompatibleTextRendering = true;
            //
            // qryBgBewilligung
            //
            this.qryBgBewilligung.CanDelete = true;
            this.qryBgBewilligung.CanInsert = true;
            this.qryBgBewilligung.CanUpdate = true;
            this.qryBgBewilligung.HostControl = this;
            this.qryBgBewilligung.SelectStatement = "SELECT *\r\nFROM BgBewilligung BEW";
            this.qryBgBewilligung.TableName = "BgBewilligung";
            this.qryBgBewilligung.BeforePost += new System.EventHandler(this.qryBgBewilligung_BeforePost);
            //
            // DlgWhFinanzplanReferentin
            //
            this.ActiveSQLQuery = this.qryBgBewilligung;
            this.CancelButton = this.btnAbbrechen;
            this.ClientSize = new System.Drawing.Size(488, 270);
            this.Controls.Add(this.lblDatumVisum);
            this.Controls.Add(this.lblBemerkung);
            this.Controls.Add(this.btnAbbrechen);
            this.Controls.Add(this.btnVisieren);
            this.Controls.Add(this.btnAblehnen);
            this.Controls.Add(this.edtBemerkung);
            this.Controls.Add(this.lblXUser);
            this.Controls.Add(this.edtDatumVisum);
            this.Controls.Add(this.lblTitel);
            this.Controls.Add(this.edtNameReferentin);
            this.Name = "DlgWhFinanzplanReferentin";
            this.Text = "Visum ReferentIn";
            ((System.ComponentModel.ISupportInitialize)(this.edtNameReferentin.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtDatumVisum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblXUser)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBemerkung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumVisum)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgBewilligung)).EndInit();
            this.ResumeLayout(false);
        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Public Properties

        public bool UserYes
        {
            get { return this.userYes; }
        }

        #endregion

        #region Private Methods

        private void btnAbbrechen_Click(object sender, System.EventArgs e)
        {
            this.userCancel = true;

            qryBgBewilligung.RowModified = false;
            qryBgBewilligung.DataSet.AcceptChanges();
        }

        private void btnAblehnen_Click(object sender, System.EventArgs e)
        {
            this.userCancel = false;
            this.userYes = false;

            qryBgBewilligung.RowModified = true;
            qryBgBewilligung["BgBewilligungCode"] = 7;
            qryBgBewilligung.Post(qryBgBewilligung.TableName);
            DialogResult = DialogResult.OK;
        }

        private void btnVisieren_Click(object sender, System.EventArgs e)
        {
            this.userCancel = false;
            this.userYes = true;

            qryBgBewilligung.RowModified = true;
            qryBgBewilligung["BgBewilligungCode"] = 8;
            qryBgBewilligung.Post(qryBgBewilligung.TableName);
            DialogResult = DialogResult.OK;
        }

        private void qryBgBewilligung_BeforePost(object sender, System.EventArgs e)
        {
            if (DBUtil.IsEmpty(edtNameReferentin.EditValue))
            {
                KissMsg.ShowError("Name ReferentIn darf nicht leer sein.");
                throw new KissCancelException();//return;
            }

            qryBgBewilligung["Datum"] = DateTime.Now;
            qryBgBewilligung["UserID"] = Session.User.UserID;

            if (DBUtil.IsEmpty(edtBemerkung.EditValue))
            {
                qryBgBewilligung["Bemerkung"] = edtNameReferentin.EditValue;
            }
            else
            {
                qryBgBewilligung["Bemerkung"] = string.Format("{0}: {1}", edtNameReferentin.EditValue, edtBemerkung.EditValue);
            }
        }

        #endregion
    }
}