#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using Kiss.Interfaces.UI;
using KiSS4.DB;
using KiSS4.Gui;
using System;
using System.Data;
using System.Drawing;

namespace KiSS4.Sozialhilfe.ZH
{
    public class CtlWhSpezialkonto : KiSS4.Gui.KissUserControl
    {
        #region Fields

        private BgSpezkontoTyp bgSpezkontoTypCode = 0;
        private DevExpress.XtraGrid.Columns.GridColumn colBaPersonID;
        private DevExpress.XtraGrid.Columns.GridColumn colBetragBelastung;
        private DevExpress.XtraGrid.Columns.GridColumn colBetragGutschrift;
        private DevExpress.XtraGrid.Columns.GridColumn colBetragGutschriftEffektiv;
        private DevExpress.XtraGrid.Columns.GridColumn colBetragProMonat;
        private DevExpress.XtraGrid.Columns.GridColumn colBuchungstext;
        private DevExpress.XtraGrid.Columns.GridColumn colDatum;
        private DevExpress.XtraGrid.Columns.GridColumn colDatumBis;
        private DevExpress.XtraGrid.Columns.GridColumn colDatumVon;
        private DevExpress.XtraGrid.Columns.GridColumn colFreigegeben;
        private DevExpress.XtraGrid.Columns.GridColumn colInaktiv;
        private DevExpress.XtraGrid.Columns.GridColumn colNameSpezkonto;
        private DevExpress.XtraGrid.Columns.GridColumn colSaldo;
        private DevExpress.XtraGrid.Columns.GridColumn colSaldo2;
        private DevExpress.XtraGrid.Columns.GridColumn colStartSaldo;
        private DevExpress.XtraGrid.Columns.GridColumn colVerbucht;
        private System.ComponentModel.IContainer components;
        private bool DialogMode = false;
        private KiSS4.Gui.KissCalcEdit editDatumBisJahr;
        private KiSS4.Gui.KissLookUpEdit editDatumBisMonat;
        private KiSS4.Gui.KissCalcEdit editDatumVonJahr;
        private KiSS4.Gui.KissLookUpEdit editDatumVonMonat;
        private KiSS4.Gui.KissLookUpEdit edtBaPersonID;
        private KiSS4.Gui.KissMemoEdit edtBemerkung;
        private KiSS4.Gui.KissCalcEdit edtBetragProMonat;
        private KiSS4.Gui.KissLookUpEdit edtBgKostenartID;
        private KiSS4.Gui.KissLookUpEdit edtBgPositionsartID;
        private KiSS4.Gui.KissCheckEdit edtInaktiv;
        private KiSS4.Gui.KissButtonEdit edtInstitution;
        private KiSS4.Gui.KissTextEdit edtNameSpezkonto;
        private KiSS4.Gui.KissCheckEdit edtNurOffeneAnzeigen;
        private KiSS4.Gui.KissCheckEdit edtOhneEinzelzahlung;
        private KiSS4.Gui.KissCalcEdit edtStartSaldo;
        private int FaLeistungID = 0;
        private KiSS4.Gui.KissGrid grdBgPosition;
        private KiSS4.Gui.KissGrid grdBgSpezkonto;
        private DevExpress.XtraGrid.Views.Grid.GridView grvBgPosition;
        private DevExpress.XtraGrid.Views.Grid.GridView grvBgSpezkonto;
        private object InitBelastung = null;
        private object InitName = null;
        private object InitStartSaldo = null;
        private KiSS4.Gui.KissLabel kissLabel4;
        private KiSS4.Gui.KissLabel lblBaPersonID;
        private KiSS4.Gui.KissLabel lblBemerkung;
        private KiSS4.Gui.KissLabel lblBetragProMonat;
        private KiSS4.Gui.KissLabel lblBgKostenartID;
        private KiSS4.Gui.KissLabel lblBgPositionsart;
        private KiSS4.Gui.KissLabel lblCHF1;
        private KiSS4.Gui.KissLabel lblCHF2;
        private KiSS4.Gui.KissLabel lblDatumBis;
        private KiSS4.Gui.KissLabel lblDatumVon;
        private KiSS4.Gui.KissLabel lblInstitutionID;
        private KiSS4.Gui.KissLabel lblNameSpezkonto;
        private KiSS4.Gui.KissLabel lblStartSaldo;
        private KiSS4.Gui.KissLabel lblTitel;
        private System.Windows.Forms.Panel panBaInstitutionID;
        private System.Windows.Forms.Panel panBaPersonID;
        private System.Windows.Forms.Panel panBgKostenartID;
        private System.Windows.Forms.Panel panBgPositionsartID;
        private System.Windows.Forms.Panel panFooter;
        private System.Windows.Forms.Panel panHeader;
        private System.Windows.Forms.PictureBox picTitel;
        private KiSS4.DB.SqlQuery qryBaPerson;
        private KiSS4.DB.SqlQuery qryBgKostenart;
        private KiSS4.DB.SqlQuery qryBgPosition;
        private KiSS4.DB.SqlQuery qryBgSpezkonto;
        private Decimal Saldo = 0;

        #endregion

        #region Constructors

        // Used in CtlShEinzelzahlung to display in a DlgKissUsercontrol
        public CtlWhSpezialkonto(BgSpezkontoTyp BgSpezkontoTypCode, int faLeistung, object InitName, object InitStartSaldo, object InitBelastung)
            : this(null, string.Empty, BgSpezkontoTypCode, faLeistung)
        {
            this.DialogMode = true;
            this.InitName = InitName;
            this.InitStartSaldo = InitStartSaldo;
            this.InitBelastung = InitBelastung;

            if (BgSpezkontoTypCode == BgSpezkontoTyp.Ausgabekonto)
            {
                //Maske deaktivieren
                qryBgSpezkonto.CanInsert = false;
                qryBgSpezkonto.CanUpdate = false;
                qryBgSpezkonto.CanDelete = false;
            }
        }

        public CtlWhSpezialkonto(Image titelImage, string titelText, BgSpezkontoTyp BgSpezkontoTypCode, int faLeistung)
            : this()
        {
            this.FaLeistungID = faLeistung;
            this.picTitel.Image = titelImage;
            this.BgSpezkontoTypCode = BgSpezkontoTypCode;

            lblTitel.Text = titelText;

            edtNurOffeneAnzeigen.EditValueChanging += edtNurOffeneAnzeigen_EditValueChanging;
            edtNurOffeneAnzeigen.CheckedChanged += edtNurOffeneAnzeigen_CheckedChanged;

            if (this.bgSpezkontoTypCode == BgSpezkontoTyp.Ausgabekonto)
            {
                // Die nachfolgenden Controls werden im Ausgabekonto nicht verwendet (Hinweis sozbev)
                editDatumBisJahr.Visible = false;
                editDatumVonJahr.Visible = false;
                editDatumBisMonat.Visible = false;
                editDatumVonMonat.Visible = false;
                lblDatumVon.Visible = false;
                lblDatumBis.Visible = false;
            }

            if (BgSpezkontoTypCode == BgSpezkontoTyp.Ausgabekonto)
            {
                //Maske deaktivieren
                qryBgSpezkonto.CanInsert = false;
                qryBgSpezkonto.CanUpdate = false;
                qryBgSpezkonto.CanDelete = false;
            }
        }

        public CtlWhSpezialkonto()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject6 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject5 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlWhSpezialkonto));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            this.panHeader = new System.Windows.Forms.Panel();
            this.edtInaktiv = new KiSS4.Gui.KissCheckEdit();
            this.qryBgSpezkonto = new KiSS4.DB.SqlQuery(this.components);
            this.picTitel = new System.Windows.Forms.PictureBox();
            this.lblNameSpezkonto = new KiSS4.Gui.KissLabel();
            this.grdBgSpezkonto = new KiSS4.Gui.KissGrid();
            this.grvBgSpezkonto = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colNameSpezkonto = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBaPersonID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colStartSaldo = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBetragProMonat = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colSaldo = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDatumVon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDatumBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.edtNurOffeneAnzeigen = new KiSS4.Gui.KissCheckEdit();
            this.lblTitel = new KiSS4.Gui.KissLabel();
            this.edtNameSpezkonto = new KiSS4.Gui.KissTextEdit();
            this.panBgKostenartID = new System.Windows.Forms.Panel();
            this.lblBgKostenartID = new KiSS4.Gui.KissLabel();
            this.edtBgKostenartID = new KiSS4.Gui.KissLookUpEdit();
            this.panBgPositionsartID = new System.Windows.Forms.Panel();
            this.lblBgPositionsart = new KiSS4.Gui.KissLabel();
            this.edtBgPositionsartID = new KiSS4.Gui.KissLookUpEdit();
            this.panBaPersonID = new System.Windows.Forms.Panel();
            this.lblBaPersonID = new KiSS4.Gui.KissLabel();
            this.edtBaPersonID = new KiSS4.Gui.KissLookUpEdit();
            this.panBaInstitutionID = new System.Windows.Forms.Panel();
            this.edtInstitution = new KiSS4.Gui.KissButtonEdit();
            this.lblInstitutionID = new KiSS4.Gui.KissLabel();
            this.panFooter = new System.Windows.Forms.Panel();
            this.grdBgPosition = new KiSS4.Gui.KissGrid();
            this.qryBgPosition = new KiSS4.DB.SqlQuery(this.components);
            this.grvBgPosition = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colDatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBetragGutschrift = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBetragBelastung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colSaldo2 = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colInaktiv = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFreigegeben = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerbucht = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBuchungstext = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBetragGutschriftEffektiv = new DevExpress.XtraGrid.Columns.GridColumn();
            this.edtOhneEinzelzahlung = new KiSS4.Gui.KissCheckEdit();
            this.kissLabel4 = new KiSS4.Gui.KissLabel();
            this.lblBemerkung = new KiSS4.Gui.KissLabel();
            this.editDatumBisJahr = new KiSS4.Gui.KissCalcEdit();
            this.editDatumBisMonat = new KiSS4.Gui.KissLookUpEdit();
            this.lblDatumBis = new KiSS4.Gui.KissLabel();
            this.lblCHF2 = new KiSS4.Gui.KissLabel();
            this.lblBetragProMonat = new KiSS4.Gui.KissLabel();
            this.edtBemerkung = new KiSS4.Gui.KissMemoEdit();
            this.lblDatumVon = new KiSS4.Gui.KissLabel();
            this.editDatumVonJahr = new KiSS4.Gui.KissCalcEdit();
            this.lblCHF1 = new KiSS4.Gui.KissLabel();
            this.editDatumVonMonat = new KiSS4.Gui.KissLookUpEdit();
            this.edtBetragProMonat = new KiSS4.Gui.KissCalcEdit();
            this.lblStartSaldo = new KiSS4.Gui.KissLabel();
            this.edtStartSaldo = new KiSS4.Gui.KissCalcEdit();
            this.qryBaPerson = new KiSS4.DB.SqlQuery(this.components);
            this.qryBgKostenart = new KiSS4.DB.SqlQuery(this.components);
            this.panHeader.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.edtInaktiv.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgSpezkonto)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblNameSpezkonto)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdBgSpezkonto)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvBgSpezkonto)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtNurOffeneAnzeigen.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtNameSpezkonto.Properties)).BeginInit();
            this.panBgKostenartID.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblBgKostenartID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgKostenartID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgKostenartID.Properties)).BeginInit();
            this.panBgPositionsartID.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblBgPositionsart)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgPositionsartID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgPositionsartID.Properties)).BeginInit();
            this.panBaPersonID.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID.Properties)).BeginInit();
            this.panBaInstitutionID.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.edtInstitution.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblInstitutionID)).BeginInit();
            this.panFooter.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.grdBgPosition)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgPosition)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvBgPosition)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtOhneEinzelzahlung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel4)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkung)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumBisJahr.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumBisMonat)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumBisMonat.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumBis)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblCHF2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetragProMonat)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBemerkung.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumVon)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumVonJahr.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblCHF1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumVonMonat)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumVonMonat.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBetragProMonat.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblStartSaldo)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtStartSaldo.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBaPerson)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgKostenart)).BeginInit();
            this.SuspendLayout();
            //
            // panHeader
            //
            this.panHeader.Controls.Add(this.edtInaktiv);
            this.panHeader.Controls.Add(this.picTitel);
            this.panHeader.Controls.Add(this.lblNameSpezkonto);
            this.panHeader.Controls.Add(this.grdBgSpezkonto);
            this.panHeader.Controls.Add(this.edtNurOffeneAnzeigen);
            this.panHeader.Controls.Add(this.lblTitel);
            this.panHeader.Controls.Add(this.edtNameSpezkonto);
            this.panHeader.Dock = System.Windows.Forms.DockStyle.Top;
            this.panHeader.Location = new System.Drawing.Point(0, 0);
            this.panHeader.Name = "panHeader";
            this.panHeader.Size = new System.Drawing.Size(680, 184);
            this.panHeader.TabIndex = 0;
            //
            // edtInaktiv
            //
            this.edtInaktiv.DataMember = "Inaktiv";
            this.edtInaktiv.DataSource = this.qryBgSpezkonto;
            this.edtInaktiv.Location = new System.Drawing.Point(527, 158);
            this.edtInaktiv.Name = "edtInaktiv";
            this.edtInaktiv.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtInaktiv.Properties.Appearance.Options.UseBackColor = true;
            this.edtInaktiv.Properties.Caption = "Inaktiv";
            this.edtInaktiv.Size = new System.Drawing.Size(145, 19);
            this.edtInaktiv.TabIndex = 105;
            this.edtInaktiv.Visible = false;
            this.edtInaktiv.EditValueChanged += new System.EventHandler(this.edtInaktiv_EditValueChanged);
            //
            // qryBgSpezkonto
            //
            this.qryBgSpezkonto.AutoApplyUserRights = false;
            this.qryBgSpezkonto.CanDelete = true;
            this.qryBgSpezkonto.CanInsert = true;
            this.qryBgSpezkonto.CanUpdate = true;
            this.qryBgSpezkonto.HostControl = this;
            this.qryBgSpezkonto.SelectStatement = resources.GetString("qryBgSpezkonto.SelectStatement");
            this.qryBgSpezkonto.TableName = "BgSpezkonto";
            this.qryBgSpezkonto.AfterInsert += new System.EventHandler(this.qryBgSpezkonto_AfterInsert);
            this.qryBgSpezkonto.BeforePost += new System.EventHandler(this.qryBgSpezkonto_BeforePost);
            this.qryBgSpezkonto.AfterPost += new System.EventHandler(this.qryBgSpezkonto_AfterPost);
            this.qryBgSpezkonto.BeforeDeleteQuestion += new System.EventHandler(this.qryBgSpezkonto_BeforeDeleteQuestion);
            this.qryBgSpezkonto.BeforeDelete += new System.EventHandler(this.qryBgSpezkonto_BeforeDelete);
            this.qryBgSpezkonto.AfterDelete += new System.EventHandler(this.qryBgSpezkonto_AfterDelete);
            this.qryBgSpezkonto.DeleteError += new System.UnhandledExceptionEventHandler(this.qryBgSpezkonto_DeleteError);
            this.qryBgSpezkonto.PositionChanged += new System.EventHandler(this.qryBgSpezkonto_PositionChanged);
            this.qryBgSpezkonto.ColumnChanged += new System.Data.DataColumnChangeEventHandler(this.qryBgSpezkonto_ColumnChanged);
            //
            // picTitel
            //
            this.picTitel.Location = new System.Drawing.Point(8, 5);
            this.picTitel.Name = "picTitel";
            this.picTitel.Size = new System.Drawing.Size(16, 16);
            this.picTitel.TabIndex = 104;
            this.picTitel.TabStop = false;
            //
            // lblNameSpezkonto
            //
            this.lblNameSpezkonto.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblNameSpezkonto.Location = new System.Drawing.Point(7, 155);
            this.lblNameSpezkonto.Name = "lblNameSpezkonto";
            this.lblNameSpezkonto.Size = new System.Drawing.Size(119, 24);
            this.lblNameSpezkonto.TabIndex = 3;
            this.lblNameSpezkonto.Text = "Bezeichnung";
            this.lblNameSpezkonto.UseCompatibleTextRendering = true;
            //
            // grdBgSpezkonto
            //
            this.grdBgSpezkonto.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdBgSpezkonto.DataSource = this.qryBgSpezkonto;
            //
            //
            //
            this.grdBgSpezkonto.EmbeddedNavigator.Name = "";
            this.grdBgSpezkonto.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdBgSpezkonto.Location = new System.Drawing.Point(7, 29);
            this.grdBgSpezkonto.MainView = this.grvBgSpezkonto;
            this.grdBgSpezkonto.Name = "grdBgSpezkonto";
            this.grdBgSpezkonto.Size = new System.Drawing.Size(667, 120);
            this.grdBgSpezkonto.TabIndex = 2;
            this.grdBgSpezkonto.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvBgSpezkonto});
            //
            // grvBgSpezkonto
            //
            this.grvBgSpezkonto.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvBgSpezkonto.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgSpezkonto.Appearance.Empty.Options.UseBackColor = true;
            this.grvBgSpezkonto.Appearance.Empty.Options.UseFont = true;
            this.grvBgSpezkonto.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgSpezkonto.Appearance.EvenRow.Options.UseFont = true;
            this.grvBgSpezkonto.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvBgSpezkonto.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgSpezkonto.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvBgSpezkonto.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvBgSpezkonto.Appearance.FocusedCell.Options.UseFont = true;
            this.grvBgSpezkonto.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvBgSpezkonto.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvBgSpezkonto.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgSpezkonto.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvBgSpezkonto.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvBgSpezkonto.Appearance.FocusedRow.Options.UseFont = true;
            this.grvBgSpezkonto.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvBgSpezkonto.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvBgSpezkonto.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvBgSpezkonto.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvBgSpezkonto.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvBgSpezkonto.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvBgSpezkonto.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvBgSpezkonto.Appearance.GroupRow.Options.UseFont = true;
            this.grvBgSpezkonto.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvBgSpezkonto.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvBgSpezkonto.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvBgSpezkonto.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvBgSpezkonto.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvBgSpezkonto.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvBgSpezkonto.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvBgSpezkonto.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvBgSpezkonto.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgSpezkonto.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvBgSpezkonto.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvBgSpezkonto.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvBgSpezkonto.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvBgSpezkonto.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvBgSpezkonto.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvBgSpezkonto.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgSpezkonto.Appearance.OddRow.Options.UseFont = true;
            this.grvBgSpezkonto.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvBgSpezkonto.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgSpezkonto.Appearance.Row.Options.UseBackColor = true;
            this.grvBgSpezkonto.Appearance.Row.Options.UseFont = true;
            this.grvBgSpezkonto.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgSpezkonto.Appearance.SelectedRow.Options.UseFont = true;
            this.grvBgSpezkonto.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvBgSpezkonto.Appearance.VertLine.Options.UseBackColor = true;
            this.grvBgSpezkonto.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvBgSpezkonto.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colNameSpezkonto,
            this.colBaPersonID,
            this.colStartSaldo,
            this.colBetragProMonat,
            this.colSaldo,
            this.colDatumVon,
            this.colDatumBis});
            this.grvBgSpezkonto.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvBgSpezkonto.GridControl = this.grdBgSpezkonto;
            this.grvBgSpezkonto.Name = "grvBgSpezkonto";
            this.grvBgSpezkonto.OptionsBehavior.Editable = false;
            this.grvBgSpezkonto.OptionsCustomization.AllowFilter = false;
            this.grvBgSpezkonto.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvBgSpezkonto.OptionsNavigation.AutoFocusNewRow = true;
            this.grvBgSpezkonto.OptionsNavigation.UseTabKey = false;
            this.grvBgSpezkonto.OptionsView.ColumnAutoWidth = false;
            this.grvBgSpezkonto.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvBgSpezkonto.OptionsView.ShowGroupPanel = false;
            this.grvBgSpezkonto.OptionsView.ShowIndicator = false;
            //
            // colNameSpezkonto
            //
            this.colNameSpezkonto.Caption = "Bezeichnung";
            this.colNameSpezkonto.FieldName = "NameSpezkonto";
            this.colNameSpezkonto.Name = "colNameSpezkonto";
            this.colNameSpezkonto.Visible = true;
            this.colNameSpezkonto.VisibleIndex = 0;
            this.colNameSpezkonto.Width = 265;
            //
            // colBaPersonID
            //
            this.colBaPersonID.Caption = "Person";
            this.colBaPersonID.FieldName = "BaPersonID";
            this.colBaPersonID.Name = "colBaPersonID";
            this.colBaPersonID.Visible = true;
            this.colBaPersonID.VisibleIndex = 1;
            this.colBaPersonID.Width = 100;
            //
            // colStartSaldo
            //
            this.colStartSaldo.Caption = "Startsaldo";
            this.colStartSaldo.DisplayFormat.FormatString = "N2";
            this.colStartSaldo.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colStartSaldo.FieldName = "StartSaldo";
            this.colStartSaldo.Name = "colStartSaldo";
            this.colStartSaldo.Visible = true;
            this.colStartSaldo.VisibleIndex = 2;
            this.colStartSaldo.Width = 70;
            //
            // colBetragProMonat
            //
            this.colBetragProMonat.Caption = "Monatlich";
            this.colBetragProMonat.DisplayFormat.FormatString = "n2";
            this.colBetragProMonat.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colBetragProMonat.FieldName = "BetragProMonat";
            this.colBetragProMonat.Name = "colBetragProMonat";
            this.colBetragProMonat.Visible = true;
            this.colBetragProMonat.VisibleIndex = 3;
            this.colBetragProMonat.Width = 80;
            //
            // colSaldo
            //
            this.colSaldo.Caption = "Saldo";
            this.colSaldo.DisplayFormat.FormatString = "n2";
            this.colSaldo.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colSaldo.FieldName = "Saldo";
            this.colSaldo.Name = "colSaldo";
            this.colSaldo.Visible = true;
            this.colSaldo.VisibleIndex = 4;
            this.colSaldo.Width = 80;
            //
            // colDatumVon
            //
            this.colDatumVon.Caption = "gültig von";
            this.colDatumVon.FieldName = "DatumVon";
            this.colDatumVon.Name = "colDatumVon";
            this.colDatumVon.Visible = true;
            this.colDatumVon.VisibleIndex = 5;
            //
            // colDatumBis
            //
            this.colDatumBis.Caption = "gültig bis";
            this.colDatumBis.FieldName = "DatumBis";
            this.colDatumBis.Name = "colDatumBis";
            this.colDatumBis.Visible = true;
            this.colDatumBis.VisibleIndex = 6;
            //
            // edtNurOffeneAnzeigen
            //
            this.edtNurOffeneAnzeigen.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.edtNurOffeneAnzeigen.EditValue = false;
            this.edtNurOffeneAnzeigen.Location = new System.Drawing.Point(556, 5);
            this.edtNurOffeneAnzeigen.Name = "edtNurOffeneAnzeigen";
            this.edtNurOffeneAnzeigen.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtNurOffeneAnzeigen.Properties.Appearance.Options.UseBackColor = true;
            this.edtNurOffeneAnzeigen.Properties.Caption = "nur offene (Saldo)";
            this.edtNurOffeneAnzeigen.Size = new System.Drawing.Size(116, 19);
            this.edtNurOffeneAnzeigen.TabIndex = 1;
            //
            // lblTitel
            //
            this.lblTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblTitel.Location = new System.Drawing.Point(30, 5);
            this.lblTitel.Name = "lblTitel";
            this.lblTitel.Size = new System.Drawing.Size(520, 16);
            this.lblTitel.TabIndex = 0;
            this.lblTitel.Text = "{0}";
            this.lblTitel.UseCompatibleTextRendering = true;
            //
            // edtNameSpezkonto
            //
            this.edtNameSpezkonto.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtNameSpezkonto.DataMember = "NameSpezkonto";
            this.edtNameSpezkonto.DataSource = this.qryBgSpezkonto;
            this.edtNameSpezkonto.Location = new System.Drawing.Point(132, 155);
            this.edtNameSpezkonto.Name = "edtNameSpezkonto";
            this.edtNameSpezkonto.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtNameSpezkonto.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtNameSpezkonto.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtNameSpezkonto.Properties.Appearance.Options.UseBackColor = true;
            this.edtNameSpezkonto.Properties.Appearance.Options.UseBorderColor = true;
            this.edtNameSpezkonto.Properties.Appearance.Options.UseFont = true;
            this.edtNameSpezkonto.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtNameSpezkonto.Size = new System.Drawing.Size(376, 24);
            this.edtNameSpezkonto.TabIndex = 0;
            //
            // panBgKostenartID
            //
            this.panBgKostenartID.Controls.Add(this.lblBgKostenartID);
            this.panBgKostenartID.Controls.Add(this.edtBgKostenartID);
            this.panBgKostenartID.Dock = System.Windows.Forms.DockStyle.Top;
            this.panBgKostenartID.Location = new System.Drawing.Point(0, 184);
            this.panBgKostenartID.Name = "panBgKostenartID";
            this.panBgKostenartID.Size = new System.Drawing.Size(680, 28);
            this.panBgKostenartID.TabIndex = 1;
            //
            // lblBgKostenartID
            //
            this.lblBgKostenartID.Location = new System.Drawing.Point(7, 0);
            this.lblBgKostenartID.Name = "lblBgKostenartID";
            this.lblBgKostenartID.Size = new System.Drawing.Size(119, 24);
            this.lblBgKostenartID.TabIndex = 0;
            this.lblBgKostenartID.Text = "Leistungsart";
            this.lblBgKostenartID.UseCompatibleTextRendering = true;
            //
            // edtBgKostenartID
            //
            this.edtBgKostenartID.DataMember = "BgKostenartID";
            this.edtBgKostenartID.DataSource = this.qryBgSpezkonto;
            this.edtBgKostenartID.Location = new System.Drawing.Point(132, 0);
            this.edtBgKostenartID.Name = "edtBgKostenartID";
            this.edtBgKostenartID.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBgKostenartID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBgKostenartID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBgKostenartID.Properties.Appearance.Options.UseBackColor = true;
            this.edtBgKostenartID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBgKostenartID.Properties.Appearance.Options.UseFont = true;
            this.edtBgKostenartID.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtBgKostenartID.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtBgKostenartID.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtBgKostenartID.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtBgKostenartID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject6.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject6.Options.UseBackColor = true;
            this.edtBgKostenartID.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject6)});
            this.edtBgKostenartID.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBgKostenartID.Properties.NullText = "";
            this.edtBgKostenartID.Properties.ShowFooter = false;
            this.edtBgKostenartID.Properties.ShowHeader = false;
            this.edtBgKostenartID.Size = new System.Drawing.Size(376, 24);
            this.edtBgKostenartID.TabIndex = 0;
            this.edtBgKostenartID.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtBgKostenartID_UserModifiedFld);
            this.edtBgKostenartID.EditValueChanged += new System.EventHandler(this.edtBgKostenartID_EditValueChanged);
            //
            // panBgPositionsartID
            //
            this.panBgPositionsartID.Controls.Add(this.lblBgPositionsart);
            this.panBgPositionsartID.Controls.Add(this.edtBgPositionsartID);
            this.panBgPositionsartID.Dock = System.Windows.Forms.DockStyle.Top;
            this.panBgPositionsartID.Location = new System.Drawing.Point(0, 212);
            this.panBgPositionsartID.Name = "panBgPositionsartID";
            this.panBgPositionsartID.Size = new System.Drawing.Size(680, 28);
            this.panBgPositionsartID.TabIndex = 2;
            //
            // lblBgPositionsart
            //
            this.lblBgPositionsart.Location = new System.Drawing.Point(7, 0);
            this.lblBgPositionsart.Name = "lblBgPositionsart";
            this.lblBgPositionsart.Size = new System.Drawing.Size(119, 24);
            this.lblBgPositionsart.TabIndex = 0;
            this.lblBgPositionsart.Text = "Positionsart";
            this.lblBgPositionsart.UseCompatibleTextRendering = true;
            //
            // edtBgPositionsartID
            //
            this.edtBgPositionsartID.DataMember = "BgPositionsartID";
            this.edtBgPositionsartID.DataSource = this.qryBgSpezkonto;
            this.edtBgPositionsartID.Location = new System.Drawing.Point(132, 0);
            this.edtBgPositionsartID.Name = "edtBgPositionsartID";
            this.edtBgPositionsartID.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBgPositionsartID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBgPositionsartID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBgPositionsartID.Properties.Appearance.Options.UseBackColor = true;
            this.edtBgPositionsartID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBgPositionsartID.Properties.Appearance.Options.UseFont = true;
            this.edtBgPositionsartID.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtBgPositionsartID.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtBgPositionsartID.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtBgPositionsartID.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtBgPositionsartID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject5.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject5.Options.UseBackColor = true;
            this.edtBgPositionsartID.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject5)});
            this.edtBgPositionsartID.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBgPositionsartID.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Code"),
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text", "", 50, DevExpress.Utils.FormatType.None, "", true, DevExpress.Utils.HorzAlignment.Default, DevExpress.Data.ColumnSortOrder.None)});
            this.edtBgPositionsartID.Properties.NullText = "";
            this.edtBgPositionsartID.Properties.ShowFooter = false;
            this.edtBgPositionsartID.Properties.ShowHeader = false;
            this.edtBgPositionsartID.Size = new System.Drawing.Size(376, 24);
            this.edtBgPositionsartID.TabIndex = 0;
            this.edtBgPositionsartID.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtBgPositionsartID_UserModifiedFld);
            this.edtBgPositionsartID.EditValueChanged += new System.EventHandler(this.edtBgPositionsartID_EditValueChanged);
            //
            // panBaPersonID
            //
            this.panBaPersonID.Controls.Add(this.lblBaPersonID);
            this.panBaPersonID.Controls.Add(this.edtBaPersonID);
            this.panBaPersonID.Dock = System.Windows.Forms.DockStyle.Top;
            this.panBaPersonID.Location = new System.Drawing.Point(0, 240);
            this.panBaPersonID.Name = "panBaPersonID";
            this.panBaPersonID.Size = new System.Drawing.Size(680, 28);
            this.panBaPersonID.TabIndex = 3;
            //
            // lblBaPersonID
            //
            this.lblBaPersonID.Location = new System.Drawing.Point(7, 0);
            this.lblBaPersonID.Name = "lblBaPersonID";
            this.lblBaPersonID.Size = new System.Drawing.Size(119, 24);
            this.lblBaPersonID.TabIndex = 0;
            this.lblBaPersonID.Text = "Person";
            this.lblBaPersonID.UseCompatibleTextRendering = true;
            //
            // edtBaPersonID
            //
            this.edtBaPersonID.DataMember = "BaPersonID";
            this.edtBaPersonID.DataSource = this.qryBgSpezkonto;
            this.edtBaPersonID.Location = new System.Drawing.Point(132, 0);
            this.edtBaPersonID.Name = "edtBaPersonID";
            this.edtBaPersonID.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBaPersonID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBaPersonID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaPersonID.Properties.Appearance.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBaPersonID.Properties.Appearance.Options.UseFont = true;
            this.edtBaPersonID.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtBaPersonID.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtBaPersonID.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtBaPersonID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            this.edtBaPersonID.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4)});
            this.edtBaPersonID.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBaPersonID.Properties.NullText = "";
            this.edtBaPersonID.Properties.ShowFooter = false;
            this.edtBaPersonID.Properties.ShowHeader = false;
            this.edtBaPersonID.Size = new System.Drawing.Size(376, 24);
            this.edtBaPersonID.TabIndex = 0;
            //
            // panBaInstitutionID
            //
            this.panBaInstitutionID.Controls.Add(this.edtInstitution);
            this.panBaInstitutionID.Controls.Add(this.lblInstitutionID);
            this.panBaInstitutionID.Dock = System.Windows.Forms.DockStyle.Top;
            this.panBaInstitutionID.Location = new System.Drawing.Point(0, 268);
            this.panBaInstitutionID.Name = "panBaInstitutionID";
            this.panBaInstitutionID.Size = new System.Drawing.Size(680, 28);
            this.panBaInstitutionID.TabIndex = 4;
            //
            // edtInstitution
            //
            this.edtInstitution.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtInstitution.DataMember = "InstitutionName";
            this.edtInstitution.DataSource = this.qryBgSpezkonto;
            this.edtInstitution.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtInstitution.Location = new System.Drawing.Point(132, 0);
            this.edtInstitution.Name = "edtInstitution";
            this.edtInstitution.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtInstitution.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtInstitution.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtInstitution.Properties.Appearance.Options.UseBackColor = true;
            this.edtInstitution.Properties.Appearance.Options.UseBorderColor = true;
            this.edtInstitution.Properties.Appearance.Options.UseFont = true;
            this.edtInstitution.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            this.edtInstitution.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3)});
            this.edtInstitution.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtInstitution.Properties.Name = "editOrganisationName.Properties";
            this.edtInstitution.Properties.ReadOnly = true;
            this.edtInstitution.Size = new System.Drawing.Size(376, 24);
            this.edtInstitution.TabIndex = 1;
            this.edtInstitution.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtInstitution_UserModifiedFld);
            //
            // lblInstitutionID
            //
            this.lblInstitutionID.Location = new System.Drawing.Point(7, 0);
            this.lblInstitutionID.Name = "lblInstitutionID";
            this.lblInstitutionID.Size = new System.Drawing.Size(119, 24);
            this.lblInstitutionID.TabIndex = 0;
            this.lblInstitutionID.Text = "Institution";
            this.lblInstitutionID.UseCompatibleTextRendering = true;
            //
            // panFooter
            //
            this.panFooter.Controls.Add(this.grdBgPosition);
            this.panFooter.Controls.Add(this.edtOhneEinzelzahlung);
            this.panFooter.Controls.Add(this.kissLabel4);
            this.panFooter.Controls.Add(this.lblBemerkung);
            this.panFooter.Controls.Add(this.editDatumBisJahr);
            this.panFooter.Controls.Add(this.editDatumBisMonat);
            this.panFooter.Controls.Add(this.lblDatumBis);
            this.panFooter.Controls.Add(this.lblCHF2);
            this.panFooter.Controls.Add(this.lblBetragProMonat);
            this.panFooter.Controls.Add(this.edtBemerkung);
            this.panFooter.Controls.Add(this.lblDatumVon);
            this.panFooter.Controls.Add(this.editDatumVonJahr);
            this.panFooter.Controls.Add(this.lblCHF1);
            this.panFooter.Controls.Add(this.editDatumVonMonat);
            this.panFooter.Controls.Add(this.edtBetragProMonat);
            this.panFooter.Controls.Add(this.lblStartSaldo);
            this.panFooter.Controls.Add(this.edtStartSaldo);
            this.panFooter.Dock = System.Windows.Forms.DockStyle.Fill;
            this.panFooter.Location = new System.Drawing.Point(0, 296);
            this.panFooter.Name = "panFooter";
            this.panFooter.Size = new System.Drawing.Size(680, 290);
            this.panFooter.TabIndex = 5;
            //
            // grdBgPosition
            //
            this.grdBgPosition.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdBgPosition.DataSource = this.qryBgPosition;
            //
            //
            //
            this.grdBgPosition.EmbeddedNavigator.Name = "";
            this.grdBgPosition.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdBgPosition.Location = new System.Drawing.Point(7, 142);
            this.grdBgPosition.MainView = this.grvBgPosition;
            this.grdBgPosition.Name = "grdBgPosition";
            this.grdBgPosition.Size = new System.Drawing.Size(667, 145);
            this.grdBgPosition.TabIndex = 16;
            this.grdBgPosition.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvBgPosition});
            //
            // qryBgPosition
            //
            this.qryBgPosition.AutoApplyUserRights = false;
            this.qryBgPosition.CanUpdate = true;
            this.qryBgPosition.HostControl = this;
            this.qryBgPosition.SelectStatement = resources.GetString("qryBgPosition.SelectStatement");
            this.qryBgPosition.BeforePost += new System.EventHandler(this.qryBgPosition_BeforePost);
            //
            // grvBgPosition
            //
            this.grvBgPosition.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvBgPosition.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgPosition.Appearance.Empty.Options.UseBackColor = true;
            this.grvBgPosition.Appearance.Empty.Options.UseFont = true;
            this.grvBgPosition.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgPosition.Appearance.EvenRow.Options.UseFont = true;
            this.grvBgPosition.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvBgPosition.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgPosition.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvBgPosition.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvBgPosition.Appearance.FocusedCell.Options.UseFont = true;
            this.grvBgPosition.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvBgPosition.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvBgPosition.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgPosition.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvBgPosition.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvBgPosition.Appearance.FocusedRow.Options.UseFont = true;
            this.grvBgPosition.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvBgPosition.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvBgPosition.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvBgPosition.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvBgPosition.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvBgPosition.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvBgPosition.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvBgPosition.Appearance.GroupRow.Options.UseFont = true;
            this.grvBgPosition.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvBgPosition.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvBgPosition.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvBgPosition.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvBgPosition.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvBgPosition.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvBgPosition.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvBgPosition.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvBgPosition.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgPosition.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvBgPosition.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvBgPosition.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvBgPosition.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvBgPosition.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvBgPosition.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvBgPosition.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgPosition.Appearance.OddRow.Options.UseFont = true;
            this.grvBgPosition.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvBgPosition.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgPosition.Appearance.Row.Options.UseBackColor = true;
            this.grvBgPosition.Appearance.Row.Options.UseFont = true;
            this.grvBgPosition.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBgPosition.Appearance.SelectedRow.Options.UseFont = true;
            this.grvBgPosition.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvBgPosition.Appearance.VertLine.Options.UseBackColor = true;
            this.grvBgPosition.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvBgPosition.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colDatum,
            this.colBetragGutschrift,
            this.colBetragBelastung,
            this.colSaldo2,
            this.colInaktiv,
            this.colFreigegeben,
            this.colVerbucht,
            this.colBuchungstext,
            this.colBetragGutschriftEffektiv});
            this.grvBgPosition.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvBgPosition.GridControl = this.grdBgPosition;
            this.grvBgPosition.Name = "grvBgPosition";
            this.grvBgPosition.OptionsBehavior.Editable = false;
            this.grvBgPosition.OptionsCustomization.AllowFilter = false;
            this.grvBgPosition.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvBgPosition.OptionsNavigation.AutoFocusNewRow = true;
            this.grvBgPosition.OptionsNavigation.UseTabKey = false;
            this.grvBgPosition.OptionsView.ColumnAutoWidth = false;
            this.grvBgPosition.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvBgPosition.OptionsView.ShowFooter = true;
            this.grvBgPosition.OptionsView.ShowGroupPanel = false;
            this.grvBgPosition.OptionsView.ShowIndicator = false;
            this.grvBgPosition.CustomSummaryCalculate += new DevExpress.Data.CustomSummaryEventHandler(this.grvBgPosition_CustomSummaryCalculate);
            //
            // colDatum
            //
            this.colDatum.Caption = "Monat";
            this.colDatum.DisplayFormat.FormatString = "{0:MMM yyyy}";
            this.colDatum.DisplayFormat.FormatType = DevExpress.Utils.FormatType.DateTime;
            this.colDatum.FieldName = "Datum";
            this.colDatum.Name = "colDatum";
            this.colDatum.Visible = true;
            this.colDatum.VisibleIndex = 0;
            this.colDatum.Width = 90;
            //
            // colBetragGutschrift
            //
            this.colBetragGutschrift.Caption = "Gutschrift";
            this.colBetragGutschrift.DisplayFormat.FormatString = "N2";
            this.colBetragGutschrift.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colBetragGutschrift.FieldName = "Gutschrift";
            this.colBetragGutschrift.Name = "colBetragGutschrift";
            this.colBetragGutschrift.SummaryItem.DisplayFormat = "{0:n2}";
            this.colBetragGutschrift.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colBetragGutschrift.Visible = true;
            this.colBetragGutschrift.VisibleIndex = 1;
            this.colBetragGutschrift.Width = 80;
            //
            // colBetragBelastung
            //
            this.colBetragBelastung.Caption = "Belastung";
            this.colBetragBelastung.DisplayFormat.FormatString = "N2";
            this.colBetragBelastung.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colBetragBelastung.FieldName = "Belastung";
            this.colBetragBelastung.Name = "colBetragBelastung";
            this.colBetragBelastung.SummaryItem.DisplayFormat = "{0:n2}";
            this.colBetragBelastung.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            this.colBetragBelastung.Visible = true;
            this.colBetragBelastung.VisibleIndex = 2;
            this.colBetragBelastung.Width = 80;
            //
            // colSaldo2
            //
            this.colSaldo2.Caption = "Saldo";
            this.colSaldo2.DisplayFormat.FormatString = "N2";
            this.colSaldo2.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colSaldo2.FieldName = "Saldo";
            this.colSaldo2.Name = "colSaldo2";
            this.colSaldo2.SummaryItem.DisplayFormat = "{0:n2}";
            this.colSaldo2.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Custom;
            this.colSaldo2.Visible = true;
            this.colSaldo2.VisibleIndex = 3;
            this.colSaldo2.Width = 80;
            //
            // colInaktiv
            //
            this.colInaktiv.Caption = "Inaktiv";
            this.colInaktiv.FieldName = "Inaktiv";
            this.colInaktiv.Name = "colInaktiv";
            this.colInaktiv.Visible = true;
            this.colInaktiv.VisibleIndex = 4;
            this.colInaktiv.Width = 60;
            //
            // colFreigegeben
            //
            this.colFreigegeben.Caption = "MB";
            this.colFreigegeben.FieldName = "Freigegeben";
            this.colFreigegeben.Name = "colFreigegeben";
            this.colFreigegeben.Visible = true;
            this.colFreigegeben.VisibleIndex = 5;
            this.colFreigegeben.Width = 60;
            //
            // colVerbucht
            //
            this.colVerbucht.Caption = "verbucht";
            this.colVerbucht.FieldName = "Verbucht";
            this.colVerbucht.Name = "colVerbucht";
            this.colVerbucht.Visible = true;
            this.colVerbucht.VisibleIndex = 6;
            this.colVerbucht.Width = 60;
            //
            // colBuchungstext
            //
            this.colBuchungstext.Caption = "Buchungstext";
            this.colBuchungstext.FieldName = "Buchungstext";
            this.colBuchungstext.Name = "colBuchungstext";
            this.colBuchungstext.Visible = true;
            this.colBuchungstext.VisibleIndex = 7;
            this.colBuchungstext.Width = 190;
            //
            // colBetragGutschriftEffektiv
            //
            this.colBetragGutschriftEffektiv.Caption = "Hidden";
            this.colBetragGutschriftEffektiv.FieldName = "GutschriftEffektiv";
            this.colBetragGutschriftEffektiv.Name = "colBetragGutschriftEffektiv";
            this.colBetragGutschriftEffektiv.SummaryItem.SummaryType = DevExpress.Data.SummaryItemType.Sum;
            //
            // edtOhneEinzelzahlung
            //
            this.edtOhneEinzelzahlung.DataMember = "OhneEinzelzahlung";
            this.edtOhneEinzelzahlung.DataSource = this.qryBgSpezkonto;
            this.edtOhneEinzelzahlung.Location = new System.Drawing.Point(132, 110);
            this.edtOhneEinzelzahlung.Name = "edtOhneEinzelzahlung";
            this.edtOhneEinzelzahlung.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtOhneEinzelzahlung.Properties.Appearance.Options.UseBackColor = true;
            this.edtOhneEinzelzahlung.Properties.Caption = "Verrechnung ohne Einzelzahlung";
            this.edtOhneEinzelzahlung.Size = new System.Drawing.Size(216, 19);
            this.edtOhneEinzelzahlung.TabIndex = 15;
            this.edtOhneEinzelzahlung.Visible = false;
            //
            // kissLabel4
            //
            this.kissLabel4.LabelStyle = KiSS4.Gui.LabelStyleType.DataView;
            this.kissLabel4.Location = new System.Drawing.Point(7, 113);
            this.kissLabel4.Name = "kissLabel4";
            this.kissLabel4.Size = new System.Drawing.Size(119, 16);
            this.kissLabel4.TabIndex = 14;
            this.kissLabel4.Text = "Kontoblatt";
            this.kissLabel4.UseCompatibleTextRendering = true;
            //
            // lblBemerkung
            //
            this.lblBemerkung.Location = new System.Drawing.Point(7, 68);
            this.lblBemerkung.Name = "lblBemerkung";
            this.lblBemerkung.Size = new System.Drawing.Size(119, 24);
            this.lblBemerkung.TabIndex = 12;
            this.lblBemerkung.Text = "Bemerkungen";
            this.lblBemerkung.UseCompatibleTextRendering = true;
            //
            // editDatumBisJahr
            //
            this.editDatumBisJahr.DataMember = "DatumBisJahr";
            this.editDatumBisJahr.DataSource = this.qryBgSpezkonto;
            this.editDatumBisJahr.Location = new System.Drawing.Point(570, 38);
            this.editDatumBisJahr.Name = "editDatumBisJahr";
            this.editDatumBisJahr.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.editDatumBisJahr.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.editDatumBisJahr.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.editDatumBisJahr.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.editDatumBisJahr.Properties.Appearance.Options.UseBackColor = true;
            this.editDatumBisJahr.Properties.Appearance.Options.UseBorderColor = true;
            this.editDatumBisJahr.Properties.Appearance.Options.UseFont = true;
            this.editDatumBisJahr.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.editDatumBisJahr.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.editDatumBisJahr.Properties.DisplayFormat.FormatString = "g";
            this.editDatumBisJahr.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.editDatumBisJahr.Properties.EditFormat.FormatString = "g";
            this.editDatumBisJahr.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.editDatumBisJahr.Size = new System.Drawing.Size(48, 24);
            this.editDatumBisJahr.TabIndex = 11;
            //
            // editDatumBisMonat
            //
            this.editDatumBisMonat.DataMember = "DatumBisMonat";
            this.editDatumBisMonat.DataSource = this.qryBgSpezkonto;
            this.editDatumBisMonat.Location = new System.Drawing.Point(490, 38);
            this.editDatumBisMonat.Name = "editDatumBisMonat";
            this.editDatumBisMonat.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.editDatumBisMonat.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.editDatumBisMonat.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.editDatumBisMonat.Properties.Appearance.Options.UseBackColor = true;
            this.editDatumBisMonat.Properties.Appearance.Options.UseBorderColor = true;
            this.editDatumBisMonat.Properties.Appearance.Options.UseFont = true;
            this.editDatumBisMonat.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.editDatumBisMonat.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.editDatumBisMonat.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.editDatumBisMonat.Properties.AppearanceDropDown.Options.UseFont = true;
            this.editDatumBisMonat.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.editDatumBisMonat.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.editDatumBisMonat.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.editDatumBisMonat.Properties.NullText = "";
            this.editDatumBisMonat.Properties.ShowFooter = false;
            this.editDatumBisMonat.Properties.ShowHeader = false;
            this.editDatumBisMonat.Size = new System.Drawing.Size(72, 24);
            this.editDatumBisMonat.TabIndex = 10;
            //
            // lblDatumBis
            //
            this.lblDatumBis.Location = new System.Drawing.Point(426, 38);
            this.lblDatumBis.Name = "lblDatumBis";
            this.lblDatumBis.Size = new System.Drawing.Size(58, 24);
            this.lblDatumBis.TabIndex = 9;
            this.lblDatumBis.Text = "gültig bis";
            this.lblDatumBis.UseCompatibleTextRendering = true;
            //
            // lblCHF2
            //
            this.lblCHF2.Location = new System.Drawing.Point(231, 38);
            this.lblCHF2.Name = "lblCHF2";
            this.lblCHF2.Size = new System.Drawing.Size(24, 24);
            this.lblCHF2.TabIndex = 8;
            this.lblCHF2.Text = "CHF";
            this.lblCHF2.UseCompatibleTextRendering = true;
            //
            // lblBetragProMonat
            //
            this.lblBetragProMonat.Location = new System.Drawing.Point(7, 38);
            this.lblBetragProMonat.Name = "lblBetragProMonat";
            this.lblBetragProMonat.Size = new System.Drawing.Size(119, 24);
            this.lblBetragProMonat.TabIndex = 6;
            this.lblBetragProMonat.Text = "Monatlicher Betrag";
            this.lblBetragProMonat.UseCompatibleTextRendering = true;
            //
            // edtBemerkung
            //
            this.edtBemerkung.DataMember = "Bemerkung";
            this.edtBemerkung.DataSource = this.qryBgSpezkonto;
            this.edtBemerkung.Location = new System.Drawing.Point(132, 68);
            this.edtBemerkung.Name = "edtBemerkung";
            this.edtBemerkung.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBemerkung.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBemerkung.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBemerkung.Properties.Appearance.Options.UseBackColor = true;
            this.edtBemerkung.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBemerkung.Properties.Appearance.Options.UseFont = true;
            this.edtBemerkung.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBemerkung.Size = new System.Drawing.Size(528, 39);
            this.edtBemerkung.TabIndex = 4;
            //
            // lblDatumVon
            //
            this.lblDatumVon.Location = new System.Drawing.Point(426, 8);
            this.lblDatumVon.Name = "lblDatumVon";
            this.lblDatumVon.Size = new System.Drawing.Size(58, 24);
            this.lblDatumVon.TabIndex = 3;
            this.lblDatumVon.Text = "gültig von";
            this.lblDatumVon.UseCompatibleTextRendering = true;
            //
            // editDatumVonJahr
            //
            this.editDatumVonJahr.DataMember = "DatumVonJahr";
            this.editDatumVonJahr.DataSource = this.qryBgSpezkonto;
            this.editDatumVonJahr.Location = new System.Drawing.Point(570, 8);
            this.editDatumVonJahr.Name = "editDatumVonJahr";
            this.editDatumVonJahr.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.editDatumVonJahr.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.editDatumVonJahr.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.editDatumVonJahr.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.editDatumVonJahr.Properties.Appearance.Options.UseBackColor = true;
            this.editDatumVonJahr.Properties.Appearance.Options.UseBorderColor = true;
            this.editDatumVonJahr.Properties.Appearance.Options.UseFont = true;
            this.editDatumVonJahr.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.editDatumVonJahr.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.editDatumVonJahr.Properties.DisplayFormat.FormatString = "g";
            this.editDatumVonJahr.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.editDatumVonJahr.Properties.EditFormat.FormatString = "g";
            this.editDatumVonJahr.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.editDatumVonJahr.Size = new System.Drawing.Size(48, 24);
            this.editDatumVonJahr.TabIndex = 3;
            //
            // lblCHF1
            //
            this.lblCHF1.Location = new System.Drawing.Point(231, 8);
            this.lblCHF1.Name = "lblCHF1";
            this.lblCHF1.Size = new System.Drawing.Size(24, 24);
            this.lblCHF1.TabIndex = 2;
            this.lblCHF1.Text = "CHF";
            this.lblCHF1.UseCompatibleTextRendering = true;
            //
            // editDatumVonMonat
            //
            this.editDatumVonMonat.DataMember = "DatumVonMonat";
            this.editDatumVonMonat.DataSource = this.qryBgSpezkonto;
            this.editDatumVonMonat.Location = new System.Drawing.Point(490, 8);
            this.editDatumVonMonat.Name = "editDatumVonMonat";
            this.editDatumVonMonat.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.editDatumVonMonat.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.editDatumVonMonat.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.editDatumVonMonat.Properties.Appearance.Options.UseBackColor = true;
            this.editDatumVonMonat.Properties.Appearance.Options.UseBorderColor = true;
            this.editDatumVonMonat.Properties.Appearance.Options.UseFont = true;
            this.editDatumVonMonat.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.editDatumVonMonat.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.editDatumVonMonat.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.editDatumVonMonat.Properties.AppearanceDropDown.Options.UseFont = true;
            this.editDatumVonMonat.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.editDatumVonMonat.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.editDatumVonMonat.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.editDatumVonMonat.Properties.NullText = "";
            this.editDatumVonMonat.Properties.ShowFooter = false;
            this.editDatumVonMonat.Properties.ShowHeader = false;
            this.editDatumVonMonat.Size = new System.Drawing.Size(72, 24);
            this.editDatumVonMonat.TabIndex = 2;
            //
            // edtBetragProMonat
            //
            this.edtBetragProMonat.DataMember = "BetragProMonat";
            this.edtBetragProMonat.DataSource = this.qryBgSpezkonto;
            this.edtBetragProMonat.Location = new System.Drawing.Point(132, 38);
            this.edtBetragProMonat.Name = "edtBetragProMonat";
            this.edtBetragProMonat.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtBetragProMonat.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBetragProMonat.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBetragProMonat.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBetragProMonat.Properties.Appearance.Options.UseBackColor = true;
            this.edtBetragProMonat.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBetragProMonat.Properties.Appearance.Options.UseFont = true;
            this.edtBetragProMonat.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBetragProMonat.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBetragProMonat.Properties.DisplayFormat.FormatString = "N2";
            this.edtBetragProMonat.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtBetragProMonat.Properties.EditFormat.FormatString = "N2";
            this.edtBetragProMonat.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtBetragProMonat.Size = new System.Drawing.Size(96, 24);
            this.edtBetragProMonat.TabIndex = 1;
            //
            // lblStartSaldo
            //
            this.lblStartSaldo.Location = new System.Drawing.Point(7, 8);
            this.lblStartSaldo.Name = "lblStartSaldo";
            this.lblStartSaldo.Size = new System.Drawing.Size(119, 24);
            this.lblStartSaldo.TabIndex = 0;
            this.lblStartSaldo.Text = "Startsaldo";
            this.lblStartSaldo.UseCompatibleTextRendering = true;
            //
            // edtStartSaldo
            //
            this.edtStartSaldo.DataMember = "StartSaldo";
            this.edtStartSaldo.DataSource = this.qryBgSpezkonto;
            this.edtStartSaldo.Location = new System.Drawing.Point(132, 8);
            this.edtStartSaldo.Name = "edtStartSaldo";
            this.edtStartSaldo.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtStartSaldo.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtStartSaldo.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtStartSaldo.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtStartSaldo.Properties.Appearance.Options.UseBackColor = true;
            this.edtStartSaldo.Properties.Appearance.Options.UseBorderColor = true;
            this.edtStartSaldo.Properties.Appearance.Options.UseFont = true;
            this.edtStartSaldo.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtStartSaldo.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtStartSaldo.Properties.DisplayFormat.FormatString = "N2";
            this.edtStartSaldo.Properties.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtStartSaldo.Properties.EditFormat.FormatString = "N2";
            this.edtStartSaldo.Properties.EditFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.edtStartSaldo.Size = new System.Drawing.Size(96, 24);
            this.edtStartSaldo.TabIndex = 0;
            //
            // qryBaPerson
            //
            this.qryBaPerson.HostControl = this;
            this.qryBaPerson.SelectStatement = resources.GetString("qryBaPerson.SelectStatement");
            //
            // qryBgKostenart
            //
            this.qryBgKostenart.HostControl = this;
            this.qryBgKostenart.SelectStatement = resources.GetString("qryBgKostenart.SelectStatement");
            //
            // CtlWhSpezialkonto
            //
            this.ActiveSQLQuery = this.qryBgSpezkonto;
            this.Controls.Add(this.panFooter);
            this.Controls.Add(this.panBaInstitutionID);
            this.Controls.Add(this.panBaPersonID);
            this.Controls.Add(this.panBgPositionsartID);
            this.Controls.Add(this.panBgKostenartID);
            this.Controls.Add(this.panHeader);
            this.Name = "CtlWhSpezialkonto";
            this.Size = new System.Drawing.Size(680, 586);
            this.Load += new System.EventHandler(this.CtlWhSpezialkonto_Load);
            this.panHeader.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.edtInaktiv.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgSpezkonto)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.picTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblNameSpezkonto)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdBgSpezkonto)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvBgSpezkonto)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtNurOffeneAnzeigen.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblTitel)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtNameSpezkonto.Properties)).EndInit();
            this.panBgKostenartID.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblBgKostenartID)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgKostenartID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgKostenartID)).EndInit();
            this.panBgPositionsartID.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblBgPositionsart)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgPositionsartID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBgPositionsartID)).EndInit();
            this.panBaPersonID.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblBaPersonID)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBaPersonID)).EndInit();
            this.panBaInstitutionID.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.edtInstitution.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblInstitutionID)).EndInit();
            this.panFooter.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.grdBgPosition)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgPosition)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvBgPosition)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtOhneEinzelzahlung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel4)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBemerkung)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumBisJahr.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumBisMonat.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumBisMonat)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumBis)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblCHF2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBetragProMonat)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBemerkung.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblDatumVon)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumVonJahr.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblCHF1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumVonMonat.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.editDatumVonMonat)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBetragProMonat.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblStartSaldo)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtStartSaldo.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBaPerson)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBgKostenart)).EndInit();
            this.ResumeLayout(false);
        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Private Properties

        private BgSpezkontoTyp BgSpezkontoTypCode
        {
            set
            {
                bgSpezkontoTypCode = value;
                colInaktiv.Visible = (value == BgSpezkontoTyp.Abzahlungskonto);
                edtInaktiv.Visible = (value == BgSpezkontoTyp.Abzahlungskonto);
            }
            get { return bgSpezkontoTypCode; }
        }

        #endregion

        #region Private Methods

        private bool Quoting
        {
            get
            {
                object quoting;
                if (this.bgSpezkontoTypCode == BgSpezkontoTyp.Abzahlungskonto)
                {
                    // Das Verrechnungskonto präferiert die Positionsart
                    quoting = edtBgPositionsartID.GetColumnValue("Quoting");
                    if (!DBUtil.IsEmpty(quoting))
                    {
                        return (bool)quoting;
                    }
                }
                quoting = edtBgKostenartID.GetColumnValue("Quoting");
                return DBUtil.IsEmpty(quoting) || (bool)quoting;
            }
        }

        private void CalcDatumBis()
        {
            if (this.BgSpezkontoTypCode != BgSpezkontoTyp.Abzahlungskonto) return;
            if (DBUtil.IsEmpty(qryBgSpezkonto["DatumVonJahr"])) return;
            if (DBUtil.IsEmpty(qryBgSpezkonto["DatumVonMonat"])) return;
            if (DBUtil.IsEmpty(qryBgSpezkonto["StartSaldo"])) return;
            if (DBUtil.IsEmpty(qryBgSpezkonto["BetragProMonat"]) || Convert.ToDecimal(qryBgSpezkonto["BetragProMonat"]) <= 0m) return;

            if (!(qryBgSpezkonto["StartSaldo"] is decimal) ||
               !(qryBgSpezkonto["BetragProMonat"] is decimal) ||
               !(qryBgSpezkonto["BgSpezkontoID"] is int))
            {
                qryBgSpezkonto["DatumBisMonat"] = DBNull.Value;
                qryBgSpezkonto["DatumBisJahr"] = DBNull.Value;
                qryBgSpezkonto["DatumBis"] = DBNull.Value;
            }
            else
            {
                object datumBis = DBUtil.ExecuteScalarSQL("SELECT dbo.[fnWhBudget_GetSpezkontoEnddatum] ({0}, {1}, {2}, {3}, {4})", qryBgSpezkonto["BgSpezkontoID"],
                                                                                                                               new DateTime((int)qryBgSpezkonto["DatumVonJahr"], (int)qryBgSpezkonto["DatumVonMonat"], 1),
                                                                                                                               qryBgSpezkonto["StartSaldo"],
                                                                                                                               qryBgSpezkonto["BetragProMonat"],
                                                                                                                               qryBgSpezkonto["Inaktiv"]);

                if (datumBis is DateTime)
                {
                    qryBgSpezkonto["DatumBisMonat"] = ((DateTime)datumBis).Month;
                    qryBgSpezkonto["DatumBisJahr"] = ((DateTime)datumBis).Year;
                }
                else
                {
                    qryBgSpezkonto["DatumBisMonat"] = DBNull.Value;
                    qryBgSpezkonto["DatumBisJahr"] = DBNull.Value;
                    qryBgSpezkonto["DatumBis"] = DBNull.Value;
                }
            }
            qryBgSpezkonto.RefreshDisplay();
        }

        private void CtlWhSpezialkonto_Load(object sender, System.EventArgs e)
        {
            // Positionsarten
            edtBgPositionsartID.LoadQuery(DBUtil.OpenSQL(@"
                SELECT
                  Code = SPT.BgPositionsartID,
                  Text = BKA.KontoNr + ' ' + SPT.Name,
                  Quoting = BKA.Quoting
                FROM WhPositionsart SPT
                  INNER JOIN BgKostenart  BKA ON BKA.BgKostenartID = SPT.BgKostenartID
                WHERE
                  SPT.BgKategorieCode = 3 AND
                  BKA.KontoNr NOT IN (860, 861, 862)	-- SiLei-Ertragsleistungen dürfen nur via SiLei-Maske erfasst werden (Mantis #90)
                ORDER BY SortKey"));

            // Monate
            SqlQuery qry = DBUtil.OpenSQL(@"
                select  Code = null, Text = null union all
                select  1, 'Jan' union all
                select  2, 'Feb' union all
                select  3, 'März' union all
                select  4, 'Apr' union all
                select  5, 'Mai' union all
                select  6, 'Juni' union all
                select  7, 'Juli' union all
                select  8, 'Aug' union all
                select  9, 'Sep' union all
                select 10, 'Okt' union all
                select 11, 'Nov' union all
                select 12, 'Dez' ");

            editDatumVonMonat.LoadQuery(qry);
            editDatumBisMonat.LoadQuery(qry);

            //rename/resize/enable Fields,GridColumns,Labels
            switch (this.BgSpezkontoTypCode)
            {
                case BgSpezkontoTyp.Ausgabekonto:
                    lblStartSaldo.Visible = false;
                    edtStartSaldo.Visible = false;
                    lblBetragProMonat.Visible = false;
                    edtBetragProMonat.Visible = false;
                    lblCHF2.Visible = false;
                    lblCHF1.Visible = false;

                    panBgPositionsartID.Visible = false;
                    panBgKostenartID.Visible = true;
                    panBaInstitutionID.Visible = true;

                    edtOhneEinzelzahlung.Visible = false;
                    colNameSpezkonto.Width += 50;
                    colStartSaldo.VisibleIndex = -1;
                    break;

                case BgSpezkontoTyp.Vorabzugkonto:
                    lblStartSaldo.Visible = false;
                    edtStartSaldo.Visible = false;
                    lblCHF1.Visible = false;

                    panBgPositionsartID.Visible = false;
                    panBgKostenartID.Visible = false;
                    panBaInstitutionID.Visible = false;

                    edtOhneEinzelzahlung.Visible = false;
                    colStartSaldo.VisibleIndex = -1;
                    break;

                case BgSpezkontoTyp.Abzahlungskonto:
                    panBgPositionsartID.Visible = true;
                    panBgKostenartID.Visible = true;
                    panBaInstitutionID.Visible = false;

                    lblStartSaldo.Text = "Abzuzahlender Betrag";
                    colStartSaldo.Caption = "Abzahlbetrag";
                    //		colBetragProMonat.VisibleIndex = -1;
                    break;
            }

            RefreshDisplay();

            if (DialogMode)
            {
                qryBgSpezkonto.Insert();
                qryBgSpezkonto["NameSpezkonto"] = this.InitName;
                qryBgSpezkonto["StartSaldo"] = this.InitStartSaldo;
                qryBgSpezkonto["BetragProMonat"] = this.InitBelastung;
                qryBgSpezkonto["OhneEinzelzahlung"] = false;
            }

            qryBaPerson.Fill(FaLeistungID);

            edtBaPersonID.LoadQuery(qryBaPerson, "BaPersonID", "NameVorname");
            colBaPersonID.ColumnEdit = grdBgSpezkonto.GetLOVLookUpEdit(qryBaPerson, "BaPersonID", "NameVorname");
        }

        private void DisplayBewegungen()
        {
            Saldo = 0;

            //Sortierung:
            // 1. Jahr
            // 2. Monat
            // 3. Ausgabe   (Typ 1): Budget vor EZ
            //	  Vorabzug  (Typ 2): Budget vor EZ
            //	  Abzahlung (Typ 3): EZ vor Budget

            grdBgPosition.DataSource = null;
            qryBgPosition.Fill(qryBgSpezkonto["BgSpezkontoID"], qryBgSpezkonto["BgSpezkontoTypCode"]);
            grdBgPosition.DataSource = qryBgPosition;

            //Calculate Saldo column
            for (int i = qryBgPosition.DataTable.Rows.Count - 1; i >= 0; i--)
            {
                DataRow row = qryBgPosition.DataTable.Rows[i];

                if (!DBUtil.IsEmpty(row["Gutschrift"]))
                    Saldo += (Decimal)row["Gutschrift"];

                if (!DBUtil.IsEmpty(row["Belastung"]))
                    Saldo -= (Decimal)row["Belastung"];

                row["Saldo"] = Saldo;
            }
        }

        private void edtBgKostenartID_EditValueChanged(object sender, System.EventArgs e)
        {
            if (BgSpezkontoTypCode == BgSpezkontoTyp.Ausgabekonto)
            {
                edtBgPositionsartID.EditValue = DBNull.Value;
            }
            if (!qryBgSpezkonto.IsFilling && !qryBgPosition.IsFilling)
            {
                // The edit-mode can only be set correctly after the queries were be filled
                SetEditMode();
            }
        }

        private void edtBgKostenartID_UserModifiedFld(object sender, UserModifiedFldEventArgs e)
        {
            object value = edtBgKostenartID.EditValue;
            object val = qryBgSpezkonto["BgKostenartID"];
            qryBgSpezkonto["BgKostenartID"] = value;
            bool quoting = this.Quoting;
            qryBgSpezkonto["Quoting"] = quoting;
            if (quoting)
            {
                // Bei gequoteten LAs darf man kein Person auswählen
                edtBaPersonID.EditValue = null;
                qryBgSpezkonto["BaPersonID"] = null;
            }
            SetEditMode();
        }

        private void edtBgPositionsartID_EditValueChanged(object sender, EventArgs e)
        {
            if (!qryBgSpezkonto.IsFilling && !qryBgPosition.IsFilling)
            {
                // The edit-mode can only be set correctly after the queries were be filled
                SetEditMode();
            }
        }

        private void edtBgPositionsartID_UserModifiedFld(object sender, UserModifiedFldEventArgs e)
        {
            qryBgSpezkonto["BgPositionsartID"] = edtBgPositionsartID.EditValue;
            bool quoting = this.Quoting;
            qryBgSpezkonto["Quoting"] = quoting;
            if (quoting)
            {
                // Bei gequoteten LAs darf man kein Person auswählen
                edtBaPersonID.EditValue = null;
                qryBgSpezkonto["BaPersonID"] = null;
            }
            SetEditMode();
        }

        private void edtInaktiv_EditValueChanged(object sender, System.EventArgs e)
        {
            if (qryBgSpezkonto.IsFilling) return;
            if (qryBgSpezkonto.IsInserting) return;

            qryBgSpezkonto["Inaktiv"] = edtInaktiv.Checked;
            // funktioniert leider nicht
            //CalcDatumBis();
        }

        private void edtInstitution_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            string SearchString = edtInstitution.EditValue.ToString().Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (e.ButtonClicked)
                {
                    SearchString = "%";
                }
                else
                {
                    qryBgSpezkonto["BaInstitutionID"] = DBNull.Value;
                    qryBgSpezkonto["InstitutionName"] = DBNull.Value;
                    return;
                }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
              SELECT ID$                 = INS.BaInstitutionID,
                     Institution         = INS.Name,
                     Adresse             = INS.Adresse,
                     Typ                 = INS.Typ,
                     InstitutionTypCode$ = INS.InstitutionTypCode,
                     OrtStrasse$         = INS.OrtStrasse
              FROM   vwInstitution INS
              WHERE  INS.Name LIKE '%' + {0} + '%'
              ORDER BY INS.Name",
              SearchString,
              e.ButtonClicked, null, null, null);

            if (!e.Cancel)
            {
                qryBgSpezkonto["BaInstitutionID"] = dlg[0];
                qryBgSpezkonto["InstitutionName"] = dlg[1];
            }
        }

        private void edtNurOffeneAnzeigen_CheckedChanged(object sender, System.EventArgs e)
        {
            RefreshDisplay();
        }

        private void edtNurOffeneAnzeigen_EditValueChanging(object sender, DevExpress.XtraEditors.Controls.ChangingEventArgs e)
        {
            e.Cancel = !qryBgSpezkonto.Post();
        }

        private void grvBgPosition_CustomSummaryCalculate(object sender, DevExpress.Data.CustomSummaryEventArgs e)
        {
            if (e.Item == colSaldo2.SummaryItem && e.SummaryProcess == DevExpress.Data.CustomSummaryProcess.Finalize)
                e.TotalValue = Saldo;
        }

        private void qryBgPosition_BeforePost(object sender, System.EventArgs e)
        {
            qryBgPosition.Row.AcceptChanges();
            qryBgPosition.RowModified = false;
        }

        private void qryBgSpezkonto_AfterDelete(object sender, System.EventArgs e)
        {
            try
            {
                Session.Commit();
            }
            catch (Exception ex)
            {
                Session.Rollback();
                KissMsg.ShowInfo(ex.Message);
                return;
            }

            if (qryBgSpezkonto.Count == 0)
            {
                DisplayBewegungen();
                RefreshKostensart();
            }
        }

        private void qryBgSpezkonto_AfterInsert(object sender, System.EventArgs e)
        {
            qryBgSpezkonto["FaLeistungID"] = this.FaLeistungID;
            qryBgSpezkonto["BgSpezkontoTypCode"] = (int)BgSpezkontoTypCode;

            switch (BgSpezkontoTypCode)
            {
                case BgSpezkontoTyp.Ausgabekonto:
                    //		qryBgSpezkonto["BgKostenartID"] = 1;
                    break;

                case BgSpezkontoTyp.Vorabzugkonto:
                    qryBgSpezkonto["StartSaldo"] = 0;
                    qryBgSpezkonto["BetragProMonat"] = 100;
                    break;

                case BgSpezkontoTyp.Abzahlungskonto:
                    qryBgSpezkonto["OhneEinzelzahlung"] = true;
                    qryBgSpezkonto["StartSaldo"] = 100;
                    qryBgSpezkonto["BetragProMonat"] = 100;
                    break;
            }

            //Gültig von: nächsten Monat vorschlagen
            qryBgSpezkonto["DatumVonJahr"] = DateTime.Today.AddMonths(1).Year;
            qryBgSpezkonto["DatumVonMonat"] = DateTime.Today.AddMonths(1).Month;

            qryBgSpezkonto["Saldo"] = qryBgSpezkonto["StartSaldo"];

            edtNameSpezkonto.Focus();
        }

        private void qryBgSpezkonto_AfterPost(object sender, System.EventArgs e)
        {
            switch (BgSpezkontoTypCode)
            {
                case BgSpezkontoTyp.Vorabzugkonto:
                case BgSpezkontoTyp.Abzahlungskonto:
                    DBUtil.ExecSQL("EXECUTE spWhSpezkonto_UpdateBudget {0}", qryBgSpezkonto["BgSpezkontoID"]);
                    qryBgSpezkonto_PositionChanged(this, EventArgs.Empty);
                    break;
            }

            // Gültig von/bis im Grid updaten
            this.qryBgSpezkonto.Row.AcceptChanges();
            this.qryBgSpezkonto.RowModified = false;
            qryBgSpezkonto.Refresh();
        }

        private void qryBgSpezkonto_BeforeDelete(object sender, System.EventArgs e)
        {
            try
            {
                Session.BeginTransaction();
                // Dieses SQL-Statement sollte mit dem zweiten Teil des SQL-Statements in qryBgSpezkonto_BeforeDeleteQuestion übereinstimmen
                DBUtil.ExecSQL(@"
                    DELETE BPO
                    FROM BgPosition        BPO
                      INNER JOIN BgBudget  BBG ON BBG.BgBudgetID = BPO.BgBudgetID
                    WHERE BPO.BgSpezkontoID = {0} AND BPO.BgKategorieCode IN (3, 6)
                      AND (BBG.MasterBudget = 1 OR BBG.BgBewilligungStatusCode < 5)"
                    , qryBgSpezkonto["BgSpezkontoID"]);
            }
            catch (Exception ex)
            {
                Session.Rollback();
                KissMsg.ShowInfo(ex.Message);
            }
            if (Session.Transaction == null)
                throw new KissCancelException();
        }

        private void qryBgSpezkonto_BeforeDeleteQuestion(object sender, System.EventArgs e)
        {
            if (qryBgPosition.Count == 0) return;
            if (qryBgPosition.Count == 1)
            {
                Text = qryBgPosition.DataTable.Rows[0]["BuchungsText"].ToString();
                if (Text.ToUpper() == "STARTSALDO") return;
            }
            // Alle Positionen minus diejenigen, die gelöscht werden: Keine weiteren sollten existieren
            object affectedRows = DBUtil.ExecuteScalarSQL(@"
                SELECT COUNT(POS.BgPositionID)
                FROM
                    (SELECT DISTINCT BPO.BgPositionID
                    FROM BgPosition        BPO
                    WHERE BPO.BgSpezkontoID = {0}
                    EXCEPT
                    SELECT DISTINCT BPO.BgPositionID
                    FROM BgPosition        BPO
                      INNER JOIN BgBudget  BBG ON BBG.BgBudgetID = BPO.BgBudgetID
                    WHERE BPO.BgSpezkontoID = {0} AND BPO.BgKategorieCode IN (3, 6)
                      AND (BBG.MasterBudget = 1 OR BBG.BgBewilligungStatusCode < 5)) POS"
                    , qryBgSpezkonto["BgSpezkontoID"]);
            if (DBUtil.IsEmpty(affectedRows) || (int)affectedRows == 0)
                return;

            throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "BereitsGebucht", "Auf dieses Konto wurde bereits gebucht und kann deshalb nicht mehr gelöscht werden", KissMsgCode.MsgInfo));
        }

        private void qryBgSpezkonto_BeforePost(object sender, System.EventArgs e)
        {
            if (BgSpezkontoTypCode == BgSpezkontoTyp.Abzahlungskonto)
            {
                this.CalcDatumBis();
            }
            else if (BgSpezkontoTypCode == BgSpezkontoTyp.Ausgabekonto)
            {
                // verhindern von inkonsistenten Einträgen (z.T. ist BgPositionsartID gesetzt, dies ist jedoch eine unnötige Datenredundanz)
                qryBgSpezkonto["BgPositionsartID"] = null;
            }
            qryBgSpezkonto["DatumVon"] = new DateTime((int)qryBgSpezkonto["DatumVonJahr"], (int)qryBgSpezkonto["DatumVonMonat"], 1);

            if (!DBUtil.IsEmpty(qryBgSpezkonto["DatumBisJahr"]) && !DBUtil.IsEmpty(qryBgSpezkonto["DatumBisMonat"]))
            {
                DateTime d = new DateTime((int)qryBgSpezkonto["DatumBisJahr"],
                    (int)qryBgSpezkonto["DatumBisMonat"],
                    1);
                qryBgSpezkonto["DatumBis"] = d.AddMonths(1).AddDays(-1);
            }
            else
                qryBgSpezkonto["DatumBis"] = DBNull.Value;

            if (!DBUtil.IsEmpty(qryBgSpezkonto["DatumBis"]) &&
                ((DateTime)qryBgSpezkonto["DatumVon"]) > ((DateTime)qryBgSpezkonto["DatumBis"]))
            {
                throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "DatBisVorDatVon", "'gültig bis' darf nicht vor 'gültig von' sein.", KissMsgCode.MsgInfo), editDatumVonMonat);
            }

            if (qryBgSpezkonto.Row.RowState != System.Data.DataRowState.Added && qryBgSpezkonto.ColumnModified("Startsaldo"))
            {
                decimal Saldo = (decimal)qryBgSpezkonto["Saldo", System.Data.DataRowVersion.Original]
                                - (decimal)qryBgSpezkonto["Startsaldo", System.Data.DataRowVersion.Original]
                                + (decimal)qryBgSpezkonto["Startsaldo"];

                if (Saldo < 0)
                {
                    Saldo = (decimal)qryBgSpezkonto["Startsaldo"] - Saldo;
                    throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "MinStartsaldo", "Der Startsaldo muss mindestens Fr. {0:n2} betragen", KissMsgCode.MsgInfo, Saldo), this.edtStartSaldo);
                }

                qryBgSpezkonto["Saldo"] = Saldo;
            }

            object o;

            switch (BgSpezkontoTypCode)
            {
                case BgSpezkontoTyp.Vorabzugkonto:
                    DBUtil.CheckNotNullField(edtBetragProMonat, lblBetragProMonat.Text);
                    if (qryBgSpezkonto.ColumnModified("Startsaldo"))
                    {
                        o = DBUtil.GetUserPermission(Permission.Sh_StartsaldoVorabzugskonto, FaLeistungID, null);
                        if (null == o)
                            throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "KompetenzNichtEingerichtet", "Die Kompetenz 'Sozialhilfe: Monatsbudget - max. Startsaldo eines Vorabzugskontos' muss zuerst für Sie eingerichtet werden.", KissMsgCode.MsgInfo));

                        decimal maxStartSaldo = Convert.ToDecimal(o);
                        if (this.edtStartSaldo.Value > maxStartSaldo)
                            throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "KeineKompetenzStartsaldo", "Sie haben nicht die Kompetenz, einen Startsaldo von {0:n2} einzugeben.\r\nIhre Kompetenz liegt bei {1:n2}", KissMsgCode.MsgInfo, this.edtStartSaldo.Value, maxStartSaldo));
                    }
                    break;

                case BgSpezkontoTyp.Abzahlungskonto:
                    if (this.qryBgSpezkonto.ColumnModified("OhneEinzelzahlung") &&
                        DBUtil.OpenSQL("SELECT * FROM BgPosition WHERE BgSpezkontoID = {0} AND BgKategorieCode = 101"
                        , this.qryBgSpezkonto["BgSpezkontoID"]).Count > 0)
                    {
                        throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "EinzelzahlungExistiertBereits", "Rückerstattung ohne Einzelzahlung darf nicht mehr verändert werden.\r\nEs existiert bereits eine Einzelzahlung auf diesem Konto", KissMsgCode.MsgInfo));
                    }

                    DBUtil.CheckNotNullField(edtBetragProMonat, lblBetragProMonat.Text);
                    if (qryBgSpezkonto.Row.RowState == System.Data.DataRowState.Added)
                    {
                        o = DBUtil.ExecuteScalarSQL(@"
                            SELECT	MAX(DATEADD(m, 1, dbo.fnDateSerial(BBG.Jahr, BBG.Monat, 1)))
                            FROM	BgFinanzplan SFP
                                    INNER JOIN BgBudget  BBG ON BBG.BgFinanzplanID = SFP.BgFinanzplanID
                            WHERE	SFP.FaLeistungID = {0} AND
                                    SFP.BgBewilligungStatusCode = 5 AND
                                    BBG.MasterBudget = 0 AND BBG.BgBewilligungStatusCode >= 5 AND
                                    dbo.fnDateSerial(BBG.Jahr, BBG.Monat, 1) >= dbo.fnFirstDayOf({1})",
                            this.FaLeistungID,
                            qryBgSpezkonto["DatumVon"]);

                        if (!DBUtil.IsEmpty(o))
                            throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "MonatsbudgetGesperrt", "'gültig von' ist nicht zulässig, da freigegebene oder gesperrte Monatsbudgets in diesem oder späteren Monat vorhanden sind.", KissMsgCode.MsgInfo), this.editDatumVonMonat);

                        o = DBUtil.ExecuteScalarSQL(@"
                            SELECT	Count(*)
                            FROM	BgFinanzplan SFP
                                    INNER JOIN BgBudget    BBG ON BBG.BgFinanzplanID = SFP.BgFinanzplanID
                                    INNER JOIN BgPosition  BPO ON BPO.BgBudgetID = BBG.BgBudgetID AND BPO.BgSpezkontoID = {2}
                            WHERE	SFP.FaLeistungID = {0} AND
                                    SFP.BgBewilligungStatusCode = 5 AND
                                    BBG.MasterBudget = 0 AND BBG.BgBewilligungStatusCode >= 5 AND
                                    dbo.fnDateSerial(BBG.Jahr, BBG.Monat, 1) < dbo.fnFirstDayOf({1})",
                            this.FaLeistungID,
                            qryBgSpezkonto["DatumVon"],
                            qryBgSpezkonto["BgSpezkontoID"]);

                        if ((int)o > 0)
                            throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "AbzahlungGemacht", "'gültig von' ist nicht zulässig. Es sind {0} Abzahlungen vor diesem Monat gemacht worden", KissMsgCode.MsgInfo, o), this.editDatumVonMonat);
                    }

                    if (Convert.ToDecimal(colBetragBelastung.SummaryItem.SummaryValue) > Convert.ToDecimal(qryBgSpezkonto["StartSaldo"]))
                        throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "SummeEinzUebersteigtAbzahlungsziel", "Die Summe aller Einzelzahlungen ({0:n2}) übersteigt das Abzahlungsziel ({1:n2}))", KissMsgCode.MsgInfo, colBetragBelastung.SummaryItem.SummaryValue, qryBgSpezkonto["StartSaldo"]), this.edtStartSaldo);

                    if (Convert.ToDecimal(colBetragGutschriftEffektiv.SummaryItem.SummaryValue) > Convert.ToDecimal(qryBgSpezkonto["StartSaldo"]))
                        throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "SummeAbzUebersteigtAbzahlungsziel", "Die Summe aller Abzahlungen ({0:n2}) übersteigt das Abzahlungsziel ({1:n2}))", KissMsgCode.MsgInfo, colBetragGutschriftEffektiv.SummaryItem.SummaryValue, qryBgSpezkonto["StartSaldo"]), this.edtStartSaldo);

                    if (DBUtil.IsEmpty(qryBgSpezkonto["BetragProMonat"]) || Convert.ToDecimal(qryBgSpezkonto["BetragProMonat"]) <= (decimal)0)
                        throw new KissInfoException(KissMsg.GetMLMessage("CtlWhSpezialkonto", "BetragMonatGroesserNull", "Der monatliche Betrag muss > 0.00 sein.", KissMsgCode.MsgInfo), this.edtBetragProMonat);

                    if (!DBUtil.IsEmpty(edtBgPositionsartID.EditValue) &&
                        edtBgPositionsartID.GetColumnValue("Quoting") as bool? == false &&
                        DBUtil.IsEmpty(edtBaPersonID.EditValue) ||
                        DBUtil.IsEmpty(edtBgPositionsartID.EditValue) &&
                        edtBgKostenartID.GetColumnValue("Quoting") as bool? == false &&
                        DBUtil.IsEmpty(edtBaPersonID.EditValue))
                        throw new KissInfoException("Für diese Positionsart muss eine Person ausgewählt werden.");
                    break;
            }

            DBUtil.CheckNotNullField(editDatumVonMonat, lblDatumVon.Text);
            DBUtil.CheckNotNullField(editDatumVonJahr, lblDatumVon.Text);

            if (BgSpezkontoTypCode == BgSpezkontoTyp.Ausgabekonto || BgSpezkontoTypCode == BgSpezkontoTyp.Abzahlungskonto)
            {   //if((int)qryBgSpezkonto["BgSpezkontoTypCode"] == 101) // Einzelzahlung
                DBUtil.CheckNotNullField(edtBgKostenartID, this.lblBgKostenartID.Text);
            }

            DBUtil.CheckNotNullField(edtNameSpezkonto, lblNameSpezkonto.Text);
            DBUtil.CheckNotNullField(edtStartSaldo, lblStartSaldo.Text);
        }

        private void qryBgSpezkonto_ColumnChanged(object sender, System.Data.DataColumnChangeEventArgs e)
        {
            if (qryBgSpezkonto.IsFilling) return;
            if (qryBgSpezkonto.IsInserting) return;

            if (e.Column.ColumnName == "StartSaldo" ||
                e.Column.ColumnName == "BetragProMonat" ||
                e.Column.ColumnName == "DatumVonJahr" ||
                e.Column.ColumnName == "DatumVonMonat" ||
                e.Column.ColumnName == "Inaktiv")
            {
                CalcDatumBis();
            }
        }

        private void qryBgSpezkonto_DeleteError(object sender, UnhandledExceptionEventArgs e)
        {
            if (Session.Transaction != null)
                Session.Rollback();
        }

        private void qryBgSpezkonto_PositionChanged(object sender, System.EventArgs e)
        {
            //lblDebug.Text = "PositionChanged";
            DisplayBewegungen();
            RefreshKostensart();
            SetEditMode();

            if (qryBgSpezkonto.Row == null) return;

            if (!DBUtil.IsEmpty(qryBgSpezkonto["DatumVon"]))
            {
                qryBgSpezkonto["DatumVonMonat"] = ((DateTime)qryBgSpezkonto["DatumVon"]).Month;
                qryBgSpezkonto["DatumVonJahr"] = ((DateTime)qryBgSpezkonto["DatumVon"]).Year;
            }

            if (!DBUtil.IsEmpty(qryBgSpezkonto["DatumBis"]))
            {
                qryBgSpezkonto["DatumBisMonat"] = ((DateTime)qryBgSpezkonto["DatumBis"]).Month;
                qryBgSpezkonto["DatumBisJahr"] = ((DateTime)qryBgSpezkonto["DatumBis"]).Year;
            }

            if (qryBgSpezkonto.Row.RowState != System.Data.DataRowState.Added)
            {
                qryBgSpezkonto.RowModified = false;
                qryBgSpezkonto.Row.AcceptChanges();
            }
        }

        private void RefreshDisplay()
        {
            qryBgSpezkonto.ApplyUserRights(string.Format("CtlWhSpezialkonto_{0}", this.BgSpezkontoTypCode));
            qryBgSpezkonto.Fill(FaLeistungID, (int)BgSpezkontoTypCode, edtNurOffeneAnzeigen.Checked ? 1 : 0);
            if (qryBgSpezkonto.Count == 0)
            {
                DisplayBewegungen();
                RefreshKostensart();
            }
        }

        private void RefreshKostensart()
        {
            // Kostenarten
            qryBgKostenart.Fill(qryBgSpezkonto["FaLeistungID"], (int)BgSpezkontoTypCode, !DBUtil.IsEmpty(qryBgSpezkonto["BgKostenartID"]) ? (object)(int)qryBgSpezkonto["BgKostenartID"] : DBNull.Value);
            edtBgKostenartID.LoadQuery(qryBgKostenart, "BgKostenartID", "NrName");
        }

        private void SetEditMode()
        {
            bool verbuchteBuchungenVorhanden = qryBgPosition.DataTable.Select("Verbucht = 1").Length > 0;
            bool verrechnungBeglichen = verbuchteBuchungenVorhanden && !DBUtil.IsEmpty(qryBgSpezkonto["Saldo"]) && (decimal)qryBgSpezkonto["Saldo"] == 0m;
            bool quoting = DBUtil.IsEmpty(qryBgSpezkonto["Quoting"]) || (bool)qryBgSpezkonto["Quoting"];

            edtBgKostenartID.EditMode = verbuchteBuchungenVorhanden ? EditModeType.ReadOnly : EditModeType.Normal;
            edtBgPositionsartID.EditMode = verbuchteBuchungenVorhanden ? EditModeType.ReadOnly : EditModeType.Normal; // && !DBUtil.IsEmpty(qryBgSpezkonto["BgPositionsartID"])
            edtBaPersonID.EditMode = verbuchteBuchungenVorhanden || quoting ? EditModeType.ReadOnly : EditModeType.Normal;

            editDatumVonMonat.EditMode = verbuchteBuchungenVorhanden ? EditModeType.ReadOnly : EditModeType.Normal;
            editDatumVonJahr.EditMode = verbuchteBuchungenVorhanden ? EditModeType.ReadOnly : EditModeType.Normal;

            editDatumBisMonat.EditMode = (this.bgSpezkontoTypCode == BgSpezkontoTyp.Abzahlungskonto) || verrechnungBeglichen ? EditModeType.ReadOnly : EditModeType.Normal;
            editDatumBisJahr.EditMode = (this.bgSpezkontoTypCode == BgSpezkontoTyp.Abzahlungskonto) || verrechnungBeglichen ? EditModeType.ReadOnly : EditModeType.Normal;

            edtInaktiv.EditMode = verrechnungBeglichen ? EditModeType.ReadOnly : EditModeType.Normal;
            edtStartSaldo.EditMode = verrechnungBeglichen ? EditModeType.ReadOnly : EditModeType.Normal;
            edtBetragProMonat.EditMode = verrechnungBeglichen ? EditModeType.ReadOnly : EditModeType.Normal;
            edtNameSpezkonto.EditMode = verrechnungBeglichen ? EditModeType.ReadOnly : EditModeType.Normal;
        }

        #endregion
    }
}