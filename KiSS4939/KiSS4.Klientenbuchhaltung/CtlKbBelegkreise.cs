#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.312
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using Kiss.Interfaces.UI;
using KiSS.DBScheme;
using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Klientenbuchhaltung
{
    public class CtlKbBelegkreise : KiSS4.Gui.KissUserControl
    {
        #region Fields

        private DevExpress.XtraGrid.Columns.GridColumn colBelegKreisCode;
        private DevExpress.XtraGrid.Columns.GridColumn colBereichBis;
        private DevExpress.XtraGrid.Columns.GridColumn colBereichVon;
        private DevExpress.XtraGrid.Columns.GridColumn colKonto;
        private DevExpress.XtraGrid.Columns.GridColumn colNaechsteBelegNr;
        private System.ComponentModel.IContainer components = null;
        private KiSS4.Gui.KissCalcEdit edtBelegNrBis;
        private KiSS4.Gui.KissLookUpEdit edtBelegNrCode;
        private KiSS4.Gui.KissCalcEdit edtBelegNrVon;
        private KiSS4.Gui.KissButtonEdit edtKbKontoNr;
        private KiSS4.Gui.KissCalcEdit edtNaechsteBelegNr;
        private KiSS4.Gui.KissGrid grdBelegKreis;
        private DevExpress.XtraGrid.Views.Grid.GridView grvBelegKreis;
        private object kbPeriodeID;
        private KiSS4.Gui.KissLabel lblAktivkonto;
        private KiSS4.Gui.KissLabel lblBelegNrBereich;
        private KiSS4.Gui.KissLabel lblKbBelegKreisCode;
        private KiSS4.Gui.KissLabel lblNaechsteBelegNr;
        private KiSS4.Gui.KissLabel lblStrich;
        private DevExpress.XtraGrid.Columns.GridColumn colAnzahlBelege;
        private DevExpress.XtraGrid.Columns.GridColumn volVerwendetVon;
        private DevExpress.XtraGrid.Columns.GridColumn colVergebenBis;
        private KiSS4.DB.SqlQuery qryBelegKreis;

        #endregion

        #region Constructors

        public CtlKbBelegkreise()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlKbBelegkreise));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            this.components = new System.ComponentModel.Container();
            this.grdBelegKreis = new KiSS4.Gui.KissGrid();
            this.qryBelegKreis = new KiSS4.DB.SqlQuery();
            this.grvBelegKreis = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colBelegKreisCode = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colKonto = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colNaechsteBelegNr = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBereichVon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBereichBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colAnzahlBelege = new DevExpress.XtraGrid.Columns.GridColumn();
            this.volVerwendetVon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVergebenBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.edtBelegNrCode = new KiSS4.Gui.KissLookUpEdit();
            this.edtNaechsteBelegNr = new KiSS4.Gui.KissCalcEdit();
            this.edtBelegNrVon = new KiSS4.Gui.KissCalcEdit();
            this.edtBelegNrBis = new KiSS4.Gui.KissCalcEdit();
            this.lblStrich = new KiSS4.Gui.KissLabel();
            this.lblNaechsteBelegNr = new KiSS4.Gui.KissLabel();
            this.lblBelegNrBereich = new KiSS4.Gui.KissLabel();
            this.lblKbBelegKreisCode = new KiSS4.Gui.KissLabel();
            this.lblAktivkonto = new KiSS4.Gui.KissLabel();
            this.edtKbKontoNr = new KiSS4.Gui.KissButtonEdit();
            ((System.ComponentModel.ISupportInitialize)(this.grdBelegKreis)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBelegKreis)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvBelegKreis)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBelegNrCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBelegNrCode.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtNaechsteBelegNr.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBelegNrVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBelegNrBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblStrich)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblNaechsteBelegNr)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBelegNrBereich)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKbBelegKreisCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAktivkonto)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKbKontoNr.Properties)).BeginInit();
            this.SuspendLayout();
            // 
            // grdBelegKreis
            // 
            this.grdBelegKreis.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdBelegKreis.DataSource = this.qryBelegKreis;
            // 
            // 
            // 
            this.grdBelegKreis.EmbeddedNavigator.Name = "";
            this.grdBelegKreis.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdBelegKreis.Location = new System.Drawing.Point(8, 6);
            this.grdBelegKreis.MainView = this.grvBelegKreis;
            this.grdBelegKreis.Name = "grdBelegKreis";
            this.grdBelegKreis.Size = new System.Drawing.Size(809, 324);
            this.grdBelegKreis.TabIndex = 0;
            this.grdBelegKreis.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvBelegKreis});
            // 
            // qryBelegKreis
            // 
            this.qryBelegKreis.CanDelete = true;
            this.qryBelegKreis.CanInsert = true;
            this.qryBelegKreis.CanUpdate = true;
            this.qryBelegKreis.HostControl = this;
            this.qryBelegKreis.SelectStatement = resources.GetString("qryBelegKreis.SelectStatement");
            this.qryBelegKreis.TableName = "KbBelegKreis";
            this.qryBelegKreis.AfterInsert += new System.EventHandler(this.qryBelegKreis_AfterInsert);
            this.qryBelegKreis.BeforePost += new System.EventHandler(this.qryBelegKreis_BeforePost);
            this.qryBelegKreis.AfterPost += new System.EventHandler(this.qryBelegKreis_AfterPost);
            this.qryBelegKreis.BeforeDeleteQuestion += new System.EventHandler(this.qryBelegKreis_BeforeDeleteQuestion);
            this.qryBelegKreis.PositionChanged += new System.EventHandler(this.qryBelegKreis_PositionChanged);
            this.qryBelegKreis.ColumnChanged += new System.Data.DataColumnChangeEventHandler(this.qryBelegKreis_ColumnChanged);
            // 
            // grvBelegKreis
            // 
            this.grvBelegKreis.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvBelegKreis.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBelegKreis.Appearance.Empty.Options.UseBackColor = true;
            this.grvBelegKreis.Appearance.Empty.Options.UseFont = true;
            this.grvBelegKreis.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBelegKreis.Appearance.EvenRow.Options.UseFont = true;
            this.grvBelegKreis.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvBelegKreis.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBelegKreis.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvBelegKreis.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvBelegKreis.Appearance.FocusedCell.Options.UseFont = true;
            this.grvBelegKreis.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvBelegKreis.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvBelegKreis.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBelegKreis.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvBelegKreis.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvBelegKreis.Appearance.FocusedRow.Options.UseFont = true;
            this.grvBelegKreis.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvBelegKreis.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvBelegKreis.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvBelegKreis.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvBelegKreis.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvBelegKreis.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvBelegKreis.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvBelegKreis.Appearance.GroupRow.Options.UseFont = true;
            this.grvBelegKreis.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvBelegKreis.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvBelegKreis.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvBelegKreis.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvBelegKreis.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvBelegKreis.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvBelegKreis.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvBelegKreis.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvBelegKreis.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBelegKreis.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvBelegKreis.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvBelegKreis.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvBelegKreis.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvBelegKreis.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvBelegKreis.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvBelegKreis.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBelegKreis.Appearance.OddRow.Options.UseFont = true;
            this.grvBelegKreis.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvBelegKreis.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBelegKreis.Appearance.Row.Options.UseBackColor = true;
            this.grvBelegKreis.Appearance.Row.Options.UseFont = true;
            this.grvBelegKreis.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvBelegKreis.Appearance.SelectedRow.Options.UseFont = true;
            this.grvBelegKreis.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvBelegKreis.Appearance.VertLine.Options.UseBackColor = true;
            this.grvBelegKreis.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvBelegKreis.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colBelegKreisCode,
            this.colKonto,
            this.colNaechsteBelegNr,
            this.colBereichVon,
            this.colBereichBis,
            this.colAnzahlBelege,
            this.volVerwendetVon,
            this.colVergebenBis});
            this.grvBelegKreis.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvBelegKreis.GridControl = this.grdBelegKreis;
            this.grvBelegKreis.Name = "grvBelegKreis";
            this.grvBelegKreis.OptionsBehavior.Editable = false;
            this.grvBelegKreis.OptionsCustomization.AllowFilter = false;
            this.grvBelegKreis.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvBelegKreis.OptionsNavigation.AutoFocusNewRow = true;
            this.grvBelegKreis.OptionsNavigation.UseTabKey = false;
            this.grvBelegKreis.OptionsView.ColumnAutoWidth = false;
            this.grvBelegKreis.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvBelegKreis.OptionsView.ShowGroupPanel = false;
            this.grvBelegKreis.OptionsView.ShowIndicator = false;
            // 
            // colBelegKreisCode
            // 
            this.colBelegKreisCode.Caption = "Beleg Kreis-Typ";
            this.colBelegKreisCode.FieldName = "KbBelegKreisCode";
            this.colBelegKreisCode.Name = "colBelegKreisCode";
            this.colBelegKreisCode.Visible = true;
            this.colBelegKreisCode.VisibleIndex = 0;
            this.colBelegKreisCode.Width = 147;
            // 
            // colKonto
            // 
            this.colKonto.Caption = "Konto";
            this.colKonto.FieldName = "KontoName";
            this.colKonto.Name = "colKonto";
            this.colKonto.Visible = true;
            this.colKonto.VisibleIndex = 1;
            this.colKonto.Width = 314;
            // 
            // colNaechsteBelegNr
            // 
            this.colNaechsteBelegNr.Caption = "Nächste Nr";
            this.colNaechsteBelegNr.FieldName = "NaechsteBelegNr";
            this.colNaechsteBelegNr.Name = "colNaechsteBelegNr";
            this.colNaechsteBelegNr.Visible = true;
            this.colNaechsteBelegNr.VisibleIndex = 2;
            this.colNaechsteBelegNr.Width = 110;
            // 
            // colBereichVon
            // 
            this.colBereichVon.Caption = "Bereich von";
            this.colBereichVon.FieldName = "BelegNrVon";
            this.colBereichVon.Name = "colBereichVon";
            this.colBereichVon.Visible = true;
            this.colBereichVon.VisibleIndex = 3;
            this.colBereichVon.Width = 110;
            // 
            // colBereichBis
            // 
            this.colBereichBis.Caption = "Bereich bis";
            this.colBereichBis.FieldName = "BelegNrBis";
            this.colBereichBis.Name = "colBereichBis";
            this.colBereichBis.Visible = true;
            this.colBereichBis.VisibleIndex = 4;
            this.colBereichBis.Width = 110;
            // 
            // colAnzahlBelege
            // 
            this.colAnzahlBelege.Caption = "Anzahl Belege";
            this.colAnzahlBelege.FieldName = "AnzahlBelege";
            this.colAnzahlBelege.Name = "colAnzahlBelege";
            this.colAnzahlBelege.Visible = true;
            this.colAnzahlBelege.VisibleIndex = 5;
            this.colAnzahlBelege.Width = 90;
            // 
            // volVerwendetVon
            // 
            this.volVerwendetVon.Caption = "vergeben von";
            this.volVerwendetVon.FieldName = "VergebenVon";
            this.volVerwendetVon.Name = "volVerwendetVon";
            this.volVerwendetVon.Visible = true;
            this.volVerwendetVon.VisibleIndex = 6;
            this.volVerwendetVon.Width = 90;
            // 
            // colVergebenBis
            // 
            this.colVergebenBis.Caption = "vergeben bis";
            this.colVergebenBis.FieldName = "VergebenBis";
            this.colVergebenBis.Name = "colVergebenBis";
            this.colVergebenBis.Visible = true;
            this.colVergebenBis.VisibleIndex = 7;
            this.colVergebenBis.Width = 90;
            // 
            // edtBelegNrCode
            // 
            this.edtBelegNrCode.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBelegNrCode.DataMember = "KbBelegKreisCode";
            this.edtBelegNrCode.DataSource = this.qryBelegKreis;
            this.edtBelegNrCode.Location = new System.Drawing.Point(135, 350);
            this.edtBelegNrCode.LOVName = "KbBelegkreis";
            this.edtBelegNrCode.Name = "edtBelegNrCode";
            this.edtBelegNrCode.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBelegNrCode.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBelegNrCode.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBelegNrCode.Properties.Appearance.Options.UseBackColor = true;
            this.edtBelegNrCode.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBelegNrCode.Properties.Appearance.Options.UseFont = true;
            this.edtBelegNrCode.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtBelegNrCode.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtBelegNrCode.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtBelegNrCode.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtBelegNrCode.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtBelegNrCode.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtBelegNrCode.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBelegNrCode.Properties.NullText = "";
            this.edtBelegNrCode.Properties.ShowFooter = false;
            this.edtBelegNrCode.Properties.ShowHeader = false;
            this.edtBelegNrCode.Size = new System.Drawing.Size(250, 24);
            this.edtBelegNrCode.TabIndex = 1;
            this.edtBelegNrCode.CloseUp += new DevExpress.XtraEditors.Controls.CloseUpEventHandler(this.edtBelegNrCode_CloseUp);
            // 
            // edtNaechsteBelegNr
            // 
            this.edtNaechsteBelegNr.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtNaechsteBelegNr.DataMember = "NaechsteBelegNr";
            this.edtNaechsteBelegNr.DataSource = this.qryBelegKreis;
            this.edtNaechsteBelegNr.Location = new System.Drawing.Point(135, 440);
            this.edtNaechsteBelegNr.Name = "edtNaechsteBelegNr";
            this.edtNaechsteBelegNr.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtNaechsteBelegNr.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtNaechsteBelegNr.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtNaechsteBelegNr.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtNaechsteBelegNr.Properties.Appearance.Options.UseBackColor = true;
            this.edtNaechsteBelegNr.Properties.Appearance.Options.UseBorderColor = true;
            this.edtNaechsteBelegNr.Properties.Appearance.Options.UseFont = true;
            this.edtNaechsteBelegNr.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtNaechsteBelegNr.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtNaechsteBelegNr.Size = new System.Drawing.Size(85, 24);
            this.edtNaechsteBelegNr.TabIndex = 4;
            // 
            // edtBelegNrVon
            // 
            this.edtBelegNrVon.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBelegNrVon.DataMember = "BelegNrVon";
            this.edtBelegNrVon.DataSource = this.qryBelegKreis;
            this.edtBelegNrVon.Location = new System.Drawing.Point(135, 470);
            this.edtBelegNrVon.Name = "edtBelegNrVon";
            this.edtBelegNrVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtBelegNrVon.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBelegNrVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBelegNrVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBelegNrVon.Properties.Appearance.Options.UseBackColor = true;
            this.edtBelegNrVon.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBelegNrVon.Properties.Appearance.Options.UseFont = true;
            this.edtBelegNrVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBelegNrVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBelegNrVon.Size = new System.Drawing.Size(85, 24);
            this.edtBelegNrVon.TabIndex = 5;
            // 
            // edtBelegNrBis
            // 
            this.edtBelegNrBis.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBelegNrBis.DataMember = "BelegNrBis";
            this.edtBelegNrBis.DataSource = this.qryBelegKreis;
            this.edtBelegNrBis.Location = new System.Drawing.Point(245, 470);
            this.edtBelegNrBis.Name = "edtBelegNrBis";
            this.edtBelegNrBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtBelegNrBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBelegNrBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBelegNrBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBelegNrBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtBelegNrBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBelegNrBis.Properties.Appearance.Options.UseFont = true;
            this.edtBelegNrBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtBelegNrBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBelegNrBis.Size = new System.Drawing.Size(85, 24);
            this.edtBelegNrBis.TabIndex = 6;
            // 
            // lblStrich
            // 
            this.lblStrich.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblStrich.Location = new System.Drawing.Point(230, 470);
            this.lblStrich.Name = "lblStrich";
            this.lblStrich.Size = new System.Drawing.Size(8, 24);
            this.lblStrich.TabIndex = 6;
            this.lblStrich.Text = "-";
            this.lblStrich.UseCompatibleTextRendering = true;
            // 
            // lblNaechsteBelegNr
            // 
            this.lblNaechsteBelegNr.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblNaechsteBelegNr.Location = new System.Drawing.Point(15, 440);
            this.lblNaechsteBelegNr.Name = "lblNaechsteBelegNr";
            this.lblNaechsteBelegNr.Size = new System.Drawing.Size(100, 24);
            this.lblNaechsteBelegNr.TabIndex = 268;
            this.lblNaechsteBelegNr.Text = "nächste Beleg-Nr.";
            this.lblNaechsteBelegNr.UseCompatibleTextRendering = true;
            // 
            // lblBelegNrBereich
            // 
            this.lblBelegNrBereich.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblBelegNrBereich.Location = new System.Drawing.Point(15, 470);
            this.lblBelegNrBereich.Name = "lblBelegNrBereich";
            this.lblBelegNrBereich.Size = new System.Drawing.Size(100, 24);
            this.lblBelegNrBereich.TabIndex = 286;
            this.lblBelegNrBereich.Text = "Beleg-Nr.-Bereich";
            this.lblBelegNrBereich.UseCompatibleTextRendering = true;
            // 
            // lblKbBelegKreisCode
            // 
            this.lblKbBelegKreisCode.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblKbBelegKreisCode.Location = new System.Drawing.Point(15, 350);
            this.lblKbBelegKreisCode.Name = "lblKbBelegKreisCode";
            this.lblKbBelegKreisCode.Size = new System.Drawing.Size(85, 24);
            this.lblKbBelegKreisCode.TabIndex = 288;
            this.lblKbBelegKreisCode.Text = "Beleg-Nr.-Typ";
            this.lblKbBelegKreisCode.UseCompatibleTextRendering = true;
            // 
            // lblAktivkonto
            // 
            this.lblAktivkonto.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.lblAktivkonto.Location = new System.Drawing.Point(15, 400);
            this.lblAktivkonto.Name = "lblAktivkonto";
            this.lblAktivkonto.Size = new System.Drawing.Size(100, 23);
            this.lblAktivkonto.TabIndex = 289;
            this.lblAktivkonto.Text = "Aktivkonto";
            this.lblAktivkonto.UseCompatibleTextRendering = true;
            // 
            // edtKbKontoNr
            // 
            this.edtKbKontoNr.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Left)));
            this.edtKbKontoNr.DataMember = "KontoName";
            this.edtKbKontoNr.DataSource = this.qryBelegKreis;
            this.edtKbKontoNr.Location = new System.Drawing.Point(135, 400);
            this.edtKbKontoNr.Name = "edtKbKontoNr";
            this.edtKbKontoNr.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtKbKontoNr.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtKbKontoNr.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtKbKontoNr.Properties.Appearance.Options.UseBackColor = true;
            this.edtKbKontoNr.Properties.Appearance.Options.UseBorderColor = true;
            this.edtKbKontoNr.Properties.Appearance.Options.UseFont = true;
            this.edtKbKontoNr.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtKbKontoNr.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtKbKontoNr.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtKbKontoNr.Size = new System.Drawing.Size(250, 24);
            this.edtKbKontoNr.TabIndex = 290;
            this.edtKbKontoNr.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtKbKontoNr_UserModifiedFld);
            // 
            // CtlKbBelegkreise
            // 
            this.ActiveSQLQuery = this.qryBelegKreis;
            this.Controls.Add(this.edtKbKontoNr);
            this.Controls.Add(this.lblAktivkonto);
            this.Controls.Add(this.lblKbBelegKreisCode);
            this.Controls.Add(this.lblBelegNrBereich);
            this.Controls.Add(this.lblNaechsteBelegNr);
            this.Controls.Add(this.lblStrich);
            this.Controls.Add(this.edtBelegNrBis);
            this.Controls.Add(this.edtBelegNrVon);
            this.Controls.Add(this.edtNaechsteBelegNr);
            this.Controls.Add(this.edtBelegNrCode);
            this.Controls.Add(this.grdBelegKreis);
            this.Name = "CtlKbBelegkreise";
            this.Size = new System.Drawing.Size(825, 535);
            this.Load += new System.EventHandler(this.CtlKbBelegkreise_Load);
            ((System.ComponentModel.ISupportInitialize)(this.grdBelegKreis)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBelegKreis)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvBelegKreis)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBelegNrCode.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBelegNrCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtNaechsteBelegNr.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBelegNrVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBelegNrBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblStrich)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblNaechsteBelegNr)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBelegNrBereich)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKbBelegKreisCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblAktivkonto)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKbKontoNr.Properties)).EndInit();
            this.ResumeLayout(false);

        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Private Methods

        private void CtlKbBelegkreise_Load(object sender, System.EventArgs e)
        {
            kbPeriodeID = FormController.GetMessage("FrmKbKlientenbuchhaltung", false, "Action", "KbPeriodeID");
            qryBelegKreis.Fill(kbPeriodeID);

            colBelegKreisCode.ColumnEdit = grdBelegKreis.GetLOVLookUpEdit((SqlQuery)edtBelegNrCode.Properties.DataSource);
        }

        private void SetEditMode()
        {
            bool nochKeineBelege = DBUtil.IsEmpty(qryBelegKreis["AnzahlBelege"]) ||
                                    (int)qryBelegKreis["AnzahlBelege"] == 0;
            edtKbKontoNr.EditMode = DBUtil.IsEmpty(qryBelegKreis["KbBelegkreisCode"]) || (int)qryBelegKreis["KbBelegkreisCode"] != 1 ? EditModeType.ReadOnly : EditModeType.Normal;
            edtNaechsteBelegNr.EditMode = EditModeType.ReadOnly;
            edtBelegNrVon.EditMode = nochKeineBelege ? EditModeType.Normal : EditModeType.ReadOnly;
            edtBelegNrCode.EditMode = nochKeineBelege ? EditModeType.Normal : EditModeType.ReadOnly;
            edtKbKontoNr.EditMode = nochKeineBelege ? EditModeType.Normal : EditModeType.ReadOnly;
        }

        private void edtBelegNrCode_CloseUp(object sender, DevExpress.XtraEditors.Controls.CloseUpEventArgs e)
        {
            /*
                         Specifies that the dropdown window was closed because an end user:
            ButtonClick  clicked the editor's dropdown button.
            Cancel       pressed the ESC key or clicked the close button
                         (available for LookUpEdit, CalcEdit and PopupContainerEdit controls).
            CloseUpKey   pressed a shortcut used to close the dropdown (the ALT+DOWN ARROW or RepositoryItemPopupBase.CloseUpKey).
            Immediate    clicked outside the editor.
            Normal       selected an option from the editor's dropdown.
            */
            e.AcceptValue = true;
            if (!e.CloseMode.Equals(DevExpress.XtraEditors.PopupCloseMode.Normal)) return;

            this.edtKbKontoNr.EditValue = null;
            qryBelegKreis["KontoNr"] = DBNull.Value;
            qryBelegKreis["KbBelegkreisCode"] = e.Value;
            this.SetEditMode();
        }

        private void edtKbKontoNr_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            KissLookupDialog dlg = new KissLookupDialog();

            var searchString = edtKbKontoNr.Text;

            if (DBUtil.IsEmpty(searchString) && !e.ButtonClicked)
            {
                qryBelegKreis["KontoNr"] = DBNull.Value;
                qryBelegKreis["KontoName"] = DBNull.Value;
                return;
            }

            if (dlg.SearchData(@"
                SELECT DISTINCT
                    KTO.KbKontoID,
                    KTO.KontoNr,
                    KTO.KontoName
                FROM KbKonto KTO
                WHERE KTO.KontoNr like {0} + '%'
                  AND KTO.KbPeriodeID = {1}
                  AND KTO.KbKontoKlasseCode = 5 --AktivKonto",
                edtKbKontoNr.Text.Replace("*", "%").Replace("?", "_").Replace(" ", "%"),
                e.ButtonClicked,
                kbPeriodeID))
            {
                string text = string.Format("{0} {1}", dlg["KontoNr"], dlg["KontoName"]);
                edtKbKontoNr.Text = text;
                qryBelegKreis["KontoNr"] = dlg["KontoNr"];
                qryBelegKreis["KontoName"] = text;
            }
        }

        private void qryBelegKreis_AfterInsert(object sender, System.EventArgs e)
        {
            qryBelegKreis["KbPeriodeID"] = kbPeriodeID;
            qryBelegKreis["AnzahlBelege"] = 0;
        }

        private void qryBelegKreis_AfterPost(object sender, System.EventArgs e)
        {
            this.SetEditMode();
        }

        private void qryBelegKreis_BeforePost(object sender, System.EventArgs e)
        {
            DBUtil.CheckNotNullField(edtBelegNrVon, lblBelegNrBereich.Text);
            DBUtil.CheckNotNullField(edtBelegNrBis, lblBelegNrBereich.Text);
            DBUtil.CheckNotNullField(edtBelegNrCode, lblKbBelegKreisCode.Text);

            //Nicht aktivkonto
            if ((int)qryBelegKreis["KbBelegkreisCode"] != 1 && 0 < (int)DBUtil.ExecuteScalarSQL(@"
                SELECT COUNT(*)
                FROM KbBelegkreis
                WHERE KbPeriodeID = {0} AND isNull({1}, -1) <> KbBelegKreisID
                  AND KbBelegkreisCode = {2}",
                kbPeriodeID,
                qryBelegKreis["KbBelegKreisID"],
                edtBelegNrCode.EditValue))
            {
                throw new KissInfoException(KissMsg.GetMLMessage("CtlKbBelegkreise", "BelegKreisTypDoppelt", "Dieser Belegkreis ist bereits vergeben.", KissMsgCode.MsgInfo), this.edtBelegNrCode);
            }
            //aktivkonto
            if ((int)qryBelegKreis["KbBelegkreisCode"] == 1 && 0 < (int)DBUtil.ExecuteScalarSQL(@"
                SELECT COUNT(*)
                FROM KbBelegkreis
                WHERE KbPeriodeID = {0} AND isNull({1}, -1) <> KbBelegKreisID
                  AND KbBelegkreisCode = {2}
                  AND KontoNr = {3}",
                kbPeriodeID,
                qryBelegKreis["KbBelegKreisID"],
                edtBelegNrCode.EditValue,
                qryBelegKreis["KontoNr"]))
            {
                throw new KissInfoException(KissMsg.GetMLMessage("CtlKbBelegkreise", "BelegKreisAktivKontoDoppelt", "Für dieses Aktivkonto existiert bereits ein Belegkreis.", KissMsgCode.MsgInfo), this.edtBelegNrCode);
            }

            int naechsteNr = (int)qryBelegKreis[DBO.KbBelegKreis.NaechsteBelegNr];
            int belegNrVon = (int)qryBelegKreis[DBO.KbBelegKreis.BelegNrVon];
            int belegNrBis = (int)qryBelegKreis[DBO.KbBelegKreis.BelegNrBis];


            SqlQuery qry = DBUtil.OpenSQL(@"
               SELECT KbBelegKreisID, BelegNrVon, BelegNrBis
               FROM KbBelegKreis
               WHERE KbPeriodeID = {0}
                 AND KbBelegKreisID <> ISNULL({1}, -1)
                 AND ({2} BETWEEN BelegNrVon AND BelegNrBis
                   OR {3} BETWEEN BelegNrVon AND BelegNrBis
                   OR {2} < BelegNrVon AND {3} > BelegNrBis)",
                kbPeriodeID,
                qryBelegKreis["KbBelegKreisID"],
                belegNrVon,
                belegNrBis);

            if (qry.Count > 0)
            {
                throw new KissInfoException(
                    KissMsg.GetMLMessage(
                        "CtlKbBelegkreise",
                        "BelegKreisÜberschneidung",
                        "Der angegebene Belegkreis {0}-{1} überschneidet sich mit dem bestehenden Belegkreis {2}-{3}",
                        KissMsgCode.MsgInfo,
                        belegNrVon,
                        belegNrBis,
                        qry["BelegNrVon"],
                        qry["BelegNrBis"]),
                    this.edtBelegNrVon);
            }

            // von < bis?
            if (belegNrVon >= belegNrBis)
            {
                throw new KissInfoException(KissMsg.GetMLMessage("CtlKbBelegkreise", "BereichFalsch", "Das untere Ende des Bereichs muss kleiner sein als das obere Ende", KissMsgCode.MsgInfo), edtBelegNrVon);
            }

            // NächsteBelegNr innerhalb von/bis?
            if (naechsteNr < belegNrVon || naechsteNr > belegNrBis)
            {
                throw new KissInfoException(KissMsg.GetMLMessage("CtlKbBelegkreise", "NaechsteNummerNichtInBereich", "Die nächste Belegnummer muss innerhalb des Bereichs liegen.", KissMsgCode.MsgInfo), this.edtNaechsteBelegNr);
            }

            // deckt von/bis alle bestehenden Belegnummern ab?
            qry = DBUtil.OpenSQL(@"
               SELECT Min = MIN(BelegNr), Max = MAX(BelegNr), Count = Count(*)
               FROM KbBuchung
               WHERE KbBelegKreisID = {0}",
               qryBelegKreis["KbBelegKreisID"]);
            int count = (int)qry["Count"];
            if (count > 0 && ((int)qry["Min"] < belegNrVon || (int)qry["Max"] > belegNrBis))
            {
                throw new KissInfoException(KissMsg.GetMLMessage("CtlKbBelegkreise",
                                                                 "BestehenderBereichNichtAbgedeckt",
                                                                 "Der angegebene Bereich {0}-{1} deckt nicht die existierenden Belege {2}-{3} ab",
                                                                 KissMsgCode.MsgInfo,
                                                                 belegNrVon,
                                                                 belegNrBis,
                                                                 qry["Min"],
                                                                 qry["Max"]), this.edtBelegNrVon);
            }

            if (count > 0 && (qryBelegKreis.ColumnModified(qryBelegKreis.Row, DBO.KbBelegKreis.BelegNrVon) ||
                              qryBelegKreis.ColumnModified(qryBelegKreis.Row, DBO.KbBelegKreis.KbBelegKreisCode) ||
                              qryBelegKreis.ColumnModified(qryBelegKreis.Row, DBO.KbBelegKreis.KontoNr)))
            {
                throw new KissInfoException(KissMsg.GetMLMessage("CtlKbBelegkreise",
                                                                 "DatenVeraendertTrotzBelege",
                                                                 "In diesem Nummernkreis existieren bereits {0} Belege, deshalb darf der Beleg-Nr.-Typ, das Aktivkonto und die erste Belegnummer nicht angepasst werden",
                                                                 KissMsgCode.MsgInfo,
                                                                 belegNrVon), this.edtBelegNrVon);
            }
        }

        private void qryBelegKreis_PositionChanged(object sender, System.EventArgs e)
        {
            this.SetEditMode();
        }

        private void qryBelegKreis_BeforeDeleteQuestion(object sender, EventArgs e)
        {
            if (!DBUtil.IsEmpty(qryBelegKreis["KbBelegKreisID"]))
            {
                // deckt von/bis alle bestehenden Belegnummern ab?
                int anzahlBuchungenInBelegKreis = (int)DBUtil.ExecuteScalarSQL(@"
                   SELECT Count(*)
                   FROM KbBuchung
                   WHERE KbBelegKreisID = {0}",
                   qryBelegKreis["KbBelegKreisID"]);
                if (anzahlBuchungenInBelegKreis > 0)
                {
                    throw new KissInfoException(KissMsg.GetMLMessage("CtlKbBelegkreise",
                                                                     "BelegInBelegKreisVorhanden",
                                                                     "In diesen Belegkreis wurden bereits {0} Belege gebucht, deshalb darf er dicht gelöscht werden.",
                                                                     KissMsgCode.MsgInfo,
                                                                     anzahlBuchungenInBelegKreis));
                }
            }
        }

        private void qryBelegKreis_ColumnChanged(object sender, System.Data.DataColumnChangeEventArgs e)
        {
            if (qryBelegKreis.IsFilling) return;
            if (qryBelegKreis.IsInserting) return;

            if (e.Column.ColumnName == DBO.KbBelegKreis.BelegNrVon)
            {
                // BelegNrVon darf nur editiert werden, wenn keine Belege im Belegkreis existieren. Deshalb gilt NaechsteBelegNr = BelegNrVon
                // mit pessimistic locking wird sichergestellt, dass eine inzwischen gelöste BelegNr überschrieben wird
                qryBelegKreis[DBO.KbBelegKreis.NaechsteBelegNr] = e.ProposedValue;
                qryBelegKreis.RefreshDisplay();
            }
        }

        #endregion

    }
}