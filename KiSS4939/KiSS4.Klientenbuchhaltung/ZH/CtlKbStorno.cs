#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Collections.Generic;
using System.Data;
using System.Reflection;
using System.Windows.Forms;
using KiSS4.Common.ZH;
using KiSS4.DB;
using KiSS4.Gui;
using KiSS4.Messages;

namespace KiSS4.Klientenbuchhaltung.ZH
{
    public class CtlKbStorno : KiSS4.Common.KissQueryControl
    {
        #region Fields

        private KiSS4.Gui.KissButton btnAlle;
        private KiSS4.Gui.KissButton btnBruttoSprungMonatsBudget;
        private KiSS4.Gui.KissButton btnKeine;
        private KiSS4.Gui.KissButton btnNettoSprungMonatsBudget;
        private KiSS4.Gui.KissButton btnSaveStorno;
        private KiSS4.Gui.KissButton btnTransferStorno;
        private KiSS4.Gui.KissCheckEdit chkSuchInklInaktiveW;
        private KiSS4.Gui.KissCheckEdit chkSucheNurStornierte;
        private DevExpress.XtraGrid.Columns.GridColumn colBetrag;
        private DevExpress.XtraGrid.Columns.GridColumn colBetrifft;
        private DevExpress.XtraGrid.Columns.GridColumn colBetrifftPerson;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoBetrag;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoBudget;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoID;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoKonto;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoNameVorname;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoPSCDNr;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoSA;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoSZ;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoStatus;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoStorno;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoTeam;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoText;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoValuta;
        private DevExpress.XtraGrid.Columns.GridColumn colBuchungstext;
        private DevExpress.XtraGrid.Columns.GridColumn colDebitor;
        private DevExpress.XtraGrid.Columns.GridColumn colFaFallID;
        private DevExpress.XtraGrid.Columns.GridColumn colFaelligDatum;
        private DevExpress.XtraGrid.Columns.GridColumn colFehlermeldung;
        private DevExpress.XtraGrid.Columns.GridColumn colKbBuchungBruttoID;
        private DevExpress.XtraGrid.Columns.GridColumn colKbBuchungStatusCode;
        private DevExpress.XtraGrid.Columns.GridColumn colMasterBudget;
        private DevExpress.XtraGrid.Columns.GridColumn colNameVorname;
        private DevExpress.XtraGrid.Columns.GridColumn colNettoID;
        private DevExpress.XtraGrid.Columns.GridColumn colNettoPSCDNr;
        private DevExpress.XtraGrid.Columns.GridColumn colNettoStorno;
        private DevExpress.XtraGrid.Columns.GridColumn colPersonBetrag;
        private DevExpress.XtraGrid.Columns.GridColumn colPersonBuchungstext;
        private DevExpress.XtraGrid.Columns.GridColumn colPersonVerwPeriodeBis;
        private DevExpress.XtraGrid.Columns.GridColumn colPersonVerwPeriodeVon;
        private DevExpress.XtraGrid.Columns.GridColumn colSA;
        private DevExpress.XtraGrid.Columns.GridColumn colSZ;
        private DevExpress.XtraGrid.Columns.GridColumn colStorniertVon;
        private DevExpress.XtraGrid.Columns.GridColumn colTeam;
        private DevExpress.XtraGrid.Columns.GridColumn colVerwBis;
        private DevExpress.XtraGrid.Columns.GridColumn colVerwPeriodeBis;
        private DevExpress.XtraGrid.Columns.GridColumn colVerwPeriodeVon;
        private DevExpress.XtraGrid.Columns.GridColumn colVerwVon;
        private System.ComponentModel.IContainer components;
        private KiSS4.Common.CtlGotoFall ctlGotoFallNetto;
        private KiSS4.Common.ZH.CtlOrgUnitTeamUser ctlOrgUnitTeamUser;
        private KiSS4.Gui.KissDateEdit edtStornoDatum;
        private KiSS4.Gui.KissTextEdit edtSucheBelegNr;
        private KiSS4.Gui.KissButtonEdit edtSucheBgKostenartID;
        private KiSS4.Gui.KissCalcEdit edtSucheFallNr;
        private KiSS4.Gui.KissButtonEdit edtSucheLT;
        private KiSS4.Gui.KissTextEdit edtSuchePersonNr;
        private KiSS4.Gui.KissDateEdit edtSucheValutaDatumBis;
        private KiSS4.Gui.KissDateEdit edtSucheValutaDatumVon;
        private DevExpress.XtraGrid.Views.Grid.GridView gridView1;
        private DevExpress.XtraGrid.Views.Grid.GridView grvKbBuchungKostenartSuche;
        private DevExpress.XtraGrid.Views.Grid.GridView grvKbBuchungSuche;
        private KiSS4.Gui.KissLabel kissLabel2;
        private KiSS4.Gui.KissLabel kissLabel4;
        private KiSS4.Gui.KissLabel lblNettoBelege;
        private KiSS4.Gui.KissLabel lblStornoDatum;
        private KiSS4.Gui.KissLabel lblSucheBelegNr;
        private KiSS4.Gui.KissLabel lblSucheBetrifftPerson;
        private KiSS4.Gui.KissLabel lblSucheFallNr;
        private KiSS4.Gui.KissLabel lblSucheLA;
        private KiSS4.Gui.KissLabel lblSuchePersonNr;
        private KiSS4.Gui.KissLabel lblSucheValuta;
        private string m_HiddenLAs = "";
        private int m_SelectedBelegCount = 0;
        private KiSS4.DB.SqlQuery qryBrutto;
        private DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit repositoryItemCheckEdit1;
        private DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit repositoryItemCheckEdit2;
        private DevExpress.XtraEditors.Repository.RepositoryItemImageComboBox repositoryItemImageComboBox1;
        private DevExpress.XtraEditors.Repository.RepositoryItemImageComboBox repositoryItemImageComboBox2;
        private DevExpress.XtraGrid.Columns.GridColumn colStornoFehler;
        private DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit repositoryItemCheckEdit3;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoStornoFehler;
        private DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit repositoryItemCheckEdit4;
        private KissCheckEdit chkMitFehler;
        private KissCheckEdit chkNettoStatus3;
        private KissCheckEdit chkNettoStatus7;
        private KissRadioGroup edtKategorie;

        protected KiSS4.Gui.KissGrid grdBrutto;

        #endregion

        #region Constructors

        public CtlKbStorno()
        {
            this.InitializeComponent();
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlKbStorno));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.XtraGrid.GridLevelNode gridLevelNode1 = new DevExpress.XtraGrid.GridLevelNode();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject6 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject5 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject4 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject3 = new DevExpress.Utils.SerializableAppearanceObject();
            this.lblNettoBelege = new KiSS4.Gui.KissLabel();
            this.btnSaveStorno = new KiSS4.Gui.KissButton();
            this.btnKeine = new KiSS4.Gui.KissButton();
            this.btnTransferStorno = new KiSS4.Gui.KissButton();
            this.grdBrutto = new KiSS4.Gui.KissGrid();
            this.qryBrutto = new KiSS4.DB.SqlQuery(this.components);
            this.gridView1 = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colBruttoID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoPSCDNr = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoKonto = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoStorno = new DevExpress.XtraGrid.Columns.GridColumn();
            this.repositoryItemCheckEdit2 = new DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit();
            this.colBruttoBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoStatus = new DevExpress.XtraGrid.Columns.GridColumn();
            this.repositoryItemImageComboBox2 = new DevExpress.XtraEditors.Repository.RepositoryItemImageComboBox();
            this.colBruttoText = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoValuta = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoSA = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoTeam = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoSZ = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoBudget = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoNameVorname = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBetrifftPerson = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerwVon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerwBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colDebitor = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoStornoFehler = new DevExpress.XtraGrid.Columns.GridColumn();
            this.repositoryItemCheckEdit4 = new DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit();
            this.kissLabel2 = new KiSS4.Gui.KissLabel();
            this.ctlGotoFallNetto = new KiSS4.Common.CtlGotoFall();
            this.btnBruttoSprungMonatsBudget = new KiSS4.Gui.KissButton();
            this.btnNettoSprungMonatsBudget = new KiSS4.Gui.KissButton();
            this.btnAlle = new KiSS4.Gui.KissButton();
            this.edtStornoDatum = new KiSS4.Gui.KissDateEdit();
            this.lblStornoDatum = new KiSS4.Gui.KissLabel();
            this.ctlOrgUnitTeamUser = new KiSS4.Common.ZH.CtlOrgUnitTeamUser();
            this.lblSucheValuta = new KiSS4.Gui.KissLabel();
            this.edtSucheValutaDatumVon = new KiSS4.Gui.KissDateEdit();
            this.edtSucheValutaDatumBis = new KiSS4.Gui.KissDateEdit();
            this.lblSucheFallNr = new KiSS4.Gui.KissLabel();
            this.edtSucheFallNr = new KiSS4.Gui.KissCalcEdit();
            this.lblSucheBetrifftPerson = new KiSS4.Gui.KissLabel();
            this.edtSucheLT = new KiSS4.Gui.KissButtonEdit();
            this.lblSuchePersonNr = new KiSS4.Gui.KissLabel();
            this.edtSuchePersonNr = new KiSS4.Gui.KissTextEdit();
            this.lblSucheLA = new KiSS4.Gui.KissLabel();
            this.edtSucheBgKostenartID = new KiSS4.Gui.KissButtonEdit();
            this.lblSucheBelegNr = new KiSS4.Gui.KissLabel();
            this.kissLabel4 = new KiSS4.Gui.KissLabel();
            this.edtSucheBelegNr = new KiSS4.Gui.KissTextEdit();
            this.chkSuchInklInaktiveW = new KiSS4.Gui.KissCheckEdit();
            this.chkSucheNurStornierte = new KiSS4.Gui.KissCheckEdit();
            this.colBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBetrifft = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBuchungstext = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFaelligDatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFaFallID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFehlermeldung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colKbBuchungBruttoID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colKbBuchungStatusCode = new DevExpress.XtraGrid.Columns.GridColumn();
            this.repositoryItemImageComboBox1 = new DevExpress.XtraEditors.Repository.RepositoryItemImageComboBox();
            this.colMasterBudget = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colNameVorname = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colNettoID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colNettoPSCDNr = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colNettoStorno = new DevExpress.XtraGrid.Columns.GridColumn();
            this.repositoryItemCheckEdit1 = new DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit();
            this.colPersonBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colPersonBuchungstext = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colPersonVerwPeriodeBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colPersonVerwPeriodeVon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colSA = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colStorniertVon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colSZ = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colTeam = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerwPeriodeBis = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colVerwPeriodeVon = new DevExpress.XtraGrid.Columns.GridColumn();
            this.grvKbBuchungKostenartSuche = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.grvKbBuchungSuche = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colStornoFehler = new DevExpress.XtraGrid.Columns.GridColumn();
            this.repositoryItemCheckEdit3 = new DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit();
            this.chkMitFehler = new KiSS4.Gui.KissCheckEdit();
            this.chkNettoStatus3 = new KiSS4.Gui.KissCheckEdit();
            this.chkNettoStatus7 = new KiSS4.Gui.KissCheckEdit();
            this.edtKategorie = new KiSS4.Gui.KissRadioGroup(this.components);
            ((System.ComponentModel.ISupportInitialize)(this.qryQuery)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvQuery1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdQuery1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.xDocument.Properties)).BeginInit();
            this.tabControlSearch.SuspendLayout();
            this.tpgListe.SuspendLayout();
            this.tpgSuchen.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblNettoBelege)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdBrutto)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBrutto)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gridView1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemImageComboBox2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit4)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtStornoDatum.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblStornoDatum)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSucheValuta)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheValutaDatumVon.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheValutaDatumBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSucheFallNr)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheFallNr.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSucheBetrifftPerson)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheLT.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSuchePersonNr)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSuchePersonNr.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSucheLA)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheBgKostenartID.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSucheBelegNr)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel4)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheBelegNr.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.chkSuchInklInaktiveW.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.chkSucheNurStornierte.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemImageComboBox1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvKbBuchungKostenartSuche)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvKbBuchungSuche)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit3)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.chkMitFehler.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.chkNettoStatus3.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.chkNettoStatus7.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKategorie.Properties)).BeginInit();
            this.SuspendLayout();
            // 
            // qryQuery
            // 
            this.qryQuery.BatchUpdate = true;
            this.qryQuery.CanUpdate = true;
            this.qryQuery.SelectStatement = resources.GetString("qryQuery.SelectStatement");
            // 
            // grvQuery1
            // 
            this.grvQuery1.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvQuery1.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.Empty.Options.UseBackColor = true;
            this.grvQuery1.Appearance.Empty.Options.UseFont = true;
            this.grvQuery1.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.grvQuery1.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.EvenRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.EvenRow.Options.UseFont = true;
            this.grvQuery1.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvQuery1.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvQuery1.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvQuery1.Appearance.FocusedCell.Options.UseFont = true;
            this.grvQuery1.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvQuery1.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvQuery1.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvQuery1.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.FocusedRow.Options.UseFont = true;
            this.grvQuery1.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvQuery1.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvQuery1.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvQuery1.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvQuery1.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvQuery1.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.GroupRow.Options.UseFont = true;
            this.grvQuery1.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvQuery1.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvQuery1.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvQuery1.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvQuery1.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvQuery1.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvQuery1.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvQuery1.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvQuery1.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvQuery1.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvQuery1.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvQuery1.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvQuery1.Appearance.OddRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(222)))));
            this.grvQuery1.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.OddRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.OddRow.Options.UseFont = true;
            this.grvQuery1.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvQuery1.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.Row.Options.UseBackColor = true;
            this.grvQuery1.Appearance.Row.Options.UseFont = true;
            this.grvQuery1.Appearance.SelectedRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(208)))), ((int)(((byte)(170)))), ((int)(((byte)(74)))));
            this.grvQuery1.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvQuery1.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.grvQuery1.Appearance.SelectedRow.Options.UseBackColor = true;
            this.grvQuery1.Appearance.SelectedRow.Options.UseFont = true;
            this.grvQuery1.Appearance.SelectedRow.Options.UseForeColor = true;
            this.grvQuery1.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvQuery1.Appearance.VertLine.Options.UseBackColor = true;
            this.grvQuery1.OptionsBehavior.Editable = false;
            this.grvQuery1.OptionsCustomization.AllowFilter = false;
            this.grvQuery1.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvQuery1.OptionsNavigation.AutoFocusNewRow = true;
            this.grvQuery1.OptionsNavigation.UseTabKey = false;
            this.grvQuery1.OptionsPrint.AutoWidth = false;
            this.grvQuery1.OptionsPrint.ExpandAllDetails = true;
            this.grvQuery1.OptionsPrint.UsePrintStyles = true;
            this.grvQuery1.OptionsView.ColumnAutoWidth = false;
            this.grvQuery1.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvQuery1.OptionsView.ShowGroupPanel = false;
            this.grvQuery1.OptionsView.ShowIndicator = false;
            // 
            // grdQuery1
            // 
            this.grdQuery1.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdQuery1.EmbeddedNavigator.Name = "";
            this.grdQuery1.GridStyle = KiSS4.Gui.GridStyleType.Default;
            this.grdQuery1.Location = new System.Drawing.Point(3, 27);
            this.grdQuery1.MainView = this.grvKbBuchungSuche;
            this.grdQuery1.RepositoryItems.AddRange(new DevExpress.XtraEditors.Repository.RepositoryItem[] {
            this.repositoryItemCheckEdit1,
            this.repositoryItemImageComboBox1,
            this.repositoryItemCheckEdit3});
            this.grdQuery1.Size = new System.Drawing.Size(766, 265);
            this.grdQuery1.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvKbBuchungKostenartSuche,
            this.grvKbBuchungSuche});
            // 
            // xDocument
            // 
            this.xDocument.DataMember = null;
            this.xDocument.EditValue = null;
            this.xDocument.Location = new System.Drawing.Point(3, 994);
            this.xDocument.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.xDocument.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.xDocument.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.xDocument.Properties.Appearance.Options.UseBackColor = true;
            this.xDocument.Properties.Appearance.Options.UseBorderColor = true;
            this.xDocument.Properties.Appearance.Options.UseFont = true;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.xDocument.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", -1, true, false, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("xDocument.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1, "Dokument öffnen")});
            this.xDocument.Visible = false;
            // 
            // ctlGotoFall
            // 
            this.ctlGotoFall.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.ctlGotoFall.DataMember = "BaPersonID";
            this.ctlGotoFall.DataSource = this.qryBrutto;
            this.ctlGotoFall.Location = new System.Drawing.Point(659, 304);
            this.ctlGotoFall.Size = new System.Drawing.Size(110, 24);
            // 
            // searchTitle
            // 
            this.searchTitle.Location = new System.Drawing.Point(0, 2);
            this.searchTitle.Size = new System.Drawing.Size(768, 24);
            // 
            // tabControlSearch
            // 
            this.tabControlSearch.Location = new System.Drawing.Point(8, 3);
            this.tabControlSearch.SelectedTabIndex = 1;
            this.tabControlSearch.Size = new System.Drawing.Size(784, 494);
            this.tabControlSearch.SelectedTabChanging += new System.ComponentModel.CancelEventHandler(this.tabControlSearch_SelectedTabChanging);
            this.tabControlSearch.SelectedTabChanged += new SharpLibrary.WinControls.TabControlExTabChangeEventHandler(this.tabControlSearch_SelectedTabChanged);
            // 
            // tpgListe
            // 
            this.tpgListe.Controls.Add(this.lblStornoDatum);
            this.tpgListe.Controls.Add(this.edtStornoDatum);
            this.tpgListe.Controls.Add(this.btnAlle);
            this.tpgListe.Controls.Add(this.btnNettoSprungMonatsBudget);
            this.tpgListe.Controls.Add(this.btnBruttoSprungMonatsBudget);
            this.tpgListe.Controls.Add(this.ctlGotoFallNetto);
            this.tpgListe.Controls.Add(this.kissLabel2);
            this.tpgListe.Controls.Add(this.grdBrutto);
            this.tpgListe.Controls.Add(this.btnTransferStorno);
            this.tpgListe.Controls.Add(this.btnKeine);
            this.tpgListe.Controls.Add(this.btnSaveStorno);
            this.tpgListe.Controls.Add(this.lblNettoBelege);
            this.tpgListe.Location = new System.Drawing.Point(6, 6);
            this.tpgListe.Size = new System.Drawing.Size(772, 456);
            this.tpgListe.Controls.SetChildIndex(this.grdQuery1, 0);
            this.tpgListe.Controls.SetChildIndex(this.lblNettoBelege, 0);
            this.tpgListe.Controls.SetChildIndex(this.ctlGotoFall, 0);
            this.tpgListe.Controls.SetChildIndex(this.xDocument, 0);
            this.tpgListe.Controls.SetChildIndex(this.btnSaveStorno, 0);
            this.tpgListe.Controls.SetChildIndex(this.btnKeine, 0);
            this.tpgListe.Controls.SetChildIndex(this.btnTransferStorno, 0);
            this.tpgListe.Controls.SetChildIndex(this.grdBrutto, 0);
            this.tpgListe.Controls.SetChildIndex(this.kissLabel2, 0);
            this.tpgListe.Controls.SetChildIndex(this.ctlGotoFallNetto, 0);
            this.tpgListe.Controls.SetChildIndex(this.btnBruttoSprungMonatsBudget, 0);
            this.tpgListe.Controls.SetChildIndex(this.btnNettoSprungMonatsBudget, 0);
            this.tpgListe.Controls.SetChildIndex(this.btnAlle, 0);
            this.tpgListe.Controls.SetChildIndex(this.edtStornoDatum, 0);
            this.tpgListe.Controls.SetChildIndex(this.lblStornoDatum, 0);
            // 
            // tpgSuchen
            // 
            this.tpgSuchen.Controls.Add(this.edtKategorie);
            this.tpgSuchen.Controls.Add(this.chkNettoStatus7);
            this.tpgSuchen.Controls.Add(this.chkNettoStatus3);
            this.tpgSuchen.Controls.Add(this.chkMitFehler);
            this.tpgSuchen.Controls.Add(this.chkSucheNurStornierte);
            this.tpgSuchen.Controls.Add(this.chkSuchInklInaktiveW);
            this.tpgSuchen.Controls.Add(this.edtSucheBelegNr);
            this.tpgSuchen.Controls.Add(this.kissLabel4);
            this.tpgSuchen.Controls.Add(this.lblSucheBelegNr);
            this.tpgSuchen.Controls.Add(this.edtSucheBgKostenartID);
            this.tpgSuchen.Controls.Add(this.lblSucheLA);
            this.tpgSuchen.Controls.Add(this.edtSuchePersonNr);
            this.tpgSuchen.Controls.Add(this.lblSuchePersonNr);
            this.tpgSuchen.Controls.Add(this.edtSucheLT);
            this.tpgSuchen.Controls.Add(this.lblSucheBetrifftPerson);
            this.tpgSuchen.Controls.Add(this.edtSucheFallNr);
            this.tpgSuchen.Controls.Add(this.lblSucheFallNr);
            this.tpgSuchen.Controls.Add(this.edtSucheValutaDatumBis);
            this.tpgSuchen.Controls.Add(this.edtSucheValutaDatumVon);
            this.tpgSuchen.Controls.Add(this.lblSucheValuta);
            this.tpgSuchen.Controls.Add(this.ctlOrgUnitTeamUser);
            this.tpgSuchen.Location = new System.Drawing.Point(6, 6);
            this.tpgSuchen.Size = new System.Drawing.Size(772, 456);
            this.tpgSuchen.Controls.SetChildIndex(this.ctlOrgUnitTeamUser, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.lblSucheValuta, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtSucheValutaDatumVon, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtSucheValutaDatumBis, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.lblSucheFallNr, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtSucheFallNr, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.lblSucheBetrifftPerson, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtSucheLT, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.lblSuchePersonNr, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtSuchePersonNr, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.lblSucheLA, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtSucheBgKostenartID, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.lblSucheBelegNr, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.kissLabel4, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtSucheBelegNr, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.chkSuchInklInaktiveW, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.chkSucheNurStornierte, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.chkMitFehler, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.searchTitle, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.chkNettoStatus3, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.chkNettoStatus7, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.edtKategorie, 0);
            // 
            // lblNettoBelege
            // 
            this.lblNettoBelege.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.lblNettoBelege.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblNettoBelege.Location = new System.Drawing.Point(3, 6);
            this.lblNettoBelege.Name = "lblNettoBelege";
            this.lblNettoBelege.Size = new System.Drawing.Size(518, 17);
            this.lblNettoBelege.TabIndex = 0;
            this.lblNettoBelege.Text = "Alle gefundenen und abhängigen Netto-Belege:";
            this.lblNettoBelege.UseCompatibleTextRendering = true;
            // 
            // btnSaveStorno
            // 
            this.btnSaveStorno.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnSaveStorno.Enabled = false;
            this.btnSaveStorno.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnSaveStorno.Location = new System.Drawing.Point(569, 429);
            this.btnSaveStorno.Name = "btnSaveStorno";
            this.btnSaveStorno.Size = new System.Drawing.Size(200, 24);
            this.btnSaveStorno.TabIndex = 4;
            this.btnSaveStorno.Text = "Selektion für Stornolauf speichern";
            this.btnSaveStorno.UseCompatibleTextRendering = true;
            this.btnSaveStorno.UseVisualStyleBackColor = false;
            this.btnSaveStorno.Click += new System.EventHandler(this.btnSaveStorno_Click);
            // 
            // btnKeine
            // 
            this.btnKeine.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnKeine.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnKeine.Location = new System.Drawing.Point(511, 429);
            this.btnKeine.Name = "btnKeine";
            this.btnKeine.Size = new System.Drawing.Size(52, 24);
            this.btnKeine.TabIndex = 6;
            this.btnKeine.Text = "Keine";
            this.btnKeine.UseCompatibleTextRendering = true;
            this.btnKeine.UseVisualStyleBackColor = false;
            this.btnKeine.Click += new System.EventHandler(this.btnKeine_Click);
            // 
            // btnTransferStorno
            // 
            this.btnTransferStorno.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnTransferStorno.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnTransferStorno.Location = new System.Drawing.Point(294, 429);
            this.btnTransferStorno.Name = "btnTransferStorno";
            this.btnTransferStorno.Size = new System.Drawing.Size(122, 24);
            this.btnTransferStorno.TabIndex = 7;
            this.btnTransferStorno.Text = "Stornolauf starten";
            this.btnTransferStorno.UseCompatibleTextRendering = true;
            this.btnTransferStorno.UseVisualStyleBackColor = false;
            this.btnTransferStorno.Click += new System.EventHandler(this.btnTransferStorno_Click);
            // 
            // grdBrutto
            // 
            this.grdBrutto.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdBrutto.ColumnFilterActivated = true;
            this.grdBrutto.DataSource = this.qryBrutto;
            this.grdBrutto.EmbeddedNavigator.Name = "";
            this.grdBrutto.ImeMode = System.Windows.Forms.ImeMode.On;
            gridLevelNode1.RelationName = "Level1";
            this.grdBrutto.LevelTree.Nodes.AddRange(new DevExpress.XtraGrid.GridLevelNode[] {
            gridLevelNode1});
            this.grdBrutto.Location = new System.Drawing.Point(3, 330);
            this.grdBrutto.MainView = this.gridView1;
            this.grdBrutto.Name = "grdBrutto";
            this.grdBrutto.RepositoryItems.AddRange(new DevExpress.XtraEditors.Repository.RepositoryItem[] {
            this.repositoryItemImageComboBox2,
            this.repositoryItemCheckEdit2,
            this.repositoryItemCheckEdit4});
            this.grdBrutto.Size = new System.Drawing.Size(766, 93);
            this.grdBrutto.TabIndex = 111;
            this.grdBrutto.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.gridView1});
            // 
            // qryBrutto
            // 
            this.qryBrutto.BatchUpdate = true;
            this.qryBrutto.CanUpdate = true;
            this.qryBrutto.FillTimeOut = 360;
            this.qryBrutto.HostControl = this;
            this.qryBrutto.SelectStatement = resources.GetString("qryBrutto.SelectStatement");
            // 
            // gridView1
            // 
            this.gridView1.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gridView1.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.Empty.Options.UseBackColor = true;
            this.gridView1.Appearance.Empty.Options.UseFont = true;
            this.gridView1.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.gridView1.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.EvenRow.Options.UseBackColor = true;
            this.gridView1.Appearance.EvenRow.Options.UseFont = true;
            this.gridView1.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gridView1.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gridView1.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gridView1.Appearance.FocusedCell.Options.UseFont = true;
            this.gridView1.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gridView1.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gridView1.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gridView1.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gridView1.Appearance.FocusedRow.Options.UseFont = true;
            this.gridView1.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gridView1.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gridView1.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gridView1.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gridView1.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gridView1.Appearance.GroupRow.Options.UseBackColor = true;
            this.gridView1.Appearance.GroupRow.Options.UseFont = true;
            this.gridView1.Appearance.GroupRow.Options.UseForeColor = true;
            this.gridView1.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gridView1.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gridView1.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gridView1.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gridView1.Appearance.HeaderPanel.Options.UseFont = true;
            this.gridView1.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gridView1.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gridView1.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gridView1.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gridView1.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gridView1.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gridView1.Appearance.HorzLine.Options.UseBackColor = true;
            this.gridView1.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.OddRow.Options.UseFont = true;
            this.gridView1.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gridView1.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.Row.Options.UseBackColor = true;
            this.gridView1.Appearance.Row.Options.UseFont = true;
            this.gridView1.Appearance.SelectedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.gridView1.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.gridView1.Appearance.SelectedRow.Options.UseBackColor = true;
            this.gridView1.Appearance.SelectedRow.Options.UseFont = true;
            this.gridView1.Appearance.SelectedRow.Options.UseForeColor = true;
            this.gridView1.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gridView1.Appearance.VertLine.Options.UseBackColor = true;
            this.gridView1.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gridView1.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colBruttoID,
            this.colBruttoPSCDNr,
            this.colBruttoKonto,
            this.colBruttoStorno,
            this.colBruttoBetrag,
            this.colBruttoStatus,
            this.colBruttoText,
            this.colBruttoValuta,
            this.colBruttoSA,
            this.colBruttoTeam,
            this.colBruttoSZ,
            this.colBruttoBudget,
            this.colBruttoNameVorname,
            this.colBetrifftPerson,
            this.colVerwVon,
            this.colVerwBis,
            this.colDebitor,
            this.colBruttoStornoFehler});
            this.gridView1.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gridView1.GridControl = this.grdBrutto;
            this.gridView1.Name = "gridView1";
            this.gridView1.OptionsDetail.ShowDetailTabs = false;
            this.gridView1.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gridView1.OptionsNavigation.AutoFocusNewRow = true;
            this.gridView1.OptionsNavigation.UseTabKey = false;
            this.gridView1.OptionsView.ColumnAutoWidth = false;
            this.gridView1.OptionsView.ShowChildrenInGroupPanel = true;
            this.gridView1.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gridView1.OptionsView.ShowGroupPanel = false;
            this.gridView1.OptionsView.ShowIndicator = false;
            this.gridView1.CellValueChanging += new DevExpress.XtraGrid.Views.Base.CellValueChangedEventHandler(this.gridView1_CellValueChanging);
            this.gridView1.CustomRowCellEdit += new DevExpress.XtraGrid.Views.Grid.CustomRowCellEditEventHandler(this.gridView1_CustomRowCellEdit);
            // 
            // colBruttoID
            // 
            this.colBruttoID.Caption = "Brutto ID";
            this.colBruttoID.FieldName = "KbBuchungBruttoID";
            this.colBruttoID.Name = "colBruttoID";
            this.colBruttoID.OptionsColumn.AllowEdit = false;
            this.colBruttoID.Visible = true;
            this.colBruttoID.VisibleIndex = 15;
            // 
            // colBruttoPSCDNr
            // 
            this.colBruttoPSCDNr.Caption = "PSCD Beleg Nr";
            this.colBruttoPSCDNr.FieldName = "BelegNr";
            this.colBruttoPSCDNr.Name = "colBruttoPSCDNr";
            this.colBruttoPSCDNr.OptionsColumn.AllowEdit = false;
            this.colBruttoPSCDNr.Visible = true;
            this.colBruttoPSCDNr.VisibleIndex = 2;
            this.colBruttoPSCDNr.Width = 90;
            // 
            // colBruttoKonto
            // 
            this.colBruttoKonto.Caption = "LA";
            this.colBruttoKonto.FieldName = "KontoNr";
            this.colBruttoKonto.Name = "colBruttoKonto";
            this.colBruttoKonto.OptionsColumn.AllowEdit = false;
            this.colBruttoKonto.Visible = true;
            this.colBruttoKonto.VisibleIndex = 5;
            this.colBruttoKonto.Width = 34;
            // 
            // colBruttoStorno
            // 
            this.colBruttoStorno.Caption = "Storno";
            this.colBruttoStorno.ColumnEdit = this.repositoryItemCheckEdit2;
            this.colBruttoStorno.FieldName = "Storno";
            this.colBruttoStorno.Name = "colBruttoStorno";
            this.colBruttoStorno.Visible = true;
            this.colBruttoStorno.VisibleIndex = 0;
            this.colBruttoStorno.Width = 48;
            // 
            // repositoryItemCheckEdit2
            // 
            this.repositoryItemCheckEdit2.AutoHeight = false;
            this.repositoryItemCheckEdit2.Name = "repositoryItemCheckEdit2";
            // 
            // colBruttoBetrag
            // 
            this.colBruttoBetrag.Caption = "Betrag";
            this.colBruttoBetrag.FieldName = "Betrag";
            this.colBruttoBetrag.Name = "colBruttoBetrag";
            this.colBruttoBetrag.OptionsColumn.AllowEdit = false;
            this.colBruttoBetrag.Visible = true;
            this.colBruttoBetrag.VisibleIndex = 4;
            this.colBruttoBetrag.Width = 53;
            // 
            // colBruttoStatus
            // 
            this.colBruttoStatus.Caption = "S";
            this.colBruttoStatus.ColumnEdit = this.repositoryItemImageComboBox2;
            this.colBruttoStatus.FieldName = "KbBuchungStatusCode";
            this.colBruttoStatus.Name = "colBruttoStatus";
            this.colBruttoStatus.OptionsColumn.AllowEdit = false;
            this.colBruttoStatus.OptionsColumn.AllowSize = false;
            this.colBruttoStatus.OptionsColumn.FixedWidth = true;
            this.colBruttoStatus.Visible = true;
            this.colBruttoStatus.VisibleIndex = 7;
            this.colBruttoStatus.Width = 20;
            // 
            // repositoryItemImageComboBox2
            // 
            this.repositoryItemImageComboBox2.AutoHeight = false;
            this.repositoryItemImageComboBox2.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.repositoryItemImageComboBox2.Name = "repositoryItemImageComboBox2";
            // 
            // colBruttoText
            // 
            this.colBruttoText.Caption = "Buchungstext";
            this.colBruttoText.FieldName = "Buchungstext";
            this.colBruttoText.Name = "colBruttoText";
            this.colBruttoText.OptionsColumn.AllowEdit = false;
            this.colBruttoText.Visible = true;
            this.colBruttoText.VisibleIndex = 6;
            this.colBruttoText.Width = 138;
            // 
            // colBruttoValuta
            // 
            this.colBruttoValuta.Caption = "Fälligkeit/Valuta";
            this.colBruttoValuta.FieldName = "FaelligDatum";
            this.colBruttoValuta.Name = "colBruttoValuta";
            this.colBruttoValuta.OptionsColumn.AllowEdit = false;
            this.colBruttoValuta.Visible = true;
            this.colBruttoValuta.VisibleIndex = 10;
            // 
            // colBruttoSA
            // 
            this.colBruttoSA.Caption = "SA";
            this.colBruttoSA.FieldName = "SA";
            this.colBruttoSA.Name = "colBruttoSA";
            this.colBruttoSA.OptionsColumn.AllowEdit = false;
            this.colBruttoSA.Visible = true;
            this.colBruttoSA.VisibleIndex = 12;
            this.colBruttoSA.Width = 43;
            // 
            // colBruttoTeam
            // 
            this.colBruttoTeam.Caption = "Team";
            this.colBruttoTeam.FieldName = "Team";
            this.colBruttoTeam.Name = "colBruttoTeam";
            this.colBruttoTeam.OptionsColumn.AllowEdit = false;
            this.colBruttoTeam.Visible = true;
            this.colBruttoTeam.VisibleIndex = 13;
            this.colBruttoTeam.Width = 48;
            // 
            // colBruttoSZ
            // 
            this.colBruttoSZ.Caption = "SZ";
            this.colBruttoSZ.FieldName = "SZ";
            this.colBruttoSZ.Name = "colBruttoSZ";
            this.colBruttoSZ.OptionsColumn.AllowEdit = false;
            this.colBruttoSZ.Visible = true;
            this.colBruttoSZ.VisibleIndex = 14;
            this.colBruttoSZ.Width = 45;
            // 
            // colBruttoBudget
            // 
            this.colBruttoBudget.Caption = "Budget";
            this.colBruttoBudget.FieldName = "Budget";
            this.colBruttoBudget.Name = "colBruttoBudget";
            this.colBruttoBudget.OptionsColumn.AllowEdit = false;
            this.colBruttoBudget.Visible = true;
            this.colBruttoBudget.VisibleIndex = 11;
            // 
            // colBruttoNameVorname
            // 
            this.colBruttoNameVorname.Caption = "Name, Vorname";
            this.colBruttoNameVorname.FieldName = "NameVorname";
            this.colBruttoNameVorname.Name = "colBruttoNameVorname";
            this.colBruttoNameVorname.OptionsColumn.AllowEdit = false;
            this.colBruttoNameVorname.Visible = true;
            this.colBruttoNameVorname.VisibleIndex = 16;
            this.colBruttoNameVorname.Width = 123;
            // 
            // colBetrifftPerson
            // 
            this.colBetrifftPerson.Caption = "Betrifft Person";
            this.colBetrifftPerson.FieldName = "BetrifftPerson";
            this.colBetrifftPerson.Name = "colBetrifftPerson";
            this.colBetrifftPerson.OptionsColumn.AllowEdit = false;
            this.colBetrifftPerson.Visible = true;
            this.colBetrifftPerson.VisibleIndex = 3;
            this.colBetrifftPerson.Width = 106;
            // 
            // colVerwVon
            // 
            this.colVerwVon.Caption = "Verw.von";
            this.colVerwVon.FieldName = "VerwPeriodeVon";
            this.colVerwVon.Name = "colVerwVon";
            this.colVerwVon.OptionsColumn.AllowEdit = false;
            this.colVerwVon.Visible = true;
            this.colVerwVon.VisibleIndex = 8;
            // 
            // colVerwBis
            // 
            this.colVerwBis.Caption = "Verw.bis";
            this.colVerwBis.FieldName = "VerwPeriodeBis";
            this.colVerwBis.Name = "colVerwBis";
            this.colVerwBis.OptionsColumn.AllowEdit = false;
            this.colVerwBis.Visible = true;
            this.colVerwBis.VisibleIndex = 9;
            // 
            // colDebitor
            // 
            this.colDebitor.Caption = "Debitor";
            this.colDebitor.FieldName = "Schuldner";
            this.colDebitor.Name = "colDebitor";
            this.colDebitor.OptionsColumn.AllowEdit = false;
            this.colDebitor.Visible = true;
            this.colDebitor.VisibleIndex = 17;
            this.colDebitor.Width = 145;
            // 
            // colBruttoStornoFehler
            // 
            this.colBruttoStornoFehler.Caption = "Fehler";
            this.colBruttoStornoFehler.FieldName = "StornoFehler";
            this.colBruttoStornoFehler.Name = "colBruttoStornoFehler";
            this.colBruttoStornoFehler.OptionsColumn.AllowEdit = false;
            this.colBruttoStornoFehler.Visible = true;
            this.colBruttoStornoFehler.VisibleIndex = 1;
            this.colBruttoStornoFehler.Width = 48;
            // 
            // repositoryItemCheckEdit4
            // 
            this.repositoryItemCheckEdit4.AutoHeight = false;
            this.repositoryItemCheckEdit4.Name = "repositoryItemCheckEdit4";
            // 
            // kissLabel2
            // 
            this.kissLabel2.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.kissLabel2.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.kissLabel2.Location = new System.Drawing.Point(3, 311);
            this.kissLabel2.Name = "kissLabel2";
            this.kissLabel2.Size = new System.Drawing.Size(531, 16);
            this.kissLabel2.TabIndex = 112;
            this.kissLabel2.Text = "Alle abhängigen Brutto-Belege aller gefundenen Netto-Belege:";
            this.kissLabel2.UseCompatibleTextRendering = true;
            // 
            // ctlGotoFallNetto
            // 
            this.ctlGotoFallNetto.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.ctlGotoFallNetto.BaPersonID = ((object)(resources.GetObject("ctlGotoFallNetto.BaPersonID")));
            this.ctlGotoFallNetto.DataMember = "BaPersonID";
            this.ctlGotoFallNetto.DataSource = this.qryQuery;
            this.ctlGotoFallNetto.Location = new System.Drawing.Point(659, 0);
            this.ctlGotoFallNetto.Name = "ctlGotoFallNetto";
            this.ctlGotoFallNetto.Size = new System.Drawing.Size(110, 27);
            this.ctlGotoFallNetto.TabIndex = 113;
            // 
            // btnBruttoSprungMonatsBudget
            // 
            this.btnBruttoSprungMonatsBudget.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnBruttoSprungMonatsBudget.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnBruttoSprungMonatsBudget.Location = new System.Drawing.Point(540, 304);
            this.btnBruttoSprungMonatsBudget.Name = "btnBruttoSprungMonatsBudget";
            this.btnBruttoSprungMonatsBudget.Size = new System.Drawing.Size(113, 24);
            this.btnBruttoSprungMonatsBudget.TabIndex = 114;
            this.btnBruttoSprungMonatsBudget.Text = "> Monatsbudget";
            this.btnBruttoSprungMonatsBudget.UseCompatibleTextRendering = true;
            this.btnBruttoSprungMonatsBudget.UseVisualStyleBackColor = false;
            this.btnBruttoSprungMonatsBudget.Click += new System.EventHandler(this.btnBruttoSprungMonatsBudget_Click);
            // 
            // btnNettoSprungMonatsBudget
            // 
            this.btnNettoSprungMonatsBudget.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Right)));
            this.btnNettoSprungMonatsBudget.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnNettoSprungMonatsBudget.Location = new System.Drawing.Point(540, 0);
            this.btnNettoSprungMonatsBudget.Name = "btnNettoSprungMonatsBudget";
            this.btnNettoSprungMonatsBudget.Size = new System.Drawing.Size(113, 24);
            this.btnNettoSprungMonatsBudget.TabIndex = 115;
            this.btnNettoSprungMonatsBudget.Text = "> Monatsbudget";
            this.btnNettoSprungMonatsBudget.UseCompatibleTextRendering = true;
            this.btnNettoSprungMonatsBudget.UseVisualStyleBackColor = false;
            this.btnNettoSprungMonatsBudget.Click += new System.EventHandler(this.btnNettoSprungMonatsBudget_Click);
            // 
            // btnAlle
            // 
            this.btnAlle.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnAlle.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnAlle.Location = new System.Drawing.Point(453, 429);
            this.btnAlle.Name = "btnAlle";
            this.btnAlle.Size = new System.Drawing.Size(52, 24);
            this.btnAlle.TabIndex = 116;
            this.btnAlle.Text = "Alle";
            this.btnAlle.UseCompatibleTextRendering = true;
            this.btnAlle.UseVisualStyleBackColor = false;
            this.btnAlle.Click += new System.EventHandler(this.btnAlle_Click);
            // 
            // edtStornoDatum
            // 
            this.edtStornoDatum.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.edtStornoDatum.EditValue = null;
            this.edtStornoDatum.Location = new System.Drawing.Point(168, 429);
            this.edtStornoDatum.Name = "edtStornoDatum";
            this.edtStornoDatum.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtStornoDatum.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtStornoDatum.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtStornoDatum.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtStornoDatum.Properties.Appearance.Options.UseBackColor = true;
            this.edtStornoDatum.Properties.Appearance.Options.UseBorderColor = true;
            this.edtStornoDatum.Properties.Appearance.Options.UseFont = true;
            this.edtStornoDatum.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtStornoDatum.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtStornoDatum.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtStornoDatum.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtStornoDatum.Properties.ShowToday = false;
            this.edtStornoDatum.Size = new System.Drawing.Size(105, 24);
            this.edtStornoDatum.TabIndex = 117;
            // 
            // lblStornoDatum
            // 
            this.lblStornoDatum.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.lblStornoDatum.Location = new System.Drawing.Point(50, 428);
            this.lblStornoDatum.Name = "lblStornoDatum";
            this.lblStornoDatum.Size = new System.Drawing.Size(113, 24);
            this.lblStornoDatum.TabIndex = 118;
            this.lblStornoDatum.Text = "Storno Minimum-Datum";
            this.lblStornoDatum.UseCompatibleTextRendering = true;
            // 
            // ctlOrgUnitTeamUser
            // 
            this.ctlOrgUnitTeamUser.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.ctlOrgUnitTeamUser.LableWidth = 113;
            this.ctlOrgUnitTeamUser.Location = new System.Drawing.Point(8, 47);
            this.ctlOrgUnitTeamUser.Name = "ctlOrgUnitTeamUser";
            this.ctlOrgUnitTeamUser.SetUserOnNewSearch = false;
            this.ctlOrgUnitTeamUser.ShowUser = true;
            this.ctlOrgUnitTeamUser.Size = new System.Drawing.Size(373, 84);
            this.ctlOrgUnitTeamUser.TabIndex = 16;
            // 
            // lblSucheValuta
            // 
            this.lblSucheValuta.Location = new System.Drawing.Point(8, 154);
            this.lblSucheValuta.Name = "lblSucheValuta";
            this.lblSucheValuta.Size = new System.Drawing.Size(108, 24);
            this.lblSucheValuta.TabIndex = 17;
            this.lblSucheValuta.Text = "Fälligkeit/Valuta von";
            this.lblSucheValuta.UseCompatibleTextRendering = true;
            // 
            // edtSucheValutaDatumVon
            // 
            this.edtSucheValutaDatumVon.EditValue = null;
            this.edtSucheValutaDatumVon.Location = new System.Drawing.Point(122, 152);
            this.edtSucheValutaDatumVon.Name = "edtSucheValutaDatumVon";
            this.edtSucheValutaDatumVon.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtSucheValutaDatumVon.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheValutaDatumVon.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheValutaDatumVon.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheValutaDatumVon.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheValutaDatumVon.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheValutaDatumVon.Properties.Appearance.Options.UseFont = true;
            this.edtSucheValutaDatumVon.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject6.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject6.Options.UseBackColor = true;
            this.edtSucheValutaDatumVon.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtSucheValutaDatumVon.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject6)});
            this.edtSucheValutaDatumVon.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSucheValutaDatumVon.Properties.ShowToday = false;
            this.edtSucheValutaDatumVon.Size = new System.Drawing.Size(97, 24);
            this.edtSucheValutaDatumVon.TabIndex = 18;
            // 
            // edtSucheValutaDatumBis
            // 
            this.edtSucheValutaDatumBis.EditValue = null;
            this.edtSucheValutaDatumBis.Location = new System.Drawing.Point(281, 152);
            this.edtSucheValutaDatumBis.Name = "edtSucheValutaDatumBis";
            this.edtSucheValutaDatumBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtSucheValutaDatumBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheValutaDatumBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheValutaDatumBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheValutaDatumBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheValutaDatumBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheValutaDatumBis.Properties.Appearance.Options.UseFont = true;
            this.edtSucheValutaDatumBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject5.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject5.Options.UseBackColor = true;
            this.edtSucheValutaDatumBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtSucheValutaDatumBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject5)});
            this.edtSucheValutaDatumBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSucheValutaDatumBis.Properties.ShowToday = false;
            this.edtSucheValutaDatumBis.Size = new System.Drawing.Size(100, 24);
            this.edtSucheValutaDatumBis.TabIndex = 19;
            // 
            // lblSucheFallNr
            // 
            this.lblSucheFallNr.Location = new System.Drawing.Point(411, 153);
            this.lblSucheFallNr.Name = "lblSucheFallNr";
            this.lblSucheFallNr.Size = new System.Drawing.Size(100, 23);
            this.lblSucheFallNr.TabIndex = 20;
            this.lblSucheFallNr.Text = "Fallnummer";
            this.lblSucheFallNr.UseCompatibleTextRendering = true;
            // 
            // edtSucheFallNr
            // 
            this.edtSucheFallNr.Location = new System.Drawing.Point(514, 154);
            this.edtSucheFallNr.Name = "edtSucheFallNr";
            this.edtSucheFallNr.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtSucheFallNr.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheFallNr.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheFallNr.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheFallNr.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheFallNr.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheFallNr.Properties.Appearance.Options.UseFont = true;
            this.edtSucheFallNr.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtSucheFallNr.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSucheFallNr.Size = new System.Drawing.Size(100, 24);
            this.edtSucheFallNr.TabIndex = 21;
            // 
            // lblSucheBetrifftPerson
            // 
            this.lblSucheBetrifftPerson.Location = new System.Drawing.Point(8, 184);
            this.lblSucheBetrifftPerson.Name = "lblSucheBetrifftPerson";
            this.lblSucheBetrifftPerson.Size = new System.Drawing.Size(85, 24);
            this.lblSucheBetrifftPerson.TabIndex = 22;
            this.lblSucheBetrifftPerson.Text = "Leistungsträger";
            this.lblSucheBetrifftPerson.UseCompatibleTextRendering = true;
            // 
            // edtSucheLT
            // 
            this.edtSucheLT.Location = new System.Drawing.Point(122, 183);
            this.edtSucheLT.Name = "edtSucheLT";
            this.edtSucheLT.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheLT.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheLT.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheLT.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheLT.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheLT.Properties.Appearance.Options.UseFont = true;
            this.edtSucheLT.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject4.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject4.Options.UseBackColor = true;
            this.edtSucheLT.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject4)});
            this.edtSucheLT.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSucheLT.Size = new System.Drawing.Size(259, 24);
            this.edtSucheLT.TabIndex = 23;
            this.edtSucheLT.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtSucheLT_UserModifiedFld);
            // 
            // lblSuchePersonNr
            // 
            this.lblSuchePersonNr.Location = new System.Drawing.Point(411, 184);
            this.lblSuchePersonNr.Name = "lblSuchePersonNr";
            this.lblSuchePersonNr.Size = new System.Drawing.Size(100, 23);
            this.lblSuchePersonNr.TabIndex = 24;
            this.lblSuchePersonNr.Text = "Personen-Nr.";
            this.lblSuchePersonNr.UseCompatibleTextRendering = true;
            // 
            // edtSuchePersonNr
            // 
            this.edtSuchePersonNr.Location = new System.Drawing.Point(514, 184);
            this.edtSuchePersonNr.Name = "edtSuchePersonNr";
            this.edtSuchePersonNr.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSuchePersonNr.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSuchePersonNr.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSuchePersonNr.Properties.Appearance.Options.UseBackColor = true;
            this.edtSuchePersonNr.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSuchePersonNr.Properties.Appearance.Options.UseFont = true;
            this.edtSuchePersonNr.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtSuchePersonNr.Size = new System.Drawing.Size(100, 24);
            this.edtSuchePersonNr.TabIndex = 25;
            // 
            // lblSucheLA
            // 
            this.lblSucheLA.Location = new System.Drawing.Point(8, 214);
            this.lblSucheLA.Name = "lblSucheLA";
            this.lblSucheLA.Size = new System.Drawing.Size(85, 24);
            this.lblSucheLA.TabIndex = 26;
            this.lblSucheLA.Text = "Leistungsart";
            this.lblSucheLA.UseCompatibleTextRendering = true;
            // 
            // edtSucheBgKostenartID
            // 
            this.edtSucheBgKostenartID.Location = new System.Drawing.Point(122, 214);
            this.edtSucheBgKostenartID.LookupSQL = "SELECT\r\n  ID$  = BgKostenartID,\r\n  Text = IsNull(KontoNr + \' \', \'\') + Name\r\nFROM " +
                "BgKostenart   BKA\r\nWHERE IsNull(KontoNr + \' \', \'\') + Name LIKE \'%\' + {0} + \'%\'\r\n" +
                "----";
            this.edtSucheBgKostenartID.Name = "edtSucheBgKostenartID";
            this.edtSucheBgKostenartID.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheBgKostenartID.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheBgKostenartID.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheBgKostenartID.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheBgKostenartID.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheBgKostenartID.Properties.Appearance.Options.UseFont = true;
            this.edtSucheBgKostenartID.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject3.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject3.Options.UseBackColor = true;
            this.edtSucheBgKostenartID.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Ellipsis, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject3)});
            this.edtSucheBgKostenartID.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtSucheBgKostenartID.Size = new System.Drawing.Size(259, 24);
            this.edtSucheBgKostenartID.TabIndex = 27;
            this.edtSucheBgKostenartID.UserModifiedFld += new KiSS4.Gui.UserModifiedFldEventHandler(this.edtSucheBgKostenartID_UserModifiedFld);
            // 
            // lblSucheBelegNr
            // 
            this.lblSucheBelegNr.Location = new System.Drawing.Point(411, 214);
            this.lblSucheBelegNr.Name = "lblSucheBelegNr";
            this.lblSucheBelegNr.Size = new System.Drawing.Size(100, 23);
            this.lblSucheBelegNr.TabIndex = 28;
            this.lblSucheBelegNr.Text = "Beleg-Nr.";
            this.lblSucheBelegNr.UseCompatibleTextRendering = true;
            // 
            // kissLabel4
            // 
            this.kissLabel4.Location = new System.Drawing.Point(240, 153);
            this.kissLabel4.Name = "kissLabel4";
            this.kissLabel4.Size = new System.Drawing.Size(28, 24);
            this.kissLabel4.TabIndex = 29;
            this.kissLabel4.Text = "bis";
            this.kissLabel4.UseCompatibleTextRendering = true;
            // 
            // edtSucheBelegNr
            // 
            this.edtSucheBelegNr.Location = new System.Drawing.Point(514, 214);
            this.edtSucheBelegNr.Name = "edtSucheBelegNr";
            this.edtSucheBelegNr.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtSucheBelegNr.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtSucheBelegNr.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtSucheBelegNr.Properties.Appearance.Options.UseBackColor = true;
            this.edtSucheBelegNr.Properties.Appearance.Options.UseBorderColor = true;
            this.edtSucheBelegNr.Properties.Appearance.Options.UseFont = true;
            this.edtSucheBelegNr.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtSucheBelegNr.Size = new System.Drawing.Size(100, 24);
            this.edtSucheBelegNr.TabIndex = 30;
            // 
            // chkSuchInklInaktiveW
            // 
            this.chkSuchInklInaktiveW.EditValue = false;
            this.chkSuchInklInaktiveW.Location = new System.Drawing.Point(8, 260);
            this.chkSuchInklInaktiveW.Name = "chkSuchInklInaktiveW";
            this.chkSuchInklInaktiveW.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.chkSuchInklInaktiveW.Properties.Appearance.Options.UseBackColor = true;
            this.chkSuchInklInaktiveW.Properties.Caption = "inkl. inaktive W ";
            this.chkSuchInklInaktiveW.Size = new System.Drawing.Size(150, 19);
            this.chkSuchInklInaktiveW.TabIndex = 31;
            // 
            // chkSucheNurStornierte
            // 
            this.chkSucheNurStornierte.EditValue = false;
            this.chkSucheNurStornierte.Location = new System.Drawing.Point(362, 260);
            this.chkSucheNurStornierte.Name = "chkSucheNurStornierte";
            this.chkSucheNurStornierte.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.chkSucheNurStornierte.Properties.Appearance.Options.UseBackColor = true;
            this.chkSucheNurStornierte.Properties.Caption = "Nur Belege, die als zu stornieren markiert sind";
            this.chkSucheNurStornierte.Size = new System.Drawing.Size(242, 19);
            this.chkSucheNurStornierte.TabIndex = 32;
            // 
            // colBetrag
            // 
            this.colBetrag.Caption = "Betrag";
            this.colBetrag.DisplayFormat.FormatString = "n2";
            this.colBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colBetrag.FieldName = "Betrag";
            this.colBetrag.Name = "colBetrag";
            this.colBetrag.OptionsColumn.AllowEdit = false;
            this.colBetrag.Visible = true;
            this.colBetrag.VisibleIndex = 5;
            this.colBetrag.Width = 56;
            // 
            // colBetrifft
            // 
            this.colBetrifft.Caption = "Betrifft Person";
            this.colBetrifft.FieldName = "Betrifft";
            this.colBetrifft.Name = "colBetrifft";
            this.colBetrifft.OptionsColumn.AllowEdit = false;
            this.colBetrifft.Visible = true;
            this.colBetrifft.VisibleIndex = 0;
            this.colBetrifft.Width = 303;
            // 
            // colBuchungstext
            // 
            this.colBuchungstext.Caption = "Buchungstext";
            this.colBuchungstext.FieldName = "Buchungstext";
            this.colBuchungstext.Name = "colBuchungstext";
            this.colBuchungstext.OptionsColumn.AllowEdit = false;
            this.colBuchungstext.Visible = true;
            this.colBuchungstext.VisibleIndex = 8;
            this.colBuchungstext.Width = 134;
            // 
            // colFaelligDatum
            // 
            this.colFaelligDatum.Caption = "Fälligkeit/Valuta";
            this.colFaelligDatum.FieldName = "FaelligDatum";
            this.colFaelligDatum.Name = "colFaelligDatum";
            this.colFaelligDatum.OptionsColumn.AllowEdit = false;
            this.colFaelligDatum.Visible = true;
            this.colFaelligDatum.VisibleIndex = 6;
            this.colFaelligDatum.Width = 72;
            // 
            // colFaFallID
            // 
            this.colFaFallID.Caption = "FallNr";
            this.colFaFallID.FieldName = "FaFallID";
            this.colFaFallID.Name = "colFaFallID";
            this.colFaFallID.OptionsColumn.AllowEdit = false;
            this.colFaFallID.Visible = true;
            this.colFaFallID.VisibleIndex = 3;
            this.colFaFallID.Width = 63;
            // 
            // colFehlermeldung
            // 
            this.colFehlermeldung.Caption = "Storno Fehlermeldung";
            this.colFehlermeldung.FieldName = "Fehlermeldung";
            this.colFehlermeldung.Name = "colFehlermeldung";
            this.colFehlermeldung.OptionsColumn.AllowEdit = false;
            this.colFehlermeldung.Width = 92;
            // 
            // colKbBuchungBruttoID
            // 
            this.colKbBuchungBruttoID.Caption = "KbBuchungBruttoID";
            this.colKbBuchungBruttoID.FieldName = "KbBuchungID";
            this.colKbBuchungBruttoID.Name = "colKbBuchungBruttoID";
            this.colKbBuchungBruttoID.OptionsColumn.AllowEdit = false;
            // 
            // colKbBuchungStatusCode
            // 
            this.colKbBuchungStatusCode.Caption = "S";
            this.colKbBuchungStatusCode.ColumnEdit = this.repositoryItemImageComboBox1;
            this.colKbBuchungStatusCode.FieldName = "KbBuchungStatusCode";
            this.colKbBuchungStatusCode.Name = "colKbBuchungStatusCode";
            this.colKbBuchungStatusCode.OptionsColumn.AllowEdit = false;
            this.colKbBuchungStatusCode.OptionsColumn.AllowSize = false;
            this.colKbBuchungStatusCode.OptionsColumn.FixedWidth = true;
            this.colKbBuchungStatusCode.Visible = true;
            this.colKbBuchungStatusCode.VisibleIndex = 7;
            this.colKbBuchungStatusCode.Width = 20;
            // 
            // repositoryItemImageComboBox1
            // 
            this.repositoryItemImageComboBox1.AutoHeight = false;
            this.repositoryItemImageComboBox1.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo)});
            this.repositoryItemImageComboBox1.Name = "repositoryItemImageComboBox1";
            // 
            // colMasterBudget
            // 
            this.colMasterBudget.Caption = "M";
            this.colMasterBudget.FieldName = "MasterBudget";
            this.colMasterBudget.Name = "colMasterBudget";
            this.colMasterBudget.OptionsColumn.AllowEdit = false;
            this.colMasterBudget.Visible = true;
            this.colMasterBudget.VisibleIndex = 2;
            this.colMasterBudget.Width = 22;
            // 
            // colNameVorname
            // 
            this.colNameVorname.Caption = "Name, Vorname";
            this.colNameVorname.FieldName = "NameVorname";
            this.colNameVorname.Name = "colNameVorname";
            this.colNameVorname.OptionsColumn.AllowEdit = false;
            this.colNameVorname.Visible = true;
            this.colNameVorname.VisibleIndex = 4;
            this.colNameVorname.Width = 143;
            // 
            // colNettoID
            // 
            this.colNettoID.Caption = "Netto ID";
            this.colNettoID.FieldName = "KBBuchungID";
            this.colNettoID.Name = "colNettoID";
            this.colNettoID.OptionsColumn.AllowEdit = false;
            this.colNettoID.Visible = true;
            this.colNettoID.VisibleIndex = 11;
            this.colNettoID.Width = 63;
            // 
            // colNettoPSCDNr
            // 
            this.colNettoPSCDNr.Caption = "PSCD Beleg Nr";
            this.colNettoPSCDNr.FieldName = "BelegNr";
            this.colNettoPSCDNr.Name = "colNettoPSCDNr";
            this.colNettoPSCDNr.OptionsColumn.AllowEdit = false;
            this.colNettoPSCDNr.Visible = true;
            this.colNettoPSCDNr.VisibleIndex = 2;
            // 
            // colNettoStorno
            // 
            this.colNettoStorno.Caption = "Storno";
            this.colNettoStorno.ColumnEdit = this.repositoryItemCheckEdit1;
            this.colNettoStorno.FieldName = "Storno";
            this.colNettoStorno.Name = "colNettoStorno";
            this.colNettoStorno.Visible = true;
            this.colNettoStorno.VisibleIndex = 0;
            this.colNettoStorno.Width = 48;
            // 
            // repositoryItemCheckEdit1
            // 
            this.repositoryItemCheckEdit1.AutoHeight = false;
            this.repositoryItemCheckEdit1.Name = "repositoryItemCheckEdit1";
            // 
            // colPersonBetrag
            // 
            this.colPersonBetrag.Caption = "Betrag";
            this.colPersonBetrag.FieldName = "Betrag";
            this.colPersonBetrag.Name = "colPersonBetrag";
            this.colPersonBetrag.OptionsColumn.AllowEdit = false;
            this.colPersonBetrag.Visible = true;
            this.colPersonBetrag.VisibleIndex = 3;
            // 
            // colPersonBuchungstext
            // 
            this.colPersonBuchungstext.Caption = "Buchungstext";
            this.colPersonBuchungstext.FieldName = "Buchungstext";
            this.colPersonBuchungstext.Name = "colPersonBuchungstext";
            this.colPersonBuchungstext.OptionsColumn.AllowEdit = false;
            this.colPersonBuchungstext.Visible = true;
            this.colPersonBuchungstext.VisibleIndex = 1;
            this.colPersonBuchungstext.Width = 309;
            // 
            // colPersonVerwPeriodeBis
            // 
            this.colPersonVerwPeriodeBis.Caption = "Verw.bis";
            this.colPersonVerwPeriodeBis.FieldName = "VerwPeriodeBis";
            this.colPersonVerwPeriodeBis.Name = "colPersonVerwPeriodeBis";
            this.colPersonVerwPeriodeBis.OptionsColumn.AllowEdit = false;
            this.colPersonVerwPeriodeBis.Visible = true;
            this.colPersonVerwPeriodeBis.VisibleIndex = 5;
            this.colPersonVerwPeriodeBis.Width = 78;
            // 
            // colPersonVerwPeriodeVon
            // 
            this.colPersonVerwPeriodeVon.Caption = "Verw.von";
            this.colPersonVerwPeriodeVon.FieldName = "VerwPeriodeVon";
            this.colPersonVerwPeriodeVon.Name = "colPersonVerwPeriodeVon";
            this.colPersonVerwPeriodeVon.OptionsColumn.AllowEdit = false;
            this.colPersonVerwPeriodeVon.Visible = true;
            this.colPersonVerwPeriodeVon.VisibleIndex = 4;
            this.colPersonVerwPeriodeVon.Width = 77;
            // 
            // colSA
            // 
            this.colSA.Caption = "SA";
            this.colSA.FieldName = "SA";
            this.colSA.Name = "colSA";
            this.colSA.OptionsColumn.AllowEdit = false;
            this.colSA.Visible = true;
            this.colSA.VisibleIndex = 12;
            this.colSA.Width = 37;
            // 
            // colStorniertVon
            // 
            this.colStorniertVon.Caption = "Storniert von";
            this.colStorniertVon.FieldName = "StornierungVermerktUser";
            this.colStorniertVon.Name = "colStorniertVon";
            this.colStorniertVon.OptionsColumn.AllowEdit = false;
            this.colStorniertVon.Visible = true;
            this.colStorniertVon.VisibleIndex = 15;
            // 
            // colSZ
            // 
            this.colSZ.Caption = "SZ";
            this.colSZ.FieldName = "SZ";
            this.colSZ.Name = "colSZ";
            this.colSZ.OptionsColumn.AllowEdit = false;
            this.colSZ.Visible = true;
            this.colSZ.VisibleIndex = 14;
            this.colSZ.Width = 44;
            // 
            // colTeam
            // 
            this.colTeam.Caption = "Team";
            this.colTeam.FieldName = "Team";
            this.colTeam.Name = "colTeam";
            this.colTeam.OptionsColumn.AllowEdit = false;
            this.colTeam.Visible = true;
            this.colTeam.VisibleIndex = 13;
            this.colTeam.Width = 50;
            // 
            // colVerwPeriodeBis
            // 
            this.colVerwPeriodeBis.Caption = "Verw.bis";
            this.colVerwPeriodeBis.FieldName = "VerwPeriodeBis";
            this.colVerwPeriodeBis.Name = "colVerwPeriodeBis";
            this.colVerwPeriodeBis.OptionsColumn.AllowEdit = false;
            this.colVerwPeriodeBis.Visible = true;
            this.colVerwPeriodeBis.VisibleIndex = 10;
            this.colVerwPeriodeBis.Width = 69;
            // 
            // colVerwPeriodeVon
            // 
            this.colVerwPeriodeVon.Caption = "Verw.von";
            this.colVerwPeriodeVon.FieldName = "VerwPeriodeVon";
            this.colVerwPeriodeVon.Name = "colVerwPeriodeVon";
            this.colVerwPeriodeVon.OptionsColumn.AllowEdit = false;
            this.colVerwPeriodeVon.Visible = true;
            this.colVerwPeriodeVon.VisibleIndex = 9;
            this.colVerwPeriodeVon.Width = 68;
            // 
            // grvKbBuchungKostenartSuche
            // 
            this.grvKbBuchungKostenartSuche.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvKbBuchungKostenartSuche.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungKostenartSuche.Appearance.Empty.Options.UseBackColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.Empty.Options.UseFont = true;
            this.grvKbBuchungKostenartSuche.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungKostenartSuche.Appearance.EvenRow.Options.UseFont = true;
            this.grvKbBuchungKostenartSuche.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvKbBuchungKostenartSuche.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungKostenartSuche.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvKbBuchungKostenartSuche.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.FocusedCell.Options.UseFont = true;
            this.grvKbBuchungKostenartSuche.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvKbBuchungKostenartSuche.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungKostenartSuche.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvKbBuchungKostenartSuche.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.FocusedRow.Options.UseFont = true;
            this.grvKbBuchungKostenartSuche.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvKbBuchungKostenartSuche.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvKbBuchungKostenartSuche.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungKostenartSuche.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvKbBuchungKostenartSuche.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.GroupRow.Options.UseFont = true;
            this.grvKbBuchungKostenartSuche.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvKbBuchungKostenartSuche.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvKbBuchungKostenartSuche.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungKostenartSuche.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvKbBuchungKostenartSuche.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvKbBuchungKostenartSuche.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungKostenartSuche.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvKbBuchungKostenartSuche.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvKbBuchungKostenartSuche.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvKbBuchungKostenartSuche.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungKostenartSuche.Appearance.OddRow.Options.UseFont = true;
            this.grvKbBuchungKostenartSuche.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvKbBuchungKostenartSuche.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungKostenartSuche.Appearance.Row.Options.UseBackColor = true;
            this.grvKbBuchungKostenartSuche.Appearance.Row.Options.UseFont = true;
            this.grvKbBuchungKostenartSuche.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungKostenartSuche.Appearance.SelectedRow.Options.UseFont = true;
            this.grvKbBuchungKostenartSuche.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvKbBuchungKostenartSuche.Appearance.VertLine.Options.UseBackColor = true;
            this.grvKbBuchungKostenartSuche.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvKbBuchungKostenartSuche.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colBetrifft,
            this.colPersonBuchungstext,
            this.colMasterBudget,
            this.colPersonBetrag,
            this.colPersonVerwPeriodeVon,
            this.colPersonVerwPeriodeBis,
            this.colKbBuchungBruttoID});
            this.grvKbBuchungKostenartSuche.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvKbBuchungKostenartSuche.GridControl = this.grdQuery1;
            this.grvKbBuchungKostenartSuche.Name = "grvKbBuchungKostenartSuche";
            this.grvKbBuchungKostenartSuche.OptionsBehavior.Editable = false;
            this.grvKbBuchungKostenartSuche.OptionsCustomization.AllowFilter = false;
            this.grvKbBuchungKostenartSuche.OptionsDetail.ShowDetailTabs = false;
            this.grvKbBuchungKostenartSuche.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvKbBuchungKostenartSuche.OptionsNavigation.AutoFocusNewRow = true;
            this.grvKbBuchungKostenartSuche.OptionsNavigation.UseTabKey = false;
            this.grvKbBuchungKostenartSuche.OptionsView.ColumnAutoWidth = false;
            this.grvKbBuchungKostenartSuche.OptionsView.ShowChildrenInGroupPanel = true;
            this.grvKbBuchungKostenartSuche.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvKbBuchungKostenartSuche.OptionsView.ShowGroupPanel = false;
            this.grvKbBuchungKostenartSuche.OptionsView.ShowIndicator = false;
            // 
            // grvKbBuchungSuche
            // 
            this.grvKbBuchungSuche.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvKbBuchungSuche.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungSuche.Appearance.Empty.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.Empty.Options.UseFont = true;
            this.grvKbBuchungSuche.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.grvKbBuchungSuche.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungSuche.Appearance.EvenRow.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.EvenRow.Options.UseFont = true;
            this.grvKbBuchungSuche.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvKbBuchungSuche.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungSuche.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvKbBuchungSuche.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.FocusedCell.Options.UseFont = true;
            this.grvKbBuchungSuche.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvKbBuchungSuche.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvKbBuchungSuche.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungSuche.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvKbBuchungSuche.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.FocusedRow.Options.UseFont = true;
            this.grvKbBuchungSuche.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvKbBuchungSuche.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvKbBuchungSuche.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvKbBuchungSuche.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungSuche.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvKbBuchungSuche.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.GroupRow.Options.UseFont = true;
            this.grvKbBuchungSuche.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvKbBuchungSuche.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvKbBuchungSuche.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvKbBuchungSuche.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungSuche.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvKbBuchungSuche.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvKbBuchungSuche.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvKbBuchungSuche.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungSuche.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvKbBuchungSuche.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvKbBuchungSuche.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvKbBuchungSuche.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvKbBuchungSuche.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungSuche.Appearance.OddRow.Options.UseFont = true;
            this.grvKbBuchungSuche.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvKbBuchungSuche.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungSuche.Appearance.Row.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.Row.Options.UseFont = true;
            this.grvKbBuchungSuche.Appearance.SelectedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.grvKbBuchungSuche.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbBuchungSuche.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.grvKbBuchungSuche.Appearance.SelectedRow.Options.UseBackColor = true;
            this.grvKbBuchungSuche.Appearance.SelectedRow.Options.UseFont = true;
            this.grvKbBuchungSuche.Appearance.SelectedRow.Options.UseForeColor = true;
            this.grvKbBuchungSuche.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvKbBuchungSuche.Appearance.VertLine.Options.UseBackColor = true;
            this.grvKbBuchungSuche.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvKbBuchungSuche.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colFaFallID,
            this.colNameVorname,
            this.colBetrag,
            this.colKbBuchungStatusCode,
            this.colBuchungstext,
            this.colFaelligDatum,
            this.colVerwPeriodeVon,
            this.colNettoID,
            this.colVerwPeriodeBis,
            this.colSA,
            this.colTeam,
            this.colSZ,
            this.colNettoStorno,
            this.colFehlermeldung,
            this.colStorniertVon,
            this.colNettoPSCDNr,
            this.colStornoFehler});
            this.grvKbBuchungSuche.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvKbBuchungSuche.GridControl = this.grdQuery1;
            this.grvKbBuchungSuche.Name = "grvKbBuchungSuche";
            this.grvKbBuchungSuche.OptionsDetail.ShowDetailTabs = false;
            this.grvKbBuchungSuche.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvKbBuchungSuche.OptionsNavigation.AutoFocusNewRow = true;
            this.grvKbBuchungSuche.OptionsNavigation.UseTabKey = false;
            this.grvKbBuchungSuche.OptionsView.ColumnAutoWidth = false;
            this.grvKbBuchungSuche.OptionsView.ShowChildrenInGroupPanel = true;
            this.grvKbBuchungSuche.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvKbBuchungSuche.OptionsView.ShowGroupPanel = false;
            this.grvKbBuchungSuche.OptionsView.ShowIndicator = false;
            this.grvKbBuchungSuche.CellValueChanging += new DevExpress.XtraGrid.Views.Base.CellValueChangedEventHandler(this.grvKbBuchungSuche_CellValueChanging);
            this.grvKbBuchungSuche.CustomRowCellEdit += new DevExpress.XtraGrid.Views.Grid.CustomRowCellEditEventHandler(this.grvKbBuchungSuche_CustomRowCellEdit);
            // 
            // colStornoFehler
            // 
            this.colStornoFehler.Caption = "Fehler";
            this.colStornoFehler.FieldName = "StornoFehler";
            this.colStornoFehler.Name = "colStornoFehler";
            this.colStornoFehler.OptionsColumn.AllowEdit = false;
            this.colStornoFehler.Visible = true;
            this.colStornoFehler.VisibleIndex = 1;
            this.colStornoFehler.Width = 48;
            // 
            // repositoryItemCheckEdit3
            // 
            this.repositoryItemCheckEdit3.AutoHeight = false;
            this.repositoryItemCheckEdit3.Name = "repositoryItemCheckEdit3";
            // 
            // chkMitFehler
            // 
            this.chkMitFehler.EditValue = false;
            this.chkMitFehler.Location = new System.Drawing.Point(8, 286);
            this.chkMitFehler.Name = "chkMitFehler";
            this.chkMitFehler.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.chkMitFehler.Properties.Appearance.Options.UseBackColor = true;
            this.chkMitFehler.Properties.Caption = "inkl. Belege mit Stornofehler";
            this.chkMitFehler.Size = new System.Drawing.Size(242, 19);
            this.chkMitFehler.TabIndex = 35;
            // 
            // chkNettoStatus3
            // 
            this.chkNettoStatus3.EditValue = true;
            this.chkNettoStatus3.Location = new System.Drawing.Point(8, 337);
            this.chkNettoStatus3.Name = "chkNettoStatus3";
            this.chkNettoStatus3.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.chkNettoStatus3.Properties.Appearance.Options.UseBackColor = true;
            this.chkNettoStatus3.Properties.Caption = "Inkl. übermittelte Belege (gelber Pfeil)";
            this.chkNettoStatus3.Size = new System.Drawing.Size(242, 19);
            this.chkNettoStatus3.TabIndex = 37;
            this.chkNettoStatus3.CheckedChanged += new System.EventHandler(this.chkNettoStatus3_CheckedChanged);
            // 
            // chkNettoStatus7
            // 
            this.chkNettoStatus7.EditValue = false;
            this.chkNettoStatus7.Location = new System.Drawing.Point(8, 362);
            this.chkNettoStatus7.Name = "chkNettoStatus7";
            this.chkNettoStatus7.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.chkNettoStatus7.Properties.Appearance.Options.UseBackColor = true;
            this.chkNettoStatus7.Properties.Caption = "Inkl. gesperrter Belege (rotes Ausrufezeichen)";
            this.chkNettoStatus7.Size = new System.Drawing.Size(267, 19);
            this.chkNettoStatus7.TabIndex = 38;
            this.chkNettoStatus7.CheckedChanged += new System.EventHandler(this.chkNettoStatus7_CheckedChanged);
            // 
            // edtKategorie
            // 
            this.edtKategorie.EditValue = 2;
            this.edtKategorie.Location = new System.Drawing.Point(362, 337);
            this.edtKategorie.Name = "edtKategorie";
            this.edtKategorie.Properties.Appearance.BackColor = System.Drawing.Color.Transparent;
            this.edtKategorie.Properties.Appearance.Options.UseBackColor = true;
            this.edtKategorie.Properties.AppearanceDisabled.BackColor = System.Drawing.Color.Transparent;
            this.edtKategorie.Properties.AppearanceDisabled.Options.UseBackColor = true;
            this.edtKategorie.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.NoBorder;
            this.edtKategorie.Properties.Items.AddRange(new DevExpress.XtraEditors.Controls.RadioGroupItem[] {
            new DevExpress.XtraEditors.Controls.RadioGroupItem(1, "Barbelege"),
            new DevExpress.XtraEditors.Controls.RadioGroupItem(2, "Sollstellungen (Debitoren)"),
            new DevExpress.XtraEditors.Controls.RadioGroupItem(3, "Bankrückläufer"),
            new DevExpress.XtraEditors.Controls.RadioGroupItem(4, "Alle gesperrten Belege älter als 60 Tage")});
            this.edtKategorie.Size = new System.Drawing.Size(224, 79);
            this.edtKategorie.TabIndex = 39;
            // 
            // CtlKbStorno
            // 
            this.Name = "CtlKbStorno";
            this.Load += new System.EventHandler(this.CtlKbStorno_Load);
            ((System.ComponentModel.ISupportInitialize)(this.qryQuery)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvQuery1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdQuery1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.xDocument.Properties)).EndInit();
            this.tabControlSearch.ResumeLayout(false);
            this.tpgListe.ResumeLayout(false);
            this.tpgSuchen.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblNettoBelege)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grdBrutto)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryBrutto)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gridView1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemImageComboBox2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit4)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtStornoDatum.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblStornoDatum)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSucheValuta)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheValutaDatumVon.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheValutaDatumBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSucheFallNr)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheFallNr.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSucheBetrifftPerson)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheLT.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSuchePersonNr)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSuchePersonNr.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSucheLA)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheBgKostenartID.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblSucheBelegNr)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.kissLabel4)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtSucheBelegNr.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.chkSuchInklInaktiveW.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.chkSucheNurStornierte.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemImageComboBox1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvKbBuchungKostenartSuche)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvKbBuchungSuche)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit3)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.chkMitFehler.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.chkNettoStatus3.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.chkNettoStatus7.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKategorie.Properties)).EndInit();
            this.ResumeLayout(false);
            this.PerformLayout();

        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Public Methods

        public override void OnSearch()
        {
            if (tabControlSearch.SelectedTab == tpgSuchen)
            {
                foreach (Control ctl in UtilsGui.AllControls(tpgSuchen))
                {
                    if (ctl is KissButtonEdit)
                    {
                        KissButtonEdit edt = (KissButtonEdit)ctl;
                        edt.CheckPendingSearchValue();
                    }

                    if (ctl is CtlOrgUnitTeamUser)
                    {
                        ((CtlOrgUnitTeamUser)ctl).CheckPendingSearchValue();
                    }
                }
            }

            grdQuery1.View.ClearColumnsFilter();
            grdBrutto.View.ClearColumnsFilter();

            // Workaround um F3 weiter zu reichen, da das FrameWork das OrgUnitTeamUser UserControl nicht kennt
            try
            {
                if (((ContainerControl)ActiveControl).ActiveControl.Equals(ctlOrgUnitTeamUser))
                    edtSucheLT.Focus();
            }
            catch
            {
            }

            if (edtSucheValutaDatumVon.DateTime > edtSucheValutaDatumBis.DateTime)
            {
                KissMsg.ShowInfo("'Fälligkeit/Valuta von' kann nicht nach 'Fälligkeit/Valuta bis' sein");
                return;
            }

            base.OnSearch();
        }

        #endregion

        #region Protected Methods

        protected override void NewSearch()
        {
            base.NewSearch();
            ctlOrgUnitTeamUser.NewSearch();
        }

        #endregion

        #region Private Methods

        private void AskToSave()
        {
            // Zuerst nachfragen, ob die Storno-Selektion gespeichert werden soll
            if (KissMsg.ShowQuestion("Wollen Sie die selektierten Buchungen für die Stornierung speichern? Diese Buchungen werden dann im nächsten Storno-Lauf definitiv storniert. In der Zwischenzeit können Sie die Storno-Selektion jederzeit wieder ändern."))
            {
                SaveStornoSelektion();
            }
        }

        private void CtlKbStorno_Load(object sender, System.EventArgs e)
        {
            //Buchungsstati laden
            repositoryItemImageComboBox1.SmallImages = KissImageList.SmallImageList;
            repositoryItemImageComboBox2.SmallImages = KissImageList.SmallImageList;

            SqlQuery qryStati = DBUtil.OpenSQL("select * from XLOVCode where LOVName = 'KbBuchungsStatus' order by SortKey");
            foreach (DataRow row in qryStati.DataTable.Rows)
            {
                repositoryItemImageComboBox1.Items.Add(new DevExpress.XtraEditors.Controls.ImageComboBoxItem(
                    row["Text"].ToString(),
                    (int)row["Code"],
                    KissImageList.GetImageIndex(Convert.ToInt32(row["Value1"]))));

                repositoryItemImageComboBox2.Items.Add(new DevExpress.XtraEditors.Controls.ImageComboBoxItem(
                    row["Text"].ToString(),
                    (int)row["Code"],
                    KissImageList.GetImageIndex(Convert.ToInt32(row["Value1"]))));

            }

            bool rechtStornoAlleBelegtypen = DBUtil.UserHasRight("CtlKbStorno_StornoAlleBelegtypen");
            bool rechtStornoAusfuehren = DBUtil.UserHasRight("CtlKbStorno_StornoAusfuehren");

            // Wenn der Benutzer nicht alle LAs stornieren darf, dann schränken wir hier auf die Hardcodierte Liste ein
            if (!rechtStornoAlleBelegtypen)
            {
                // Der Benutzer kann nicht alle Belegtypen stornieren, d.h. dies ist ein Benutzer, der nur Sollstellungen stornieren kann, d.h. wir lassen auch nicht alle LAs zu
                m_HiddenLAs = "AND ({0} < 810 OR ({0} > 819 AND {0} < 860) OR ({0} > 862 AND {0} < 989) OR {0} > 992)";
            }

            btnAlle.Visible = rechtStornoAusfuehren;
            edtStornoDatum.Visible = rechtStornoAusfuehren;
            lblStornoDatum.Visible = rechtStornoAusfuehren;
            btnTransferStorno.Visible = rechtStornoAusfuehren;

            edtKategorie.Visible = rechtStornoAlleBelegtypen;
            edtKategorie.EditValue = 2;	// Per default sind die Sollstellungen gewählt, das ist auch der richtige Default für Sozis, die nur Sollstellungen stornieren dürfen

            btnKeine.Visible = rechtStornoAlleBelegtypen;

            if (rechtStornoAlleBelegtypen)
            {
                searchTitle.Text = "Suche stornierbare Belege (Sollstellungen oder Barbelege)";
            }
            else
            {
                searchTitle.Text = "Suche stornierbare Sollstellungen (Debitoren)";
            }
            colNettoStorno.OptionsColumn.AllowEdit = true;
            colBruttoStorno.OptionsColumn.AllowEdit = true;

            edtStornoDatum.EditValue = new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1);	// Erster Tag des aktuellen Monats

            // Verstecke die privaten und nicht benötigten Parent-Controls, die sonst sehr unschön unsere Controls überdecken würden
            ShowParentControl("chkShowGroupPanel", false);
            ShowParentControl("chkMultilineSelect", false);
            ShowParentControl("lblAmount", false);
            ShowParentControl("lblRowCount1", false);

            // Setze die SQL Statements für die beiden Queries (Für Netto- und Brutto-Suche)
            SetSQLStatements();

            NewSearch();
        }

        private void ProgressEnd()
        {
            qryQuery.Refresh();
            qryBrutto.Refresh();
        }

        private void ProgressStart()
        {
            int successCount = 0;
            int failureCount = 0;
            int count = 1;
            bool lastLineUpdateable = false;

            try
            {
                Cursor = Cursors.WaitCursor;

                DlgProgressLog.AddLine("Start der Übertragung");

                // StornoDatum
                DateTime stornoDatum = edtStornoDatum.DateTime;

                foreach (System.Data.DataRow row in qryQuery.DataTable.Rows)
                {
                    if (!DBUtil.IsEmpty(row["Storno"]) && (bool)row["Storno"])
                    {
                        string UserText = string.Format("Beleg {0}/{1} Nettobeleg {2}: {3} ; CHF {4:N2} ", count, m_SelectedBelegCount, row["KBBuchungID"], row["NameVorname"], row["Betrag"]);

                        if (lastLineUpdateable)
                        {
                            DlgProgressLog.UpdateLastLine(UserText + ": stornieren ... ");
                        }
                        else
                        {
                            DlgProgressLog.AddLine(UserText + ": stornieren ... ");
                            lastLineUpdateable = true;
                        }
                        // alle 10 Zeilen die Belegzeile stehen lassen (für Fortschrittshistory)
                        if (count % 10 == 0)
                            lastLineUpdateable = false;

                        try
                        {
                            KiSS4.FAMOZ.PSCDServices.PSCDInterface.StornoNettoBelege(new int[] { (int)row["KbBuchungID"] }, stornoDatum);
                            successCount++;
                        }
                        catch (Exception ex)
                        {
                            if (lastLineUpdateable)
                                DlgProgressLog.UpdateLastLine(ex.Message);
                            else
                                DlgProgressLog.AddLine(ex.Message);

                            lastLineUpdateable = false;
                            failureCount++;

                            string truncatedMessage = ex.Message == null ? ex.Message : ex.Message.Substring(0, Math.Min(300, ex.Message.Length));
                            // Speichere die Fehlermeldung
                            DBUtil.ExecSQL("UPDATE KbBuchungStorno SET StornoFehlermeldung = {0} WHERE KbBuchungID = {1} AND StornoFehlermeldung IS NULL", truncatedMessage, row["KbBuchungID"]);
                        }
                        count++;
                    }
                }

                DlgProgressLog.AddLine("Ende des Stornolaufs");
                DlgProgressLog.AddLine(string.Format("- {0} Nettobeleg(e) erfolgreich storniert", successCount));
                DlgProgressLog.AddLine(string.Format("- {0} Nettobeleg(e) konnten nicht storniert werden", failureCount));
            }
            catch (CancelledByUserException)
            {
                KissMsg.ShowInfo("Abbruch durch Benutzer/in\r\n\r\n" +
                                 string.Format("- {0} Nettobeleg(e) erfolgreich storniert", successCount) + "\r\n" +
                                 string.Format("- {0} Nettobeleg(e) konnten nicht storniert werden", failureCount));

            }
            finally
            {
                Cursor = Cursors.Default;
                DlgProgressLog.EndProgress();
                DlgProgressLog.ShowTopMost();
            }
        }

        private bool SaveStornoSelektion()
        {
            try
            {
                Cursor = Cursors.WaitCursor;

                // Generiere einen konkatinierten String mit allen IDs der selektierten und nicht-selektierten Belege
                List<int> selektierteIDsList = new List<int>();
                List<int> nichtSelektierteIDsList = new List<int>();
                string selektierteIDs = "";
                string nichtSelektierteIDS = "";
                int updateBlockSize = 500;
                m_SelectedBelegCount = 0;

                Session.BeginTransaction();

                foreach (DataRow R in qryQuery.DataTable.Rows)
                {
                    if (!DBUtil.IsEmpty(R["Storno"]))
                    {
                        int ID = (int)R["KbBuchungID"];

                        if ((bool)R["Storno"])
                        {
                            selektierteIDsList.Add(ID);
                            m_SelectedBelegCount++;
                        }
                        else
                        {
                            nichtSelektierteIDsList.Add(ID);
                        }
                    }
                }

                if (nichtSelektierteIDsList.Count > 0)
                {
                    // Lösche alle nicht selektierten aus der Storno-Tabelle. Damit dies auch mit grossen Mengen von IDs klappt, machen wir das in Chunks (nicht alle miteinander, sondern in Blöcken)
                    nichtSelektierteIDS = "";
                    for (int i = 0; i < nichtSelektierteIDsList.Count; i++)
                    {
                        string IDString = nichtSelektierteIDsList[i].ToString();
                        nichtSelektierteIDS = string.IsNullOrEmpty(nichtSelektierteIDS) ? IDString : nichtSelektierteIDS + ", " + IDString;

                        if ((i > 0 && (i % updateBlockSize) == 0) || i == nichtSelektierteIDsList.Count - 1)
                        {
                            // So, entweder ist wieder ein Chunk parat, oder wir sind am Ende der Liste

                            // Lösche nicht selektierte in der Storno-Tabelle  (falls vorhanden)
                            DB.DBUtil.ExecSQLThrowingException(@"
                            DELETE FROM dbo.KbBuchungStorno
                            WHERE KbBuchungID IN
                            (
                                SELECT KbBuchungID FROM dbo.KbBuchungStorno
                                WHERE StornoDatum IS NULL AND StornoFehlermeldung IS NULL
                                AND KbBuchungID IN (" + nichtSelektierteIDS + @")
                            )
                            ");

                            nichtSelektierteIDS = "";
                        }
                    }
                }

                if (selektierteIDsList.Count > 0)
                {
                    // Füge alle selektierten zu der Storno-Tabelle. Damit dies auch mit grossen Mengen von IDs klappt, machen wir das in Chunks (nicht alle miteinander, sondern in Blöcken)
                    selektierteIDs = "";
                    for (int i = 0; i < selektierteIDsList.Count; i++)
                    {
                        string IDString = selektierteIDsList[i].ToString();
                        selektierteIDs = string.IsNullOrEmpty(selektierteIDs) ? IDString : selektierteIDs + ", " + IDString;

                        if ((i > 0 && (i % updateBlockSize) == 0) || i == selektierteIDsList.Count - 1)
                        {
                            // So, entweder ist wieder ein Chunk parat, oder wir sind am Ende der Liste

                            // Füge selektierte zu der Storno-Tabelle  (falls sie nicht schon existieren)
                            DB.DBUtil.ExecSQLThrowingException(@"
                            INSERT INTO dbo.KbBuchungStorno
                            (KbBuchungID, StornierungVermerktUserID, StornierungVermerktDatum)
                            (
                                SELECT BUC.KbBuchungID, {0}, {1} FROM dbo.KbBuchung BUC
                                    LEFT JOIN dbo.KbBuchungStorno STO ON STO.KbBuchungID = BUC.KbBuchungID
                                WHERE BUC.KbBuchungID IN (" + selektierteIDs + @")
                                        AND STO.KbBuchungID IS NULL		-- Es gibt noch keine Storno-Eintrag für diesen Beleg
                            )
                            ", Session.User.UserID, DateTime.Now);

                            selektierteIDs = "";
                        }
                    }
                }
                Session.Commit();

                // Success-Meldung
                KissMsg.ShowInfo("Selektion erfolgreich gespeichert.");

                // Die Selektion ist gespeichert
                btnSaveStorno.Enabled = false;

                return true;
            }
            catch (Exception ex)
            {
                if (Session.Transaction != null)
                {
                    Session.Rollback();
                }

                KissMsg.ShowError("Es ist ein Fehler aufgetreten. Bitte versuchen Sie es noch einmal. Fehlermeldung: " + ex.Message);
            }
            finally
            {
                if (Session.Transaction != null)
                {
                    Session.Rollback();
                }

                Cursor = Cursors.Default;
            }

            return false;
        }

        private bool SelectDependendRows(SqlQuery qryNettoBuchungen, SqlQuery qryBruttoBuchungen, bool stornoChecked, ref string errorMsg)
        {
            bool success = true;

            // Wir prüfen nur, wenn der Benutzer die Buchung anklickt. Wenn er sie deselektiert, interessiert uns diese Prüfung nicht
            if (stornoChecked)
            {
                foreach (DataRow rowNetto in qryNettoBuchungen.DataTable.Rows)
                {
                    string kbBuchungID = ((int)rowNetto["KbBuchungID"]).ToString();

                    // Prüfe diese Netto-Buchung, ob sie noch storniert werden kann (mit der Stored Proc spKbBuchung_StornoCheck())
                    try
                    {
                        // Zuerst erstelle den KbBuchungStorno-Eintrag, falls noch keiner existiert
                        if (DBUtil.IsEmpty(rowNetto["KbBuchungStornoID"]))
                        {
                            DB.DBUtil.ExecSQLThrowingException(@"
                                    IF NOT EXISTS(SELECT KbBuchungID FROM KbBuchungStorno WHERE KbBuchungID = {0}) BEGIN
                                        INSERT INTO dbo.KbBuchungStorno 
                                            (KbBuchungID, StornierungVermerktUserID, StornierungVermerktDatum)
                                        VALUES
                                            ({0}, {1}, GetDate())
                                    END", kbBuchungID, Session.User.UserID);
                        }

                        // Dann prüfe, ob der Storno machbar ist
                        DB.DBUtil.ExecSQLThrowingException(@"                         
                                    EXEC dbo.spKbBuchung_StornoCheck {0}", kbBuchungID);
                    }
                    catch (Exception ex)
                    {
                        try
                        {
                            // Storno ist nicht machbar, speichere die Fehlermeldung
                            DB.DBUtil.ExecSQLThrowingException("UPDATE KbBuchungStorno SET StornoFehlermeldung = {0} WHERE KbBuchungID = {1}", ex.Message, kbBuchungID);
                        }
                        catch (Exception ex2)
                        {
                            // Wenn dies schiefgeht, dann zeigen wir die Fehlermeldung an
                            KissMsg.ShowError("Fehler bei der Überprüfen der Stornierbarkeit von Netto-Beleg " + kbBuchungID, ex2);
                        }

                        errorMsg = ex.Message;
                        success = false;
                    }
                }
            }

            if (!success)
            {
                // Ok, wenn wir hierhin kommen, dann kann der Storno nicht durchgeführt werden
                // => d.h. markiere nun alle Netto- und Brutto-Belege als Storno-Fehler
                if (qryNettoBuchungen.DataTable.Rows.Count > 0)
                {
                    foreach (DataRow rowNetto in qryNettoBuchungen.DataTable.Rows)
                    {
                        foreach (DataRow row in qryQuery.DataTable.Rows)
                        {
                            if ((int)row["KbBuchungID"] == (int)rowNetto["KbBuchungID"])
                            {
                                row["StornoFehler"] = "F";
                                break;
                            }
                        }
                    }
                }

                if (qryBruttoBuchungen.DataTable.Rows.Count > 0)
                {
                    foreach (DataRow rowBrutto in qryBruttoBuchungen.DataTable.Rows)
                    {
                        foreach (DataRow row in qryBrutto.DataTable.Rows)
                        {
                            if ((int)row["KbBuchungBruttoID"] == (int)rowBrutto["KbBuchungBruttoID"])
                            {
                                row["StornoFehler"] = "F";
                                break;
                            }
                        }
                    }
                }
                return false;
            }

            // Ok, wenn wir hierhin kommen, wurde entweder deselektiert, oder aber alle Netto- und Brutto-Belege sind stornierbar
            // => d.h. selektiere nun alle Netto- und Brutto-Belege, die in der aktuellen Ansicht gefunden werden
            if (qryNettoBuchungen.DataTable.Rows.Count > 0)
            {
                foreach (DataRow rowNetto in qryNettoBuchungen.DataTable.Rows)
                {
                    foreach (DataRow row in qryQuery.DataTable.Rows)
                    {
                        if ((int)row["KbBuchungID"] == (int)rowNetto["KbBuchungID"])
                        {
                            row["Storno"] = stornoChecked;
                            break;
                        }
                    }
                }
            }

            if (qryBruttoBuchungen.DataTable.Rows.Count > 0)
            {
                foreach (DataRow rowBrutto in qryBruttoBuchungen.DataTable.Rows)
                {
                    foreach (DataRow row in qryBrutto.DataTable.Rows)
                    {
                        if ((int)row["KbBuchungBruttoID"] == (int)rowBrutto["KbBuchungBruttoID"])
                        {
                            row["Storno"] = stornoChecked;
                            break;
                        }
                    }
                }
            }

            // Die Selektion hat geändert
            btnSaveStorno.Enabled = true;

            return true;
        }

        private bool SelectDependendRowsByBruttoID(int kbBuchungBruttoID, bool stornoChecked, ref string errorMsg)
        {
            // Finde alle Netto-Buchungen zu der selektierten Brutto-Buchung
            SqlQuery qryNettoBuchungen = DBUtil.OpenSQL(@"
                SELECT Distinct KBU.KbBuchungID, KBU.BelegNr, STO.KbBuchungStornoID
                  FROM dbo.KbBuchungBrutto KBB WITH (READUNCOMMITTED)
                    INNER JOIN dbo.KbBuchungBruttoPerson KBP WITH (READUNCOMMITTED) ON KBP.KbBuchungBruttoID = KBB.KbBuchungBruttoID
                    INNER JOIN dbo.KbBuchungKostenart    KBK WITH (READUNCOMMITTED) ON KBK.BgPositionID      = KBP.BgPositionID
                    INNER JOIN dbo.KbBuchung             KBU WITH (READUNCOMMITTED) ON KBU.KbBuchungID       = KBK.KbBuchungID
                    LEFT JOIN  dbo.KbBuchungStorno       STO WITH (READUNCOMMITTED) ON STO.KbBuchungID       = KBU.KbBuchungID
                WHERE
                    KBB.KbBuchungBruttoID = " + kbBuchungBruttoID);

            // Finde alle Brutto-Buchungen zu der selektierten Brutto-Buchung (und allen abhängigen Netto-Buchungen)
            SqlQuery qryBruttoBuchungen = DBUtil.OpenSQL(@"
                SELECT Distinct KBBALL.KbBuchungBruttoID, KBBALL.BelegNr
                FROM dbo.KbBuchungBrutto KBB WITH (READUNCOMMITTED)
                    INNER JOIN dbo.KbBuchungBruttoPerson KBP1 WITH (READUNCOMMITTED) ON KBP1.KbBuchungBruttoID 		= KBB.KbBuchungBruttoID
                    INNER JOIN dbo.KbBuchungKostenart    KBK1 WITH (READUNCOMMITTED) ON KBK1.BgPositionID      		= KBP1.BgPositionID
                    INNER JOIN dbo.KbBuchungKostenart    KBK2 WITH (READUNCOMMITTED) ON KBK2.BgPositionID      		= KBK1.BgPositionID
                    INNER JOIN dbo.KbBuchungKostenart    KBK3 WITH (READUNCOMMITTED) ON KBK3.KbBuchungID      		= KBK2.KbBuchungID
                    INNER JOIN dbo.KbBuchungBruttoPerson KBP2 WITH (READUNCOMMITTED) ON KBP2.BgPositionID      		= KBK3.BgPositionID
                    INNER JOIN dbo.KbBuchungBrutto       KBBALL WITH (READUNCOMMITTED) ON KBBALL.KbBuchungBruttoID 	= KBP2.KbBuchungBruttoID
                WHERE
                    KBB.KbBuchungBruttoID = " + kbBuchungBruttoID);

            return SelectDependendRows(qryNettoBuchungen, qryBruttoBuchungen, stornoChecked, ref errorMsg);
        }

        private bool SelectDependendRowsByNettoID(int kbBuchungID, bool stornoChecked, ref string errorMsg)
        {
            // Finde alle Netto-Buchungen zu der selektierten Netto-Buchung
            SqlQuery qryNettoBuchungen = DBUtil.OpenSQL(@"
                SELECT Distinct KBU2.KbBuchungID, KBU2.BelegNr, STO.KbBuchungStornoID
                FROM dbo.KbBuchung KBU1 WITH (READUNCOMMITTED)
                    INNER JOIN dbo.KbBuchungKostenart    KBK1 WITH (READUNCOMMITTED) ON KBK1.KbBuchungID      = KBU1.KbBuchungID
                    INNER JOIN dbo.KbBuchungKostenart    KBK2 WITH (READUNCOMMITTED) ON KBK2.BgPositionID      = KBK1.BgPositionID
                    INNER JOIN dbo.KbBuchung             KBU2 WITH (READUNCOMMITTED) ON KBU2.KbBuchungID       = KBK2.KbBuchungID
                    LEFT JOIN  dbo.KbBuchungStorno       STO  WITH (READUNCOMMITTED) ON STO.KbBuchungID       = KBU2.KbBuchungID
                WHERE
                KBU1.KbBuchungID = " + kbBuchungID);

            // Finde alle Brutto-Buchungen zu der selektierten Netto-Buchung (und allen abhängigen Netto-Buchungen)
            SqlQuery qryBruttoBuchungen = DBUtil.OpenSQL(@"
                SELECT Distinct KBB.KbBuchungBruttoID, KBB.BelegNr
                FROM dbo.KbBuchung KBU1 WITH (READUNCOMMITTED)
                    INNER JOIN dbo.KbBuchungKostenart    KBK1 WITH (READUNCOMMITTED) ON KBK1.KbBuchungID      = KBU1.KbBuchungID
                    INNER JOIN dbo.KbBuchungKostenart    KBK2 WITH (READUNCOMMITTED) ON KBK2.BgPositionID      = KBK1.BgPositionID
                    INNER JOIN dbo.KbBuchung             KBU2 WITH (READUNCOMMITTED) ON KBU2.KbBuchungID       = KBK2.KbBuchungID

                    INNER JOIN dbo.KbBuchungKostenart    KBK WITH (READUNCOMMITTED) ON KBK.KbBuchungID      = KBU2.KbBuchungID
                    INNER JOIN dbo.KbBuchungBruttoPerson KBP WITH (READUNCOMMITTED) ON KBP.BgPositionID      = KBK.BgPositionID
                    INNER JOIN dbo.KbBuchungBrutto       KBB WITH (READUNCOMMITTED) ON KBB.KbBuchungBruttoID       = KBP.KbBuchungBruttoID
                WHERE KBU1.KbBuchungID = " + kbBuchungID);

            return SelectDependendRows(qryNettoBuchungen, qryBruttoBuchungen, stornoChecked, ref errorMsg);
        }

        private void SetSQLStatements()
        {
            int tageRotePosGruenstellbar = DBUtil.GetConfigInt(@"System\Sozialhilfe\TageNachBudgetGruenstellbar", 60);

            // Netto-Belege
            qryQuery.SelectStatement = @"
            DECLARE @OrgGruppeID int
            SET @OrgGruppeID = NULL
            --- SET @OrgGruppeID = {ctlOrgUnitTeamUser.SucheGruppe}

            DECLARE @TeamID int
            SET @TeamID = NULL
            --- SET @TeamID = {ctlOrgUnitTeamUser.SucheTeam}

            SELECT distinct
                    KBBuchungID                 = BUCALL.KBBuchungID,
                    BelegNr                     = BUCALL.BelegNr,
                    BaPersonID                  = PRS1.BaPersonID,
                    FaFallID                    = LEI.FaFallID,
                    NameVorname                 = PRS1.Name + ', ' + PRS1.Vorname,
                    Betrag                      = CASE WHEN KDEB.KbKontoID IS NULL THEN -BUCALL.Betrag ELSE BUCALL.Betrag END,	-- Bei Kreditoren-Beträgen (=Auszahlungen) kehren wir das Vorzeichen der Netto-Buchung, damit Brutto und Netto übereinstimmen
                    Soll                        = BUCALL.SollKtoNr,
                    Haben                       = BUCALL.HabenKtoNr,
                    KbBuchungStatusCode         = BUCALL.KbBuchungStatusCode,
                    Buchungstext                = BUCALL.Text,
                    FaelligDatum                = BUCALL.ValutaDatum,
                    VerwPeriodeVon              = KKACOUNT.VerwPeriodeVon,
                    VerwPeriodeBis              = KKACOUNT.VerwPeriodeBis,
                    SA                          = USR.ShortName + ' (' + USR.NameVorname + ')',
                    Team                        = USR.OrgUnitShort,
                    SZ                          = USR.SozialzentrumKurz,
                    Storno                      = CASE WHEN (KBS.KbBuchungID IS NULL OR KBS.StornoFehlermeldung IS NOT NULL) THEN convert(bit,0) ELSE convert(bit,1) END,
                    StornoFehler                = CASE WHEN KBS.StornoFehlermeldung IS NULL THEN '' ELSE 'F' END,
                    StornierungVermerktUser     = STU.ShortName + ' (' + STU.NameVorname + ')',
                    Fehlermeldung               = KBS.StornoFehlermeldung,
                    BgBudgetID                  = BUD.BgBudgetID
            FROM KbBuchung                                  BUCSEL  -- Dies ist die Buchung, die wir Suchen
                    -- Finde alle Netto-Buchungen, die von der Netto-Buchung BUC abhängig sind (d.h. gleiche Positions-ID haben)
                    INNER JOIN dbo.KbBuchungKostenart       KKASEL WITH (READUNCOMMITTED) ON KKASEL.KbBuchungID		= BUCSEL.KbBuchungID
                    INNER JOIN dbo.KbBuchungKostenart       KKA WITH (READUNCOMMITTED)	  ON KKA.BgPositionID    = KKASEL.BgPositionID
                    INNER JOIN dbo.KbBuchung                BUCALL WITH (READUNCOMMITTED) ON BUCALL.KbBuchungID     = KKA.KbBuchungID	-- Dies sind alle verwandten Buchungen
                    INNER JOIN      (SELECT DISTINCT 
                                        KbBuchungID, 
                                        VerwPeriodeVon = MIN(VerwPeriodeVon), 
                                        VerwPeriodeBis = MAX(VerwPeriodeBis)
                                     FROM KbBuchungKostenart
                                     GROUP BY KbBuchungID)
                                                            KKACOUNT ON KKACOUNT.KbBuchungID = BUCALL.KbBuchungID
                    INNER JOIN dbo.KbBuchungKostenart       KKAALL WITH (READUNCOMMITTED) ON KKAALL.KbBuchungID = BUCALL.KbBuchungID
                    INNER JOIN dbo.BgBudget                 BUD WITH (READUNCOMMITTED) ON BUD.BgBudgetID = BUCALL.BgBudgetID
                    INNER JOIN dbo.BgFinanzplan             BFP WITH (READUNCOMMITTED) ON BFP.BgFinanzplanID = BUD.BgFinanzplanID
                    INNER JOIN dbo.FaLeistung               LEI WITH (READUNCOMMITTED) ON LEI.FaLeistungID = BFP.FaLeistungID
                    INNER JOIN dbo.FaFall                   FAL WITH (READUNCOMMITTED) ON FAL.FaFallID = LEI.FaFallID
                    INNER JOIN dbo.BaPerson                 PRS1 WITH (READUNCOMMITTED) ON PRS1.BaPersonID = FAL.BaPersonID		-- Leistungsträger
                    INNER JOIN dbo.vwUser                   USR WITH (READUNCOMMITTED) ON USR.UserID = LEI.UserID
                    LEFT JOIN dbo.KbBuchungStorno           KBS WITH (READUNCOMMITTED) ON KBS.KbBuchungID = BUCALL.KbBuchungID
                    LEFT JOIN dbo.vwUser                    STU WITH (READUNCOMMITTED) ON STU.UserID = KBS.StornierungVermerktUserID
                    INNER JOIN dbo.KbBuchungBruttoPerson    KBPALL WITH (READUNCOMMITTED) ON KBPALL.BgPositionID		= KKAALL.BgPositionID
                    INNER JOIN dbo.KbBuchungBrutto          KBBALL WITH (READUNCOMMITTED) ON KBBALL.KbBuchungBruttoID = KBPALL.KbBuchungBruttoID
                    INNER JOIN      (SELECT 
                                        KbBuchungBruttoID, 
                                        VerwPeriodeVon = MIN(VerwPeriodeVon), 
                                        VerwPeriodeBis = MAX(VerwPeriodeBis), 
                                        AnzahlPersonen = COUNT(KbBuchungBruttoID), 
                                        BaPersonID = MAX(BaPersonID), 
                                        Schuldner_BaInstitutionID = MAX(IsNull(Schuldner_BaInstitutionID, 0))
                                    FROM KbBuchungBruttoPerson
                                    GROUP BY KbBuchungBruttoID)
                                                                    KBPCOUNT ON KBPCOUNT.KbBuchungBruttoID = KBBALL.KbBuchungBruttoID
                    INNER JOIN dbo.BaPerson                 PRS2 WITH (READUNCOMMITTED) ON PRS2.BaPersonID = KBPCOUNT.BaPersonID        -- Betrifft Person
                    LEFT JOIN dbo.KbKonto                   KDEB WITH (READUNCOMMITTED) ON KDEB.KbPeriodeID = BUCALL.KbPeriodeID        -- Debitoren-Konto (nur gefüllt wenn die Buchung eine Debitoren-Buchung ist)
                                                                                       AND KDEB.KontoNr = BUCALL.SollKtoNr 
                                                                                       AND KDEB.KbKontoartCodes = 20
                    LEFT JOIN dbo.vwInstitution             INS WITH (READUNCOMMITTED) ON INS.BaInstitutionID = KBPCOUNT.Schuldner_BaInstitutionID

            WHERE ((@OrgGruppeID IS NULL AND @TeamID IS NULL) OR USR.OrgUnitID IN (SELECT OrgUnitID FROM dbo.fnOrgUnitsOfTeam(@OrgGruppeID,@TeamID)))
            AND (
                    1 = 0
            ---  OR 1 = (CASE WHEN {chkNettoStatus3.Checked} = 1 AND BUCALL.KbBuchungStatusCode = 3 THEN 1 ELSE 0 END) 
            ---  OR 1 = (CASE WHEN {chkNettoStatus7.Checked} = 1 AND BUCALL.KbBuchungStatusCode = 7 THEN 1 ELSE 0 END)
            ---  OR 1 = (CASE WHEN {edtKategorie.EditValue} = 4 /*rote > 60d*/ AND BUCALL.KbBuchungStatusCode = 7 THEN 1 ELSE 0 END)
            ---  OR 1 = (CASE WHEN {edtKategorie.EditValue} = 3 AND BUCALL.KbBuchungStatusCode = 9 THEN 1 ELSE 0 END) -- Bei Rückläufern sollte schon nach Rückläufern gesucht werden...
            )
            ---  AND 1 = (CASE WHEN {chkMitFehler.Checked} = 0 AND KBS.StornoFehlermeldung IS NOT NULL THEN 0 ELSE 1 END) 
            ---  AND LEI.UserID = {ctlOrgUnitTeamUser.SucheUserID.LookupID}
            ---  AND KKASEL.BgKostenartID = {edtSucheBgKostenartID.LookupID} -- weitere Einschränkung der Kostenart
            ---  AND (BUCSEL.KbBuchungID LIKE LTRIM(RTRIM({edtSucheBelegNr})) + '%' OR BUCSEL.BelegNr LIKE LTRIM(RTRIM({edtSucheBelegNr})) + '%' OR KBBALL.KbBuchungBruttoID LIKE LTRIM(RTRIM({edtSucheBelegNr})) + '%' OR KBBALL.BelegNr LIKE LTRIM(RTRIM({edtSucheBelegNr})) + '%')
            ---  AND BUCSEL.ValutaDatum >= {edtSucheValutaDatumVon}
            ---  AND BUCSEL.ValutaDatum <= {edtSucheValutaDatumBis}
            ---  AND FAL.FaFallID = {edtSucheFallNr}
            ---  AND LEI.BaPersonID = {edtSucheLT.LookupID}
            ---  AND KKAALL.BaPersonID = {edtSuchePersonNr}
            ---  AND ({chkSuchInklInaktiveW.Checked} = 1 OR LEI.DatumBis is null)
            ---  AND 1 = (CASE WHEN {chkSucheNurStornierte.Checked} = 1 AND (KBS.KbBuchungID IS NULL OR KBS.StornoFehlermeldung IS NOT NULL) THEN 0 ELSE 1 END)
            ---  AND 1 = (CASE WHEN {edtKategorie.EditValue} = 2 /*Sollstellungen*/ AND KDEB.KbKontoID IS NULL THEN 0 ELSE 1 END)
            ---  AND 1 = (CASE WHEN {edtKategorie.EditValue} = 1 /*Barbelege*/ AND (BUCSEL.KbAuszahlungsArtCode IS NULL OR BUCSEL.KbAuszahlungsArtCode <> 103) THEN 0 ELSE 1 END)
            ---  AND 1 = (CASE WHEN {edtKategorie.EditValue} = 3 /*Rückläufer*/ AND (BUCSEL.KbBuchungStatusCode IS NULL OR BUCSEL.KbBuchungStatusCode <> 9 OR BUCSEL.RuecklaeuferErledigt <> 1) THEN 0 ELSE 1 END)
            " + string.Format(@"---  AND 1 = (CASE WHEN {{edtKategorie.EditValue}} = 4 /*rote > 60d*/ AND (BUCSEL.KbBuchungStatusCode IS NULL OR BUCSEL.KbBuchungStatusCode <> 7 OR DATEDIFF(d, dbo.fnLastDayOf(dbo.fnDateSerial(BUD.Jahr, BUD.Monat,1)), GETDATE()) < {0}) THEN 0 ELSE 1 END)
            ", tageRotePosGruenstellbar)
             + string.Format(m_HiddenLAs, "BKA.KontoNr");	// Ergänze mit dem Filter für LAs

            qryBrutto.SelectStatement = @"
            DECLARE @OrgGruppeID int
            SET @OrgGruppeID = NULL
            --- SET @OrgGruppeID = {ctlOrgUnitTeamUser.SucheGruppe}

            DECLARE @TeamID int
            SET @TeamID = NULL
            --- SET @TeamID = {ctlOrgUnitTeamUser.SucheTeam}

            SELECT DISTINCT
                KbBuchungBruttoID           = KBBALL.KbBuchungBruttoID,
                BelegNr                     = KBBALL.BelegNr,
                KontoNr                     = KKAALL.KontoNr,
                NameVorname                 = PRS1.Name + ', ' + PRS1.Vorname,
                BetrifftPerson              = CASE WHEN KBPCOUNT.AnzahlPersonen = 1 THEN PRS2.Name + ', ' + PRS2.Vorname ELSE PRS1.Name + ', ' + PRS1.Vorname + ' (Leistungsträger)' END,
                BaPersonID                  = PRS1.BaPersonID,
                Betrag                      = KBBALL.Betrag,
                Schuldner                   = CASE WHEN INS.BaInstitutionID IS NULL THEN '' ELSE INS.Name + ', ' + INS.Adresse END,
                KbBuchungStatusCode         = KBBALL.KbBuchungStatusCode,
                Buchungstext                = KBBALL.Text,
                FaelligDatum                = KBBALL.ValutaDatum,
                VerwPeriodeVon              = KBPCOUNT.VerwPeriodeVon,
                VerwPeriodeBis              = KBPCOUNT.VerwPeriodeBis,
                SA                          = USR.ShortName + ' (' + USR.NameVorname + ')',
                Team                        = USR.OrgUnitShort,
                SZ                          = USR.SozialzentrumKurz,
                Budget                      = CONVERT(varchar(2), BUD.Monat) + '.' + CONVERT(varchar(4), BUD.Jahr),
                Storno                      = CASE WHEN (KBS.KbBuchungID IS NULL OR KBS.StornoFehlermeldung IS NOT NULL) THEN convert(bit,0) ELSE convert(bit,1) END,
                StornoFehler                = CASE WHEN KBS.StornoFehlermeldung IS NULL THEN '' ELSE 'F' END,
                BgBudgetID                  = BUD.BgBudgetID
            FROM KbBuchung                              BUCSEL  -- Dies ist die Buchung, die wir Suchen
                -- Finde alle Netto-Buchungen, die von der Netto-Buchung BUC abhängig sind (d.h. gleiche Positions-ID haben)
                INNER JOIN dbo.KbBuchungKostenart       KKASEL WITH (READUNCOMMITTED) ON KKASEL.KbBuchungID		= BUCSEL.KbBuchungID
                INNER JOIN dbo.KbBuchungKostenart       KKA WITH (READUNCOMMITTED)	  ON KKA.BgPositionID    = KKASEL.BgPositionID
                INNER JOIN dbo.KbBuchung                BUCALL WITH (READUNCOMMITTED) ON BUCALL.KbBuchungID     = KKA.KbBuchungID	-- Dies sind alle verwandten Buchungen

                INNER JOIN dbo.KbBuchungKostenart       KKAALL WITH (READUNCOMMITTED) ON KKAALL.KbBuchungID = BUCALL.KbBuchungID
                INNER JOIN dbo.BgBudget                 BUD WITH (READUNCOMMITTED) ON BUD.BgBudgetID = BUCALL.BgBudgetID
                INNER JOIN dbo.BgFinanzplan             BFP WITH (READUNCOMMITTED) ON BFP.BgFinanzplanID = BUD.BgFinanzplanID
                INNER JOIN dbo.FaLeistung               LEI WITH (READUNCOMMITTED) ON LEI.FaLeistungID = BFP.FaLeistungID
                INNER JOIN dbo.FaFall                   FAL WITH (READUNCOMMITTED) ON FAL.FaFallID = LEI.FaFallID
                INNER JOIN dbo.BaPerson                 PRS1 WITH (READUNCOMMITTED) ON PRS1.BaPersonID = FAL.BaPersonID		-- Leistungsträger
                INNER JOIN dbo.vwUser                   USR WITH (READUNCOMMITTED) ON USR.UserID = LEI.UserID
                LEFT JOIN dbo.KbBuchungStorno           KBS WITH (READUNCOMMITTED) ON KBS.KbBuchungID = BUCALL.KbBuchungID
                LEFT JOIN dbo.vwUser                    STU WITH (READUNCOMMITTED) ON STU.UserID = KBS.StornierungVermerktUserID
                INNER JOIN dbo.KbBuchungBruttoPerson    KBPALL WITH (READUNCOMMITTED) ON KBPALL.BgPositionID		= KKAALL.BgPositionID
                INNER JOIN dbo.KbBuchungBrutto          KBBALL WITH (READUNCOMMITTED) ON KBBALL.KbBuchungBruttoID = KBPALL.KbBuchungBruttoID
                INNER JOIN  (SELECT KbBuchungBruttoID, 
                             VerwPeriodeVon = MIN(VerwPeriodeVon), VerwPeriodeBis = MAX(VerwPeriodeBis), 
                             AnzahlPersonen = COUNT(KbBuchungBruttoID), BaPersonID = MAX(BaPersonID), 
                             Schuldner_BaInstitutionID = MAX(IsNull(Schuldner_BaInstitutionID, 0))
                             FROM KbBuchungBruttoPerson
                             GROUP BY KbBuchungBruttoID)
                                                        KBPCOUNT ON KBPCOUNT.KbBuchungBruttoID = KBBALL.KbBuchungBruttoID
                INNER JOIN dbo.BaPerson                 PRS2 WITH (READUNCOMMITTED) ON PRS2.BaPersonID = KBPCOUNT.BaPersonID        -- Betrifft Person
                LEFT JOIN dbo.KbKonto                   KDEB WITH (READUNCOMMITTED) ON KDEB.KbPeriodeID = BUCALL.KbPeriodeID        -- Debitoren-Konto (nur gefüllt wenn die Buchung eine Debitoren-Buchung ist)
                                                                                   AND KDEB.KontoNr = BUCALL.SollKtoNr
                                                                                   AND KDEB.KbKontoartCodes = 20
                LEFT JOIN dbo.vwInstitution             INS WITH (READUNCOMMITTED) ON INS.BaInstitutionID = KBPCOUNT.Schuldner_BaInstitutionID

            WHERE ((@OrgGruppeID IS NULL AND @TeamID IS NULL) OR USR.OrgUnitID IN (SELECT OrgUnitID FROM dbo.fnOrgUnitsOfTeam(@OrgGruppeID,@TeamID)))
            AND (
                    1 = 0
            ---  OR 1 = (CASE WHEN {chkNettoStatus3.Checked} = 1 AND BUCALL.KbBuchungStatusCode = 3 THEN 1 ELSE 0 END) 
            ---  OR 1 = (CASE WHEN {chkNettoStatus7.Checked} = 1 AND BUCALL.KbBuchungStatusCode = 7 THEN 1 ELSE 0 END)
            ---  OR 1 = (CASE WHEN {edtKategorie.EditValue} = 4 /*rote > 60d*/ AND BUCALL.KbBuchungStatusCode = 7 THEN 1 ELSE 0 END)
            ---  OR 1 = (CASE WHEN {edtKategorie.EditValue} = 3 AND BUCALL.KbBuchungStatusCode = 9 THEN 1 ELSE 0 END) -- Bei Rückläufern sollte schon nach Rückläufern gesucht werden...
            )
            ---  AND 1 = (CASE WHEN {chkMitFehler.Checked} = 0 AND KBS.StornoFehlermeldung IS NOT NULL THEN 0 ELSE 1 END) 
            ---  AND LEI.UserID = {ctlOrgUnitTeamUser.SucheUserID.LookupID}
            ---  AND KKASEL.BgKostenartID = {edtSucheBgKostenartID.LookupID} -- weitere Einschränkung der Kostenart
            ---  AND (BUCSEL.KbBuchungID LIKE LTRIM(RTRIM({edtSucheBelegNr})) + '%' OR BUCSEL.BelegNr LIKE LTRIM(RTRIM({edtSucheBelegNr})) + '%' OR KBBALL.KbBuchungBruttoID LIKE LTRIM(RTRIM({edtSucheBelegNr})) + '%' OR KBBALL.BelegNr LIKE LTRIM(RTRIM({edtSucheBelegNr})) + '%')
            ---  AND BUCSEL.ValutaDatum >= {edtSucheValutaDatumVon}
            ---  AND BUCSEL.ValutaDatum <= {edtSucheValutaDatumBis}
            ---  AND FAL.FaFallID = {edtSucheFallNr}
            ---  AND LEI.BaPersonID = {edtSucheLT.LookupID}
            ---  AND KKAALL.BaPersonID = {edtSuchePersonNr}
            ---  AND ({chkSuchInklInaktiveW.Checked} = 1 OR LEI.DatumBis is null)
            ---  AND 1 = (CASE WHEN {chkSucheNurStornierte.Checked} = 1 AND (KBS.KbBuchungID IS NULL OR KBS.StornoFehlermeldung IS NOT NULL) THEN 0 ELSE 1 END)
            ---  AND 1 = (CASE WHEN {edtKategorie.EditValue} = 2 /*Sollstellungen*/ AND KDEB.KbKontoID IS NULL THEN 0 ELSE 1 END)
            ---  AND 1 = (CASE WHEN {edtKategorie.EditValue} = 1 /*Barbelege*/ AND (BUCSEL.KbAuszahlungsArtCode IS NULL OR BUCSEL.KbAuszahlungsArtCode <> 103) THEN 0 ELSE 1 END)
            ---  AND 1 = (CASE WHEN {edtKategorie.EditValue} = 3 /*Rückläufer*/ AND (BUCSEL.KbBuchungStatusCode IS NULL OR BUCSEL.KbBuchungStatusCode <> 9 OR BUCSEL.RuecklaeuferErledigt <> 1) THEN 0 ELSE 1 END)
            " + string.Format(@"---  AND 1 = (CASE WHEN {{edtKategorie.EditValue}} = 4 /*rote > 60d*/ AND (BUCSEL.KbBuchungStatusCode IS NULL OR BUCSEL.KbBuchungStatusCode <> 7 OR DATEDIFF(d, dbo.fnLastDayOf(dbo.fnDateSerial(BUD.Jahr, BUD.Monat,1)), GETDATE()) < {0}) THEN 0 ELSE 1 END)
            ", tageRotePosGruenstellbar)
             + string.Format(m_HiddenLAs, "BKA.KontoNr");	// Ergänze mit dem Filter für LAs            
        }

        private void ShowParentControl(string parentControlName, bool show)
        {
            Type t = this.GetType();

            Type parentT = t.BaseType;

            // Hole das private Member mit dem erwähnten Namen
            BindingFlags bf = BindingFlags.NonPublic | BindingFlags.Instance;
            FieldInfo fi = parentT.GetField(parentControlName, bf);
            if (fi != null)
            {
                Control chkShowGroupPanel = fi.GetValue(this) as Control;
                if (chkShowGroupPanel != null)
                {
                    // OK, wir haben das Control gefunden, setze nun das Visible Property
                    chkShowGroupPanel.Visible = show;
                }
            }
        }

        private void SprungMontagsBudget(SqlQuery query)
        {
            if (!DBUtil.IsEmpty(query["BgBudgetID"]))
            {
                SqlQuery qrytemp = DBUtil.OpenSQL(@"
                    SELECT FAL.BaPersonID, FLE.ModulID, BFP.BgFinanzplanID
                    FROM BgBudget              BBG
                      INNER JOIN BgFinanzplan  BFP ON BFP.BgFinanzplanID = BBG.BgFinanzplanID
                      INNER JOIN FaLeistung    FLE ON FLE.FaLeistungID = BFP.FaLeistungID
                      INNER JOIN FaFall        FAL ON FAL.FaFallID = FLE.FaFallID
                    WHERE BBG.BgBudgetID = {0}",
                    query["BgBudgetID"]);

                if (qrytemp.Count == 1)
                {
                    string jumpToPath = string.Format(
                        "ClassName=FrmFall;BaPersonID={0};ModulID={1};TreeNodeID=CtlWhFinanzplan{2}\\BBG{3}",
                        qrytemp["BaPersonID"],
                        qrytemp["ModulID"],
                        qrytemp["BgFinanzplanID"],
                        query["BgBudgetID"]);

                    System.Collections.Specialized.HybridDictionary dic = FormController.ConvertToDictionary(jumpToPath);
                    bool result = FormController.OpenForm((string)dic["ClassName"], "Action", "JumpToPath", dic);
                }
            }
        }

        private void btnAlle_Click(object sender, System.EventArgs e)
        {
            if (!KissMsg.ShowQuestion("Sind Sie sicher, dass Sie alle angezeigten Belege selektieren wollen? Bei vielen Belegen kann dies einige Minuten dauern."))
            {
                return;
            }

            Cursor = Cursors.WaitCursor;

            string errorMsg = "";
            int fehler = 0;

            foreach (DataRow R in qryQuery.DataTable.Rows)
            {
                if (SelectDependendRowsByNettoID((int)R["KbBuchungID"], true, ref errorMsg))
                {
                    //Ok, selektion hat geklappt, nun selektiere auch noch diese Netto-Beleg (der wurde nämlich noch nicht selektiert)
                    R["Storno"] = true;
                }
                else
                {
                    // Fehler bei der Selektion.
                    R["StornoFehler"] = "F";
                    fehler++;
                }
            }

            if (fehler > 0)
            {
                KissMsg.ShowError(fehler + " Nettobelege konnten nicht selektiert werden, weil sie abhängige, teilausgeglichene Netto- oder Brutto-Belege haben. Alle anderen Belege, die storniert werden können, sind nun selektiert worden.");
            }

            Cursor = Cursors.Default;
        }

        private void btnBruttoSprungMonatsBudget_Click(object sender, System.EventArgs e)
        {
            SprungMontagsBudget(qryBrutto);
        }

        private void btnKeine_Click(object sender, System.EventArgs e)
        {
            Cursor = Cursors.WaitCursor;

            foreach (DataRow R in qryQuery.DataTable.Rows)
            {
                if (!DBUtil.IsEmpty(R["Storno"])) R["Storno"] = false;
            }

            foreach (DataRow R in qryBrutto.DataTable.Rows)
            {
                if (!DBUtil.IsEmpty(R["Storno"])) R["Storno"] = false;
            }

            btnSaveStorno.Enabled = true;

            Cursor = Cursors.Default;
        }

        private void btnNettoSprungMonatsBudget_Click(object sender, System.EventArgs e)
        {
            SprungMontagsBudget(qryQuery);
        }

        private void btnSaveStorno_Click(object sender, System.EventArgs e)
        {
            AskToSave();
        }

        private void btnTransferStorno_Click(object sender, System.EventArgs e)
        {
            if (btnSaveStorno.Enabled)
            {
                // Es gibt noch nicht gespeicherte Selektionen
                if (KissMsg.ShowQuestion("Um die selektierten Buchungen im KiSS und PSCD zu stornieren, muss die aktuelle Selektion zuerst gespeichert werden. Möchten Sie die Selektion nun speichern?"))
                {
                    SaveStornoSelektion();
                }
                else
                {
                    return;
                }
            }

            // Zähle die zu übermittelnden Belege
            m_SelectedBelegCount = 0;
            foreach (DataRow R in qryQuery.DataTable.Rows)
            {
                if (!DBUtil.IsEmpty(R["Storno"]))
                {
                    if ((bool)R["Storno"])
                    {
                        m_SelectedBelegCount++;
                    }
                }
            }

            // Zuerst nachfragen, ob die Storno-Selektion an PSCD übermittelt werden soll
            if (KissMsg.ShowQuestion(string.Format("Wollen Sie die {0} selektierten Buchungen definitiv im Kiss und PSCD stornieren?", m_SelectedBelegCount)))
            {
                DlgProgressLog.Show("Stornolauf", 700, 500, new ProgressEventHandler(ProgressStart), new ProgressEventHandler(ProgressEnd), Session.MainForm);
            }
        }

        private void edtSucheBgKostenartID_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            string SearchString = edtSucheBgKostenartID.Text.Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (e.ButtonClicked)
                {
                    SearchString = "%";
                }
                else
                {
                    edtSucheBgKostenartID.EditValue = DBNull.Value;
                    edtSucheBgKostenartID.LookupID = DBNull.Value;
                    return;
                }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
                SELECT KontoNr, Name,
                  BgKostenartID$ = BgKostenartID,
                  KontoNrName$ = KontoNr + ' ' + Name
                FROM BgKostenart
                WHERE ModulID = 3 AND (KontoNr LIKE '%' + {0} + '%' OR Name LIKE '%' + {0} + '%')" + string.Format(m_HiddenLAs, "KontoNr") + @"
                ORDER BY KontoNr, Name
                ", SearchString, e.ButtonClicked);

            if (!e.Cancel)
            {
                edtSucheBgKostenartID.EditValue = dlg["KontoNrName$"];
                edtSucheBgKostenartID.LookupID = dlg["BgKostenartID$"];
            }
        }

        private void edtSucheLT_UserModifiedFld(object sender, KiSS4.Gui.UserModifiedFldEventArgs e)
        {
            string SearchString = edtSucheLT.Text.Replace("*", "%").Replace("?", "_").Replace(" ", "%");

            if (DBUtil.IsEmpty(SearchString))
            {
                if (e.ButtonClicked)
                {
                    SearchString = "%";
                }
                else
                {
                    edtSucheLT.EditValue = DBNull.Value;
                    edtSucheLT.LookupID = DBNull.Value;
                    return;
                }
            }

            KissLookupDialog dlg = new KissLookupDialog();
            e.Cancel = !dlg.SearchData(@"
                SELECT ID = PRS.BaPersonID, PRS.DisplayText,
                  BaPersonID$ = PRS.BaPersonID, NameVorname$ = PRS.NameVorname
                FROM vwPerson           PRS
                WHERE (PRS.NameVorname LIKE '%' + {0} + '%' OR CAST(PRS.BaPersonID as varchar) = {0})
                  AND EXISTS (SELECT BaPersonID
                              FROM FaLeistung           LEI
                                INNER JOIN BgFinanzplan BFP ON BFP.FaLeistungID = LEI.FaLeistungID
                              WHERE BaPersonID = PRS.BaPersonID AND FaProzessCode = 300)
                ORDER BY PRS.Name, PRS.Vorname
                ", SearchString, e.ButtonClicked);

            if (!e.Cancel)
            {
                edtSucheLT.EditValue = dlg["NameVorname$"];
                edtSucheLT.LookupID = dlg["BaPersonID$"];
            }
        }

        private void gridView1_CellValueChanging(object sender, DevExpress.XtraGrid.Views.Base.CellValueChangedEventArgs e)
        {
            if (e.Column != colBruttoStorno) return;

            try
            {
                Cursor = Cursors.WaitCursor;

                string errorMsg = "";

                if (SelectDependendRowsByBruttoID((int)qryBrutto["KbBuchungBruttoID"], (bool)e.Value, ref errorMsg))
                {
                    // OK, jetzt sind alle abhängigen Zeilen selektiert, d.h. selektiere auch diese Zeile
                    gridView1.SetRowCellValue((int)e.RowHandle, colBruttoStorno, true);
                }
                else
                {
                    // Selektion konnte nicht gemacht werden
                    qryBrutto["StornoFehler"] = "F";
                    KissMsg.ShowError("Selektion des Brutto-Belegs " + qryBrutto["KbBuchungBruttoID"].ToString() + ": " + errorMsg);
                }
            }
            finally
            {
                Cursor = Cursors.Default;
            }
        }

        private void gridView1_CustomRowCellEdit(object sender, DevExpress.XtraGrid.Views.Grid.CustomRowCellEditEventArgs e)
        {
            if (e.Column == colBruttoStorno)
            {
                e.RepositoryItem = repositoryItemCheckEdit2;
            }
        }

        private void grvKbBuchungSuche_CellValueChanging(object sender, DevExpress.XtraGrid.Views.Base.CellValueChangedEventArgs e)
        {
            if (e.Column != colNettoStorno) return;

            try
            {
                Cursor = Cursors.WaitCursor;

                string errorMsg = "";

                if (SelectDependendRowsByNettoID((int)qryQuery["KbBuchungID"], (bool)e.Value, ref errorMsg))
                {
                    // OK, jetzt sind alle abhängigen Zeilen selektiert, d.h. selektiere auch diese Zeile
                    grvKbBuchungSuche.SetRowCellValue((int)e.RowHandle, colNettoStorno, true);
                }
                else
                {
                    // Selektion konnte nicht gemacht werden
                    qryQuery["StornoFehler"] = "F";
                    KissMsg.ShowError("Selektion des Netto-Belegs " + qryQuery["KbBuchungID"].ToString() + ": " + errorMsg);
                }
            }
            finally
            {
                Cursor = Cursors.Default;
            }
        }

        private void grvKbBuchungSuche_CustomRowCellEdit(object sender, DevExpress.XtraGrid.Views.Grid.CustomRowCellEditEventArgs e)
        {
            if (e.Column == colNettoStorno)
            {
                e.RepositoryItem = repositoryItemCheckEdit1;
            }
        }

        private void tabControlSearch_SelectedTabChanged(SharpLibrary.WinControls.TabPageEx page)
        {
            if (page == tpgListe)
            {
                btnSaveStorno.Enabled = false;
            }
        }

        private void tabControlSearch_SelectedTabChanging(object sender, System.ComponentModel.CancelEventArgs e)
        {
            if (tabControlSearch.SelectedTab == tpgListe)
            {
                if (btnSaveStorno.Enabled)
                {
                    // Wir springen von der Liste weg, und die aktuelle Selektion ist noch nicht gespeichert
                    AskToSave();
                }
            }
        }

        #endregion

        private void chkNettoStatus7_CheckedChanged(object sender, EventArgs e)
        {
            // Stelle sicher, dass mind. einer der Status-Checkboxen gesetzt ist
            if (chkNettoStatus7.Checked == false)
            {
                chkNettoStatus3.Checked = true;
            }
        }

        private void chkNettoStatus3_CheckedChanged(object sender, EventArgs e)
        {
            // Stelle sicher, dass mind. einer der Status-Checkboxen gesetzt ist
            if (chkNettoStatus3.Checked == false)
            {
                chkNettoStatus7.Checked = true;
            }
        }
    }
}