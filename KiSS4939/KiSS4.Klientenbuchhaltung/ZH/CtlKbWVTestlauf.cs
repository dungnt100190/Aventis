#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3053
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using System.Drawing;
using System.Threading;
using System.Windows.Forms;
using Kiss.Infrastructure;
using KiSS4.DB;
using KiSS4.Gui;
using KiSS4.Messages;

namespace KiSS4.Klientenbuchhaltung.ZH
{
    public class CtlKbWVTestlauf : KiSS4.Common.KissSearchUserControl
    {
        #region Enumerations

        private enum WVLaufResult
        {
            Unknown, OK, Aborted, Exception
        }

        #endregion

        #region Fields

        private System.Collections.Generic.List<int> IDs = new System.Collections.Generic.List<int>();
        private KiSS4.Gui.KissButton btnAlle;
        private KiSS4.Gui.KissButton btnDeleteStatusL;
        private KiSS4.Gui.KissButton btnDeleteStatusLV;
        private KiSS4.Gui.KissButton btnFeedback;
        private KiSS4.Gui.KissButton btnGroupByBED;
        private KiSS4.Gui.KissButton btnGroupByWVCode;
        private KiSS4.Gui.KissButton btnKeine;
        private KiSS4.Gui.KissButton btnSend;
        private KiSS4.Gui.KissButton btnStartEchtlauf;
        private KiSS4.Gui.KissButton btnStartWVLauf;
        private DevExpress.XtraGrid.Columns.GridColumn colBED;
        private DevExpress.XtraGrid.Columns.GridColumn colBeguenstigter;
        private DevExpress.XtraGrid.Columns.GridColumn colBelegNr;
        private DevExpress.XtraGrid.Columns.GridColumn colBetrag;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttoID;
        private DevExpress.XtraGrid.Columns.GridColumn colEPs;
        private DevExpress.XtraGrid.Columns.GridColumn colFallID;
        private DevExpress.XtraGrid.Columns.GridColumn colFehlerID;
        private DevExpress.XtraGrid.Columns.GridColumn colFehlermeldung;
        private DevExpress.XtraGrid.Columns.GridColumn colID;
        private DevExpress.XtraGrid.Columns.GridColumn colJahr;
        private DevExpress.XtraGrid.Columns.GridColumn colKostenart;
        private DevExpress.XtraGrid.Columns.GridColumn colLA;
        private DevExpress.XtraGrid.Columns.GridColumn colPeriode;
        private DevExpress.XtraGrid.Columns.GridColumn colPersonID;
        private DevExpress.XtraGrid.Columns.GridColumn colSelektion;
        private DevExpress.XtraGrid.Columns.GridColumn colStartDatum;
        private DevExpress.XtraGrid.Columns.GridColumn colStatus;
        private DevExpress.XtraGrid.Columns.GridColumn colTestlauf;
        private DevExpress.XtraGrid.Columns.GridColumn colUT;
        private DevExpress.XtraGrid.Columns.GridColumn colUser;
        private DevExpress.XtraGrid.Columns.GridColumn colWVCode;
        private KiSS4.Gui.KissLabel colZeitspanne;
        private System.ComponentModel.IContainer components;
        private KiSS4.Gui.KissCheckedLookupEdit edtBED;
        private KiSS4.Gui.KissDateEdit edtBis;
        private KiSS4.Gui.KissCalcEdit edtJahr;
        private KiSS4.Gui.KissLookUpEdit edtPeriode;
        private KiSS4.Gui.KissCheckedLookupEdit edtWVCode;
        private KiSS4.Gui.KissGrid grdFehler;
        private KiSS4.Gui.KissGrid grdKbWVLauf;
        private KiSS4.Gui.KissGrid grdWVEinzelposten;
        private DevExpress.XtraGrid.Views.Grid.GridView gridView1;
        private DevExpress.XtraGrid.Views.Grid.GridView grvKbWVLauf;
        private DevExpress.XtraGrid.Views.Grid.GridView grvWVEinzelposten;
        private KiSS4.DB.SqlQuery gryKbWVLaufFehlermeldungen;
        private int[] iconIDs = new int[] { 1355, 1356 };
        private int iconIndex = 0;
        private DateTime lastKeyboardEvent = DateTime.Now;
        private DateTime lastProgressUpdate = DateTime.Now;
        private KiSS4.Gui.KissLabel lblBED;
        private KiSS4.Gui.KissLabel lblBis;
        private KiSS4.Gui.KissLabel lblJahr;
        private KiSS4.Gui.KissLabel lblLaufTitel;
        private KiSS4.Gui.KissLabel lblLaufzeit;
        private KiSS4.Gui.KissLabel lblLaufzeitLegende;
        private KiSS4.Gui.KissLabel lblWVCode;
        private Exception m_wvLaufException = null;
        private WVLaufResult m_wvLaufResult = WVLaufResult.Unknown;
        private SqlCommand m_wvLaufSqlCommand = null;
        private Thread m_wvLaufThread = null;
        private System.Windows.Forms.Panel pnlEinzelposten;
        private System.Windows.Forms.Panel pnlFehlermeldungen;
        private System.Windows.Forms.Panel pnlGroup;
        private System.Windows.Forms.Panel pnlLauf;
        private System.Windows.Forms.Panel pnlNeuerLauf;
        private System.Windows.Forms.Panel pnlSenden;
        private KiSS4.DB.SqlQuery qryKbWVEinzelposition;
        private KiSS4.DB.SqlQuery qryKbWVLauf;
        private KiSS4.DB.SqlQuery qryNeufakturierungAbgesetzterMigWVEinzelpostenLog;
        private DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit repositoryItemCheckEdit1;
        private DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit repositoryItemCheckEdit2;
        private DevExpress.XtraEditors.Repository.RepositoryItemTextEdit repositoryItemTextEdit1;
        private KiSS4.Gui.KissSplitterCollapsible splitter;
        private KiSS4.Gui.KissSplitterCollapsible splitterListe;
        private DateTime startTime = DateTime.Now;
        private bool testlauf = true;
        private System.Windows.Forms.Timer tmrFeedback;

        private int kbWVLaufPeriodeCodeMigriertePosten = 7;
        private KissLabel lblProgress;
        private DevExpress.XtraGrid.Columns.GridColumn colBruttobeleg;
        private int totalWV_EPCount;

        #endregion

        #region Constructors

        public CtlKbWVTestlauf(bool testlauf)
            : this()
        {
            this.testlauf = testlauf;
            qryKbWVLauf.Fill(testlauf);
            grdWVEinzelposten.GridStyle = testlauf ? GridStyleType.ReadOnly : GridStyleType.Editable;
            colSelektion.Visible = !testlauf;
            pnlSenden.Visible = !testlauf;
            this.grvWVEinzelposten.OptionsView.ShowIndicator = false;
            btnStartWVLauf.Text = testlauf ? "Testlauf starten" : "Echtlauf starten";
            EnableLaufParameter(false);
        }

        public CtlKbWVTestlauf()
        {
            this.InitializeComponent();

            colWVCode.ColumnEdit = grdWVEinzelposten.GetLOVLookUpEdit(DBUtil.OpenSQL("SELECT Code, Text = ShortText FROM XLOVCode WHERE LOVName = 'BaWVCode'"));
            colStatus.ColumnEdit = grdWVEinzelposten.GetLOVLookUpEdit(DBUtil.OpenSQL("SELECT Code, Text = ShortText FROM XLOVCode WHERE LOVName = 'KbWVEinzelpostenStatus'"));

            tabControlSearch.SelectedTabIndex = 1;

            edtWVCode.SetLookupDataSource(DBUtil.OpenSQL(@"
                SELECT Code, Text = ShortText + IsNull( ' (' + Text + ')','')
                FROM XLOVCode
                WHERE LOVName = 'BaWVCode' AND ShortText NOT LIKE '%-E'
                ORDER BY SortKey"));

            edtBED.SetLookupDataSource(DBUtil.OpenSQL(@"
                SELECT Code, Text = CAST(Code as varchar) + IsNull( ' (' + Text + ')','')
                FROM XLOVCode
                WHERE LOVName = 'BaBED'
                ORDER BY SortKey"));

            edtPeriode.Properties.DataSource = DBUtil.OpenSQL(@"
                SELECT Code, Text, WVCodes = Value1, BEDs = Value2, Monat = Value3
                FROM XLOVCode
                WHERE LOVName = 'KbWVLaufPeriode'
                ORDER BY SortKey");

            tmrFeedback.Tick += tmrFeedback_OnTick;
            btnFeedback.BackColor = Color.Transparent;
            grvWVEinzelposten.CustomRowCellEdit += new DevExpress.XtraGrid.Views.Grid.CustomRowCellEditEventHandler(grvWVEinzelposten_CustomRowCellEdit);

            if (Session.Env.EnvType == EnvType.Prod)
            {
                // Der L+V Löschen-Knopf muss auf Produktion versteckt sein
                btnDeleteStatusLV.Visible = false;
            }
            bool allowDelete = DBUtil.UserHasRight("CtlKbWVTestlauf", "D");
            btnDeleteStatusL.Enabled = allowDelete;
            btnDeleteStatusLV.Enabled = allowDelete;
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(CtlKbWVTestlauf));
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject1 = new DevExpress.Utils.SerializableAppearanceObject();
            DevExpress.Utils.SerializableAppearanceObject serializableAppearanceObject2 = new DevExpress.Utils.SerializableAppearanceObject();
            this.components = new System.ComponentModel.Container();
            this.splitterListe = new KiSS4.Gui.KissSplitterCollapsible();
            this.pnlFehlermeldungen = new System.Windows.Forms.Panel();
            this.grdFehler = new KiSS4.Gui.KissGrid();
            this.gryKbWVLaufFehlermeldungen = new KiSS4.DB.SqlQuery(this.components);
            this.gridView1 = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colFehlerID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colPersonID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFallID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttoID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colFehlermeldung = new DevExpress.XtraGrid.Columns.GridColumn();
            this.pnlEinzelposten = new System.Windows.Forms.Panel();
            this.grdWVEinzelposten = new KiSS4.Gui.KissGrid();
            this.qryKbWVEinzelposition = new KiSS4.DB.SqlQuery(this.components);
            this.grvWVEinzelposten = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colSelektion = new DevExpress.XtraGrid.Columns.GridColumn();
            this.repositoryItemCheckEdit2 = new DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit();
            this.colWVCode = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBED = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBetrag = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBelegNr = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colStatus = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colKostenart = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colUT = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBeguenstigter = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colLA = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colBruttobeleg = new DevExpress.XtraGrid.Columns.GridColumn();
            this.repositoryItemCheckEdit1 = new DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit();
            this.repositoryItemTextEdit1 = new DevExpress.XtraEditors.Repository.RepositoryItemTextEdit();
            this.pnlGroup = new System.Windows.Forms.Panel();
            this.lblLaufTitel = new KiSS4.Gui.KissLabel();
            this.btnGroupByWVCode = new KiSS4.Gui.KissButton();
            this.btnGroupByBED = new KiSS4.Gui.KissButton();
            this.pnlSenden = new System.Windows.Forms.Panel();
            this.btnKeine = new KiSS4.Gui.KissButton();
            this.btnAlle = new KiSS4.Gui.KissButton();
            this.btnSend = new KiSS4.Gui.KissButton();
            this.pnlLauf = new System.Windows.Forms.Panel();
            this.btnDeleteStatusLV = new KiSS4.Gui.KissButton();
            this.btnDeleteStatusL = new KiSS4.Gui.KissButton();
            this.grdKbWVLauf = new KiSS4.Gui.KissGrid();
            this.qryKbWVLauf = new KiSS4.DB.SqlQuery(this.components);
            this.grvKbWVLauf = new DevExpress.XtraGrid.Views.Grid.GridView();
            this.colID = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colUser = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colStartDatum = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colTestlauf = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colEPs = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colPeriode = new DevExpress.XtraGrid.Columns.GridColumn();
            this.colJahr = new DevExpress.XtraGrid.Columns.GridColumn();
            this.splitter = new KiSS4.Gui.KissSplitterCollapsible();
            this.pnlNeuerLauf = new System.Windows.Forms.Panel();
            this.lblProgress = new KiSS4.Gui.KissLabel();
            this.edtJahr = new KiSS4.Gui.KissCalcEdit();
            this.lblLaufzeitLegende = new KiSS4.Gui.KissLabel();
            this.lblLaufzeit = new KiSS4.Gui.KissLabel();
            this.btnStartWVLauf = new KiSS4.Gui.KissButton();
            this.btnFeedback = new KiSS4.Gui.KissButton();
            this.edtBis = new KiSS4.Gui.KissDateEdit();
            this.edtWVCode = new KiSS4.Gui.KissCheckedLookupEdit();
            this.edtBED = new KiSS4.Gui.KissCheckedLookupEdit();
            this.edtPeriode = new KiSS4.Gui.KissLookUpEdit();
            this.colZeitspanne = new KiSS4.Gui.KissLabel();
            this.lblJahr = new KiSS4.Gui.KissLabel();
            this.lblBis = new KiSS4.Gui.KissLabel();
            this.btnStartEchtlauf = new KiSS4.Gui.KissButton();
            this.lblWVCode = new KiSS4.Gui.KissLabel();
            this.lblBED = new KiSS4.Gui.KissLabel();
            this.qryNeufakturierungAbgesetzterMigWVEinzelpostenLog = new KiSS4.DB.SqlQuery(this.components);
            this.tmrFeedback = new System.Windows.Forms.Timer(this.components);
            this.tabControlSearch.SuspendLayout();
            this.tpgListe.SuspendLayout();
            this.tpgSuchen.SuspendLayout();
            this.pnlFehlermeldungen.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.grdFehler)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gryKbWVLaufFehlermeldungen)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.gridView1)).BeginInit();
            this.pnlEinzelposten.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.grdWVEinzelposten)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryKbWVEinzelposition)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvWVEinzelposten)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit2)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit1)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemTextEdit1)).BeginInit();
            this.pnlGroup.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblLaufTitel)).BeginInit();
            this.pnlSenden.SuspendLayout();
            this.pnlLauf.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.grdKbWVLauf)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryKbWVLauf)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvKbWVLauf)).BeginInit();
            this.pnlNeuerLauf.SuspendLayout();
            ((System.ComponentModel.ISupportInitialize)(this.lblProgress)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtJahr.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblLaufzeitLegende)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblLaufzeit)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBis.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtWVCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBED)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtPeriode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtPeriode.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.colZeitspanne)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblJahr)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBis)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblWVCode)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBED)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryNeufakturierungAbgesetzterMigWVEinzelpostenLog)).BeginInit();
            this.SuspendLayout();
            //
            // searchTitle
            //
            this.searchTitle.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)));
            this.searchTitle.Dock = System.Windows.Forms.DockStyle.Top;
            this.searchTitle.Location = new System.Drawing.Point(0, 0);
            this.searchTitle.Size = new System.Drawing.Size(864, 24);
            //
            // tabControlSearch
            //
            this.tabControlSearch.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)));
            this.tabControlSearch.Dock = System.Windows.Forms.DockStyle.Fill;
            this.tabControlSearch.Location = new System.Drawing.Point(0, 0);
            this.tabControlSearch.Size = new System.Drawing.Size(876, 676);
            //
            // tpgListe
            //
            this.tpgListe.Controls.Add(this.pnlEinzelposten);
            this.tpgListe.Controls.Add(this.splitterListe);
            this.tpgListe.Controls.Add(this.pnlFehlermeldungen);
            this.tpgListe.Size = new System.Drawing.Size(864, 638);
            this.tpgListe.Title = "WV-Posten";
            //
            // tpgSuchen
            //
            this.tpgSuchen.Controls.Add(this.pnlNeuerLauf);
            this.tpgSuchen.Controls.Add(this.splitter);
            this.tpgSuchen.Controls.Add(this.pnlLauf);
            this.tpgSuchen.Size = new System.Drawing.Size(864, 638);
            this.tpgSuchen.Title = "Testlauf wählen";
            this.tpgSuchen.Controls.SetChildIndex(this.searchTitle, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.pnlLauf, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.splitter, 0);
            this.tpgSuchen.Controls.SetChildIndex(this.pnlNeuerLauf, 0);
            //
            // splitterListe
            //
            this.splitterListe.AnimationDelay = 20;
            this.splitterListe.AnimationStep = 20;
            this.splitterListe.BorderStyle3D = System.Windows.Forms.Border3DStyle.Etched;
            this.splitterListe.ControlToHide = this.pnlFehlermeldungen;
            this.splitterListe.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.splitterListe.ExpandParentForm = false;
            this.splitterListe.Location = new System.Drawing.Point(0, 496);
            this.splitterListe.Name = "splitterListe";
            this.splitterListe.TabIndex = 0;
            this.splitterListe.TabStop = false;
            this.splitterListe.UseAnimations = false;
            this.splitterListe.VisualStyle = KiSS4.Gui.VisualStyles.Mozilla;
            //
            // pnlFehlermeldungen
            //
            this.pnlFehlermeldungen.Controls.Add(this.grdFehler);
            this.pnlFehlermeldungen.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.pnlFehlermeldungen.Location = new System.Drawing.Point(0, 504);
            this.pnlFehlermeldungen.Name = "pnlFehlermeldungen";
            this.pnlFehlermeldungen.Size = new System.Drawing.Size(864, 134);
            this.pnlFehlermeldungen.TabIndex = 1;
            //
            // grdFehler
            //
            this.grdFehler.DataSource = this.gryKbWVLaufFehlermeldungen;
            this.grdFehler.Dock = System.Windows.Forms.DockStyle.Fill;
            //
            //
            //
            this.grdFehler.EmbeddedNavigator.Name = "";
            this.grdFehler.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdFehler.Location = new System.Drawing.Point(0, 0);
            this.grdFehler.MainView = this.gridView1;
            this.grdFehler.Name = "grdFehler";
            this.grdFehler.Size = new System.Drawing.Size(864, 134);
            this.grdFehler.TabIndex = 0;
            this.grdFehler.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.gridView1});
            //
            // gryKbWVLaufFehlermeldungen
            //
            this.gryKbWVLaufFehlermeldungen.HostControl = this;
            this.gryKbWVLaufFehlermeldungen.SelectStatement = "SELECT *\r\nFROM   KbWVEinzelpostenFehler WEF\r\nINNER JOIN KbBuchungBruttoPerson KBP" +
                " ON KBP.KbBuchungBruttoPersonID = WEF.KbBuchungBruttoPersonID \r\nWHERE  KbWVLaufI" +
                "D = {0}";
            //
            // gridView1
            //
            this.gridView1.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.gridView1.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.Empty.Options.UseBackColor = true;
            this.gridView1.Appearance.Empty.Options.UseFont = true;
            this.gridView1.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.EvenRow.Options.UseFont = true;
            this.gridView1.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.gridView1.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.gridView1.Appearance.FocusedCell.Options.UseBackColor = true;
            this.gridView1.Appearance.FocusedCell.Options.UseFont = true;
            this.gridView1.Appearance.FocusedCell.Options.UseForeColor = true;
            this.gridView1.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.gridView1.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.gridView1.Appearance.FocusedRow.Options.UseBackColor = true;
            this.gridView1.Appearance.FocusedRow.Options.UseFont = true;
            this.gridView1.Appearance.FocusedRow.Options.UseForeColor = true;
            this.gridView1.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.gridView1.Appearance.GroupPanel.Options.UseBackColor = true;
            this.gridView1.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.gridView1.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gridView1.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gridView1.Appearance.GroupRow.Options.UseBackColor = true;
            this.gridView1.Appearance.GroupRow.Options.UseFont = true;
            this.gridView1.Appearance.GroupRow.Options.UseForeColor = true;
            this.gridView1.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.gridView1.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.gridView1.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.gridView1.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.gridView1.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.gridView1.Appearance.HeaderPanel.Options.UseFont = true;
            this.gridView1.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.gridView1.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.gridView1.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.gridView1.Appearance.HideSelectionRow.Options.UseFont = true;
            this.gridView1.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.gridView1.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.gridView1.Appearance.HorzLine.Options.UseBackColor = true;
            this.gridView1.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.OddRow.Options.UseFont = true;
            this.gridView1.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.gridView1.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.Row.Options.UseBackColor = true;
            this.gridView1.Appearance.Row.Options.UseFont = true;
            this.gridView1.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.gridView1.Appearance.SelectedRow.Options.UseFont = true;
            this.gridView1.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.gridView1.Appearance.VertLine.Options.UseBackColor = true;
            this.gridView1.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.gridView1.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colFehlerID,
            this.colPersonID,
            this.colFallID,
            this.colBruttoID,
            this.colFehlermeldung});
            this.gridView1.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.gridView1.GridControl = this.grdFehler;
            this.gridView1.Name = "gridView1";
            this.gridView1.OptionsBehavior.Editable = false;
            this.gridView1.OptionsCustomization.AllowFilter = false;
            this.gridView1.OptionsFilter.UseNewCustomFilterDialog = true;
            this.gridView1.OptionsNavigation.AutoFocusNewRow = true;
            this.gridView1.OptionsNavigation.UseTabKey = false;
            this.gridView1.OptionsView.ColumnAutoWidth = false;
            this.gridView1.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.gridView1.OptionsView.ShowGroupPanel = false;
            this.gridView1.OptionsView.ShowIndicator = false;
            //
            // colFehlerID
            //
            this.colFehlerID.Caption = "Fehler ID";
            this.colFehlerID.FieldName = "KbWVEinzelpostenFehlerID";
            this.colFehlerID.Name = "colFehlerID";
            this.colFehlerID.Visible = true;
            this.colFehlerID.VisibleIndex = 0;
            this.colFehlerID.Width = 59;
            //
            // colPersonID
            //
            this.colPersonID.Caption = "Person";
            this.colPersonID.FieldName = "BaPersonID";
            this.colPersonID.Name = "colPersonID";
            this.colPersonID.Visible = true;
            this.colPersonID.VisibleIndex = 1;
            //
            // colFallID
            //
            this.colFallID.Caption = "Fall";
            this.colFallID.FieldName = "FaFallID";
            this.colFallID.Name = "colFallID";
            this.colFallID.Visible = true;
            this.colFallID.VisibleIndex = 2;
            //
            // colBruttoID
            //
            this.colBruttoID.Caption = "Brutto ID";
            this.colBruttoID.FieldName = "KbBuchungBruttoID";
            this.colBruttoID.Name = "colBruttoID";
            this.colBruttoID.Visible = true;
            this.colBruttoID.VisibleIndex = 3;
            //
            // colFehlermeldung
            //
            this.colFehlermeldung.Caption = "Fehlermeldung";
            this.colFehlermeldung.FieldName = "WVFehlermeldung";
            this.colFehlermeldung.Name = "colFehlermeldung";
            this.colFehlermeldung.Visible = true;
            this.colFehlermeldung.VisibleIndex = 4;
            this.colFehlermeldung.Width = 800;
            //
            // pnlEinzelposten
            //
            this.pnlEinzelposten.Controls.Add(this.grdWVEinzelposten);
            this.pnlEinzelposten.Controls.Add(this.pnlGroup);
            this.pnlEinzelposten.Controls.Add(this.pnlSenden);
            this.pnlEinzelposten.Dock = System.Windows.Forms.DockStyle.Fill;
            this.pnlEinzelposten.Location = new System.Drawing.Point(0, 0);
            this.pnlEinzelposten.Name = "pnlEinzelposten";
            this.pnlEinzelposten.Size = new System.Drawing.Size(864, 496);
            this.pnlEinzelposten.TabIndex = 2;
            //
            // grdWVEinzelposten
            //
            this.grdWVEinzelposten.DataSource = this.qryKbWVEinzelposition;
            this.grdWVEinzelposten.Dock = System.Windows.Forms.DockStyle.Fill;
            //
            //
            //
            this.grdWVEinzelposten.EmbeddedNavigator.Name = "";
            this.grdWVEinzelposten.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdWVEinzelposten.Location = new System.Drawing.Point(0, 33);
            this.grdWVEinzelposten.MainView = this.grvWVEinzelposten;
            this.grdWVEinzelposten.Name = "grdWVEinzelposten";
            this.grdWVEinzelposten.RepositoryItems.AddRange(new DevExpress.XtraEditors.Repository.RepositoryItem[] {
            this.repositoryItemCheckEdit1,
            this.repositoryItemCheckEdit2,
            this.repositoryItemTextEdit1});
            this.grdWVEinzelposten.Size = new System.Drawing.Size(864, 428);
            this.grdWVEinzelposten.TabIndex = 1;
            this.grdWVEinzelposten.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvWVEinzelposten});
            //
            // qryKbWVEinzelposition
            //
            this.qryKbWVEinzelposition.BatchUpdate = true;
            this.qryKbWVEinzelposition.CanUpdate = true;
            this.qryKbWVEinzelposition.HostControl = this;
            this.qryKbWVEinzelposition.SelectStatement = resources.GetString("qryKbWVEinzelposition.SelectStatement");
            this.qryKbWVEinzelposition.TableName = "KbWVEinzelposten";
            //
            // grvWVEinzelposten
            //
            this.grvWVEinzelposten.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvWVEinzelposten.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinzelposten.Appearance.Empty.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.Empty.Options.UseFont = true;
            this.grvWVEinzelposten.Appearance.EvenRow.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(236)))), ((int)(((byte)(227)))), ((int)(((byte)(215)))));
            this.grvWVEinzelposten.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinzelposten.Appearance.EvenRow.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.EvenRow.Options.UseFont = true;
            this.grvWVEinzelposten.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvWVEinzelposten.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinzelposten.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvWVEinzelposten.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.FocusedCell.Options.UseFont = true;
            this.grvWVEinzelposten.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvWVEinzelposten.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvWVEinzelposten.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinzelposten.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvWVEinzelposten.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.FocusedRow.Options.UseFont = true;
            this.grvWVEinzelposten.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvWVEinzelposten.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvWVEinzelposten.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvWVEinzelposten.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvWVEinzelposten.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvWVEinzelposten.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.GroupRow.Options.UseFont = true;
            this.grvWVEinzelposten.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvWVEinzelposten.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvWVEinzelposten.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvWVEinzelposten.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvWVEinzelposten.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvWVEinzelposten.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvWVEinzelposten.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvWVEinzelposten.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinzelposten.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvWVEinzelposten.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvWVEinzelposten.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvWVEinzelposten.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvWVEinzelposten.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinzelposten.Appearance.OddRow.Options.UseFont = true;
            this.grvWVEinzelposten.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvWVEinzelposten.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinzelposten.Appearance.Row.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.Row.Options.UseFont = true;
            this.grvWVEinzelposten.Appearance.SelectedRow.BackColor = System.Drawing.Color.AliceBlue;
            this.grvWVEinzelposten.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvWVEinzelposten.Appearance.SelectedRow.ForeColor = System.Drawing.Color.Black;
            this.grvWVEinzelposten.Appearance.SelectedRow.Options.UseBackColor = true;
            this.grvWVEinzelposten.Appearance.SelectedRow.Options.UseFont = true;
            this.grvWVEinzelposten.Appearance.SelectedRow.Options.UseForeColor = true;
            this.grvWVEinzelposten.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvWVEinzelposten.Appearance.VertLine.Options.UseBackColor = true;
            this.grvWVEinzelposten.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvWVEinzelposten.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colSelektion,
            this.colWVCode,
            this.colBED,
            this.colBetrag,
            this.colBelegNr,
            this.colStatus,
            this.colKostenart,
            this.colUT,
            this.colBeguenstigter,
            this.colLA,
            this.colBruttobeleg});
            this.grvWVEinzelposten.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvWVEinzelposten.GridControl = this.grdWVEinzelposten;
            this.grvWVEinzelposten.Name = "grvWVEinzelposten";
            this.grvWVEinzelposten.OptionsBehavior.Editable = false;
            this.grvWVEinzelposten.OptionsCustomization.AllowFilter = false;
            this.grvWVEinzelposten.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvWVEinzelposten.OptionsNavigation.AutoFocusNewRow = true;
            this.grvWVEinzelposten.OptionsNavigation.UseTabKey = false;
            this.grvWVEinzelposten.OptionsView.ColumnAutoWidth = false;
            this.grvWVEinzelposten.OptionsView.ShowChildrenInGroupPanel = true;
            this.grvWVEinzelposten.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvWVEinzelposten.OptionsView.ShowGroupedColumns = true;
            this.grvWVEinzelposten.OptionsView.ShowGroupPanel = false;
            this.grvWVEinzelposten.OptionsView.ShowIndicator = false;
            //
            // colSelektion
            //
            this.colSelektion.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colSelektion.AppearanceCell.Options.UseBackColor = true;
            this.colSelektion.Caption = "Sel";
            this.colSelektion.ColumnEdit = this.repositoryItemCheckEdit2;
            this.colSelektion.FieldName = "Sel";
            this.colSelektion.Name = "colSelektion";
            this.colSelektion.Visible = true;
            this.colSelektion.VisibleIndex = 0;
            this.colSelektion.Width = 30;
            //
            // repositoryItemCheckEdit2
            //
            this.repositoryItemCheckEdit2.AutoHeight = false;
            this.repositoryItemCheckEdit2.Name = "repositoryItemCheckEdit2";
            this.repositoryItemCheckEdit2.NullStyle = DevExpress.XtraEditors.Controls.StyleIndeterminate.Inactive;
            //
            // colWVCode
            //
            this.colWVCode.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colWVCode.AppearanceCell.Options.UseBackColor = true;
            this.colWVCode.Caption = "WV-Code";
            this.colWVCode.FieldName = "WVCode";
            this.colWVCode.Name = "colWVCode";
            this.colWVCode.OptionsColumn.AllowEdit = false;
            this.colWVCode.Visible = true;
            this.colWVCode.VisibleIndex = 1;
            this.colWVCode.Width = 62;
            //
            // colBED
            //
            this.colBED.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colBED.AppearanceCell.Options.UseBackColor = true;
            this.colBED.Caption = "BED";
            this.colBED.FieldName = "BEDCode";
            this.colBED.Name = "colBED";
            this.colBED.OptionsColumn.AllowEdit = false;
            this.colBED.Visible = true;
            this.colBED.VisibleIndex = 2;
            this.colBED.Width = 61;
            //
            // colBetrag
            //
            this.colBetrag.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colBetrag.AppearanceCell.Options.UseBackColor = true;
            this.colBetrag.Caption = "Betrag";
            this.colBetrag.DisplayFormat.FormatString = "N2";
            this.colBetrag.DisplayFormat.FormatType = DevExpress.Utils.FormatType.Numeric;
            this.colBetrag.FieldName = "Betrag";
            this.colBetrag.Name = "colBetrag";
            this.colBetrag.OptionsColumn.AllowEdit = false;
            this.colBetrag.Visible = true;
            this.colBetrag.VisibleIndex = 3;
            this.colBetrag.Width = 82;
            //
            // colBelegNr
            //
            this.colBelegNr.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colBelegNr.AppearanceCell.Options.UseBackColor = true;
            this.colBelegNr.Caption = "BelegNr";
            this.colBelegNr.FieldName = "PscdBelegNr";
            this.colBelegNr.Name = "colBelegNr";
            this.colBelegNr.OptionsColumn.AllowEdit = false;
            this.colBelegNr.Visible = true;
            this.colBelegNr.VisibleIndex = 4;
            this.colBelegNr.Width = 96;
            //
            // colStatus
            //
            this.colStatus.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colStatus.AppearanceCell.Options.UseBackColor = true;
            this.colStatus.Caption = "Status";
            this.colStatus.FieldName = "KbWVEinzelpostenStatusCode";
            this.colStatus.Name = "colStatus";
            this.colStatus.OptionsColumn.AllowEdit = false;
            this.colStatus.Visible = true;
            this.colStatus.VisibleIndex = 5;
            this.colStatus.Width = 50;
            //
            // colKostenart
            //
            this.colKostenart.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colKostenart.AppearanceCell.Options.UseBackColor = true;
            this.colKostenart.Caption = "Buchungstext";
            this.colKostenart.FieldName = "Buchungstext";
            this.colKostenart.Name = "colKostenart";
            this.colKostenart.OptionsColumn.AllowEdit = false;
            this.colKostenart.Visible = true;
            this.colKostenart.VisibleIndex = 6;
            this.colKostenart.Width = 169;
            //
            // colUT
            //
            this.colUT.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colUT.AppearanceCell.Options.UseBackColor = true;
            this.colUT.Caption = "Unterstützungsträger";
            this.colUT.FieldName = "UnterstuetzungstraegerBaPersonID";
            this.colUT.Name = "colUT";
            this.colUT.OptionsColumn.AllowEdit = false;
            this.colUT.Visible = true;
            this.colUT.VisibleIndex = 7;
            this.colUT.Width = 138;
            //
            // colBeguenstigter
            //
            this.colBeguenstigter.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colBeguenstigter.AppearanceCell.Options.UseBackColor = true;
            this.colBeguenstigter.Caption = "Begünstigte Person";
            this.colBeguenstigter.FieldName = "BeguenstigterBaPersonID";
            this.colBeguenstigter.Name = "colBeguenstigter";
            this.colBeguenstigter.OptionsColumn.AllowEdit = false;
            this.colBeguenstigter.Visible = true;
            this.colBeguenstigter.VisibleIndex = 8;
            this.colBeguenstigter.Width = 143;
            //
            // colLA
            //
            this.colLA.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colLA.AppearanceCell.Options.UseBackColor = true;
            this.colLA.Caption = "LA";
            this.colLA.FieldName = "LA";
            this.colLA.Name = "colLA";
            this.colLA.OptionsColumn.AllowEdit = false;
            this.colLA.Visible = true;
            this.colLA.VisibleIndex = 9;
            this.colLA.Width = 40;
            //
            // colBruttobeleg
            //
            this.colBruttobeleg.AppearanceCell.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.colBruttobeleg.AppearanceCell.Options.UseBackColor = true;
            this.colBruttobeleg.Caption = "Bruttobeleg";
            this.colBruttobeleg.FieldName = "BruttobelegNr";
            this.colBruttobeleg.Name = "colBruttobeleg";
            this.colBruttobeleg.OptionsColumn.AllowEdit = false;
            this.colBruttobeleg.Visible = true;
            this.colBruttobeleg.VisibleIndex = 10;
            this.colBruttobeleg.Width = 96;
            //
            // repositoryItemCheckEdit1
            //
            this.repositoryItemCheckEdit1.AutoHeight = false;
            this.repositoryItemCheckEdit1.Name = "repositoryItemCheckEdit1";
            this.repositoryItemCheckEdit1.NullStyle = DevExpress.XtraEditors.Controls.StyleIndeterminate.Unchecked;
            //
            // repositoryItemTextEdit1
            //
            this.repositoryItemTextEdit1.AutoHeight = false;
            this.repositoryItemTextEdit1.Name = "repositoryItemTextEdit1";
            this.repositoryItemTextEdit1.ReadOnly = true;
            //
            // pnlGroup
            //
            this.pnlGroup.Controls.Add(this.lblLaufTitel);
            this.pnlGroup.Controls.Add(this.btnGroupByWVCode);
            this.pnlGroup.Controls.Add(this.btnGroupByBED);
            this.pnlGroup.Dock = System.Windows.Forms.DockStyle.Top;
            this.pnlGroup.Location = new System.Drawing.Point(0, 0);
            this.pnlGroup.Name = "pnlGroup";
            this.pnlGroup.Size = new System.Drawing.Size(864, 33);
            this.pnlGroup.TabIndex = 0;
            //
            // lblLaufTitel
            //
            this.lblLaufTitel.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.lblLaufTitel.LabelStyle = KiSS4.Gui.LabelStyleType.TitleLabel;
            this.lblLaufTitel.Location = new System.Drawing.Point(255, 10);
            this.lblLaufTitel.Name = "lblLaufTitel";
            this.lblLaufTitel.Size = new System.Drawing.Size(596, 16);
            this.lblLaufTitel.TabIndex = 4;
            this.lblLaufTitel.Text = "Lauf";
            this.lblLaufTitel.UseCompatibleTextRendering = true;
            //
            // btnGroupByWVCode
            //
            this.btnGroupByWVCode.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnGroupByWVCode.Location = new System.Drawing.Point(121, 6);
            this.btnGroupByWVCode.Name = "btnGroupByWVCode";
            this.btnGroupByWVCode.Size = new System.Drawing.Size(112, 24);
            this.btnGroupByWVCode.TabIndex = 3;
            this.btnGroupByWVCode.Text = "Summe pro Code";
            this.btnGroupByWVCode.UseCompatibleTextRendering = true;
            this.btnGroupByWVCode.UseVisualStyleBackColor = false;
            this.btnGroupByWVCode.Click += new System.EventHandler(this.btnGroupByWVCode_Click);
            //
            // btnGroupByBED
            //
            this.btnGroupByBED.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnGroupByBED.Location = new System.Drawing.Point(3, 6);
            this.btnGroupByBED.Name = "btnGroupByBED";
            this.btnGroupByBED.Size = new System.Drawing.Size(112, 24);
            this.btnGroupByBED.TabIndex = 3;
            this.btnGroupByBED.Text = "Summe pro BED";
            this.btnGroupByBED.UseCompatibleTextRendering = true;
            this.btnGroupByBED.UseVisualStyleBackColor = false;
            this.btnGroupByBED.Click += new System.EventHandler(this.btnGroupByBED_Click);
            //
            // pnlSenden
            //
            this.pnlSenden.Controls.Add(this.btnKeine);
            this.pnlSenden.Controls.Add(this.btnAlle);
            this.pnlSenden.Controls.Add(this.btnSend);
            this.pnlSenden.Dock = System.Windows.Forms.DockStyle.Bottom;
            this.pnlSenden.Location = new System.Drawing.Point(0, 461);
            this.pnlSenden.Name = "pnlSenden";
            this.pnlSenden.Size = new System.Drawing.Size(864, 35);
            this.pnlSenden.TabIndex = 0;
            //
            // btnKeine
            //
            this.btnKeine.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnKeine.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnKeine.Location = new System.Drawing.Point(601, 6);
            this.btnKeine.Name = "btnKeine";
            this.btnKeine.Size = new System.Drawing.Size(57, 24);
            this.btnKeine.TabIndex = 2;
            this.btnKeine.Text = "Keine +";
            this.btnKeine.UseCompatibleTextRendering = true;
            this.btnKeine.UseVisualStyleBackColor = false;
            this.btnKeine.Click += new System.EventHandler(this.btnKeine_Click);
            //
            // btnAlle
            //
            this.btnAlle.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnAlle.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnAlle.Location = new System.Drawing.Point(664, 6);
            this.btnAlle.Name = "btnAlle";
            this.btnAlle.Size = new System.Drawing.Size(57, 24);
            this.btnAlle.TabIndex = 2;
            this.btnAlle.Text = "Alle +";
            this.btnAlle.UseCompatibleTextRendering = true;
            this.btnAlle.UseVisualStyleBackColor = false;
            this.btnAlle.Click += new System.EventHandler(this.btnAlle_Click);
            //
            // btnSend
            //
            this.btnSend.Anchor = ((System.Windows.Forms.AnchorStyles)((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));
            this.btnSend.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnSend.Location = new System.Drawing.Point(743, 6);
            this.btnSend.Name = "btnSend";
            this.btnSend.Size = new System.Drawing.Size(121, 24);
            this.btnSend.TabIndex = 1;
            this.btnSend.Text = "An PSCD senden";
            this.btnSend.UseCompatibleTextRendering = true;
            this.btnSend.UseVisualStyleBackColor = false;
            this.btnSend.Click += new System.EventHandler(this.btnSend_Click);
            //
            // pnlLauf
            //
            this.pnlLauf.Controls.Add(this.btnDeleteStatusLV);
            this.pnlLauf.Controls.Add(this.btnDeleteStatusL);
            this.pnlLauf.Controls.Add(this.grdKbWVLauf);
            this.pnlLauf.Dock = System.Windows.Forms.DockStyle.Top;
            this.pnlLauf.Location = new System.Drawing.Point(0, 24);
            this.pnlLauf.Name = "pnlLauf";
            this.pnlLauf.Size = new System.Drawing.Size(864, 146);
            this.pnlLauf.TabIndex = 1;
            //
            // btnDeleteStatusLV
            //
            this.btnDeleteStatusLV.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnDeleteStatusLV.Location = new System.Drawing.Point(5, 112);
            this.btnDeleteStatusLV.Name = "btnDeleteStatusLV";
            this.btnDeleteStatusLV.Size = new System.Drawing.Size(83, 24);
            this.btnDeleteStatusLV.TabIndex = 338;
            this.btnDeleteStatusLV.Text = "L+V löschen";
            this.btnDeleteStatusLV.UseCompatibleTextRendering = true;
            this.btnDeleteStatusLV.UseVisualStyleBackColor = false;
            this.btnDeleteStatusLV.Click += new System.EventHandler(this.btnDeleteStatusLV_Click);
            //
            // btnDeleteStatusL
            //
            this.btnDeleteStatusL.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnDeleteStatusL.Location = new System.Drawing.Point(5, 82);
            this.btnDeleteStatusL.Name = "btnDeleteStatusL";
            this.btnDeleteStatusL.Size = new System.Drawing.Size(82, 24);
            this.btnDeleteStatusL.TabIndex = 338;
            this.btnDeleteStatusL.Text = "L löschen";
            this.btnDeleteStatusL.UseCompatibleTextRendering = true;
            this.btnDeleteStatusL.UseVisualStyleBackColor = false;
            this.btnDeleteStatusL.Click += new System.EventHandler(this.btnDeleteStatusL_Click);
            //
            // grdKbWVLauf
            //
            this.grdKbWVLauf.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.grdKbWVLauf.DataSource = this.qryKbWVLauf;
            //
            //
            //
            this.grdKbWVLauf.EmbeddedNavigator.Name = "";
            this.grdKbWVLauf.GridStyle = KiSS4.Gui.GridStyleType.ReadOnly;
            this.grdKbWVLauf.Location = new System.Drawing.Point(93, 6);
            this.grdKbWVLauf.MainView = this.grvKbWVLauf;
            this.grdKbWVLauf.Name = "grdKbWVLauf";
            this.grdKbWVLauf.Size = new System.Drawing.Size(759, 130);
            this.grdKbWVLauf.TabIndex = 333;
            this.grdKbWVLauf.ViewCollection.AddRange(new DevExpress.XtraGrid.Views.Base.BaseView[] {
            this.grvKbWVLauf});
            //
            // qryKbWVLauf
            //
            this.qryKbWVLauf.BatchUpdate = true;
            this.qryKbWVLauf.CanDelete = true;
            this.qryKbWVLauf.CanInsert = true;
            this.qryKbWVLauf.CanUpdate = true;
            this.qryKbWVLauf.HostControl = this;
            this.qryKbWVLauf.SelectStatement = resources.GetString("qryKbWVLauf.SelectStatement");
            this.qryKbWVLauf.TableName = "KbWVLauf";
            this.qryKbWVLauf.AfterInsert += new System.EventHandler(this.qryKbWVLauf_AfterInsert);
            this.qryKbWVLauf.PositionChanged += new System.EventHandler(this.qryKbWVLauf_PositionChanged);
            //
            // grvKbWVLauf
            //
            this.grvKbWVLauf.Appearance.Empty.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.grvKbWVLauf.Appearance.Empty.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbWVLauf.Appearance.Empty.Options.UseBackColor = true;
            this.grvKbWVLauf.Appearance.Empty.Options.UseFont = true;
            this.grvKbWVLauf.Appearance.EvenRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbWVLauf.Appearance.EvenRow.Options.UseFont = true;
            this.grvKbWVLauf.Appearance.FocusedCell.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvKbWVLauf.Appearance.FocusedCell.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbWVLauf.Appearance.FocusedCell.ForeColor = System.Drawing.Color.White;
            this.grvKbWVLauf.Appearance.FocusedCell.Options.UseBackColor = true;
            this.grvKbWVLauf.Appearance.FocusedCell.Options.UseFont = true;
            this.grvKbWVLauf.Appearance.FocusedCell.Options.UseForeColor = true;
            this.grvKbWVLauf.Appearance.FocusedRow.BackColor = System.Drawing.SystemColors.Highlight;
            this.grvKbWVLauf.Appearance.FocusedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbWVLauf.Appearance.FocusedRow.ForeColor = System.Drawing.Color.White;
            this.grvKbWVLauf.Appearance.FocusedRow.Options.UseBackColor = true;
            this.grvKbWVLauf.Appearance.FocusedRow.Options.UseFont = true;
            this.grvKbWVLauf.Appearance.FocusedRow.Options.UseForeColor = true;
            this.grvKbWVLauf.Appearance.GroupPanel.BackColor = System.Drawing.Color.PeachPuff;
            this.grvKbWVLauf.Appearance.GroupPanel.Options.UseBackColor = true;
            this.grvKbWVLauf.Appearance.GroupRow.BackColor = System.Drawing.Color.PeachPuff;
            this.grvKbWVLauf.Appearance.GroupRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvKbWVLauf.Appearance.GroupRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvKbWVLauf.Appearance.GroupRow.Options.UseBackColor = true;
            this.grvKbWVLauf.Appearance.GroupRow.Options.UseFont = true;
            this.grvKbWVLauf.Appearance.GroupRow.Options.UseForeColor = true;
            this.grvKbWVLauf.Appearance.HeaderPanel.BackColor = System.Drawing.Color.Tan;
            this.grvKbWVLauf.Appearance.HeaderPanel.BorderColor = System.Drawing.Color.Tan;
            this.grvKbWVLauf.Appearance.HeaderPanel.Font = new System.Drawing.Font("Arial", 11F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel, ((byte)(0)));
            this.grvKbWVLauf.Appearance.HeaderPanel.Options.UseBackColor = true;
            this.grvKbWVLauf.Appearance.HeaderPanel.Options.UseBorderColor = true;
            this.grvKbWVLauf.Appearance.HeaderPanel.Options.UseFont = true;
            this.grvKbWVLauf.Appearance.HideSelectionRow.BackColor = System.Drawing.Color.PowderBlue;
            this.grvKbWVLauf.Appearance.HideSelectionRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbWVLauf.Appearance.HideSelectionRow.ForeColor = System.Drawing.SystemColors.WindowText;
            this.grvKbWVLauf.Appearance.HideSelectionRow.Options.UseBackColor = true;
            this.grvKbWVLauf.Appearance.HideSelectionRow.Options.UseFont = true;
            this.grvKbWVLauf.Appearance.HideSelectionRow.Options.UseForeColor = true;
            this.grvKbWVLauf.Appearance.HorzLine.BackColor = System.Drawing.Color.Silver;
            this.grvKbWVLauf.Appearance.HorzLine.Options.UseBackColor = true;
            this.grvKbWVLauf.Appearance.OddRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbWVLauf.Appearance.OddRow.Options.UseFont = true;
            this.grvKbWVLauf.Appearance.Row.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.grvKbWVLauf.Appearance.Row.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbWVLauf.Appearance.Row.Options.UseBackColor = true;
            this.grvKbWVLauf.Appearance.Row.Options.UseFont = true;
            this.grvKbWVLauf.Appearance.SelectedRow.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.grvKbWVLauf.Appearance.SelectedRow.Options.UseFont = true;
            this.grvKbWVLauf.Appearance.VertLine.BackColor = System.Drawing.Color.Silver;
            this.grvKbWVLauf.Appearance.VertLine.Options.UseBackColor = true;
            this.grvKbWVLauf.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.grvKbWVLauf.Columns.AddRange(new DevExpress.XtraGrid.Columns.GridColumn[] {
            this.colID,
            this.colUser,
            this.colStartDatum,
            this.colTestlauf,
            this.colEPs,
            this.colPeriode,
            this.colJahr});
            this.grvKbWVLauf.FocusRectStyle = DevExpress.XtraGrid.Views.Grid.DrawFocusRectStyle.None;
            this.grvKbWVLauf.GridControl = this.grdKbWVLauf;
            this.grvKbWVLauf.Name = "grvKbWVLauf";
            this.grvKbWVLauf.OptionsBehavior.Editable = false;
            this.grvKbWVLauf.OptionsCustomization.AllowFilter = false;
            this.grvKbWVLauf.OptionsFilter.UseNewCustomFilterDialog = true;
            this.grvKbWVLauf.OptionsNavigation.AutoFocusNewRow = true;
            this.grvKbWVLauf.OptionsNavigation.UseTabKey = false;
            this.grvKbWVLauf.OptionsView.ColumnAutoWidth = false;
            this.grvKbWVLauf.OptionsView.ShowFilterPanelMode = DevExpress.XtraGrid.Views.Base.ShowFilterPanelMode.Never;
            this.grvKbWVLauf.OptionsView.ShowGroupPanel = false;
            this.grvKbWVLauf.OptionsView.ShowIndicator = false;
            this.grvKbWVLauf.SortInfo.AddRange(new DevExpress.XtraGrid.Columns.GridColumnSortInfo[] {
            new DevExpress.XtraGrid.Columns.GridColumnSortInfo(this.colID, DevExpress.Data.ColumnSortOrder.Descending)});
            //
            // colID
            //
            this.colID.Caption = "ID";
            this.colID.FieldName = "KbWVLaufID";
            this.colID.Name = "colID";
            this.colID.Visible = true;
            this.colID.VisibleIndex = 0;
            this.colID.Width = 46;
            //
            // colUser
            //
            this.colUser.Caption = "User";
            this.colUser.FieldName = "User";
            this.colUser.Name = "colUser";
            this.colUser.Visible = true;
            this.colUser.VisibleIndex = 2;
            this.colUser.Width = 257;
            //
            // colStartDatum
            //
            this.colStartDatum.Caption = "Datum";
            this.colStartDatum.FieldName = "StartDatum";
            this.colStartDatum.Name = "colStartDatum";
            this.colStartDatum.Visible = true;
            this.colStartDatum.VisibleIndex = 1;
            //
            // colTestlauf
            //
            this.colTestlauf.Caption = "Test";
            this.colTestlauf.FieldName = "TestlaufX";
            this.colTestlauf.Name = "colTestlauf";
            this.colTestlauf.Visible = true;
            this.colTestlauf.VisibleIndex = 3;
            this.colTestlauf.Width = 37;
            //
            // colEPs
            //
            this.colEPs.Caption = "Einzelposten";
            this.colEPs.FieldName = "AnzahlEPs";
            this.colEPs.Name = "colEPs";
            this.colEPs.ToolTip = "Anzahl Einzelposten";
            this.colEPs.Visible = true;
            this.colEPs.VisibleIndex = 6;
            this.colEPs.Width = 85;
            //
            // colPeriode
            //
            this.colPeriode.Caption = "Periode";
            this.colPeriode.FieldName = "Periode";
            this.colPeriode.Name = "colPeriode";
            this.colPeriode.Visible = true;
            this.colPeriode.VisibleIndex = 4;
            //
            // colJahr
            //
            this.colJahr.Caption = "Jahr";
            this.colJahr.FieldName = "Jahr";
            this.colJahr.Name = "colJahr";
            this.colJahr.Visible = true;
            this.colJahr.VisibleIndex = 5;
            //
            // splitter
            //
            this.splitter.AnimationDelay = 20;
            this.splitter.AnimationStep = 20;
            this.splitter.BorderStyle3D = System.Windows.Forms.Border3DStyle.Etched;
            this.splitter.ControlToHide = this.pnlLauf;
            this.splitter.Dock = System.Windows.Forms.DockStyle.Top;
            this.splitter.ExpandParentForm = false;
            this.splitter.Location = new System.Drawing.Point(0, 170);
            this.splitter.Name = "splitter";
            this.splitter.TabIndex = 2;
            this.splitter.TabStop = false;
            this.splitter.UseAnimations = false;
            this.splitter.VisualStyle = KiSS4.Gui.VisualStyles.Mozilla;
            //
            // pnlNeuerLauf
            //
            this.pnlNeuerLauf.Controls.Add(this.lblProgress);
            this.pnlNeuerLauf.Controls.Add(this.edtJahr);
            this.pnlNeuerLauf.Controls.Add(this.lblLaufzeitLegende);
            this.pnlNeuerLauf.Controls.Add(this.lblLaufzeit);
            this.pnlNeuerLauf.Controls.Add(this.btnStartWVLauf);
            this.pnlNeuerLauf.Controls.Add(this.btnFeedback);
            this.pnlNeuerLauf.Controls.Add(this.edtBis);
            this.pnlNeuerLauf.Controls.Add(this.edtWVCode);
            this.pnlNeuerLauf.Controls.Add(this.edtBED);
            this.pnlNeuerLauf.Controls.Add(this.edtPeriode);
            this.pnlNeuerLauf.Controls.Add(this.colZeitspanne);
            this.pnlNeuerLauf.Controls.Add(this.lblJahr);
            this.pnlNeuerLauf.Controls.Add(this.lblBis);
            this.pnlNeuerLauf.Controls.Add(this.btnStartEchtlauf);
            this.pnlNeuerLauf.Controls.Add(this.lblWVCode);
            this.pnlNeuerLauf.Controls.Add(this.lblBED);
            this.pnlNeuerLauf.Dock = System.Windows.Forms.DockStyle.Fill;
            this.pnlNeuerLauf.Location = new System.Drawing.Point(0, 178);
            this.pnlNeuerLauf.Name = "pnlNeuerLauf";
            this.pnlNeuerLauf.Size = new System.Drawing.Size(864, 460);
            this.pnlNeuerLauf.TabIndex = 3;
            //
            // lblProgress
            //
            this.lblProgress.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Left)
                        | System.Windows.Forms.AnchorStyles.Right)));
            this.lblProgress.Location = new System.Drawing.Point(741, 100);
            this.lblProgress.Name = "lblProgress";
            this.lblProgress.Size = new System.Drawing.Size(113, 24);
            this.lblProgress.TabIndex = 338;
            this.lblProgress.Text = "";
            this.lblProgress.UseCompatibleTextRendering = true;
            this.lblProgress.Visible = false;
            //
            // edtJahr
            //
            this.edtJahr.Location = new System.Drawing.Point(297, 9);
            this.edtJahr.Name = "edtJahr";
            this.edtJahr.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtJahr.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtJahr.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtJahr.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtJahr.Properties.Appearance.Options.UseBackColor = true;
            this.edtJahr.Properties.Appearance.Options.UseBorderColor = true;
            this.edtJahr.Properties.Appearance.Options.UseFont = true;
            this.edtJahr.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtJahr.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtJahr.Size = new System.Drawing.Size(72, 24);
            this.edtJahr.TabIndex = 337;
            //
            // lblLaufzeitLegende
            //
            this.lblLaufzeitLegende.AllowDrop = true;
            this.lblLaufzeitLegende.Location = new System.Drawing.Point(741, 41);
            this.lblLaufzeitLegende.Name = "lblLaufzeitLegende";
            this.lblLaufzeitLegende.Size = new System.Drawing.Size(100, 23);
            this.lblLaufzeitLegende.TabIndex = 336;
            this.lblLaufzeitLegende.Text = "Laufzeit:";
            this.lblLaufzeitLegende.UseCompatibleTextRendering = true;
            this.lblLaufzeitLegende.Visible = false;
            //
            // lblLaufzeit
            //
            this.lblLaufzeit.Location = new System.Drawing.Point(741, 68);
            this.lblLaufzeit.Name = "lblLaufzeit";
            this.lblLaufzeit.Size = new System.Drawing.Size(100, 23);
            this.lblLaufzeit.TabIndex = 336;
            this.lblLaufzeit.Text = "";
            this.lblLaufzeit.UseCompatibleTextRendering = true;
            this.lblLaufzeit.Visible = false;
            //
            // btnStartWVLauf
            //
            this.btnStartWVLauf.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnStartWVLauf.Location = new System.Drawing.Point(588, 9);
            this.btnStartWVLauf.Name = "btnStartWVLauf";
            this.btnStartWVLauf.Size = new System.Drawing.Size(139, 24);
            this.btnStartWVLauf.TabIndex = 334;
            this.btnStartWVLauf.Text = "Lauf starten";
            this.btnStartWVLauf.UseCompatibleTextRendering = true;
            this.btnStartWVLauf.UseVisualStyleBackColor = false;
            this.btnStartWVLauf.Click += new System.EventHandler(this.btnStartWVLauf_Click);
            //
            // btnFeedback
            //
            this.btnFeedback.Enabled = false;
            this.btnFeedback.FlatAppearance.BorderSize = 0;
            this.btnFeedback.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnFeedback.IconID = 1333;
            this.btnFeedback.Location = new System.Drawing.Point(749, 9);
            this.btnFeedback.Name = "btnFeedback";
            this.btnFeedback.Size = new System.Drawing.Size(29, 24);
            this.btnFeedback.TabIndex = 334;
            this.btnFeedback.UseCompatibleTextRendering = true;
            this.btnFeedback.UseVisualStyleBackColor = false;
            this.btnFeedback.Visible = false;
            //
            // edtBis
            //
            this.edtBis.EditValue = null;
            this.edtBis.Location = new System.Drawing.Point(471, 10);
            this.edtBis.Name = "edtBis";
            this.edtBis.Properties.AllowNullInput = DevExpress.Utils.DefaultBoolean.True;
            this.edtBis.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtBis.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtBis.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtBis.Properties.Appearance.Options.UseBackColor = true;
            this.edtBis.Properties.Appearance.Options.UseBorderColor = true;
            this.edtBis.Properties.Appearance.Options.UseFont = true;
            this.edtBis.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject1.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject1.Options.UseBackColor = true;
            this.edtBis.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Glyph, "", 8, true, true, false, DevExpress.Utils.HorzAlignment.Center, ((System.Drawing.Image)(resources.GetObject("edtBis.Properties.Buttons"))), new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject1)});
            this.edtBis.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtBis.Properties.ShowToday = false;
            this.edtBis.Size = new System.Drawing.Size(100, 24);
            this.edtBis.TabIndex = 333;
            //
            // edtWVCode
            //
            this.edtWVCode.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)));
            this.edtWVCode.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(244)))), ((int)(((byte)(240)))), ((int)(((byte)(230)))));
            this.edtWVCode.Appearance.Options.UseBackColor = true;
            this.edtWVCode.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.NoBorder;
            this.edtWVCode.CheckOnClick = true;
            this.edtWVCode.Location = new System.Drawing.Point(85, 41);
            this.edtWVCode.Name = "edtWVCode";
            this.edtWVCode.Size = new System.Drawing.Size(338, 400);
            this.edtWVCode.TabIndex = 332;
            //
            // edtBED
            //
            this.edtBED.Anchor = ((System.Windows.Forms.AnchorStyles)(((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom)
                        | System.Windows.Forms.AnchorStyles.Left)));
            this.edtBED.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(244)))), ((int)(((byte)(240)))), ((int)(((byte)(230)))));
            this.edtBED.Appearance.Options.UseBackColor = true;
            this.edtBED.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.NoBorder;
            this.edtBED.CheckOnClick = true;
            this.edtBED.Location = new System.Drawing.Point(464, 41);
            this.edtBED.Name = "edtBED";
            this.edtBED.Size = new System.Drawing.Size(263, 400);
            this.edtBED.TabIndex = 331;
            //
            // edtPeriode
            //
            this.edtPeriode.Location = new System.Drawing.Point(90, 10);
            this.edtPeriode.Name = "edtPeriode";
            this.edtPeriode.Properties.Appearance.BackColor = System.Drawing.Color.AliceBlue;
            this.edtPeriode.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtPeriode.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtPeriode.Properties.Appearance.Options.UseBackColor = true;
            this.edtPeriode.Properties.Appearance.Options.UseBorderColor = true;
            this.edtPeriode.Properties.Appearance.Options.UseFont = true;
            this.edtPeriode.Properties.AppearanceDropDown.BackColor = System.Drawing.Color.BlanchedAlmond;
            this.edtPeriode.Properties.AppearanceDropDown.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Pixel);
            this.edtPeriode.Properties.AppearanceDropDown.Options.UseBackColor = true;
            this.edtPeriode.Properties.AppearanceDropDown.Options.UseFont = true;
            this.edtPeriode.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            serializableAppearanceObject2.BackColor = System.Drawing.Color.Bisque;
            serializableAppearanceObject2.Options.UseBackColor = true;
            this.edtPeriode.Properties.Buttons.AddRange(new DevExpress.XtraEditors.Controls.EditorButton[] {
            new DevExpress.XtraEditors.Controls.EditorButton(DevExpress.XtraEditors.Controls.ButtonPredefines.Combo, "", -1, true, true, false, DevExpress.Utils.HorzAlignment.Center, null, new DevExpress.Utils.KeyShortcut(System.Windows.Forms.Keys.None), serializableAppearanceObject2)});
            this.edtPeriode.Properties.ButtonsStyle = DevExpress.XtraEditors.Controls.BorderStyles.UltraFlat;
            this.edtPeriode.Properties.Columns.AddRange(new DevExpress.XtraEditors.Controls.LookUpColumnInfo[] {
            new DevExpress.XtraEditors.Controls.LookUpColumnInfo("Text")});
            this.edtPeriode.Properties.DisplayMember = "Text";
            this.edtPeriode.Properties.NullText = "";
            this.edtPeriode.Properties.ShowFooter = false;
            this.edtPeriode.Properties.ShowHeader = false;
            this.edtPeriode.Properties.ValueMember = "Code";
            this.edtPeriode.Size = new System.Drawing.Size(158, 24);
            this.edtPeriode.TabIndex = 17;
            this.edtPeriode.EditValueChanged += new System.EventHandler(this.edtPeriode_EditValueChanged);
            //
            // colZeitspanne
            //
            this.colZeitspanne.Location = new System.Drawing.Point(16, 9);
            this.colZeitspanne.Name = "colZeitspanne";
            this.colZeitspanne.Size = new System.Drawing.Size(57, 24);
            this.colZeitspanne.TabIndex = 16;
            this.colZeitspanne.Text = "Zeitspanne";
            this.colZeitspanne.UseCompatibleTextRendering = true;
            //
            // lblJahr
            //
            this.lblJahr.Location = new System.Drawing.Point(259, 9);
            this.lblJahr.Name = "lblJahr";
            this.lblJahr.Size = new System.Drawing.Size(34, 24);
            this.lblJahr.TabIndex = 14;
            this.lblJahr.Text = "Jahr";
            this.lblJahr.UseCompatibleTextRendering = true;
            //
            // lblBis
            //
            this.lblBis.Location = new System.Drawing.Point(375, 9);
            this.lblBis.Name = "lblBis";
            this.lblBis.Size = new System.Drawing.Size(75, 24);
            this.lblBis.TabIndex = 14;
            this.lblBis.Text = "Buchungen bis";
            this.lblBis.UseCompatibleTextRendering = true;
            //
            // btnStartEchtlauf
            //
            this.btnStartEchtlauf.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnStartEchtlauf.Location = new System.Drawing.Point(733, 206);
            this.btnStartEchtlauf.Name = "btnStartEchtlauf";
            this.btnStartEchtlauf.Size = new System.Drawing.Size(121, 24);
            this.btnStartEchtlauf.TabIndex = 13;
            this.btnStartEchtlauf.Text = "Testlauf starten";
            this.btnStartEchtlauf.UseCompatibleTextRendering = true;
            this.btnStartEchtlauf.UseVisualStyleBackColor = false;
            this.btnStartEchtlauf.Visible = false;
            //
            // lblWVCode
            //
            this.lblWVCode.Location = new System.Drawing.Point(16, 35);
            this.lblWVCode.Name = "lblWVCode";
            this.lblWVCode.Size = new System.Drawing.Size(68, 24);
            this.lblWVCode.TabIndex = 2;
            this.lblWVCode.Text = "WV-Code";
            this.lblWVCode.UseCompatibleTextRendering = true;
            //
            // lblBED
            //
            this.lblBED.Location = new System.Drawing.Point(429, 35);
            this.lblBED.Name = "lblBED";
            this.lblBED.Size = new System.Drawing.Size(29, 24);
            this.lblBED.TabIndex = 1;
            this.lblBED.Text = "BED";
            this.lblBED.UseCompatibleTextRendering = true;
            //
            // qryNeufakturierungAbgesetzterMigWVEinzelpostenLog
            //
            this.qryNeufakturierungAbgesetzterMigWVEinzelpostenLog.HostControl = this;
            this.qryNeufakturierungAbgesetzterMigWVEinzelpostenLog.SelectStatement = "SELECT *\r\nFROM   NeufakturierungAbgesetzterMigWVEinzelpostenLog\r\nWHERE  KbWVLaufI" +
                "D = {0}";
            //
            // tmrFeedback
            //
            this.tmrFeedback.Interval = 300;
            //
            // CtlKbWVTestlauf
            //
            this.ActiveSQLQuery = this.qryKbWVEinzelposition;
            this.Name = "CtlKbWVTestlauf";
            this.Size = new System.Drawing.Size(876, 676);
            this.Load += new System.EventHandler(this.CtlKbWVTestlauf_Load);
            this.tabControlSearch.ResumeLayout(false);
            this.tpgListe.ResumeLayout(false);
            this.tpgSuchen.ResumeLayout(false);
            this.pnlFehlermeldungen.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.grdFehler)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gryKbWVLaufFehlermeldungen)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.gridView1)).EndInit();
            this.pnlEinzelposten.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.grdWVEinzelposten)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryKbWVEinzelposition)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvWVEinzelposten)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit2)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemCheckEdit1)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.repositoryItemTextEdit1)).EndInit();
            this.pnlGroup.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblLaufTitel)).EndInit();
            this.pnlSenden.ResumeLayout(false);
            this.pnlLauf.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.grdKbWVLauf)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryKbWVLauf)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.grvKbWVLauf)).EndInit();
            this.pnlNeuerLauf.ResumeLayout(false);
            ((System.ComponentModel.ISupportInitialize)(this.lblProgress)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtJahr.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblLaufzeitLegende)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblLaufzeit)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBis.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtWVCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtBED)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtPeriode.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtPeriode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.colZeitspanne)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblJahr)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBis)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblWVCode)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblBED)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.qryNeufakturierungAbgesetzterMigWVEinzelpostenLog)).EndInit();
            this.ResumeLayout(false);
        }

        #endregion

        #region Dispose

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if ((components != null))
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #endregion

        #region Public Methods

        public override bool OnAddData()
        {
            if (!DBUtil.IsEmpty(qryKbWVLauf["KbWVLaufID"]))
            {
                //if (!edtPeriode.Enabled)
                DataRow newRow = qryKbWVLauf.Insert();
                if (newRow != null)
                    EnableLaufParameter(true);
                return newRow == null;
            }
            return false;
        }

        public override bool OnDeleteData()
        {
            if (!qryKbWVLauf.CanDelete)
            {
                throw new KissErrorException(KissMsg.GetMLMessage(
                    "CtlKbWVTestlauf",
                    "DatensatzLoeschenNichtErlaubt",
                    "Das Löschen dieses Datensatzes ist nicht erlaubt!",
                    KissMsgCode.MsgError),
                    "SqlQuery.CanDelete = false", null);
            }
            if (KissMsg.ShowQuestion("Soll der Datensatz gelöscht werden ?"))
            {
                if (!DBUtil.IsEmpty(qryKbWVLauf["KbWVLaufID"]))
                {
                    DBUtil.ExecSQLThrowingException(@"DELETE FROM KbWVEinzelposten
                                                      WHERE KbWVLaufID = {0}
                                                        AND StorniertKbWVEinzelpostenID IS NOT NULL
                                                        AND KbWVEinzelpostenStatusCode = 100 /*Testlauf*/
                                                        AND KbWVEinzelpostenID NOT IN (SELECT StorniertKbWVEinzelpostenID FROM KbWVEinzelposten WHERE StorniertKbWVEinzelpostenID IS NOT NULL)", qryKbWVLauf["KbWVLaufID"]);
                    DBUtil.ExecSQLThrowingException(@"DELETE FROM KbWVEinzelposten
                                                      WHERE KbWVLaufID = {0}
                                                        AND StorniertKbWVEinzelpostenID IS NOT NULL
                                                        AND KbWVEinzelpostenStatusCode = 100 /*Testlauf*/
                                                        AND KbWVEinzelpostenID NOT IN (SELECT StorniertKbWVEinzelpostenID FROM KbWVEinzelposten WHERE StorniertKbWVEinzelpostenID IS NOT NULL)", qryKbWVLauf["KbWVLaufID"]);
                    DBUtil.ExecSQLThrowingException(@"DELETE FROM KbWVEinzelposten
                                                      WHERE KbWVLaufID = {0}
                                                        AND StorniertKbWVEinzelpostenID IS NOT NULL
                                                        AND KbWVEinzelpostenStatusCode = 100 /*Testlauf*/
                                                        AND KbWVEinzelpostenID NOT IN (SELECT StorniertKbWVEinzelpostenID FROM KbWVEinzelposten WHERE StorniertKbWVEinzelpostenID IS NOT NULL)", qryKbWVLauf["KbWVLaufID"]);
                    DBUtil.ExecSQLThrowingException("DELETE FROM KbWVEinzelposten WHERE KbWVLaufID = {0} AND KbWVEinzelpostenStatusCode = 100 /*Testlauf*/", qryKbWVLauf["KbWVLaufID"]);
                    DBUtil.ExecSQLThrowingException("DELETE FROM KbWVLauf WHERE KbWVLaufID = {0}", qryKbWVLauf["KbWVLaufID"]);
                    qryKbWVLauf.Refresh();
                }
            }
            //qryKbWVLauf.Delete();
            return true;
        }

        public override bool OnSaveData()
        {
            if (m_wvLaufThread != null)
                return false;
            /*
            if( ActiveSQLQuery != null )
                return ActiveSQLQuery.Post();
            */
            return true;
        }

        public void WVLaufThread()
        {
            try
            {
                startTime = DateTime.Now;

                object wvLaufID = (object)DBUtil.ExecuteScalarSQLThrowingException(@"
                  INSERT INTO KbWVLauf(UserID, StartDatum, Testlauf, KbWVLaufPeriodeCode, Jahr, BuchungenBis, WVCodes, BEDs)
                  SELECT {0}, {1}, {2}, {3}, {4}, {5}, {6}, {7}

                  SELECT SCOPE_IDENTITY()", Session.User.UserID, DateTime.Now, testlauf, edtPeriode.EditValue, edtJahr.EditValue, edtBis.EditValue, edtWVCode.EditValue, edtBED.EditValue);

                qryKbWVLauf["KbWVLaufID"] = wvLaufID;
                qryKbWVLauf["KbWVLaufPeriodeCode"] = edtPeriode.EditValue;

                bool migriertPosten = (int)edtPeriode.EditValue == kbWVLaufPeriodeCodeMigriertePosten;

                int userId = Session.User.UserID;
                DateTime bis = DBUtil.IsEmpty(edtBis.EditValue) ? DateTime.MaxValue : (DateTime)edtBis.EditValue;
                string wvCodes = edtWVCode.EditValue;
                string beds = edtBED.EditValue;

                SqlConnection connection = null;
                try
                {
                    // Connection klonen, sonst steht KiSS trotz asynchron bei der ersten DB-Abfrage still...
                    connection = (SqlConnection)((ICloneable)Session.Connection).Clone();
                    connection.Open();

                    if (!migriertPosten)
                    {
                        m_wvLaufSqlCommand = new SqlCommand(@"EXEC dbo.spKbWVEinzelpostenGenerieren @p0, @p1, @p2, @p3, @p4, @p5", connection);
                        m_wvLaufSqlCommand.Parameters.AddWithValue("@p0", userId);
                        m_wvLaufSqlCommand.Parameters.AddWithValue("@p1", testlauf);
                        m_wvLaufSqlCommand.Parameters.AddWithValue("@p2", bis);
                        m_wvLaufSqlCommand.Parameters.AddWithValue("@p3", wvCodes);
                        m_wvLaufSqlCommand.Parameters.AddWithValue("@p4", beds);
                        m_wvLaufSqlCommand.Parameters.AddWithValue("@p5", wvLaufID);
                    }
                    else
                    {
                        m_wvLaufSqlCommand = new SqlCommand(@"EXEC dbo.spNeufakturierungAbgesetzterMigWVEinzelposten @p0, @p1, @p2, @p3", connection);
                        m_wvLaufSqlCommand.Parameters.AddWithValue("@p0", testlauf);
                        m_wvLaufSqlCommand.Parameters.AddWithValue("@p1", wvLaufID);
                        m_wvLaufSqlCommand.Parameters.AddWithValue("@p2", wvCodes);
                        m_wvLaufSqlCommand.Parameters.AddWithValue("@p3", beds);
                    }
                    m_wvLaufSqlCommand.CommandTimeout = 86400;
                    m_wvLaufSqlCommand.ExecuteNonQuery();
                    m_wvLaufResult = WVLaufResult.OK;
                    return;
                }
                catch (ThreadAbortException)
                {
                    // Der Benutzer hat den Lauf abgebrochen
                    m_wvLaufException = null;
                    m_wvLaufResult = WVLaufResult.Aborted;
                    return;
                }
                catch (Exception ex)
                {
                    m_wvLaufException = ex;
                    m_wvLaufResult = WVLaufResult.Exception;
                    return;
                }
                finally
                {
                    if (connection != null)
                    {
                        connection.Close();
                    }
                }
            }
            catch (ThreadAbortException)
            {
                // Der Benutzer hat den Lauf abgebrochen
                m_wvLaufException = null;
                m_wvLaufResult = WVLaufResult.Aborted;
                return;
            }
            catch (Exception ex2)
            {
                m_wvLaufException = ex2;
                m_wvLaufResult = WVLaufResult.Exception;
                return;
            }
            finally
            {
                m_wvLaufSqlCommand = null;
                m_wvLaufThread = null;
            }
        }

        #endregion

        #region Protected Methods

        protected override void RunSearch()
        {
            //KissMsg.ShowInfo(qryKbWVLauf["KbWVLaufID"].ToString());
            kissSearch.SelectParameters = new object[] { qryKbWVLauf["KbWVLaufID"] };
            if ((int)qryKbWVLauf["KbWVLaufPeriodeCode"] == kbWVLaufPeriodeCodeMigriertePosten)
            {
                // Migrierte Posten
                qryNeufakturierungAbgesetzterMigWVEinzelpostenLog.Fill(qryKbWVLauf["KbWVLaufID"]);
                grdFehler.DataSource = qryNeufakturierungAbgesetzterMigWVEinzelpostenLog;
            }
            else
            {
                gryKbWVLaufFehlermeldungen.Fill(qryKbWVLauf["KbWVLaufID"]);
                grdFehler.DataSource = gryKbWVLaufFehlermeldungen;
            }
            base.RunSearch();
        }

        #endregion

        #region Private Methods

        private void CtlKbWVTestlauf_Load(object sender, System.EventArgs e)
        {
            grvWVEinzelposten.OptionsView.ShowGroupPanel = true;
        }

        private void EnableLaufParameter(bool enable)
        {
            edtPeriode.Enabled = enable;
            edtJahr.Enabled = enable;
            edtBis.Enabled = enable;
            edtWVCode.Enabled = enable;
            edtBED.Enabled = enable;
            btnStartWVLauf.Enabled = enable;
        }

        private void ProgressEnd()
        {
            qryKbWVEinzelposition.Refresh();
        }

        private void ProgressStart()
        {
            Cursor = Cursors.WaitCursor;
            ApplicationFacade.DoEvents();

            DlgProgressLog.AddLine("Start der Übertragung");
            ApplicationFacade.DoEvents();

            int chunkSize = 100;
            int successCount = 0;
            int failureCount = 0;
            int count = 0;
            List<int> epIDs = new List<int>();
            DateTime lastKeyboardEvent = DateTime.Now;

            try
            {
                foreach (int id in IDs)
                {
                    ApplicationFacade.DoEvents();	 // Wir sollten hier mal kurz prüfen, ob Cancel gedrückt wurde, und der Display muss auch wieder refreshed werden

                    epIDs.Add(id);
                    count++;

                    // alle 30 Min senden wir einfach irgendeinen irrelevanten Keyboard Event, so dass der Citrix-Client die Session offenlässt
                    if (lastKeyboardEvent.AddMinutes(30) < DateTime.Now)
                    {
                        SendKeys.Send("{F16}");
                        lastKeyboardEvent = DateTime.Now;
                    }

                    // Sende immer grosse Chunks von IDs, oder sende den Rest, wenn am Ende der Liste
                    if (count % chunkSize == 0 || count == IDs.Count)
                    {
                        try
                        {
                            DlgProgressLog.AddLine(count + " von " + IDs.Count + ": Sende " + epIDs.Count + " WV-Einzelposten an PSCD...");

                            bool success = KiSS4.FAMOZ.PSCDServices.PSCDInterface.SubmitWVEinzelpostenByIDs(epIDs.ToArray());

                            if (success)
                                successCount++;
                            else
                                failureCount++;
                        }
                        catch (Exception ex)
                        {
                            DlgProgressLog.AddLine(ex.Message);
                            failureCount++;
                        }
                        finally
                        {
                            epIDs.Clear();
                        }
                    }
                }
                DlgProgressLog.AddLine("Ende der Übertragung");
                DlgProgressLog.AddLine(string.Format("- {0} WV-Übermittlungen (à " + chunkSize + " Einzelposten) erfolgreich übermittelt", successCount));
                DlgProgressLog.AddLine(string.Format("- {0} WV-Übermittlungen (à " + chunkSize + " Einzelposten) teilweise fehlerhaft", failureCount));
            }
            catch (CancelledByUserException)
            {
                KissMsg.ShowInfo("Abbruch durch Benutzer/in\r\n\r\n" +
                                 string.Format("- {0} WV-Übermittlungen (à " + chunkSize + " Einzelposten) erfolgreich übermittelt", successCount) + "\r\n" +
                                 string.Format("- {0} WV-Übermittlungen (à " + chunkSize + " Einzelposten) teilweise fehlerhaft", failureCount));
            }

            Cursor = Cursors.Default;

            DlgProgressLog.EndProgress();
            DlgProgressLog.ShowTopMost();
        }

        private void btnAlle_Click(object sender, System.EventArgs e)
        {
            foreach (DataRow row in qryKbWVEinzelposition.DataTable.Rows)
            {
                if (!DBUtil.IsEmpty(row["Sel"]))
                    row["Sel"] = true;
            }
        }

        private void btnDeleteStatusLV_Click(object sender, System.EventArgs e)
        {
            DeleteEPs(false);
        }

        private void btnDeleteStatusL_Click(object sender, System.EventArgs e)
        {
            DeleteEPs(true);
        }

        private void DeleteEPs(bool deleteOnlyStatusL)
        {
            try
            {
                Session.BeginTransaction();

                if (!(bool)qryKbWVLauf["Testlauf"])
                {
                    DBUtil.ExecSQLThrowingException(@"UPDATE KbWVEinzelposten
                                                      SET Ungueltig = 0
                                                      WHERE KbWVEinzelpostenID IN (SELECT StorniertKbWVEinzelpostenID
                                                                                   FROM KbWVEinzelposten
                                                                                   WHERE KbWVLaufID = {0} AND StorniertKbWVEinzelpostenID IS NOT NULL)", qryKbWVLauf["KbWVLaufID"]);
                }

                // Delete twice because of self-references
                for (int i = 0; i < 2; i++)
                {
                    DBUtil.ExecSQLThrowingException(@"DELETE FROM KbWVEinzelposten
                                                      WHERE KbWVLaufID = {0}
                                                       AND (KbWVEinzelpostenStatusCode = 1 /*Status L*/ OR
                                                            KbWVEinzelpostenStatusCode = 2 /*Status V*/ AND 0={1})
                                                       AND KbWVEinzelpostenID NOT IN (SELECT StorniertKbWVEinzelpostenID FROM KbWVEinzelposten WHERE StorniertKbWVEinzelpostenID IS NOT NULL)", qryKbWVLauf["KbWVLaufID"], deleteOnlyStatusL);
                }
                Session.Commit();
            }
            catch (Exception ex)
            {
                Session.Rollback();
                KissMsg.ShowError(ex.Message);
            }
            qryKbWVLauf.Refresh();
        }

        private void btnGroupByBED_Click(object sender, System.EventArgs e)
        {
            KissLookupDialog dlg = new KissLookupDialog();
            dlg.SearchData(@"
                SELECT BED = BEDCode, [Betrag Total] = CONVERT(varchar,SUM(Betrag),0), [Anzahl Posten] = Count(*)
                FROM KbWVEinzelposten
                WHERE KbWVLaufID = {1}
                GROUP BY BEDCode WITH ROLLUP
                ORDER BY BEDCode", "", true, qryKbWVLauf["KbWVLaufID"]);
        }

        private void btnGroupByWVCode_Click(object sender, System.EventArgs e)
        {
            KissLookupDialog dlg = new KissLookupDialog();
            dlg.SearchData(@"
                SELECT WVCode = dbo.fnLOVShortText('BaWVCode',WVCode), [Betrag Total] = CONVERT(varchar,SUM(Betrag),0), [Anzahl Posten] = Count(*)
                FROM KbWVEinzelposten
                WHERE KbWVLaufID = {1}
                GROUP BY WVCode WITH ROLLUP
                ORDER BY WVCode", "", true, qryKbWVLauf["KbWVLaufID"]);
        }

        private void btnKeine_Click(object sender, System.EventArgs e)
        {
            foreach (DataRow row in qryKbWVEinzelposition.DataTable.Rows)
            {
                if (!DBUtil.IsEmpty(row["Sel"]))
                    row["Sel"] = false;
            }
        }

        private void btnSend_Click(object sender, System.EventArgs e)
        {
            decimal total = 0m;

            IDs.Clear();

            foreach (DataRow R in qryKbWVEinzelposition.DataTable.Rows)
            {
                if (!DBUtil.IsEmpty(R["Sel"]) && (bool)R["Sel"])
                {
                    IDs.Add((int)R["KbWVEinzelpostenID"]);
                    total += (decimal)R["Betrag"];
                }
            }
            if (IDs.Count == 0) return;
            totalWV_EPCount = IDs.Count;

            string msg;
            if (IDs.Count == 1)
                msg = string.Format("Soll 1 WV-Posten mit dem Betrag von CHF {0:0,0.00} an PSCD übermittelt werden?", total);
            else
                msg = string.Format("Sollen {0} WV-Posten mit dem Total von CHF {1:0,0.00} an PSCD übermittelt werden?", IDs.Count, total);

            if (KissMsg.ShowQuestion(msg))
            {
                DlgProgressLog.Show("Übertragung WV-Einzelposten", 700, 500, new ProgressEventHandler(ProgressStart), new ProgressEventHandler(ProgressEnd), Session.MainForm);
            }
        }

        private void btnStartWVLauf_Click(object sender, System.EventArgs e)
        {
            if (m_wvLaufThread != null)
            {
                // Der Lauf läuft, d.h. wir sollen den Lauf abbrechen (zuerst nachfragen)
                if (KissMsg.ShowQuestion("Wollen Sie den Lauf wirklich abbrechen?"))
                {
                    // OK, Abbruch wurde bestätigt. Wir müssen nochmals prüfen, ob der Thread und der SqlCommand immer noch laufen oder nicht
                    try
                    {
                        Cursor = Cursors.WaitCursor;
                        if (m_wvLaufSqlCommand != null)
                        {
                            m_wvLaufSqlCommand.Cancel();
                        }
                        if (m_wvLaufThread != null)
                        {
                            m_wvLaufThread.Abort();
                            m_wvLaufThread.Join();
                        }
                    }
                    catch (Exception ex)
                    {
                        Cursor = Cursors.Default;
                        KissMsg.ShowError("Beim Abbrechen des Laufs ist folgender Fehler aufgetreten: " + ex.ToString());
                    }
                    finally
                    {
                        Cursor = Cursors.Default;
                    }
                }
            }
            else
            {
                // Der Lauf läuft noch nicht, d.h. starte den Lauf
                m_wvLaufThread = new Thread(new ThreadStart(WVLaufThread));

                m_wvLaufThread.Start();

                btnFeedback.Visible = true;
                lblLaufzeit.Visible = true;
                lblProgress.Visible = true;
                lblLaufzeitLegende.Visible = true;
                tmrFeedback_OnTick(null, EventArgs.Empty);
                tmrFeedback.Enabled = true;

                btnStartWVLauf.Text = testlauf ? "Testlauf abbrechen" : "Echtlauf abbrechen";

                KissMsg.ShowInfo("Der Lauf ist nun gestartet. WICHTIG: Bitte arbeiten Sie in dieser KiSS-Applikation nicht weiter, bis der Lauf vollständig aufbereitet ist!");
            }
        }

        private void edtPeriode_EditValueChanged(object sender, System.EventArgs e)
        {
            //KissMsg.ShowInfo(string.Format("EditValue {0}, <> {1}",edtPeriode.EditValue,qryKbWVLauf["KbWVLaufPeriodeCode"]));
            if (DBUtil.IsEmpty(edtPeriode.EditValue))
                return;
            try
            {
                if ((int)edtPeriode.EditValue == 7) // migrierte posten
                {
                    edtJahr.EditValue = null;
                    edtBis.EditValue = null;
                    return;
                }

                //qryKbWVLauf["KbWVLaufPeriodeCode"] = edtPeriode.EditValue;
                //KissMsg.ShowInfo(string.Format("EditValue {0}, Code {1}",edtPeriode.EditValue,qryKbWVLauf["KbWVLaufPeriodeCode"]));
                DataRow row = ((SqlQuery)edtPeriode.Properties.DataSource).DataTable.Select(string.Format("Code = {0}", edtPeriode.EditValue))[0];
                edtWVCode.EditValue = (string)row["WVCodes"];
                edtBED.EditValue = (string)row["BEDs"];
                //KissMsg.ShowInfo(string.Format("WV {0}, BED {1}",qryKbWVLauf["WVCodes"],qryKbWVLauf["BEDs"]));
                int jahr = DateTime.Today.Year;
                if (!DBUtil.IsEmpty(edtJahr.EditValue))
                    jahr = (int)edtJahr.EditValue;
                int monat = int.Parse((string)row["Monat"]);
                edtBis.EditValue = new DateTime(jahr, monat, DateTime.DaysInMonth(jahr, monat));
                //KissMsg.ShowInfo(string.Format("EditValue {0}, Code {1}",edtPeriode.EditValue,qryKbWVLauf["KbWVLaufPeriodeCode"]));
            }
            catch (Exception ex)
            {
                KissMsg.ShowInfo(ex.Message);
            }
        }

        private void grvWVEinzelposten_CustomRowCellEdit(object sender, DevExpress.XtraGrid.Views.Grid.CustomRowCellEditEventArgs e)
        {
            if (e.Column == colSelektion)
            {
                if (DBUtil.IsEmpty(grvWVEinzelposten.GetRowCellValue(e.RowHandle, e.Column)))
                    e.RepositoryItem = repositoryItemTextEdit1;
                else
                    e.RepositoryItem = repositoryItemCheckEdit2;
            }
        }

        private void qryKbWVLauf_AfterInsert(object sender, System.EventArgs e)
        {
            EnableLaufParameter(true);

            edtJahr.EditValue = DateTime.Today.Year;

            edtPeriode.EditValue =
            (int)DBUtil.ExecuteScalarSQL(@"
                SELECT TOP 1 Code
                FROM (SELECT Code, Value3 FROM XLOVCode WHERE LOVName = 'KbWVLaufPeriode') LOV
                WHERE Value3 <= {0} OR {0} < 3
                ORDER BY Value3 DESC", DateTime.Today.Month);
        }

        private void qryKbWVLauf_PositionChanged(object sender, System.EventArgs e)
        {
            bool newWVLauf = DBUtil.IsEmpty(qryKbWVLauf["KbWVLaufID"]);
            EnableLaufParameter(newWVLauf);
            /*
            try
            {
            pnlNeuerLauf.Visible = (int)qryKbWVLauf["AnzahlEPs"] == 0;//DBUtil.IsEmpty(qryKbWVLauf["KbWVLaufID"]);//(int)qryKbWVLauf["AnzahlEPs"] == 0;
            }
            catch
            {
            pnlNeuerLauf.Visible = false;
            }
            */
            if (!newWVLauf)
            {
                edtBED.EditValue = qryKbWVLauf["BEDs"] as string;
                edtWVCode.EditValue = qryKbWVLauf["WVCodes"] as string;
                edtBis.EditValue = qryKbWVLauf["BuchungenBis"];
                edtJahr.EditValue = qryKbWVLauf["Jahr"];

                lblLaufTitel.Text = "Lauf " + qryKbWVLauf["KbWVLaufID"] + " (" + qryKbWVLauf["Periode"] + " " + qryKbWVLauf["Jahr"] + ")";
            }
        }

        private void tmrFeedback_OnTick(object sender, EventArgs e)
        {
            if (m_wvLaufThread != null)
            {
                if (++iconIndex >= iconIDs.Length)
                    iconIndex = 0;
                btnFeedback.IconID = iconIDs[iconIndex];
                TimeSpan laufzeit = DateTime.Now - startTime;
                lblLaufzeit.Text = string.Format("{0}h {1:00}min {2:00}s", laufzeit.Hours, laufzeit.Minutes, laufzeit.Seconds);

                // Alle 2 sek machen wir einen Update des Progress-Texts
                if (lastProgressUpdate.AddSeconds(2) < DateTime.Now)
                {
                    try
                    {
                        lblProgress.Text = (string)DBUtil.ExecuteScalarSQL("SELECT Text FROM dbo.KbWVLauf WITH (READUNCOMMITTED) WHERE KbWvLaufID = {0}", qryKbWVLauf["KbWVLaufID"]);
                    }
                    catch (Exception)
                    {
                        // Keine Aktion hier
                    }

                    lastProgressUpdate = DateTime.Now;
                }
                // alle 30 Min senden wir einfach irgendeinen irrelevanten Keyboard Event, so dass der Citrix-Client die Session offenlässt
                if (lastKeyboardEvent.AddMinutes(30) < DateTime.Now)
                {
                    SendKeys.Send("{F16}");
                    lastKeyboardEvent = DateTime.Now;
                }
            }
            else
            {
                // Stelle den Timer ab
                tmrFeedback.Enabled = false;

                // Prüfe das Resultat des Laufs
                switch (m_wvLaufResult)
                {
                    case WVLaufResult.OK:

                        lblProgress.Text = "";
                        KissMsg.ShowInfo("Der Lauf wurde erfolgreich aufbereitet");

                        qryKbWVLauf["AnzahlEPs"] = qryKbWVEinzelposition.Count;
                        try
                        {
                            EnableLaufParameter(false);
                        }
                        catch (Exception exx)
                        {
                            KissMsg.ShowInfo(exx.Message);
                        }
                        break;

                    case WVLaufResult.Exception:
                        if (m_wvLaufException != null)
                        {
                            if (m_wvLaufException as ThreadAbortException == null)
                            {
                                // Dies ist keine Thread Abort Exception => Zeige die Exception an
                                KissMsg.ShowError("Die Aufbereitung des Laufs wurde durch folgenden Fehler abgebrochen: " + m_wvLaufException.ToString());
                            }
                        }
                        else
                        {
                            KissMsg.ShowError("Die Aufbereitung des Laufs wurde durch einen unbekannten Fehler abgebrochen!");
                        }
                        break;

                    case WVLaufResult.Aborted:
                        lblProgress.Text = "";
                        KissMsg.ShowInfo("Der Lauf wurde abgebrochen");
                        break;
                }

                btnStartWVLauf.Text = testlauf ? "Testlauf starten" : "Echtlauf starten";
                btnStartWVLauf.Enabled = false;
                m_wvLaufResult = WVLaufResult.Unknown;
                m_wvLaufException = null;

                qryKbWVLauf.Refresh();
            }
        }

        #endregion
    }
}