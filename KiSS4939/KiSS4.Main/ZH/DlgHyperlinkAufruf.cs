#region Header

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.832
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#endregion

using KiSS4.DB;
using KiSS4.Gui;

namespace KiSS4.Main.ZH
{
    public class DlgHyperlinkAufruf : KiSS4.Gui.KissDialog
    {
        #region Fields

        private KiSS4.Gui.KissHyperlinkButton btnLink;
        private KiSS4.Gui.KissTextEdit edtKontextname;
        private KiSS4.Gui.KissMemoEdit edtPfad;
        private KiSS4.Gui.KissLabel lblKontextname;

        #endregion

        #region Constructors

        public DlgHyperlinkAufruf()
        {
            this.InitializeComponent();

            string context = "";

            KissChildForm frm = Session.MainForm.ActiveMdiChild as KissChildForm;
            if (frm != null || Session.IsKiss5Mode)
            {
                System.Collections.Specialized.HybridDictionary dic = FormController.GetMessage(frm,
                "Action", "GetJumpToPath") as System.Collections.Specialized.HybridDictionary;

                edtPfad.Text = FormController.ConvertToString(dic);

                if (!DBUtil.IsEmpty(dic["TreeNodeID"]))
                {
                    context = dic["TreeNodeID"].ToString();
                    context = context.Substring(context.LastIndexOf("/") + 1);  //strip leading namespace
                    context = System.Text.RegularExpressions.Regex.Replace(context, @"\d*$", "");
                }
                else if (!DBUtil.IsEmpty(dic["ClassName"]))
                {
                    context = dic["ClassName"].ToString();
                }
            }
            switch (context)
            {
                case "":
                    context = "FrmMain";
                    break;

                case "S":
                    context = "CtlSozialsystemContainer";
                    break;

                case "P":
                    context = "CtlBaPerson";
                    break;
            }

            edtKontextname.Text = context;
            btnLink.Context = context;

            SqlQuery qry = DBUtil.OpenSQL("select 1 from XHyperlinkContext where Name = {0}", btnLink.Context);
            if (qry.Count == 0)
            {
                KissMsg.ShowInfo("Für diese Maske sind keine Intranet/Internet-Seiten eingerichtet");
                btnLink.Context = "";
            }
        }

        #endregion

        #region Windows Form Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            this.btnLink = new KiSS4.Gui.KissHyperlinkButton();
            this.edtKontextname = new KiSS4.Gui.KissTextEdit();
            this.lblKontextname = new KiSS4.Gui.KissLabel();
            this.edtPfad = new KiSS4.Gui.KissMemoEdit();
            ((System.ComponentModel.ISupportInitialize)(this.edtKontextname.Properties)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKontextname)).BeginInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtPfad.Properties)).BeginInit();
            this.SuspendLayout();
            //
            // btnLink
            //
            this.btnLink.BackColor = System.Drawing.Color.Bisque;
            this.btnLink.ButtonStyle = KiSS4.Gui.ButtonStyleType.Custom;
            this.btnLink.Context = null;
            this.btnLink.FlatAppearance.BorderColor = System.Drawing.Color.Black;
            this.btnLink.FlatStyle = System.Windows.Forms.FlatStyle.Flat;
            this.btnLink.Font = new System.Drawing.Font("Arial", 12F, System.Drawing.FontStyle.Underline, System.Drawing.GraphicsUnit.Pixel);
            this.btnLink.ForeColor = System.Drawing.Color.Blue;
            this.btnLink.Location = new System.Drawing.Point(12, 54);
            this.btnLink.Name = "btnLink";
            this.btnLink.Size = new System.Drawing.Size(90, 24);
            this.btnLink.TabIndex = 1;
            this.btnLink.Text = "Hyperlink";
            this.btnLink.URL = null;
            this.btnLink.UseCompatibleTextRendering = true;
            this.btnLink.UseVisualStyleBackColor = true;
            //
            // edtKontextname
            //
            this.edtKontextname.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtKontextname.Location = new System.Drawing.Point(12, 24);
            this.edtKontextname.Name = "edtKontextname";
            this.edtKontextname.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtKontextname.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtKontextname.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtKontextname.Properties.Appearance.Options.UseBackColor = true;
            this.edtKontextname.Properties.Appearance.Options.UseBorderColor = true;
            this.edtKontextname.Properties.Appearance.Options.UseFont = true;
            this.edtKontextname.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtKontextname.Properties.ReadOnly = true;
            this.edtKontextname.Size = new System.Drawing.Size(230, 24);
            this.edtKontextname.TabIndex = 2;
            //
            // lblKontextname
            //
            this.lblKontextname.Location = new System.Drawing.Point(12, -2);
            this.lblKontextname.Name = "lblKontextname";
            this.lblKontextname.Size = new System.Drawing.Size(100, 23);
            this.lblKontextname.TabIndex = 3;
            this.lblKontextname.Text = "Kontextname";
            this.lblKontextname.UseCompatibleTextRendering = true;
            //
            // edtPfad
            //
            this.edtPfad.EditMode = Kiss.Interfaces.UI.EditModeType.ReadOnly;
            this.edtPfad.Location = new System.Drawing.Point(13, 85);
            this.edtPfad.Name = "edtPfad";
            this.edtPfad.Properties.Appearance.BackColor = System.Drawing.Color.FromArgb(((int)(((byte)(247)))), ((int)(((byte)(239)))), ((int)(((byte)(231)))));
            this.edtPfad.Properties.Appearance.BorderColor = System.Drawing.Color.Linen;
            this.edtPfad.Properties.Appearance.Font = new System.Drawing.Font("Arial", 13F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Pixel);
            this.edtPfad.Properties.Appearance.Options.UseBackColor = true;
            this.edtPfad.Properties.Appearance.Options.UseBorderColor = true;
            this.edtPfad.Properties.Appearance.Options.UseFont = true;
            this.edtPfad.Properties.BorderStyle = DevExpress.XtraEditors.Controls.BorderStyles.HotFlat;
            this.edtPfad.Properties.ReadOnly = true;
            this.edtPfad.Size = new System.Drawing.Size(352, 119);
            this.edtPfad.TabIndex = 4;
            //
            // DlgHyperlinkAufruf
            //
            this.ClientSize = new System.Drawing.Size(377, 216);
            this.Controls.Add(this.edtPfad);
            this.Controls.Add(this.lblKontextname);
            this.Controls.Add(this.edtKontextname);
            this.Controls.Add(this.btnLink);
            this.Name = "DlgHyperlinkAufruf";
            this.Text = "Hyperlink Test";
            this.Load += new System.EventHandler(this.DlgHyperlinkAufruf_Load);
            ((System.ComponentModel.ISupportInitialize)(this.edtKontextname.Properties)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.lblKontextname)).EndInit();
            ((System.ComponentModel.ISupportInitialize)(this.edtPfad.Properties)).EndInit();
            this.ResumeLayout(false);
        }

        #endregion

        #region Private Methods

        private void DlgHyperlinkAufruf_Load(object sender, System.EventArgs e)
        {
            if (!DBUtil.UserHasRight("DlgHyperlinkAufruf_AdminShowKontext"))
            {
                this.StartPosition = System.Windows.Forms.FormStartPosition.Manual;
                this.Location = new System.Drawing.Point(10000, 0);
            }
            if (btnLink.Context != "") btnLink.PerformClick();
            if (!DBUtil.UserHasRight("DlgHyperlinkAufruf_AdminShowKontext"))
            {
                Close();
            }
        }

        #endregion
    }
}